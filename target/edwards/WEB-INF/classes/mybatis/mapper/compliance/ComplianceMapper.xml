<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edwards.biz.complianceManagement.ComplianceMapper">
    <select id="selectModelList" resultType="map">
		/* 요건 식품 품목마스터 */
		select *
		from soo.dbo.CPS_YogunItem
		where useYn = 'Y'
		<if test='itemKey != null and itemKey != ""'>AND itemKey = #{itemKey}</if>
		<if test='yogSaup != null and yogSaup != ""'>AND yogSaup = #{yogSaup}</if>
		<if test='codeName != null and codeName != ""'>AND codeName LIKE #{codeName} + '%'</if>
		<if test='engName != null and engName != ""'>AND engName LIKE '%' + #{engName} + '%'</if>
		<if test='codeName1 != null and codeName1 != ""'>AND codeName = #{codeName1}</if>
		<if test='engName1 != null and engName1 != ""'>AND engName = #{engName1}</if>
        order by itemKey desc
	</select>

    <insert id="insertModel">
		/* 요건 식품 품목 입력 */
		INSERT INTO soo.dbo.CPS_YogunItem
		(yogCom,
		yogSaup,
		codeName,
		engName,
		korName,
		hsCode,
		useYn,
		addUserId,
		addUserNm,
		addDtm)
		VALUES
		(#{yogCom},
		#{yogSaup},
		#{codeName},
		#{engName},
		#{korName},
		#{hsCode},
		#{useYn},
		#{_userId},
		#{_userNm},
		#{addDtm}
		)
	</insert>

    <update id="updateModel">
		/* 요건 식품 품목 수정 */
		update soo.dbo.CPS_YogunItem
	    set
	    korName 		= #{korName},
	    hsCode 			= #{hsCode},
	    editUserId 		= #{_userId},
		editUserNm 		= #{_userNm},
		editDtm 		= #{editDtm}
		where itemKey 	= #{itemKey}
	</update>

    <insert id="insertSikpumMaster">
		/* 요건식품 입력 */
		INSERT INTO soo.dbo.CPS_YogunMaster
		(seinGubun,
		yogCom,
		yogSaup,
		hblNo,
		mrnNo,
		invNo,
		iphangDate,
		banipDate,
		singoDate,
		suriDate,
		jangchiCode,
		jangchiName,
		jubsuDate,
		finishDate,
		testGubun,
		jungmilCost,
		labelCost,
		etcCost,
		fees,
		remark,
		program,
		billGubun,
		billDate,
		useYn,
		addUserId,
		addUserNm,
		addDtm)
		VALUES
		(#{seinGubun},
		#{yogCom},
		#{yogSaup},
		#{hblNo},
		#{mrnNo},
		#{invNo},
		#{iphangDate},
		#{banipDate},
		#{singoDate},
		#{suriDate},
		#{jangchiCode},
		#{jangchiName},
		#{jubsuDate},
		#{finishDate},
		#{testGubun},
		#{jungmilCost},
		#{labelCost},
		#{etcCost},
		#{fees},
		#{remark},
		#{program},
		#{billGubun},
		#{billDate},
		#{useYn},
		#{_userId},
		#{_userNm},
		#{addDtm}
		)
	</insert>

    <update id="updateSikpumMaster">
		/* 요건 식품 마스터 수정 */
		update soo.dbo.CPS_YogunMaster
	    set
	    seinGubun		= #{seinGubun},
	    yogCom			= #{yogCom},
		yogSaup			= #{yogSaup},
		hblNo			= #{hblNo},
		mrnNo			= #{mrnNo},
		invNo			= #{invNo},
		iphangDate		= #{iphangDate},
		banipDate		= #{banipDate},
		singoDate		= #{singoDate},
		suriDate		= #{suriDate},
		jangchiCode		= #{jangchiCode},
		jangchiName		= #{jangchiName},
		jubsuDate		= #{jubsuDate},
		finishDate		= #{finishDate},
		testGubun		= #{testGubun},
		jungmilCost		= #{jungmilCost},
		labelCost		= #{labelCost},
		etcCost			= #{etcCost},
		fees			= #{fees},
		remark			= #{remark},
		program			= #{program},
		billGubun		= #{billGubun},
		billDate		= #{billDate},
		useYn			= #{useYn},
		editUserId		= #{_userId},
		editUserNm		= #{_userNm},
		editDtm			= #{editDtm}
		where yogKey 	= #{yogKey}
	</update>

    <update id="deleteSikpumMaster">
		/* 요건 식품 마스터 삭제 */
		update soo.dbo.CPS_YogunMaster
	    set
		useYn			= #{useYn},
		editUserId		= #{_userId},
		editUserNm		= #{_userNm},
		editDtm			= #{editDtm}
		where yogKey 	= #{yogKey}
	</update>

    <update id="gwanSikpumMaster">
		/* 요건 식품 마스터 관세청 업데이트 */
		update soo.dbo.CPS_YogunMaster
	    set
		mrnNo			= #{cargo},
		banipDate		= #{banip},
		jangchiCode		= #{jangchic},
		jangchiName		= #{jangchin},
		editUserId		= #{_userId},
		editUserNm		= #{_userNm},
		editDtm			= #{editDtm}
		where yogKey 	= #{yogKey}
	</update>

    <update id="saveDetailMaster">
		/* 요건 식품 마스터 접수일 완료일 비고 업데이트 */
		update soo.dbo.CPS_YogunMaster
	    set
		jubsuDate		= #{jubsuDate},
		finishDate		= #{finishDate},
		remark			= #{remark},
		editUserId		= #{_userId},
		editUserNm		= #{_userNm},
		editDtm			= #{editDtm}
		where yogKey 	= #{yogKey}
	</update>

    <select id="selectSikpumMaster" resultType="map">
		/* 요건 식품 마스터 */
		select *
		from soo.dbo.CPS_YogunMaster
		where useYn = 'Y'
		<if test='yogKey != null and yogKey != ""'>AND yogKey = #{yogKey}</if>
		<if test='yogSaup != null and yogSaup != ""'>AND yogSaup = #{yogSaup}</if>
		<if test='hblNo != null and hblNo != ""'>AND hblNo LIKE '%' + #{hblNo} + '%'</if>
        order by yogKey desc
	</select>

    <select id="selectSikpumTop1Master" resultType="map">
		/* 요건 식품 마스터 top1*/
		select top 1 *
		from soo.dbo.CPS_YogunMaster
		where useYn = 'Y'
		<if test='yogKey != null and yogKey != ""'>AND yogKey = #{yogKey}</if>
		<if test='yogSaup != null and yogSaup != ""'>AND yogSaup = #{yogSaup}</if>
		<if test='hblNo != null and hblNo != ""'>AND hblNo LIKE '%' + #{hblNo} + '%'</if>
        order by yogKey desc
	</select>

    <insert id="copySikpumMaster">
		/* 요건식품 복사 */
		INSERT INTO soo.dbo.CPS_YogunMaster
		(seinGubun,
		yogCom,
		yogSaup,
		hblNo,
		mrnNo,
		invNo,
		iphangDate,
		banipDate,
		singoDate,
		suriDate,
		jangchiCode,
		jangchiName,
		jubsuDate,
		finishDate,
		testGubun,
		jungmilCost,
		labelCost,
		etcCost,
		fees,
		remark,
		program,
		billGubun,
		billDate,
		useYn,
		addUserId,
		addUserNm,
		addDtm)
		select seinGubun,
		yogCom,
		yogSaup,
		hblNo,
		mrnNo,
		invNo,
		iphangDate,
		banipDate,
		singoDate,
		suriDate,
		jangchiCode,
		jangchiName,
		jubsuDate,
		finishDate,
		testGubun,
		jungmilCost,
		labelCost,
		etcCost,
		fees,
		remark,
		program,
		billGubun,
		billDate,
		#{useYn},
		#{_userId},
		#{_userNm},
		#{addDtm}
		from soo.dbo.CPS_YogunMaster
		where useYn = 'Y'
		<if test='yogKey != null and yogKey != ""'>AND yogKey = #{yogKey}</if>
	</insert>

    <insert id="insertSikpumDetail">
		/* 요건 식품 Detail 입력 */
		INSERT INTO soo.dbo.CPS_YogunDetail
		(yogKey,
		itemKey,
		category,
		su,
		jung,
		wonsanji,
		productCode,
		productCom,
		exportCode,
		exportCom,
		singoCode,
		singoName,
		memo,
		useYn,
		addUserId,
		addUserNm,
		addDtm)
		VALUES
		(#{yogKey},
		#{itemKey},
		#{category},
		#{su},
		#{jung},
		#{wonsanji},
		#{productCode},
		#{productCom},
		#{exportCode},
		#{exportCom},
		#{singoCode},
		#{singoName},
		#{memo},
		#{useYn},
		#{_userId},
		#{_userNm},
		#{addDtm}
		)
	</insert>

    <insert id="copySikpumDetail">
		/* 요건 식품 Detail 복사 */
		INSERT INTO soo.dbo.CPS_YogunDetail
		(yogKey,
		itemKey,
		category,
		su,
		jung,
		wonsanji,
		productCode,
		productCom,
		exportCode,
		exportCom,
		singoCode,
		singoName,
		memo,
		useYn,
		addUserId,
		addUserNm,
		addDtm)
		select
		#{_yogKey},
		itemKey,
		category,
		su,
		jung,
		wonsanji,
		productCode,
		productCom,
		exportCode,
		exportCom,
		singoCode,
		singoName,
		memo,
		#{useYn},
		#{_userId},
		#{_userNm},
		#{addDtm}
		from soo.dbo.CPS_YogunDetail
		where useYn = 'Y'
		<if test='yogKey != null and yogKey != ""'>AND yogKey = #{yogKey}</if>
	</insert>

    <update id="updateSikpumDetail">
		/* 요건 식품 Detail 수정 */
		update soo.dbo.CPS_YogunDetail
	    set
	    category		= #{category},
		su				= #{su},
		jung			= #{jung},
		wonsanji		= #{wonsanji},
		productCode		= #{productCode},
		productCom		= #{productCom},
		exportCode		= #{exportCode},
		exportCom		= #{exportCom},
		singoCode		= #{singoCode},
		singoName		= #{singoName},
		memo			= #{memo},
	    editUserId 		= #{_userId},
		editUserNm 		= #{_userNm},
		editDtm 		= #{editDtm}
		where yogdKey 	= #{yogdKey}
	</update>

    <select id="selectSikpumDetailList" resultType="map">
		/* 요건 식품 디테일 */
		select a.*, b.*
		from soo.dbo.CPS_YogunDetail a, soo.dbo.CPS_YogunItem b
		where a.useYn = 'Y'
		and a.itemKey = b.itemKey
		<if test='yogKey != null and yogKey != ""'>AND a.yogKey = #{yogKey}</if>
		<if test='itemKey != null and itemKey != ""'>AND a.itemKey = #{itemKey}</if>
        order by a.yogdKey desc
	</select>

    <select id="selectSikpumDetailTop1List" resultType="map">
		/* 요건 식품 디테일 Top1 */
		select top 1 a.*, b.*
		from soo.dbo.CPS_YogunDetail a, soo.dbo.CPS_YogunItem b
		where a.useYn = 'Y'
		and a.itemKey = b.itemKey
		<if test='yogKey != null and yogKey != ""'>AND a.yogKey = #{yogKey}</if>
		<if test='itemKey != null and itemKey != ""'>AND a.itemKey = #{itemKey}</if>
        order by a.yogdKey desc
	</select>

    <update id="deleteSikpumDetail">
		/* 요건 식품 Detail 삭제 */
		update soo.dbo.CPS_YogunDetail
	    set
	    useYn 			= #{useYn},
	    editUserId 		= #{_userId},
		editUserNm 		= #{_userNm},
		editDtm 		= #{editDtm}
		where yogdKey 	= #{yogdKey}
	</update>

    <select id="selectSikpumList" resultType="map">
		/* 요건 식품 마스터 */
		select a.*, b.*, c.*
		from soo.dbo.CPS_YogunMaster a, soo.dbo.CPS_YogunDetail b, soo.dbo.CPS_YogunItem c
		where a.yogKey = b.yogKey
		and b.itemKey = c.itemKey
		and a.useYn='Y'
		and b.useYn='Y'
		<if test='yogKey != null and yogKey != ""'>AND a.yogKey = #{yogKey}</if>
		<if test='itemKey != null and itemKey != ""'>AND c.itemKey = #{itemKey}</if>
		<if test='yogCom != null and yogCom != ""'>AND a.yogCom LIKE '%' + #{yogCom} + '%'</if>
		<if test='hblNo != null and hblNo != ""'>AND a.hblNo LIKE '%' + #{hblNo} + '%'</if>
		<if test='memo != null and memo != ""'>AND b.memo LIKE '%' + #{memo} + '%'</if>
		<if test='category != null and category != ""'>AND b.category = #{category}</if>
		<if test='jajae != null and jajae != ""'>AND c.jajaeCode = ''</if>
		<if test='codeName != null and codeName != ""'>AND c.codeName LIKE '%' + #{codeName} + '%'</if>
		<if test='engName != null and engName != ""'>AND c.engName LIKE '%' + #{engName} + '%'</if>
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "iphangDate"'>AND a.iphangDate BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "banipDate"'>AND a.banipDate BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        order by a.yogKey desc
	</select>

    <select id="selectJisaList" resultType="map">
		/* 사업자와 비엘로 지사검색 */
		select 'ncustoms' as 'jisa' from ncustoms.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_bs' as 'jisa' from ncustoms_bs.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_ca' as 'jisa' from ncustoms_ca.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_cj' as 'jisa' from ncustoms_cj.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_cw' as 'jisa' from ncustoms_cw.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_dj' as 'jisa' from ncustoms_dj.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_gm' as 'jisa' from ncustoms_gm.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_ic' as 'jisa' from ncustoms_ic.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_jj' as 'jisa' from ncustoms_jj.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_pj' as 'jisa' from ncustoms_pj.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_pt' as 'jisa' from ncustoms_pt.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_sel4' as 'jisa' from ncustoms_sel4.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_sn' as 'jisa' from ncustoms_sn.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_us' as 'jisa' from ncustoms_us.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_yj' as 'jisa' from ncustoms_yj.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
		union all
		select 'ncustoms_ys' as 'jisa' from ncustoms_ys.kcba.Impo1
		where Impo_bl_no=#{hblNo}
		  and Impo_napse_saup=#{yogSaup}
	</select>

    <select id="selectMcountList" resultType="map">
		/* 비엘과 영문품명으로 자재검색 */
		select Mcount_no, Mmodel_code
		from CPS.[dbo].[MAAA100]
		where Mmodel_code in (
			select impum_jajae_code from ${_defaultDB}.kcba.Impo3
			where Impum_key in (
			select impo_key from ${_defaultDB}.kcba.Impo1
			where Impo_bl_no = #{hblNo})
			and (Impum_gukyk1 LIKE '%' + #{engName} + '%' or Impum_gukyk2 LIKE '%' + #{engName} + '%'))
	</select>

    <update id="updateModelJajae">
		/* 요건 식품 품목 자재 수정 */
		update soo.dbo.CPS_YogunItem
	    set
	    mcountNo 		= #{mcountNo},
	    jajaeCode 		= #{jajaeCode}
		where itemKey 	= #{itemKey}
	</update>

    <select id="selectMasterList" resultType="map">
		/* 마스터리스트 */
		select b.itemKey,b.yogCom, b.yogSaup, b.codeName, b.jajaeCode, b.hsCode,
		ISNULL((SELECT count(a.yogdKey) FROM soo.dbo.CPS_YogunDetail a
		 where itemKey in (select itemKey from soo.dbo.CPS_YogunItem where itemKey=b.itemKey)
		 and category='식품'), 0) AS '식품',
		ISNULL((SELECT count(a.yogdKey) FROM soo.dbo.CPS_YogunDetail a
		 where itemKey in (select itemKey from soo.dbo.CPS_YogunItem where itemKey=b.itemKey)
		 and category='식물'), 0) AS '식물',
		ISNULL((SELECT count(a.yogdKey) FROM soo.dbo.CPS_YogunDetail a
		 where itemKey in (select itemKey from soo.dbo.CPS_YogunItem where itemKey=b.itemKey)
		 and category='동물'), 0) AS '동물',
		ISNULL((SELECT count(a.yogdKey) FROM soo.dbo.CPS_YogunDetail a
		 where itemKey in (select itemKey from soo.dbo.CPS_YogunItem where itemKey=b.itemKey)
		 and category='축산물'), 0) AS '축산물',
		ISNULL((SELECT count(a.yogdKey) FROM soo.dbo.CPS_YogunDetail a
		 where itemKey in (select itemKey from soo.dbo.CPS_YogunItem where itemKey=b.itemKey)
		 and category='수산물'), 0) AS '수산물',
		 0 AS '전기',
		 0 AS '전파',
		 0 AS '공산품',
		 0 AS '화장품',
		 0 AS '자동차부품',
		 0 AS '화학물질',
		 0 AS '방폭면제',
		 0 AS '의료기기'
		 from soo.dbo.CPS_YogunItem b
		 where b.useYn='Y'
		 <if test='yogCom != null and yogCom != ""'>AND b.yogCom LIKE '%' + #{yogCom} + '%'</if>
		 <if test='codeName != null and codeName != ""'>AND b.codeName LIKE '%' + #{codeName} + '%'</if>
		 group by b.itemKey,b.yogCom,b.yogSaup,b.codeName,b.jajaeCode,b.hsCode
	</select>

    <select id="selectCompResultList" resultType="map">
		/* 마스터리스트 */
		select b.ComSangho, b.BlNo,
		(select case when COUNT(a.RqGbn) > 0 then 'O' else 'X' end from CPS.dbo.RQAA100 a where a.ComSangho = b.ComSangho and a.BlNo = b.BlNo and a.RqGbn='AM') as 'AM',
		(select case when COUNT(a.RqGbn) > 0 then 'O' else 'X' end from CPS.dbo.RQAA100 a where a.ComSangho = b.ComSangho and a.BlNo = b.BlNo and a.RqGbn='BM') as 'BM',
		(select case when COUNT(a.RqGbn) > 0 then 'O' else 'X' end from CPS.dbo.RQAA100 a where a.ComSangho = b.ComSangho and a.BlNo = b.BlNo and a.RqGbn='CM') as 'CM',
		(select case when COUNT(a.RqGbn) > 0 then 'O' else 'X' end from CPS.dbo.RQAA100 a where a.ComSangho = b.ComSangho and a.BlNo = b.BlNo and a.RqGbn='DM') as 'DM',
		(select case when COUNT(a.RqGbn) > 0 then 'O' else 'X' end from CPS.dbo.RQAA100 a where a.ComSangho = b.ComSangho and a.BlNo = b.BlNo and a.RqGbn='EM') as 'EM',
		(select case when COUNT(a.RqGbn) > 0 then 'O' else 'X' end from CPS.dbo.RQAA100 a where a.ComSangho = b.ComSangho and a.BlNo = b.BlNo and a.RqGbn='FM') as 'FM',
		(select case when COUNT(a.RqGbn) > 0 then 'O' else 'X' end from CPS.dbo.RQAA100 a where a.ComSangho = b.ComSangho and a.BlNo = b.BlNo and a.RqGbn='GM') as 'GM',
		(select case when COUNT(a.RqGbn) > 0 then 'O' else 'X' end from CPS.dbo.RQAA100 a where a.ComSangho = b.ComSangho and a.BlNo = b.BlNo and a.RqGbn='HM') as 'HM'
		from CPS.dbo.RQAA100 b
		where b.ComSangho !=''
		and b.useYn='Y'
		<if test='ComSangho != null and ComSangho != ""'>AND b.ComSangho LIKE '%' + #{ComSangho} + '%'</if>
		<if test='BlNo != null and BlNo != ""'>AND b.BlNo LIKE '%' + #{BlNo} + '%'</if>
		group by b.ComSangho, b.BlNo
		order by b.ComSangho
	</select>

    <select id="selectResultMasterList" resultType="map" fetchSize="1000">
		/* 마스터리스트 */
		select *
		 from CPS.dbo.RQAA100
		 where useYn='Y'
		 <if test='RqGbn != null and RqGbn != ""'>AND RqGbn = #{RqGbn}</if>
		 <if test='RqGbnM != null and RqGbnM != ""'>AND RqGbn like '%' + #{RqGbnM}</if>
		 <if test='RqGbnD != null and RqGbnD != ""'>AND RqGbn = #{RqGbnD}</if>
		 <if test='RqPart != null and RqPart != ""'>AND RqPart = #{RqPart}</if>
		 <if test='ApplyNo != null and ApplyNo != ""'>AND ApplyNo = #{ApplyNo}</if>
		 <if test='SendNo != null and SendNo != ""'>AND SendNo = #{SendNo}</if>
		 <if test='Status != null and Status != ""'>AND Status = #{Status}</if>
		 <if test='ComSaup != null and ComSaup != ""'>AND ComSaup = #{ComSaup}</if>
		 <if test='ComSangho != null and ComSangho != ""'>AND ComSangho LIKE '%' + #{ComSangho} + '%'</if>
		 <if test='BlNo != null and BlNo != ""'>AND BlNo LIKE '%' + #{BlNo} + '%'</if>
		 <if test='IssueNo != null and IssueNo != ""'>AND IssueNo LIKE '%' + #{IssueNo} + '%'</if>
		 <if test='ProcessDtm != null and ProcessDtm != ""'>AND ProcessDtm = #{ProcessDtm}</if>
		 <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "IssueDtm"'>AND IssueDtm BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "ProcessDtm"'>AND ProcessDtm BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        order by IssueDtm desc
	</select>

    <select id="selectResultStatusList" resultType="map">
		/* 상태리스트 */
		select Status
		from CPS.dbo.RQAA100
		where Status !=''
		group by Status
		order by Status
	</select>

    <select id="selectResultDetailList" resultType="map">
		/* 요건 디테일리스트 */
		select
		a.SUIPYOGUN_GIGWANPUMCD,
		b.Impum_jajae_code,
		b.Impum_gukyk2,
		b.Impum_su,
		b.Impum_su_danwi,
		b.Impum_danga,
		c.Imlan_popum,
		c.Imlan_jung,
		c.Imlan_total_tax,
		d.impo_mrn_no,
		d.impo_bl_no,
		c.Imlan_hs,
		d.Impo_gonggub_sangho,
		c.Imlan_wonsanji_code,
		e.CD_DESC
		from ${_defaultDB}.kcba.Impo41 a, ${_defaultDB}.kcba.Impo3 b, ${_defaultDB}.kcba.Impo2 c, ${_defaultDB}.kcba.Impo1 d, soo_MST.dbo.TBR_SYS_CODE e
		where a.suipyogun_key = b.Impum_key
		and  a.suipyogun_lan = b.Impum_lan
		and a.suipyogun_heang = b.Impum_heang
		and a.suipyogun_key = c.Imlan_key
		and a.suipyogun_lan = c.Imlan_jechl_lan
		and a.suipyogun_key = d.Impo_key
		and c.Imlan_wonsanji_code = e.CD
		and e.MCD = 'CNTZ_CD'
		<if test='IssueNo != null and IssueNo != ""'>AND a.SUIPYOGUN_NO = #{IssueNo}</if>
	</select>

    <select id="selectResultDetailList2" resultType="map">
		/* 요건 디테일리스트 */
		select
		a.SUIPYOGUN_GIGWANPUMCD,
		b.Impum_jajae_code,
		b.Impum_gukyk2,
		b.Impum_su,
		b.Impum_su_danwi,
		b.Impum_danga,
		c.Imlan_popum,
		c.Imlan_jung,
		c.Imlan_jung_danwi,
		c.Imlan_total_tax,
		c.Imlan_gwanse_gam,
		d.impo_mrn_no,
		d.impo_bl_no,
		d.Impo_mrn_no,
		c.Imlan_hs,
		d.Impo_gonggub_sangho,
		c.Imlan_wonsanji_code
		from ${_defaultDB}.kcba.Impo41 a, ${_defaultDB}.kcba.Impo3 b, ${_defaultDB}.kcba.Impo2 c, ${_defaultDB}.kcba.Impo1 d
		where a.suipyogun_key = b.Impum_key
		and  a.suipyogun_lan = b.Impum_lan
		and a.suipyogun_heang = b.Impum_heang
		and a.suipyogun_key = c.Imlan_key
		and a.suipyogun_lan = c.Imlan_jechl_lan
		and a.suipyogun_key = d.Impo_key
		<if test='IssueNo != null and IssueNo != ""'>AND a.SUIPYOGUN_NO = #{IssueNo}</if>
		<if test='GIGWANPUMCD != null and GIGWANPUMCD != ""'>AND a.SUIPYOGUN_GIGWANPUMCD = #{GIGWANPUMCD}</if>
	</select>

    <select id="selectComList" resultType="map">
		/* 회사정보 */
		select ComSaupNo, ComHnm
		from CPS.dbo.BSAA100M
		where ComHnm = #{ComSangho}
	</select>

    <select id="selectComList1" resultType="map">
		/* 회사정보 */
		select Saup, RealSangho
		from CPS.dbo.RQAB100
		where Sangho = #{ComSangho}
	</select>

    <select id="selectCodeList" resultType="map">
		/* 문서코드 */
		select Cd
		from CPS.dbo.CDAF100D
		where Mcd='CD_YOGDOC'
		and CdPrtNm = #{DocuGbn}
	</select>

    <insert id="insertResult">
		/* 요건결과입력 */
		INSERT INTO CPS.dbo.RQAA100
		(RqGbn,
		SendNo,
		ApplyNo,
		IssueNo,
		DocuGbn,
		ItemCode,
		ItemNm,
		BlNo,
		ComSangho,
		ComSaup,
		IssueDtm,
		ProcessDtm,
		SenderSangho,
		Status,
		Su,
		Etc01,
		UseYn,
		AddUserKey,
		AddUserNm,
		AddDtm,
		EditUserKey,
		EditUserNm,
		EditDtm,
		RgFlag,
		MrnNo,
		Rqpart,
		RealSangho)
		VALUES
		(#{RqGbn},
		#{SendNo},
		#{ApplyNo},
		#{IssueNo},
		#{DocuGbn},
		#{ItemCode},
		#{ItemNm},
		#{BlNo},
		#{ComSangho},
		#{ComSaup},
		#{IssueDtm},
		#{ProcessDtm},
		#{SenderSangho},
		#{Status},
		#{Su},
		#{Etc01},
		#{UseYn},
		#{AddUserKey},
		#{AddUserNm},
		#{AddDtm},
		#{EditUserKey},
		#{EditUserNm},
		#{EditDtm},
		#{RgFlag},
		#{MrnNo},
		#{Rqpart},
		#{RealSangho}
		)
	</insert>

    <update id="updateResult">
		/* 요건결과 수정 */
		update CPS.dbo.RQAA100
		<trim prefix="SET" suffixOverrides=",">
		    <if test='RqGbn != null'>RqGbn = #{RqGbn} ,</if>
		    <if test='SendNo != null'>SendNo = #{SendNo} ,</if>
		    <if test='ApplyNo != null'>ApplyNo = #{ApplyNo} ,</if>
		    <if test='IssueNo != null'>IssueNo = #{IssueNo} ,</if>
		    <if test='DocuGbn != null'>DocuGbn = #{DocuGbn} ,</if>
		    <if test='ItemCode != null'>ItemCode = #{ItemCode} ,</if>
		    <if test='ItemNm != null'>ItemNm = #{ItemNm} ,</if>
		    <if test='BlNo != null'>BlNo = #{BlNo} ,</if>
		    <if test='ComSangho != null'>ComSangho = #{ComSangho} ,</if>
		    <if test='ComSaup != null'>ComSaup = #{ComSaup} ,</if>
		    <if test='IssueDtm != null'>IssueDtm = #{IssueDtm} ,</if>
		    <if test='ProcessDtm != null'>ProcessDtm = #{ProcessDtm} ,</if>
			<if test='SenderSangho != null'>SenderSangho = #{SenderSangho} ,</if>
			<if test='Status != null'>Status = #{Status} ,</if>
			<if test='Su != null'>Su = #{Su} ,</if>
			<if test='Etc01 != null'>Etc01 = #{Etc01} ,</if>
			<if test='UseYn != null'>UseYn = #{UseYn} ,</if>
			<if test='EditUserKey != null'>EditUserKey = #{EditUserKey} ,</if>
			<if test='EditUserNm != null'>EditUserNm = #{EditUserNm} ,</if>
			<if test='EditDtm != null'>EditDtm = #{EditDtm} ,</if>
			<if test='RgFlag != null'>RgFlag = #{RgFlag} ,</if>
			<if test='MrnNo != null'>MrnNo = #{MrnNo} ,</if>
			<if test='Rqpart != null'>Rqpart = #{Rqpart} ,</if>
			<if test='RealSangho != null'>RealSangho = #{RealSangho} ,</if>
		</trim>
		where SendNo= #{SendNo}
	</update>

    <insert id="insertResultDtl">
		/* 요건결과입력 */
		INSERT INTO CPS.dbo.RQAA100
		(RqGbn,
		IssueNo,
		DocuGbn,
		ItemCode,
		ItemNm,
		BlNo,
		IssueDtm,
		ProcessDtm,
		Su,
		SuDanwi,
		IdentiCode,
		HsCode,
		Etc01,
		Etc02,
		Etc03,
		Etc04,
		Etc05,
		Etc06,
		Etc07,
		Etc08,
		Etc09,
		Etc10,
		UseYn,
		AddUserKey,
		AddUserNm,
		AddDtm,
		EditUserKey,
		EditUserNm,
		EditDtm,
		RgFlag,
		Rqpart)
		VALUES
		(#{RqGbn},
		#{IssueNo},
		#{DocuGbn},
		#{ItemCode},
		#{ItemNm},
		#{BlNo},
		#{IssueDtm},
		#{ProcessDtm},
		#{Su},
		#{SuDanwi},
		#{IdentiCode},
		#{HsCode},
		#{Etc01},
		#{Etc02},
		#{Etc03},
		#{Etc04},
		#{Etc05},
		#{Etc06},
		#{Etc07},
		#{Etc08},
		#{Etc09},
		#{Etc10},
		#{UseYn},
		#{AddUserKey},
		#{AddUserNm},
		#{AddDtm},
		#{EditUserKey},
		#{EditUserNm},
		#{EditDtm},
		#{RgFlag},
		#{Rqpart}
		)
	</insert>

    <select id="selectYogNcomList" resultType="map">
		/* 요건현황 엔컴연계 */
		select k.*, f.SDAAKey, f.EdmsOrgFileNm,
		case when k.ProcessDtm = '' then '요건신청'
		when k.Impo_ok_date = '' and k.ProcessDtm != ''  then '요건승인'
		when k.Impo_ok_date != '' then '수입신고수리'
		else k.Status end as 'Status1',
		case when k.RqGbn = 'KM' then '식품검역'
		when k.RqGbn = 'AM' then '공산품'
		when k.RqGbn = 'CM' then '공산품'
		when k.RqGbn = 'DM' then '전기용품'
		when k.RqGbn = 'EM' then '전기용품'
		when k.RqGbn = 'JM' then '식물검역'
		when k.RqGbn = 'LM' then '위생용품'
		else k.RqGbn end as 'RqGbn1'
		from
		(select
		a.BlNo,
		d.Impo_iphang_date,
		d.Impo_banip_date,
		a.RqGbn,
		a.DocuGbn,
		a.SendNo,
		a.IssueDtm,
		a.IssueNo,
		a.ProcessDtm,
		d.Impo_singo_no,
		d.Impo_ok_date,
		a.Status
		from CPS.dbo.RQAA100 a left outer join
		(
		select
		a.Impo_bl_no,
		a.Impo_iphang_date,
		a.Impo_banip_date,
		b.SUIPYOGUN_NO,
		b.SUIPYOGUN_DATE,
		b.SUIPYOGUN_TEXT_NAME,
		a.Impo_singo_no,
		a.Impo_ok_date
		from ${_defaultDB}.kcba.Impo1 a, (select SUIPYOGUN_KEY, SUIPYOGUN_NO, SUIPYOGUN_DATE, SUIPYOGUN_TEXT_NAME from ${_defaultDB}.kcba.Impo41
		group by SUIPYOGUN_KEY, SUIPYOGUN_NO, SUIPYOGUN_DATE, SUIPYOGUN_TEXT_NAME) b
		where a.Impo_key = b.SUIPYOGUN_KEY
		and a.Impo_napse_saup=#{ComSaup}
		) d
		on a.BlNo = d.Impo_bl_no
		and a.IssueNo = d.SUIPYOGUN_NO
		where a.ComSaup=#{ComSaup}
		<if test='Impo_bl_no != null and Impo_bl_no != ""'>AND a.BlNo LIKE '%' + #{Impo_bl_no} + '%'</if>
		<if test='IssueNo != null and IssueNo != ""'>AND a.IssueNo LIKE '%' + #{IssueNo} + '%'</if>
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "IssueDtm"'>AND a.IssueDtm BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "ProcessDtm"'>AND a.ProcessDtm BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date"'>AND d.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
		group by a.BlNo,
		d.Impo_iphang_date,
		d.Impo_banip_date,
		a.RqGbn,
		a.DocuGbn,
		a.SendNo,
		a.IssueDtm,
		a.IssueNo,
		a.ProcessDtm,
		d.Impo_singo_no,
		d.Impo_ok_date,
		a.Status ) k left outer join CPS.[dbo].[SDAA100] f
		on k.BlNo = f.EdmsNo
		and k.IssueNo = f.EdmsSaveFileNm
		and f.EdmsJisaCode=#{_defaultDB}
		and f.EdmsFileCategory='B0002'
		and f.UseYn='Y'
		order by k.IssueDtm desc
	</select>

    <select id="selectYogNcomList_back" resultType="map">
		/* 과거 요건현황 엔컴연계 */
		select a.Impo_bl_no, a.Impo_iphang_date, a.Impo_banip_date,
		case when b.SUIPYOGUN_TEXT_NAME='식품등의수입신고확인증' then '식품검역' else '공산품' end 'gubun',
		b.SUIPYOGUN_TEXT_NAME, b.SUIPYOGUN_NO, b.SUIPYOGUN_DATE, a.Impo_singo_no, a.Impo_ok_date,
		b.SUIPYOGUN_LAN, b.SUIPYOGUN_HEANG, b.SUIPYOGUN_GIGWANPUMCD, a.Impo_mrn_no,
		(select Impum_jajae_code from ncustoms.kcba.Impo3 where Impum_key=a.Impo_key and Impum_lan=b.SUIPYOGUN_LAN and Impum_heang = b.suipyogun_heang) as Impum_jajae_code,
		(select Imlan_popum from ncustoms.kcba.Impo2 where Imlan_key=a.Impo_key and Imlan_jechl_lan=b.SUIPYOGUN_LAN) as Imlan_popum,
		(select Impum_gukyk2 from ncustoms.kcba.Impo3 where Impum_key=a.Impo_key and Impum_lan=b.SUIPYOGUN_LAN and Impum_heang = b.suipyogun_heang) as Impum_gukyk2,
		(select Impum_su from ncustoms.kcba.Impo3 where Impum_key=a.Impo_key and Impum_lan=b.SUIPYOGUN_LAN and Impum_heang = b.suipyogun_heang) as Impum_su,
		(select Impum_su_danwi from ncustoms.kcba.Impo3 where Impum_key=a.Impo_key and Impum_lan=b.SUIPYOGUN_LAN and Impum_heang = b.suipyogun_heang) as Impum_su_danwi,
		(select Imlan_jung from ncustoms.kcba.Impo2 where Imlan_key=a.Impo_key and Imlan_jechl_lan=b.SUIPYOGUN_LAN) as Imlan_jung,
		(select Imlan_jung_danwi from ncustoms.kcba.Impo2 where Imlan_key=a.Impo_key and Imlan_jechl_lan=b.SUIPYOGUN_LAN) as Imlan_jung_danwi,
		(select Imlan_gwanse_gam from ncustoms.kcba.Impo2 where Imlan_key=a.Impo_key and Imlan_jechl_lan=b.SUIPYOGUN_LAN) as Imlan_gwanse_gam
		from ${_defaultDB}.kcba.Impo1 a, ${_defaultDB}.kcba.Impo41 b
		where a.Impo_key = b.SUIPYOGUN_KEY
		and Impo_napse_saup=#{ComSaup}
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "yogunDate"'>AND b.SUIPYOGUN_DATE BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
		order by a.Impo_ok_date desc
	</select>



















    <select id="selectComplianceMasterList" resultType="map">
		/* 요건 Item마스터 */
		select b.sangho, a.codeName, a.jajaeCode,
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y'), 0) AS '식품',
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y' and addUserId='전기'), 0) AS '전기',
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y' and addUserId='전파'), 0) AS '전파',
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y' and addUserId='공산품'), 0) AS '공산품',
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y' and addUserId='화장품'), 0) AS '화장품',
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y' and addUserId='자동차'), 0) AS '자동차',
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y' and addUserId='화학'), 0) AS '화학',
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y' and addUserId='방폭'), 0) AS '방폭',
		ISNULL((SELECT count(itemKey) FROM soo.dbo.CPS_Yogun_Item WITH (NOLOCK) WHERE a.yogSaup = yogSaup and a.codeName = codeName and useYn='Y' and addUserId='의료'), 0) AS '의료'
		from soo.dbo.CPS_Yogun_Item a WITH (NOLOCK), soo.dbo.CPS_Customer b WITH (NOLOCK)
		where a.yogSaup = b.saup
		and a.useYn = 'Y'
		and b.jisa = 'ncustoms_all'
		<if test='yogCom != null and yogCom != ""'>AND b.sangho LIKE '%' + #{yogCom} + '%'</if>
		<if test='jajaeCode != null and jajaeCode != ""'>AND a.codeName LIKE '%' + #{jajaeCode} + '%'</if>
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "addDtm"'>AND a.addDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959'</when>
                <when test='_DateType == "editDtm"'>AND (a.editDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959' or a.addDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959')</when>
            </choose>
        </if>
        order by a.itemKey desc
	</select>

    <select id="selectComplianceList" resultType="map">
		/* 요건 마스터 */
		select *
		from soo.dbo.CPS_Yogun_Master
		where useYn = 'Y'
		<if test='yogKey != null and yogKey != ""'>AND yogKey = #{yogKey}</if>
		<if test='yogGubun != null and yogGubun != ""'>AND yogGubun = #{yogGubun}</if>
        <if test='certiGubun != null and certiGubun != ""'>AND certiGubun = #{certiGubun}</if>
		<if test='jajaeCode != null and jajaeCode != ""'>AND jajaeCode LIKE '%' + #{jajaeCode} + '%'</if>
		<if test='certiNum != null and certiNum != ""'>AND certiNum LIKE '%' + #{certiNum} + '%'</if>
		<if test='yogCom != null and yogCom != ""'>AND yogCom LIKE '%' + #{yogCom} + '%'</if>
		<if test='productCom != null and productCom != ""'>AND productCom LIKE '%' + #{productCom} + '%'</if>
		<if test='blNo != null and blNo != ""'>AND blNo LIKE '%' + #{blNo} + '%'</if>
		<if test='productName != null and productName != ""'>AND productName LIKE '%' + #{productName} + '%'</if>
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "sinchungDate"'>AND sinchungDate BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "balgupDate"'>AND balgupDate BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        order by sinchungDate desc, blNo, gunSu desc
	</select>

    <insert id="insertYogMaster">
		/* 요건입력 */
		INSERT INTO soo.dbo.CPS_Yogun_Master
		(yogGubun,
		yogCom,
		yogSaup,
		blNo,
		appType,
		gunSu,
		fees,
		uploadYn,
		billYn,
		billDate,
		sinchungDate,
		balgupDate,
		iphangDate,
		mmodelCode,
		jajaeCode,
		yogSu,
		certiGubun,
		certiDoc,
		certiNum,
		certiDate,
		certiModelName,
		basicModelName,
		orderModelName,
		productName,
		productEngName,
		productCom,
		productNation,
		hsCode,
		jung,
		unitPrice,
		origin,
		invNo,
		discription,
		category,
		yogCont01,
		yogCont02,
		yogCont03,
		yogCont04,
		yogCont05,
		yogCont06,
		yogCont07,
		yogCont08,
		yogCont09,
		yogCont10,
		yogCont11,
		yogCont12,
		yogCont13,
		yogCont14,
		yogCont15,
		yogCont16,
		useYn,
		addUserId,
		addUserNm,
		addDtm)
		VALUES
		(#{yogGubun},
		#{yogCom},
		#{yogSaup},
		#{blNo},
		#{appType},
		#{gunSu},
		#{fees},
		#{uploadYn},
		#{billYn},
		#{billDate},
		#{sinchungDate},
		#{balgupDate},
		#{iphangDate},
		#{mmodelCode},
		#{jajaeCode},
		#{yogSu},
		#{certiGubun},
		#{certiDoc},
		#{certiNum},
		#{certiDate},
		#{certiModelName},
		#{basicModelName},
		#{orderModelName},
		#{productName},
		#{productEngName},
		#{productCom},
		#{productNation},
		#{hsCode},
		#{jung},
		#{unitPrice},
		#{origin},
		#{invNo},
		#{discription},
		#{category},
		#{yogCont01},
		#{yogCont02},
		#{yogCont03},
		#{yogCont04},
		#{yogCont05},
		#{yogCont06},
		#{yogCont07},
		#{yogCont08},
		#{yogCont09},
		#{yogCont10},
		#{yogCont11},
		#{yogCont12},
		#{yogCont13},
		#{yogCont14},
		#{yogCont15},
		#{yogCont16},
		#{useYn},
		#{_userId},
		#{_userNm},
		#{addDtm}
		)
	</insert>

    <update id="updateYogMaster">
		/* 요건 수정 */
		update soo.dbo.CPS_Yogun_Master
	    set
		yogGubun 		= #{yogGubun},
		yogCom 			= #{yogCom},
		yogSaup 		= #{yogSaup},
		blNo 			= #{blNo},
		appType 		= #{appType},
		gunSu 			= #{gunSu},
		fees 			= #{fees},
		uploadYn 		= #{uploadYn},
		billYn 			= #{billYn},
		billDate 		= #{billDate},
		sinchungDate 	= #{sinchungDate},
		balgupDate 		= #{balgupDate},
		iphangDate 		= #{iphangDate},
		mmodelCode 		= #{mmodelCode},
		jajaeCode 		= #{jajaeCode},
		yogSu 			= #{yogSu},
		certiGubun 		= #{certiGubun},
		certiDoc 		= #{certiDoc},
		certiNum 		= #{certiNum},
		certiDate 		= #{certiDate},
		certiModelName 	= #{certiModelName},
		basicModelName 	= #{basicModelName},
		orderModelName 	= #{orderModelName},
		productName 	= #{productName},
		productEngName 	= #{productEngName},
		productCom 		= #{productCom},
		productNation 	= #{productNation},
		hsCode 			= #{hsCode},
		jung 			= #{jung},
		unitPrice 		= #{unitPrice},
		origin 			= #{origin},
		invNo 			= #{invNo},
		discription 	= #{discription},
		category 		= #{category},
		yogCont01 		= #{yogCont01},
		yogCont02 		= #{yogCont02},
		yogCont03 		= #{yogCont03},
		yogCont04 		= #{yogCont04},
		yogCont05 		= #{yogCont05},
		yogCont06 		= #{yogCont06},
		yogCont07 		= #{yogCont07},
		yogCont08 		= #{yogCont08},
		yogCont09 		= #{yogCont09},
		yogCont10 		= #{yogCont10},
		yogCont11 		= #{yogCont11},
		yogCont12 		= #{yogCont12},
		yogCont13 		= #{yogCont13},
		yogCont14 		= #{yogCont14},
		yogCont15 		= #{yogCont15},
		yogCont16 		= #{yogCont16},
		editUserId 		= #{_userId},
		editUserNm 		= #{_userNm},
		editDtm 		= #{editDtm}
		where yogKey 	= #{yogKey}
	</update>

    <update id="deleteYogMaster">
		/* 요건 삭제 */
		update soo.dbo.CPS_Yogun_Master
	    set
	    useYn 		= #{useYn},
	    editUserId 	= #{_userId},
		editUserNm 	= #{_userNm},
		editDtm 	= #{editDtm}
		where yogKey = #{yogKey}
	</update>

    <insert id="insertSikMaster">
		/* 식품입력 */
		INSERT INTO soo.dbo.aa
		(saup,
		bl,
		inv,
		iphang,
		banip,
		singo,
		suri,
		code,
		eng,
		kor,
		hs,
		won,
		jaejo,
		product,
		suip,
		sdate,
		edate,
		gubun,
		jungmil,
		label,
		susulu,
		silbi1,
		silbi2,
		jungyn,
		billyn,
		sunyn,
		ani,
		remark,
		etc)
		VALUES
		(#{saup},
		#{bl},
		#{inv},
		#{iphang},
		#{banip},
		#{singo},
		#{suri},
		#{code},
		#{eng},
		#{kor},
		#{hs},
		#{won},
		#{jaejo},
		#{product},
		#{suip},
		#{sdate},
		#{edate},
		#{gubun},
		#{jungmil},
		#{label},
		#{susulu},
		#{silbi1},
		#{silbi2},
		#{jungyn},
		#{billyn},
		#{sunyn},
		#{ani},
		#{remark},
		#{etc}
		)
	</insert>

















	<select id="selectCompMasterList" resultType="map">
		/* 비식품 인증현황 */
		select a.*, b.mmodelCode
		from soo.dbo.CPS_Compliance_Master a
		LEFT OUTER JOIN soo.dbo.CPS_Compliance_Item b
		on a.compKey = b.masterKey
		and b.gubun = 'NoFoodMaster'
		and b.useYn = 'Y'
		where a.useYn = 'Y'
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.comNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.comNum = #{taxNum}</otherwise>
            </choose>
        </if>
		<if test='modelCode != null and modelCode != ""'>AND b.mmodelCode LIKE '%' + #{modelCode} + '%'</if>
		<if test='compKey != null and compKey != ""'>AND a.compKey = #{compKey}</if>
		<if test='status != null and status != ""'>AND a.status = #{status}</if>
		<if test='compNum != null and compNum != ""'>AND a.compNum LIKE '%' + #{compNum} + '%'</if>
		<if test='comName != null and comName != ""'>AND a.comName LIKE '%' + #{comName} + '%'</if>
		<if test='productName != null and productName != ""'>AND a.productName LIKE '%' + #{productName} + '%'</if>
		<if test='docuName != null and docuName != ""'>AND a.docuName LIKE '%' + #{docuName} + '%'</if>
		<if test='productCom != null and productCom != ""'>AND a.productCom LIKE '%' + #{productCom} + '%'</if>
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "addDtm"'>AND a.addDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959'</when>
                <when test='_DateType == "compDt"'>AND a.compDt BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        order by a.compKey desc
	</select>

	<select id="selectComplianceUnitPriceList" resultType="map">
		/* 인증자재 통관현황 */
		SELECT datas.*
		FROM (
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms.kcba.impo1 a, ncustoms.kcba.Impo3 b, ncustoms.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_ay.kcba.impo1 a, ncustoms_ay.kcba.Impo3 b, ncustoms_ay.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_bs.kcba.impo1 a, ncustoms_bs.kcba.Impo3 b, ncustoms_bs.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_ca.kcba.impo1 a, ncustoms_ca.kcba.Impo3 b, ncustoms_ca.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_cj.kcba.impo1 a, ncustoms_cj.kcba.Impo3 b, ncustoms_cj.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_cw.kcba.impo1 a, ncustoms_cw.kcba.Impo3 b, ncustoms_cw.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_dj.kcba.impo1 a, ncustoms_dj.kcba.Impo3 b, ncustoms_dj.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_gm.kcba.impo1 a, ncustoms_gm.kcba.Impo3 b, ncustoms_gm.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_ic.kcba.impo1 a, ncustoms_ic.kcba.Impo3 b, ncustoms_ic.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_jj.kcba.impo1 a, ncustoms_jj.kcba.Impo3 b, ncustoms_jj.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_pj.kcba.impo1 a, ncustoms_pj.kcba.Impo3 b, ncustoms_pj.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_pt.kcba.impo1 a, ncustoms_pt.kcba.Impo3 b, ncustoms_pt.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_sel4.kcba.impo1 a, ncustoms_sel4.kcba.Impo3 b, ncustoms_sel4.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_sn.kcba.impo1 a, ncustoms_sn.kcba.Impo3 b, ncustoms_sn.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_us.kcba.impo1 a, ncustoms_us.kcba.Impo3 b, ncustoms_us.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_yj.kcba.impo1 a, ncustoms_yj.kcba.Impo3 b, ncustoms_yj.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		union all
		select
		a.Impo_singo_no, b.Impum_jajae_code, c.SUIPYOGUN_TEXT_NAME, b.Impum_su, b.Impum_danga, b.Impum_amt, a.Impo_singo_date as 'yyyymmdd'
		from ncustoms_ys.kcba.impo1 a, ncustoms_ys.kcba.Impo3 b, ncustoms_ys.kcba.impo41 c
		where a.Impo_key = b.Impum_key
		and a.Impo_key = c.SUIPYOGUN_KEY
		and b.Impum_lan = c.SUIPYOGUN_LAN
		and b.Impum_heang = c.SUIPYOGUN_HEANG
		and a.Impo_napse_saup = #{mcoCom}
		and b.Impum_jajae_code = #{mmodelCode}
		) datas
		order by datas.yyyymmdd desc
	</select>

	<select id="selectCompApplyList" resultType="map">
		/* 비식품 인증확인신청현황 */
		select a.*
		from soo.dbo.CPS_Compliance_Apply a
		where a.useYn = 'Y'
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.comNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.comNum = #{taxNum}</otherwise>
            </choose>
        </if>
		<if test='modelCode != null and modelCode != ""'>
		    AND EXISTS (SELECT * FROM soo.dbo.CPS_Compliance_Item c WITH (NOLOCK) WHERE a.applyKey=c.masterKey AND c.gubun='NoFoodType1' and c.mModelCode LIKE '%' + #{modelCode} + '%' )
		</if>
		<if test='status != null and status != ""'>AND a.status = #{status}</if>
		<if test='confirmNum != null and confirmNum != ""'>AND a.confirmNum LIKE '%' + #{compNum} + '%'</if>
		<if test='comName != null and comName != ""'>AND a.comName LIKE '%' + #{comName} + '%'</if>
		<if test='productName != null and productName != ""'>AND a.productName LIKE '%' + #{productName} + '%'</if>
		<if test='docuName != null and docuName != ""'>AND a.docuName LIKE '%' + #{docuName} + '%'</if>
		<if test='productCom != null and productCom != ""'>AND a.productCom LIKE '%' + #{productCom} + '%'</if>
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "applyDt"'>AND a.applyDt BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "confirmDt"'>AND a.confirmDt BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        order by applyKey desc
	</select>

	<select id="selectCompItemList" resultType="map">
		/* 자재현황 */
		select
		c.productName, c.compNum, d.*
		from
		(select b.masterKey as 'compKey',  a.*
		  from soo.dbo.CPS_Compliance_Item a
		  left outer join soo.dbo.CPS_Compliance_Item b
		  on a.mcoCom = b.mcoCom
		  and a.mmodelCode = b.mmodelCode
		  and b.gubun = 'NoFoodMaster'
		  where a.masterKey = #{masterKey}
		  and a.gubun = 'NoFoodType1'
		  and a.useYn = 'Y') d
		left outer join soo.dbo.CPS_Compliance_Master c
		on d.compKey = c.compKey
	</select>

	<select id="selectRequirementMasterList" resultType="map">
		/* 세브 요건 마스터 조회 */
		SELECT	datas.*
		FROM (
			SELECT	ROW_NUMBER() OVER (ORDER BY a.CUAA110Key DESC) AS 'rownum',
					a.*
			FROM CPS_WEB.[dbo].[CUAA110] a WITH (NOLOCK)
			<where>
			    and a.UseYn='Y'
				<if test='CUAA110Key != "" and CUAA110Key != null'>AND a.CUAA110Key = #{CUAA110Key}</if>
				<if test='category != "" and category != null'>AND a.Category LIKE #{category} + '%'</if>
				<if test='subCategory != "" and subCategory != null'>AND a.SubCategory LIKE #{subCategory} + '%'</if>
				<if test='familyLevel1 != "" and familyLevel1 != null'>AND a.FamilyLevel1 LIKE #{familyLevel1} + '%'</if>
				<if test='familyLevel2 != "" and familyLevel2 != null'>AND a.FamilyLevel2 LIKE #{familyLevel2} + '%'</if>
				<if test='taxNum != "" and taxNum != null'>AND a.TaxNum = #{taxNum}</if>
				<if test='mcountNo != "" and mcountNo != null'>AND a.McountNo = #{mcountNo}</if>
				<if test='mmodelCode != "" and mmodelCode != null'>AND a.MmodelCode LIKE #{mmodelCode} + '%'</if>
				<if test='eqMmodelCode != "" and eqMmodelCode != null'>AND a.MmodelCode = #{eqMmodelCode}</if>
				<if test='strCmmfList != "" and strCmmfList != null'>AND a.MmodelCode IN ${strCmmfList}</if>
				<if test='commercialCode != "" and commercialCode != null'>AND a.CommercialCode LIKE #{commercialCode} + '%'</if>
				<if test='manufacturer != "" and manufacturer != null'>AND a.Manufacturer LIKE #{manufacturer} + '%'</if>
				<if test='kfdaYn != "" and kfdaYn != null'>AND a.KfdaYn LIKE #{kfdaYn} + '%'</if>
				<if test='kdfaStickerYn != "" and kdfaStickerYn != null'>AND a.KdfaStickerYn LIKE #{kdfaStickerYn} + '%'</if>
				<if test='useYn != "" and useYn != null'>AND a.UseYn LIKE #{useYn} + '%'</if>
				<if test='isNullMcountNo != "" and isNullMcountNo != null'>AND ISNULL(a.McountNo, '') = ''</if>
			</where>
		) datas
		<if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
		WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber}) -1) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND (CONVERT(INTEGER, #{_pageNumber}) * CONVERT(INTEGER, #{_pageRow}))
		</if>
	</select>

	<update id="updateRequirementMaster">
		/* 요건 마스터 수정/삭제 */
		UPDATE CPS_WEB.[dbo].[CUAA110]
		<trim prefix="SET" suffixOverrides=",">
		    <if test='McountNo != null'>McountNo = #{McountNo} ,</if>
		    <if test='mmodelCode != null'>MmodelCode = #{mmodelCode} ,</if>
		    <if test='mcountDescription != null'>McountDescription = #{mcountDescription} ,</if>
		    <if test='commercialCode != null'>CommercialCode = #{commercialCode} ,</if>
		    <if test='certificateNum != null'>CertificateNum = #{certificateNum} ,</if>
		    <if test='emcIdNum != null'>EmcIdNum = #{emcIdNum} ,</if>
		    <if test='eerIdNum != null'>EerIdNum = #{eerIdNum} ,</if>
		    <if test='materials1 != null'>Materials1 = #{materials1} ,</if>
		    <if test='materials2 != null'>Materials2 = #{materials2} ,</if>
		    <if test='originCountryName != null'>OriginCountryName = #{originCountryName} ,</if>
		    <if test='manufacturer != null'>Manufacturer = #{manufacturer} ,</if>
		    <if test='testingLaboratory != null'>TestingLaboratory = #{testingLaboratory} ,</if>
		    <if test='kdfaFactoryNum != null'>KdfaFactoryNum = #{kdfaFactoryNum} ,</if>
			<if test='EditUserKey != null'>EditUserKey = #{EditUserKey} ,</if>
			<if test='EditUserNm != null'>EditUserNm = #{EditUserNm} ,</if>
			<if test='EditDtm != null'>EditDtm = #{EditDtm} ,</if>
		</trim>
		WHERE CUAA110Key = #{CUAA110Key}
	</update>

	<insert id="insertRequirementMaster">
		/* 요건 마스터 입력 */
		INSERT INTO CPS_WEB.[dbo].[CUAA110]
           ([TaxNum]
           ,[MmodelCode]
           ,[McountDescription]
           ,[CommercialCode]
           ,[CertificateNum]
           ,[EmcIdNum]
           ,[EerIdNum]
           ,[Materials1]
           ,[Materials2]
           ,[OriginCountryName]
           ,[Manufacturer]
           ,[TestingLaboratory]
           ,[KdfaFactoryNum]
           ,[UseYn]
           ,[AddUserKey]
           ,[AddUserNm]
           ,[AddDtm])
     	VALUES
           ('2208146671'
           ,#{mmodelCode}
           ,#{mcountDescription}
           ,#{commercialCode}
           ,#{certificateNum}
           ,#{emcIdNum}
           ,#{eerIdNum}
           ,#{materials1}
           ,#{materials2}
           ,#{originCountryName}
           ,#{manufacturer}
           ,#{testingLaboratory}
           ,#{kdfaFactoryNum}
           ,'Y'
           ,#{AddUserKey}
           ,#{AddUserNm}
           ,#{AddDtm} )
	</insert>

	<select id="selectRequirementStatusList" resultType="map">
		/* 세브 요건 상태 조회 */
		SELECT	datas.*
		FROM (
			SELECT	ROW_NUMBER() OVER (ORDER BY a.CUAA120Key DESC) AS 'rownum',
					a.*
			FROM CPS_WEB.dbo.CUAA120 a WITH (NOLOCK)
			<where>
			    and a.UseYn = 'Y'
				<if test='CUAA120Key != "" and CUAA120Key != null'>AND a.CUAA120Key = #{CUAA120Key}</if>
				<if test='blNum != "" and blNum != null'>AND a.BlNum LIKE #{blNum} + '%'</if>
				<if test='taxNum != "" and taxNum != null'>AND a.TaxNum = #{taxNum}</if>
				<if test='mcountNo != "" and mcountNo != null'>AND a.McountNo LIKE #{mcountNo} + '%'</if>
				<if test='mmodelCode != "" and mmodelCode != null'>AND a.MmodelCode LIKE #{mmodelCode} + '%'</if>
				<if test='eqMmodelCode != "" and eqMmodelCode != null'>AND a.MmodelCode = #{eqMmodelCode}</if>
				<if test='commercialCode != "" and commercialCode != null'>AND a.CommercialCode LIKE #{commercialCode} + '%'</if>
				<if test='iphangDay != "" and iphangDay != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
					AND a.IphangDay BETWEEN #{strFromDate} AND #{strToDate}
				</if>
				<if test='banipDay != "" and banipDay != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
					AND a.BanipDay BETWEEN #{strFromDate} AND #{strToDate}
				</if>
				<if test='jubsuDay != "" and jubsuDay != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
					AND a.JubsuDay BETWEEN #{strFromDate} AND #{strToDate}
				</if>
				<if test='examinationDay != "" and examinationDay != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
					AND a.ExaminationDay BETWEEN #{strFromDate} AND #{strToDate}
				</if>
				<if test='originCountryCode != "" and originCountryCode != null'>AND a.OriginCountryCode LIKE #{originCountryCode} + '%'</if>
				<if test='originCountryAbbreviation != "" and originCountryAbbreviation != null'>AND a.OriginCountryAbbreviation LIKE #{originCountryAbbreviation} + '%'</if>
				<if test='originCountryName != "" and originCountryName != null'>AND a.OriginCountryName LIKE #{originCountryName} + '%'</if>
				<if test='examinationCostType != "" and examinationCostType != null'>AND a.ExaminationCostType LIKE #{examinationCostType} + '%'</if>
				<if test='suriDay != "" and suriDay != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
					AND a.SuriDay BETWEEN #{strFromDate} AND #{strToDate}
				</if>
				<if test='preciseCostsAccountDay != "" and preciseCostsAccountDay != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
					AND a.PreciseCostsAccountDay BETWEEN #{strFromDate} AND #{strToDate}
				</if>
				<if test='reqCostAccountDay != "" and reqCostAccountDay != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
					AND a.ReqCostAccountDay BETWEEN #{strFromDate} AND #{strToDate}
				</if>
				<if test='examinationYn != "" and examinationYn != null'>AND a.ExaminationYn LIKE #{examinationYn} + '%'</if>
				<if test='examinationDocumentNum != "" and examinationDocumentNum != null'>AND a.ExaminationDocumentNum LIKE #{examinationDocumentNum} + '%'</if>
				<if test='examinationDocumentDay != "" and examinationDocumentDay != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
					AND a.ExaminationDocumentDay BETWEEN #{strFromDate} AND #{strToDate}
				</if>
				<if test='isNullMcountNo != "" and isNullMcountNo != null'>AND ISNULL(a.McountNo, '') = ''</if>
			</where>
		) datas
		<if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
		WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber}) -1) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND (CONVERT(INTEGER, #{_pageNumber}) * CONVERT(INTEGER, #{_pageRow}))
		</if>
	</select>

	<insert id="insertRequirementStatus">
		/* 세브 요건 상태 입력 */
		INSERT INTO CPS_WEB.dbo.CUAA120
           ([BlNum]
			,[TaxNum]
			,[McountNo]
			,[MmodelCode]
			,[McountKorName]
			,[McountEngName]
			,[CommercialCode]
			,[CommercialEtcInfo]
			,[IphangDay]
			,[BanipDay]
			,[JubsuDay]
			,[ExaminationDay]
			,[OriginCountryName]
			,[ExaminationCostType]
			,[ExaminationCost]
			,[SuriDay]
			,[PreciseCostsAccountDay]
			,[ReqCostAccountDay]
			,[Remark]
			,[ExaminationYn]
			,[ExaminationDocumentNum]
			,[ExaminationDocumentDay]
			,[UseYn]
			,[AddUserKey]
			,[AddUserNm]
			,[AddDtm]
			 )
     	VALUES
           (#{blNum}
           ,#{taxNum}
           ,#{mcountNo}
           ,#{mmodelCode}
           ,#{mcountKorName}
           ,#{mcountEngName}
           ,#{commercialCode}
           ,#{commercialEtcInfo}
           ,#{iphangDay}
           ,#{banipDay}
           ,#{jubsuDay}
           ,#{examinationDay}
           ,#{originCountryName}
           ,#{examinationCostType}
           ,#{examinationCost}
           ,#{suriDay}
           ,#{preciseCostsAccountDay}
		   ,#{reqCostAccountDay}
           ,#{remark}
           ,#{examinationYn}
           ,#{examinationDocumentNum}
           ,#{examinationDocumentDay}
           ,'Y'
           ,#{AddUserKey}
           ,#{AddUserNm}
           ,#{AddDtm})
	</insert>

	<update id="updateRequirementStatus">
		/* 세브 요건 상태 수정/삭제 */
		UPDATE CPS_WEB.dbo.CUAA120
		<trim prefix="SET" suffixOverrides=",">
			<if test='blNum != null'>BlNum = #{blNum} ,</if>
			<if test='taxNum != null'>TaxNum = #{taxNum} ,</if>
			<if test='mcountNo != null'>McountNo = #{mcountNo} ,</if>
			<if test='mmodelCode != null'>MmodelCode = #{mmodelCode} ,</if>
			<if test='mcountKorName != null'>McountKorName = #{mcountKorName} ,</if>
			<if test='mcountEngName != null'>McountEngName = #{mcountEngName} ,</if>
			<if test='commercialCode != null'>CommercialCode = #{commercialCode} ,</if>
			<if test='commercialEtcInfo != null'>CommercialEtcInfo = #{commercialEtcInfo} ,</if>
			<if test='iphangDay != null'>IphangDay = #{iphangDay} ,</if>
			<if test='banipDay != null'>BanipDay = #{banipDay} ,</if>
			<if test='jubsuDay != null'>JubsuDay = #{jubsuDay} ,</if>
			<if test='examinationDay != null'>ExaminationDay = #{examinationDay} ,</if>
			<if test='originCountryName != null'>OriginCountryName = #{originCountryName} ,</if>
			<if test='examinationCostType != null'>ExaminationCostType = #{examinationCostType} ,</if>
			<if test='examinationCost != null'>ExaminationCost = #{examinationCost} ,</if>
			<if test='suriDay != null'>SuriDay = #{suriDay} ,</if>
			<if test='preciseCostsAccountDay != null'>PreciseCostsAccountDay = #{preciseCostsAccountDay} ,</if>
			<if test='reqCostAccountDay != null'>ReqCostAccountDay = #{reqCostAccountDay} ,</if>
			<if test='remark != null'>Remark = #{remark} ,</if>
			<if test='examinationYn != null'>ExaminationYn = #{examinationYn} ,</if>
			<if test='examinationDocumentNum != null'>ExaminationDocumentNum = #{examinationDocumentNum} ,</if>
			<if test='examinationDocumentDay != null'>ExaminationDocumentDay = #{examinationDocumentDay} ,</if>
			<if test='useYn != null'>UseYn = #{useYn} ,</if>
			<if test='EditUserKey != null'>EditUserKey = #{EditUserKey} ,</if>
			<if test='EditUserNm != null'>EditUserNm = #{EditUserNm} ,</if>
			<if test='EditDtm != null'>EditDtm = #{EditDtm} ,</if>
		</trim>
		WHERE CUAA120Key = #{CUAA120Key}
	</update>
</mapper>