<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.edwards.biz.edwardsManagement.EdwardsMapper">
    <select id="selectModelMaster" resultType="map">
		select *
		from rms.dbo.ED_MDL_MST
		<where>
            AND useYn = 'Y'
            <if test='MDL_NM != null and MDL_NM != ""'>AND MDL_NM LIKE '%'+ #{MDL_NM} + '%'</if>
        </where>
		order by MDL_CD
	</select>

    <insert id="insertModelMaster">
		INSERT INTO rms.dbo.ED_MDL_MST
		       ([COMP_CD]
		       ,[MDL_CD]
		       ,[MDL_NM]
		       ,[USE_FG]
		       ,[RMRK]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       ('3128112960'
		       ,#{MDL_CD}
		       ,#{MDL_NM}
		       ,#{USE_FG}
		       ,#{RMRK}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateModelMaster">
		UPDATE	rms.dbo.ED_MDL_MST
		<trim prefix="SET" suffixOverrides=",">
			<if test='MDL_CD != null'>MDL_CD = #{MDL_CD} ,</if>
			<if test='MDL_NM != null'>MDL_NM = #{MDL_NM} ,</if>
			<if test='USE_FG != null'>USE_FG = #{USE_FG} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_MDL_MST = #{KEY_ED_MDL_MST}
	</update>

    <select id="selectHsGroupMaster" resultType="map">
		select
		KEY_ED_HS_MST,
		COMP_CD,
		CASE WHEN ISNULL(COMP_CD,'')='3128112960' THEN 'EDWARDS' ELSE '' END AS 'COMP_CD1',
        HS_GRP_CD,
        HS_GRP_NM,
        USE_FG,
        RMRK
		from rms.dbo.ED_HS_MST
		<where>
            AND useYn = 'Y'
            <if test='HS_GRP_CD != null and HS_GRP_CD != ""'>AND HS_GRP_CD LIKE '%'+ #{HS_GRP_CD} + '%'</if>
            <if test='HS_GRP_NM != null and HS_GRP_NM != ""'>AND HS_GRP_NM LIKE '%'+ #{HS_GRP_NM} + '%'</if>
        </where>
		order by HS_GRP_CD desc
	</select>

    <select id="selectHsGroupList" resultType="map">
		select
		*,
		(select top 1 b.Gukyk from rms.[dbo].[ED_CSTM] b where b.HsCd = HS_CD group by b.Gukyk) as 'Gukyk'
		from rms.dbo.ED_HsMst
		<where>
            AND useYn = 'Y'
            <if test='HS_CD != null and HS_CD != ""'>AND HS_CD LIKE #{HS_CD} + '%'</if>
            <if test='RSN_CD_IMP != null and RSN_CD_IMP != ""'>AND RSN_CD_IMP = #{RSN_CD_IMP}</if>
            <if test='RSN_CD_EXP != null and RSN_CD_EXP != ""'>AND RSN_CD_EXP = #{RSN_CD_EXP}</if>
            <if test='Gukyk != null and Gukyk != ""'>AND HS_CD in (select HsCd from rms.[dbo].[ED_CSTM] where Gukyk  =#{Gukyk})</if>
            <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by HS_CD
	</select>

    <insert id="insertHsGroupMaster">
		INSERT INTO rms.dbo.ED_HS_MST
		       ([COMP_CD]
		       ,[HS_GRP_CD]
		       ,[HS_GRP_NM]
		       ,[USE_FG]
		       ,[RMRK]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{taxNum}
		       ,#{HS_GRP_CD}
		       ,#{HS_GRP_NM}
		       ,#{USE_FG}
		       ,#{RMRK}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateHsGroupMaster">
		UPDATE	rms.dbo.ED_HS_MST
		<trim prefix="SET" suffixOverrides=",">
			<if test='HS_GRP_CD != null'>HS_GRP_CD = #{HS_GRP_CD} ,</if>
			<if test='HS_GRP_NM != null'>HS_GRP_NM = #{HS_GRP_NM} ,</if>
			<if test='USE_FG != null'>USE_FG = #{USE_FG} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_HS_MST = #{KEY_ED_HS_MST}
	</update>

    <select id="selectHsGroupCodeMaster" resultType="map">
		select *,
		ISNULL((SELECT CD_DESC FROM soo_MST.dbo.TBR_SYS_CD_STD a WITH (NOLOCK) WHERE a.CD = HS_DIV and a.MCD = 'CPS_ED_04000'), '') AS 'HS_DIV1'
		from rms.dbo.ED_HS_DTL
		<where>
            AND useYn = 'Y'
            AND HS_GRP_CD = #{HS_GRP_CD}
        </where>
		order by SEQNO
	</select>

    <insert id="insertHsGroupCodeMaster">
		INSERT INTO rms.dbo.ED_HS_DTL
		       ([COMP_CD]
		        ,[HS_GRP_CD]
				,[SEQNO]
				,[HS_DIV]
				,[HS_CD]
				,[TR_GODS_NM]
				,[STD_SPEC]
				,[DFLT_FG]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm])
		VALUES
		       (#{COMP_CD}
		       ,#{HS_GRP_CD}
		       ,#{SEQNO}
			   ,#{HS_DIV}
			   ,#{HS_CD}
			   ,#{TR_GODS_NM}
			   ,#{STD_SPEC}
			   ,#{DFLT_FG}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateHsGroupCodeMaster">
		UPDATE	rms.dbo.ED_HS_DTL
		<trim prefix="SET" suffixOverrides=",">
			<if test='HS_DIV != null'>HS_DIV = #{HS_DIV} ,</if>
			<if test='HS_CD != null'>HS_CD = #{HS_CD} ,</if>
			<if test='TR_GODS_NM != null'>TR_GODS_NM = #{TR_GODS_NM} ,</if>
			<if test='STD_SPEC != null'>STD_SPEC = #{STD_SPEC} ,</if>
			<if test='DFLT_FG != null'>DFLT_FG = #{DFLT_FG} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_HS_DTL = #{KEY_ED_HS_DTL}
	</update>

    <select id="selectSysStdList" resultType="map">
		select CD, CD_DESC
        from soo_MST.dbo.TBR_SYS_CD_STD
        <where>
            AND useYn = 'Y'
            <if test='MCD != null and MCD != ""'>AND MCD = #{MCD}</if>
        </where>
        order by CD
	</select>

    <select id="selectHsSgroupMaster" resultType="map">
		select
		*
		from rms.dbo.ED_HS_SPCL_GRP_MST
		<where>
            AND useYn = 'Y'
            <if test='HS_SPCL_MNG_NO != null and HS_SPCL_MNG_NO != ""'>AND HS_SPCL_MNG_NO LIKE '%'+ #{HS_SPCL_MNG_NO} + '%'</if>
            <if test='GRP_NM != null and GRP_NM != ""'>AND GRP_NM LIKE '%'+ #{GRP_NM} + '%'</if>
            <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by HS_SPCL_MNG_NO desc
	</select>

    <insert id="insertHsSgroupMaster">
		INSERT INTO rms.dbo.ED_HS_SPCL_GRP_MST
		       ([COMP_CD]
		       ,[HS_SPCL_MNG_NO]
		       ,[DIV_CD]
		       ,[DIV_NM]
		       ,[GRP_CD]
		       ,[GRP_NM]
		       ,[USE_FG]
		       ,[RMRK]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{taxNum}
		       ,#{HS_SPCL_MNG_NO}
		       ,#{DIV_CD}
		       ,#{DIV_NM}
		       ,#{GRP_CD}
		       ,#{GRP_NM}
		       ,#{USE_FG}
		       ,#{RMRK}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateHsSgroupMaster">
		UPDATE	rms.dbo.ED_HS_SPCL_GRP_MST
		<trim prefix="SET" suffixOverrides=",">
			<if test='HS_SPCL_MNG_NO != null'>HS_SPCL_MNG_NO = #{HS_SPCL_MNG_NO} ,</if>
			<if test='DIV_CD != null'>DIV_CD = #{DIV_CD} ,</if>
			<if test='DIV_NM != null'>DIV_NM = #{DIV_NM} ,</if>
			<if test='GRP_CD != null'>GRP_CD = #{GRP_CD} ,</if>
			<if test='GRP_NM != null'>GRP_NM = #{GRP_NM} ,</if>
			<if test='USE_FG != null'>USE_FG = #{USE_FG} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_HS_SPCL_GRP_MST = #{KEY_ED_HS_SPCL_GRP_MST}
	</update>

    <select id="selectHsSgroupCodeMaster" resultType="map">
		select
		*
		from rms.dbo.ED_HS_SPCL_GRP_DTL
		<where>
            AND useYn = 'Y'
            <if test='HS_SPCL_MNG_NO != null and HS_SPCL_MNG_NO != ""'>AND HS_SPCL_MNG_NO = #{HS_SPCL_MNG_NO}</if>
        </where>
		order by SEQNO
	</select>

    <insert id="insertHsSgroupCodeMaster">
		INSERT INTO rms.dbo.ED_HS_SPCL_GRP_DTL
		       ([COMP_CD]
		        ,[HS_SPCL_MNG_NO]
				,[SEQNO]
				,[HS_CD]
				,[RMRK]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm])
		VALUES
		       (#{COMP_CD}
		       ,#{HS_SPCL_MNG_NO}
		       ,#{SEQNO}
		       ,#{HS_CD}
			   ,#{RMRK}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateHsSgroupCodeMaster">
		UPDATE	rms.dbo.ED_HS_SPCL_GRP_DTL
		<trim prefix="SET" suffixOverrides=",">
			<if test='HS_CD != null'>HS_CD = #{HS_CD} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_HS_SPCL_GRP_DTL = #{KEY_ED_HS_SPCL_GRP_DTL}
	</update>

    <select id="selectMaxCd" resultType="map">
		select
		LEFT(MAX(HS_GRP_CD),4) as 'max',
		MAX(HS_GRP_CD)+1 as 'HS_GRP_CD'
		from rms.dbo.ED_HS_MST
		where useYn='Y'
	</select>

    <select id="selectMaxSeq" resultType="map">
		select
		ISNULL(MAX(SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_HS_DTL
		<where>
		    and useYn='Y'
            <if test='HS_GRP_CD != null and HS_GRP_CD != ""'>AND HS_GRP_CD = #{HS_GRP_CD}</if>
        </where>
	</select>

    <select id="selectMaxScd" resultType="map">
		select
		LEFT(MAX(HS_SPCL_MNG_NO),4) as 'max',
		MAX(HS_SPCL_MNG_NO)+1 as 'HS_SPCL_MNG_NO'
		from rms.dbo.ED_HS_SPCL_GRP_MST
		where useYn='Y'
	</select>

    <select id="selectMaxSseq" resultType="map">
		select
		ISNULL(MAX(SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_HS_SPCL_GRP_DTL
		<where>
		    and useYn='Y'
            <if test='HS_SPCL_MNG_NO != null and HS_SPCL_MNG_NO != ""'>AND HS_SPCL_MNG_NO = #{HS_SPCL_MNG_NO}</if>
        </where>
	</select>

    <select id="selectComMaster" resultType="map">
		select *
		from rms.dbo.ED_COMP
		<where>
            AND useYn = 'Y'
            <if test='COMP_CD != null and COMP_CD != ""'>AND COMP_CD LIKE '%'+ #{COMP_CD} + '%'</if>
            <if test='COMP_NM != null and COMP_NM != ""'>AND COMP_NM LIKE '%'+ #{COMP_NM} + '%'</if>
            <if test='EXEM_DEMD_PLAN_FG != null and EXEM_DEMD_PLAN_FG != ""'>AND EXEM_DEMD_PLAN_FG = #{EXEM_DEMD_PLAN_FG}</if>
            <if test='SPCL_REL_FG != null and SPCL_REL_FG != ""'>AND SPCL_REL_FG = #{SPCL_REL_FG}</if>
            <if test='taxNum != null and taxNum != ""'>AND GRP_COMP_CD = #{taxNum}</if>
        </where>
		order by KEY_ED_COMP desc
	</select>

    <insert id="insertComMaster">
		INSERT INTO rms.dbo.ED_COMP
		       ([COMP_CD]
		       ,[COMP_NM]
		       ,[BZTP]
		       ,[ORIG_CDOC_ISSU_FG]
		       ,[EXEM_DEMD_PLAN_FG]
		       ,[SPCL_REL_FG]
		       ,[GRP_COMP_CD]
		       ,[VENDOR_FG]
		       ,[USE_FG]
		       ,[PLantNo]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{COMP_CD}
		       ,#{COMP_NM}
		       ,#{BZTP}
		       ,#{ORIG_CDOC_ISSU_FG}
		       ,#{EXEM_DEMD_PLAN_FG}
		       ,#{SPCL_REL_FG}
		       ,#{taxNum}
		       ,#{VENDOR_FG}
		       ,#{USE_FG}
		       ,#{PLantNo}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateComMaster">
		UPDATE	rms.dbo.ED_COMP
		<trim prefix="SET" suffixOverrides=",">
			<if test='COMP_CD != null'>COMP_CD = #{COMP_CD} ,</if>
			<if test='COMP_NM != null'>COMP_NM = #{COMP_NM} ,</if>
			<if test='BZTP != null'>BZTP = #{BZTP} ,</if>
			<if test='PLantNo != null'>PLantNo = #{PLantNo} ,</if>
			<if test='ORIG_CDOC_ISSU_FG != null'>ORIG_CDOC_ISSU_FG = #{ORIG_CDOC_ISSU_FG} ,</if>
			<if test='EXEM_DEMD_PLAN_FG != null'>EXEM_DEMD_PLAN_FG = #{EXEM_DEMD_PLAN_FG} ,</if>
			<if test='SPCL_REL_FG != null'>SPCL_REL_FG = #{SPCL_REL_FG} ,</if>
			<if test='VENDOR_FG != null'>VENDOR_FG = #{VENDOR_FG} ,</if>
			<if test='USE_FG != null'>USE_FG = #{USE_FG} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_COMP = #{KEY_ED_COMP}
	</update>

    <select id="selectCstmMaster" resultType="map">
		select
		*,
		CASE WHEN ISNULL(EXIM_DIV,'')='EX' THEN '수출' ELSE '수입' END AS 'EXIM_DIV1'
		from rms.dbo.ED_CSTMNOTYOG
		<where>
            AND useYn = 'Y'
            <if test='EXIM_DIV != null and EXIM_DIV != ""'>AND EXIM_DIV = #{EXIM_DIV}</if>
            <if test='LAW_CD != null and LAW_CD != ""'>AND LAW_CD LIKE '%'+ #{LAW_CD} + '%'</if>
            <if test='LAW_NM != null and LAW_NM != ""'>AND LAW_NM LIKE '%'+ #{LAW_NM} + '%'</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>and CSTM_MNG_NO in (select CSTM_MNG_NO from rms.[dbo].[ED_CSTMNOTYOG_DTL]
				where ITEM_CD like '%'+ #{ITEM_CD} + '%' and useYn='Y') </if>
        </where>
		order by HS_CD
	</select>

    <select id="selectCstmList" resultType="map">
		select
		a.*,
		b.Mmodel_2+b.Mmodel_3 as 'description',
		case when b.Mmodel_3 like '%SPEC:%' then 	RIGHT(b.Mmodel_3, Len(b.Mmodel_3)-CHARINDEX('SPEC:', b.Mmodel_3)-4)
		else '' end as 'itemSpec'
		from rms.dbo.[ED_CSTM] a left outer join CPS.[dbo].[MAAA100] b
		on a.ItemCd=b.Mmodel_code
		and a.McountNo=b.Mcount_no
		<where>
            AND a.useYn = 'Y'
            <if test='ItemCd != null and ItemCd != ""'>AND a.ItemCd LIKE '%'+ #{ItemCd} + '%'</if>
            <if test='HsCd != null and HsCd != ""'>AND a.HsCd LIKE #{HsCd} + '%'</if>
            <if test='LawNm != null and LawNm != ""'>AND a.LawNm LIKE '%'+ #{LawNm} + '%'</if>
            <if test='RsnIm != null and RsnIm != ""'>AND a.RsnIm = #{RsnIm}</if>
            <if test='RsnEx != null and RsnEx != ""'>AND a.RsnEx = #{RsnEx}</if>
            <if test='Gukyk != null and Gukyk != ""'>AND a.Gukyk = #{Gukyk}</if>
            <if test='ItemSpec != null and ItemSpec != ""'>AND b.Mmodel_3 LIKE '%'+ #{ItemSpec} + '%'</if>
            <if test='taxNum != null and taxNum != ""'>AND a.COMP_CD = #{taxNum}</if>
        </where>
		order by a.ItemCd
	</select>

    <select id="selectCstmLaw" resultType="map">
		select
		hsDesc
		from soo_MST.[dbo].[TBR_CD_HS_MATE]
		<where>
            AND useYn = 'Y'
            and gubun = 'S'
            and year = '2020'
            <if test='HsCd != null and HsCd != ""'>AND hsCode = #{HsCd}</if>
            <if test='LawNm != null and LawNm != ""'>AND hsLaw = #{LawNm}</if>
        </where>
	</select>

    <insert id="insertCstmMaster">
		INSERT INTO rms.dbo.ED_CSTMNOTYOG
		       ([COMP_CD]
		       ,[CSTM_MNG_NO]
		       ,[EXIM_DIV]
		       ,[HS_CD]
		       ,[LAW_CD]
		       ,[LAW_NM]
		       ,[USE_FG]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       ('3128112960'
		       ,#{CSTM_MNG_NO}
		       ,#{EXIM_DIV}
		       ,#{HS_CD}
		       ,#{LAW_CD}
		       ,#{LAW_NM}
		       ,#{USE_FG}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateCstmMaster">
		UPDATE	rms.dbo.ED_CSTMNOTYOG
		<trim prefix="SET" suffixOverrides=",">
			<if test='CSTM_MNG_NO != null'>CSTM_MNG_NO = #{CSTM_MNG_NO} ,</if>
			<if test='EXIM_DIV != null'>EXIM_DIV = #{EXIM_DIV} ,</if>
			<if test='HS_CD != null'>HS_CD = #{HS_CD} ,</if>
			<if test='LAW_CD != null'>LAW_CD = #{LAW_CD} ,</if>
			<if test='LAW_NM != null'>LAW_NM = #{LAW_NM} ,</if>
			<if test='USE_FG != null'>USE_FG = #{USE_FG} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_CSTMNOTYOG = #{KEY_ED_CSTMNOTYOG}
	</update>

    <select id="selectCstmCodeMaster" resultType="map">
		select *
		from rms.dbo.ED_CSTMNOTYOG_DTL
		<where>
            AND useYn = 'Y'
            <if test='CSTM_MNG_NO != null and CSTM_MNG_NO != ""'>AND CSTM_MNG_NO = #{CSTM_MNG_NO}</if>
        </where>
		order by SEQNO
	</select>

    <insert id="insertCstmCodeMaster">
		INSERT INTO rms.dbo.ED_CSTMNOTYOG_DTL
		       ([COMP_CD]
		        ,[CSTM_MNG_NO]
				,[SEQNO]
				,[ITEM_CD]
				,[RSN_CD]
				,[ETC_RSN]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm])
		VALUES
		       (#{COMP_CD}
		       ,#{CSTM_MNG_NO}
		       ,#{SEQNO}
			   ,#{ITEM_CD}
			   ,#{RSN_CD}
			   ,#{ETC_RSN}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateCstmCodeMaster">
		UPDATE	rms.dbo.ED_CSTMNOTYOG_DTL
		<trim prefix="SET" suffixOverrides=",">
			<if test='ITEM_CD != null'>ITEM_CD = #{ITEM_CD} ,</if>
			<if test='RSN_CD != null'>RSN_CD = #{RSN_CD} ,</if>
			<if test='ETC_RSN != null'>ETC_RSN = #{ETC_RSN} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_CSTMNOTYOG_DTL = #{KEY_ED_CSTMNOTYOG_DTL}
	</update>

    <select id="selectMaxCstm" resultType="map">
		select
		LEFT(MAX(CSTM_MNG_NO),4) as 'max',
		MAX(CSTM_MNG_NO)+1 as 'CSTM_MNG_NO'
		from rms.dbo.ED_CSTMNOTYOG
		where useYn='Y'
	</select>

    <select id="selectMaxSeqCstm" resultType="map">
		select
		ISNULL(MAX(SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_CSTMNOTYOG_DTL
		<where>
		    and useYn='Y'
            <if test='CSTM_MNG_NO != null and CSTM_MNG_NO != ""'>AND CSTM_MNG_NO = #{CSTM_MNG_NO}</if>
        </where>
	</select>

    <select id="selectBomMaster" resultType="map">
		select
		*
		from rms.dbo.ED_BOM_MST
		<where>
            AND useYn = 'Y'
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "CD"'>AND BOM_CD LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "NM"'>AND BOM_NM LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
            <if test='REVSN_DTTM != null and REVSN_DTTM != ""'>AND REVSN_DTTM = #{REVSN_DTTM}</if>
            <if test='USE_FG != null and USE_FG != ""'>AND USE_FG = #{USE_FG}</if>
            <if test='BOM_CD != null and BOM_CD != ""'>AND BOM_CD = #{BOM_CD}</if>
        </where>
		order by KEY_ED_BOM_MST desc
	</select>

    <insert id="insertBomMaster">
		INSERT INTO rms.dbo.ED_BOM_MST
		       ([COMP_CD]
		       ,[BOM_CD]
		       ,[BOM_NM]
		       ,[REVSN_NO]
		       ,[REVSN_DTTM]
		       ,[QTY_UNIT]
		       ,[DEMD_PLAN_FG]
		       ,[USE_EXEC_FG]
		       ,[REFUND_USE_FG]
		       ,[RMRK]
		       ,[USE_FG]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       ('3128112960'
		       ,#{BOM_CD}
		       ,#{BOM_NM}
		       ,#{REVSN_NO}
		       ,#{REVSN_DTTM}
		       ,#{QTY_UNIT}
		       ,#{DEMD_PLAN_FG}
		       ,#{USE_EXEC_FG}
		       ,#{REFUND_USE_FG}
		       ,#{RMRK}
		       ,#{USE_FG}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateBomMaster">
		UPDATE	rms.dbo.ED_BOM_MST
		<trim prefix="SET" suffixOverrides=",">
			<if test='BOM_CD != null'>BOM_CD = #{BOM_CD} ,</if>
			<if test='BOM_NM != null'>BOM_NM = #{BOM_NM} ,</if>
			<if test='REVSN_NO != null'>REVSN_NO = #{REVSN_NO} ,</if>
			<if test='REVSN_DTTM != null'>REVSN_DTTM = #{REVSN_DTTM} ,</if>
			<if test='QTY_UNIT != null'>QTY_UNIT = #{QTY_UNIT} ,</if>
			<if test='DEMD_PLAN_FG != null'>DEMD_PLAN_FG = #{DEMD_PLAN_FG} ,</if>
			<if test='USE_EXEC_FG != null'>USE_EXEC_FG = #{USE_EXEC_FG} ,</if>
			<if test='REFUND_USE_FG != null'>REFUND_USE_FG = #{REFUND_USE_FG} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='USE_FG != null'>USE_FG = #{USE_FG} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_BOM_MST = #{KEY_ED_BOM_MST}
	</update>

    <select id="selectBomCodeMaster" resultType="map">
		select *
		from rms.dbo.ED_BOM_DTL
		<where>
            AND useYn = 'Y'
            <if test='BOM_CD != null and BOM_CD != ""'>AND BOM_CD = #{BOM_CD}</if>
            <if test='REVSN_NO != null and REVSN_NO != ""'>AND REVSN_NO = #{REVSN_NO}</if>
        </where>
		order by ITEM_CD
	</select>

    <insert id="insertBomCodeMaster">
		INSERT INTO rms.dbo.ED_BOM_DTL
		       ([COMP_CD]
		        ,[SEQNO]
		        ,[BOM_CD]
				,[REVSN_NO]
				,[ITEM_CD]
				,[ITEM_NM]
				,[QTY]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm])
		VALUES
		       (#{COMP_CD}
		       ,#{SEQNO}
		       ,#{BOM_CD}
			   ,#{REVSN_NO}
			   ,#{ITEM_CD}
			   ,#{ITEM_NM}
			   ,#{QTY}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateBomCodeMaster">
		UPDATE	rms.dbo.ED_BOM_DTL
		<trim prefix="SET" suffixOverrides=",">
			<if test='SEQNO != null'>SEQNO = #{SEQNO} ,</if>
			<if test='BOM_CD != null'>BOM_CD = #{BOM_CD} ,</if>
			<if test='REVSN_NO != null'>REVSN_NO = #{REVSN_NO} ,</if>
			<if test='ITEM_CD != null'>ITEM_CD = #{ITEM_CD} ,</if>
			<if test='ITEM_NM != null'>ITEM_NM = #{ITEM_NM} ,</if>
			<if test='QTY != null'>QTY = #{QTY} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_BOM_DTL = #{KEY_ED_BOM_DTL}
	</update>

    <select id="selectMaxBom" resultType="map">
		select
		ISNULL(MAX(REVSN_NO)+1,'') as 'REVSN_NO'
		from rms.dbo.[ED_BOM_MASTER]
		<where>
		    AND useYn = 'Y'
			<if test='BOM_CD != null and BOM_CD != ""'>AND BOM_CD = #{BOM_CD}</if>
		</where>
	</select>

    <select id="selectMaxSeqBom" resultType="map">
		select
		ISNULL(MAX(SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_BOM_DTL
		<where>
		    AND useYn = 'Y'
            <if test='BOM_CD != null and BOM_CD != ""'>AND BOM_CD = #{BOM_CD}</if>
        </where>
	</select>

    <select id="selectRcmdMaster" resultType="map">
		select
		a.*,
		(select COMP_NM from rms.dbo.ED_COMP where COMP_CD = a.COMP_CD) as 'COMP_NM'
		from rms.dbo.ED_EXEM_RCMD_INFO a
		left outer join rms.dbo.ED_COMP b
		on a.COMP_CD = b.COMP_CD
		<where>
            AND a.useYn = 'Y'
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "CD"'>AND b.COMP_NM LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "INFO"'>AND a.RCMD_GODS_INFO LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
            <if test='ASGN_DTTM != null and ASGN_DTTM != ""'>AND a.ASGN_DTTM = #{ASGN_DTTM}</if>
            <if test='USE_FG != null and USE_FG != ""'>AND a.USE_FG = #{USE_FG}</if>
        </where>
		order by a.KEY_ED_EXEM_RCMD_INFO desc
	</select>

    <insert id="insertRcmdMaster">
		INSERT INTO rms.dbo.ED_EXEM_RCMD_INFO
		       ([EXEM_MNG_NO]
		       ,[RCMD_GODS_INFO]
		       ,[ASGN_DTTM]
		       ,[USE_FG]
		       ,[RMRK]
		       ,[COMP_CD]
		       ,[COMP_NM]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{EXEM_MNG_NO}
		       ,#{RCMD_GODS_INFO}
		       ,#{ASGN_DTTM}
		       ,#{USE_FG}
		       ,#{RMRK}
		       ,#{COMP_CD}
		       ,#{COMP_NM}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateRcmdMaster">
		UPDATE	rms.dbo.ED_EXEM_RCMD_INFO
		<trim prefix="SET" suffixOverrides=",">
			<if test='EXEM_MNG_NO != null'>EXEM_MNG_NO = #{EXEM_MNG_NO} ,</if>
			<if test='RCMD_GODS_INFO != null'>RCMD_GODS_INFO = #{RCMD_GODS_INFO} ,</if>
			<if test='ASGN_DTTM != null'>ASGN_DTTM = #{ASGN_DTTM} ,</if>
			<if test='USE_FG != null'>USE_FG = #{USE_FG} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='COMP_CD != null'>COMP_CD = #{COMP_CD} ,</if>
			<if test='COMP_NM != null'>COMP_NM = #{COMP_NM} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_EXEM_RCMD_INFO = #{KEY_ED_EXEM_RCMD_INFO}
	</update>

    <select id="selectRcmdCodeMaster" resultType="map">
		select *
		from rms.dbo.ED_EXEM_RCMD_INFO_DTL
		<where>
            AND useYn = 'Y'
            <if test='EXEM_MNG_NO != null and EXEM_MNG_NO != ""'>AND EXEM_MNG_NO = #{EXEM_MNG_NO}</if>
            <if test='COMP_CD != null and COMP_CD != ""'>AND COMP_CD = #{COMP_CD}</if>
        </where>
		order by CAST(RCMD_NO AS int)
	</select>

    <insert id="insertRcmdCodeMaster">
		INSERT INTO rms.dbo.ED_EXEM_RCMD_INFO_DTL
		       ([EXEM_MNG_NO],
		        [SEQNO],
				[ITEM_CD],
				[ITEM_NM],
				[RCMD_NO],
				[COMP_CD],
				[Mcount_No],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm])
		VALUES
		       (#{EXEM_MNG_NO},
		       #{SEQNO},
			   #{ITEM_CD},
			   #{ITEM_NM},
			   #{RCMD_NO},
			   #{COMP_CD},
			   #{Mcount_No},
		       'Y',
		       #{ID},
		       #{userNm},
		       #{currentDatetime})
	</insert>

    <update id="updateRcmdCodeMaster">
		UPDATE	rms.dbo.ED_EXEM_RCMD_INFO_DTL
		<trim prefix="SET" suffixOverrides=",">
			<if test='EXEM_MNG_NO != null'>EXEM_MNG_NO = #{EXEM_MNG_NO} ,</if>
			<if test='SEQNO != null'>SEQNO = #{SEQNO} ,</if>
			<if test='ITEM_CD != null'>ITEM_CD = #{ITEM_CD} ,</if>
			<if test='ITEM_NM != null'>ITEM_NM = #{ITEM_NM} ,</if>
			<if test='RCMD_NO != null'>RCMD_NO = #{RCMD_NO} ,</if>
			<if test='VENDOR_CD != null'>VENDOR_CD = #{VENDOR_CD} ,</if>
			<if test='COMP_CD != null'>COMP_CD = #{COMP_CD} ,</if>
			<if test='VENDOR_NM != null'>VENDOR_NM = #{VENDOR_NM} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		<if test='KEY_ED_EXEM_RCMD_INFO_DTL != null'>WHERE KEY_ED_EXEM_RCMD_INFO_DTL = #{KEY_ED_EXEM_RCMD_INFO_DTL}</if>
		<if test='EXEM_MNG_NO1 != null'>WHERE EXEM_MNG_NO = #{EXEM_MNG_NO1}</if>
	</update>

    <select id="selectMaxRcmd" resultType="map">
		select
		LEFT(MAX(EXEM_MNG_NO),4) as 'max',
		ISNULL(MAX(EXEM_MNG_NO)+1,'') as 'EXEM_MNG_NO'
		from rms.dbo.ED_EXEM_RCMD_INFO
		<where>
		    AND useYn = 'Y'
		</where>
	</select>

    <select id="selectMaxSeqRcmd" resultType="map">
		select
		ISNULL(MAX(SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_EXEM_RCMD_INFO_DTL
		<where>
		    AND useYn = 'Y'
            <if test='EXEM_MNG_NO != null and EXEM_MNG_NO != ""'>AND EXEM_MNG_NO = #{EXEM_MNG_NO}</if>
        </where>
	</select>

    <select id="selectRcmdItemMaster" resultType="map">
		select
			c.USE_FG,
			d.ITEM_CD,
			d.ITEM_NM,
			c.ASGN_DTTM,
			c.RCMD_GODS_INFO,
			c.COMP_NM,
			c.addUserNm,
			d.RCMD_NO
		from
		(select a.*
		from rms.dbo.ED_EXEM_RCMD_INFO a
		left outer join rms.dbo.ED_COMP b
		on a.COMP_CD = b.COMP_CD
		where a.useYn='Y') c, rms.dbo.ED_EXEM_RCMD_INFO_DTL d
		<where>
		    and d.useYn='Y'
		    AND c.EXEM_MNG_NO = d.EXEM_MNG_NO
		    AND c.COMP_CD = d.COMP_CD
		    <if test='COMP_CD != null and COMP_CD != ""'>AND c.COMP_NM LIKE '%'+ #{COMP_CD} + '%'</if>
            <if test='RCMD_GODS_INFO != null and RCMD_GODS_INFO != ""'>AND c.RCMD_GODS_INFO LIKE '%'+ #{RCMD_GODS_INFO} + '%'</if>
            <if test='ASGN_DTTM != null and ASGN_DTTM != ""'>AND c.ASGN_DTTM = #{ASGN_DTTM}</if>
            <if test='USE_FG != null and USE_FG != ""'>AND c.USE_FG = #{USE_FG}</if>
        </where>
		order by d.ITEM_CD
	</select>

    <select id="selectDemdMaster" resultType="map">
		select
		*,
		CASE WHEN ISNULL(PROC_STAT,'')='07001' THEN '적용중' ELSE '종료' END AS 'PROC_STAT1'
		from rms.dbo.ED_EXEM_DEMD_PLAN
		<where>
            AND useYn = 'Y'
            <if test='PLAN_YY != null and PLAN_YY != ""'>AND PLAN_YY = #{PLAN_YY}</if>
            <if test='PLAN_MM != null and PLAN_MM != ""'>AND PLAN_MM = #{PLAN_MM}</if>
            <if test='APLY_STRT_DT != null and APLY_STRT_DT != ""'>AND APLY_STRT_DT = #{APLY_STRT_DT}</if>
            <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%'+ #{OWN_GODS_NM} + '%'</if>
            <if test='PROC_STAT != null and PROC_STAT != ""'>AND PROC_STAT = #{PROC_STAT}</if>
        </where>
		order by KEY_ED_EXEM_DEMD_PLAN desc
	</select>

    <select id="selectMaxDemd" resultType="map">
		select
		substring(MAX(EXEM_PLAN_MNG_NO),3,8) as 'max',
		ISNULL(substring(MAX(EXEM_PLAN_MNG_NO),3,10)+1,'') as 'EXEM_PLAN_MNG_NO'
		from rms.dbo.ED_EXEM_DEMD_PLAN
		<where>
		    AND useYn = 'Y'
		</where>
	</select>

    <insert id="insertDemdMaster">
		INSERT INTO rms.dbo.ED_EXEM_DEMD_PLAN
		       ([EXEM_PLAN_MNG_NO]
		       ,[GRP_COMP_CD]
		       ,[PLAN_YY]
		       ,[PLAN_MM]
		       ,[APLY_STRT_DT]
		       ,[APLY_END_DT]
		       ,[BOM_APLY_FG]
		       ,[RMRK]
		       ,[PROC_STAT]
		       ,[OWN_GODS_CD]
		       ,[OWN_GODS_NM]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{EXEM_PLAN_MNG_NO}
		       ,'3128112960'
		       ,#{PLAN_YY}
		       ,#{PLAN_MM}
		       ,#{APLY_STRT_DT}
		       ,#{APLY_END_DT}
		       ,#{BOM_APLY_FG}
		       ,#{RMRK}
		       ,#{PROC_STAT}
		       ,#{OWN_GODS_CD}
		       ,#{OWN_GODS_NM}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateDemdMaster">
		UPDATE	rms.dbo.ED_EXEM_DEMD_PLAN
		<trim prefix="SET" suffixOverrides=",">
			<if test='EXEM_PLAN_MNG_NO != null'>EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO} ,</if>
			<if test='PLAN_YY != null'>PLAN_YY = #{PLAN_YY} ,</if>
			<if test='PLAN_MM != null'>PLAN_MM = #{PLAN_MM} ,</if>
			<if test='APLY_STRT_DT != null'>APLY_STRT_DT = #{APLY_STRT_DT} ,</if>
			<if test='APLY_END_DT != null'>APLY_END_DT = #{APLY_END_DT} ,</if>
			<if test='BOM_APLY_FG != null'>BOM_APLY_FG = #{BOM_APLY_FG} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='PROC_STAT != null'>PROC_STAT = #{PROC_STAT} ,</if>
			<if test='OWN_GODS_CD != null'>OWN_GODS_CD = #{OWN_GODS_CD} ,</if>
			<if test='OWN_GODS_NM != null'>OWN_GODS_NM = #{OWN_GODS_NM} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		<where>
            <if test='KEY_ED_EXEM_DEMD_PLAN != null and KEY_ED_EXEM_DEMD_PLAN != ""'>AND KEY_ED_EXEM_DEMD_PLAN = #{KEY_ED_EXEM_DEMD_PLAN}</if>
            <if test='EXEM_PLAN_MNG_NO != null and EXEM_PLAN_MNG_NO != ""'>AND EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO}</if>
        </where>
	</update>

    <select id="selectDemdCodeMaster" resultType="map">
		select *
		from rms.dbo.ED_EXEM_DEMD_PLAN_PROD
		<where>
            AND useYn = 'Y'
            <if test='EXEM_PLAN_MNG_NO != null and EXEM_PLAN_MNG_NO != ""'>AND EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO}</if>
        </where>
		order by PROD_CD
	</select>

    <insert id="insertDemdCodeMaster">
		INSERT INTO rms.dbo.ED_EXEM_DEMD_PLAN_PROD
		       ([EXEM_PLAN_MNG_NO]
				,[PLAN_PROD_SEQNO]
				,[PROD_CD]
				,[PROD_NM]
				,[Mcount_No]
				,[QTY]
				,[BOM_Revsn_No]
				,[GRP_COMP_CD]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm])
		VALUES
		       (#{EXEM_PLAN_MNG_NO}
		       ,#{PLAN_PROD_SEQNO}
			   ,#{PROD_CD}
			   ,#{PROD_NM}
			   ,#{Mcount_No}
			   ,#{QTY}
			   ,#{BOM_Revsn_No}
			   ,#{GRP_COMP_CD}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateDemdCodeMaster">
		UPDATE	rms.dbo.ED_EXEM_DEMD_PLAN_PROD
		<trim prefix="SET" suffixOverrides=",">
			<if test='EXEM_PLAN_MNG_NO != null'>EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO} ,</if>
			<if test='PLAN_PROD_SEQNO != null'>PLAN_PROD_SEQNO = #{PLAN_PROD_SEQNO} ,</if>
			<if test='PROD_CD != null'>PROD_CD = #{PROD_CD} ,</if>
			<if test='PROD_NM != null'>PROD_NM = #{PROD_NM} ,</if>
			<if test='Mcount_No != null'>Mcount_No = #{Mcount_No} ,</if>
			<if test='QTY != null'>QTY = #{QTY} ,</if>
			<if test='BOM_Revsn_No != null'>BOM_Revsn_No = #{BOM_Revsn_No} ,</if>
			<if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		<where>
            <if test='KEY_ED_EXEM_DEMD_PLAN_PROD != null and KEY_ED_EXEM_DEMD_PLAN_PROD != ""'>AND KEY_ED_EXEM_DEMD_PLAN_PROD = #{KEY_ED_EXEM_DEMD_PLAN_PROD}</if>
            <if test='EXEM_PLAN_MNG_NO != null and EXEM_PLAN_MNG_NO != ""'>AND EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO}</if>
        </where>
	</update>

    <select id="selectMaxSeqDemd" resultType="map">
		select
		ISNULL(MAX(PLAN_PROD_SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_EXEM_DEMD_PLAN_PROD
		<where>
		    AND useYn = 'Y'
            <if test='EXEM_PLAN_MNG_NO != null and EXEM_PLAN_MNG_NO != ""'>AND EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO}</if>
        </where>
	</select>

    <select id="selectDemdItemMaster" resultType="map">
		select *
		from rms.dbo.ED_EXEM_DEMD_PLAN_ITEM
		<where>
            AND useYn = 'Y'
            <if test='EXEM_PLAN_MNG_NO != null and EXEM_PLAN_MNG_NO != ""'>AND EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO}</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD = #{ITEM_CD}</if>
        </where>
		order by CAST(RCMD_NO AS int)
	</select>

    <select id="selectExecMaster" resultType="map">
		select
		*,
		CASE WHEN ISNULL(PROC_STAT,'')='07001' THEN '적용중' ELSE '종료' END AS 'PROC_STAT1'
		from rms.dbo.ED_EXEM_EXEC_MST
		<where>
            AND useYn = 'Y'
            <if test='JOB_NM != null and JOB_NM != ""'>AND JOB_NM LIKE '%'+ #{JOB_NM} + '%'</if>
            <if test='STRT_DT != null and STRT_DT != ""'>AND STRT_DT = #{STRT_DT}</if>
            <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%'+ #{OWN_GODS_NM} + '%'</if>
            <if test='PROC_STAT != null and PROC_STAT != ""'>AND PROC_STAT = #{PROC_STAT}</if>
            <if test='taxNum != null and taxNum != ""'>AND GRP_COMP_CD = #{taxNum}</if>
        </where>
		order by KEY_ED_EXEM_EXEC_MST desc
	</select>

    <select id="selectMaxExec" resultType="map">
		select
		substring(MAX(EXEM_EXEC_MNG_NO),3,8) as 'max',
		ISNULL(substring(MAX(EXEM_EXEC_MNG_NO),3,10)+1,'') as 'EXEM_EXEC_MNG_NO'
		from rms.dbo.ED_EXEM_EXEC_MST
		<where>
		    AND useYn = 'Y'
		</where>
	</select>

    <insert id="insertExecMaster">
		INSERT INTO rms.dbo.ED_EXEM_EXEC_MST
		       ([EXEM_EXEC_MNG_NO]
				,[JOB_NM]
				,[GRP_COMP_CD]
				,[OWN_GODS_NM]
				,[BOM_APLY_FG]
				,[STRT_DT]
				,[END_DT]
				,[RMRK]
				,[PROC_STAT]
				,[OWN_GODS_CD]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{EXEM_EXEC_MNG_NO}
		       ,#{JOB_NM}
		       ,#{GRP_COMP_CD}
		       ,#{OWN_GODS_NM}
		       ,#{BOM_APLY_FG}
		       ,#{STRT_DT}
		       ,#{END_DT}
		       ,#{RMRK}
		       ,#{PROC_STAT}
		       ,#{OWN_GODS_CD}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateExecMaster">
		UPDATE	rms.dbo.ED_EXEM_EXEC_MST
		<trim prefix="SET" suffixOverrides=",">
			<if test='EXEM_EXEC_MNG_NO != null'>EXEM_EXEC_MNG_NO = #{EXEM_EXEC_MNG_NO} ,</if>
			<if test='JOB_NM != null'>JOB_NM = #{JOB_NM} ,</if>
			<if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
			<if test='OWN_GODS_NM != null'>OWN_GODS_NM = #{OWN_GODS_NM} ,</if>
			<if test='BOM_APLY_FG != null'>BOM_APLY_FG = #{BOM_APLY_FG} ,</if>
			<if test='STRT_DT != null'>STRT_DT = #{STRT_DT} ,</if>
			<if test='END_DT != null'>END_DT = #{END_DT} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='PROC_STAT != null'>PROC_STAT = #{PROC_STAT} ,</if>
			<if test='OWN_GODS_CD != null'>OWN_GODS_CD = #{OWN_GODS_CD} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_EXEM_EXEC_MST = #{KEY_ED_EXEM_EXEC_MST}
	</update>

    <select id="selectExecCodeMaster" resultType="map">
		select *
		from rms.dbo.ED_EXEM_EXEC_PROD
		<where>
            AND useYn = 'Y'
            <if test='EXEM_EXEC_MNG_NO != null and EXEM_EXEC_MNG_NO != ""'>AND EXEM_EXEC_MNG_NO = #{EXEM_EXEC_MNG_NO}</if>
        </where>
		order by PROD_CD
	</select>

    <insert id="insertExecCodeMaster">
		INSERT INTO rms.dbo.ED_EXEM_EXEC_PROD
		       ([EXEM_EXEC_MNG_NO]
				,[PROD_SEQNO]
				,[PROD_CD]
				,[PROD_NM]
				,[EXEC_DT]
				,[QTY]
				,[BOM_REVSN_NO]
				,[GRP_COMP_CD]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm])
		VALUES
		       (#{EXEM_EXEC_MNG_NO}
		       ,#{PROD_SEQNO}
			   ,#{PROD_CD}
			   ,#{PROD_NM}
			   ,#{EXEC_DT}
			   ,#{QTY}
			   ,#{BOM_REVSN_NO}
			   ,#{GRP_COMP_CD}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateExecCodeMaster">
		UPDATE	rms.dbo.ED_EXEM_EXEC_PROD
		<trim prefix="SET" suffixOverrides=",">
			<if test='EXEM_EXEC_MNG_NO != null'>EXEM_EXEC_MNG_NO = #{EXEM_EXEC_MNG_NO} ,</if>
			<if test='PROD_SEQNO != null'>PROD_SEQNO = #{PROD_SEQNO} ,</if>
			<if test='PROD_CD != null'>PROD_CD = #{PROD_CD} ,</if>
			<if test='PROD_NM != null'>PROD_NM = #{PROD_NM} ,</if>
			<if test='EXEC_DT != null'>EXEC_DT = #{EXEC_DT} ,</if>
			<if test='QTY != null'>QTY = #{QTY} ,</if>
			<if test='BOM_REVSN_NO != null'>BOM_REVSN_NO = #{BOM_REVSN_NO} ,</if>
			<if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_EXEM_EXEC_PROD = #{KEY_ED_EXEM_EXEC_PROD}
	</update>

    <select id="selectMaxSeqExec" resultType="map">
		select
		ISNULL(MAX(PROD_SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_EXEM_EXEC_PROD
		<where>
		    AND useYn = 'Y'
            <if test='EXEM_EXEC_MNG_NO != null and EXEM_EXEC_MNG_NO != ""'>AND EXEM_EXEC_MNG_NO = #{EXEM_EXEC_MNG_NO}</if>
        </where>
	</select>

    <select id="selectExecItemMaster" resultType="map">
		select *
		from rms.dbo.ED_EXEM_EXEC_ITEM
		<where>
            AND useYn = 'Y'
            <if test='EXEM_EXEC_MNG_NO != null and EXEM_EXEC_MNG_NO != ""'>AND EXEM_EXEC_MNG_NO = #{EXEM_EXEC_MNG_NO}</if>
        </where>
		order by PROD_CD, ITEM_CD
	</select>

    <select id="selectAfmngMaster" resultType="map">
		select
		*,
		CASE WHEN ISNULL(STAT,'')='07001' THEN '적용중' ELSE '종료' END AS 'STAT1'
		from rms.dbo.ED_EXEM_AFMNG_END_MST
		<where>
            AND useYn = 'Y'
            <if test='ORDR_DT != null and ORDR_DT != ""'>AND ORDR_DT = #{ORDR_DT}</if>
            <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%'+ #{OWN_GODS_NM} + '%'</if>
            <if test='STAT != null and STAT != ""'>AND STAT = #{STAT}</if>
        </where>
		order by KEY_ED_EXEM_AFMNG_END_MST desc
	</select>

    <select id="selectMaxAfmng" resultType="map">
		select
		substring(MAX(AFMNG_END_MNG_NO),3,8) as 'max',
		ISNULL(substring(MAX(AFMNG_END_MNG_NO),3,10)+1,'') as 'AFMNG_END_MNG_NO'
		from rms.dbo.ED_EXEM_AFMNG_END_MST
		<where>
		    AND useYn = 'Y'
		</where>
	</select>

    <insert id="insertAfmngMaster">
		INSERT INTO rms.dbo.ED_EXEM_AFMNG_END_MST
		       ([AFMNG_END_MNG_NO]
				,[ORDR_DT]
				,[DECL_DDAY]
				,[GRP_COMP_CD]
				,[OWN_GODS_NM]
				,[DECL_REQ_DT]
				,[DECL_CUSTOMS_CD]
				,[DECL_DIVS_MAN]
				,[DECL_RCPT_DT]
				,[DECL_CMPL_DT]
				,[RMRK]
				,[STAT]
				,[DECL_CUSTOMS_NM]
				,[OWN_GODS_CD]
				,[OWN_GODS_DIVS_MAN]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{AFMNG_END_MNG_NO}
		       ,#{ORDR_DT}
		       ,#{DECL_DDAY}
		       ,#{GRP_COMP_CD}
		       ,#{OWN_GODS_NM}
		       ,#{DECL_REQ_DT}
		       ,#{DECL_CUSTOMS_CD}
		       ,#{DECL_DIVS_MAN}
		       ,#{DECL_RCPT_DT}
		       ,#{DECL_CMPL_DT}
		       ,#{RMRK}
		       ,#{STAT}
		       ,#{DECL_CUSTOMS_NM}
		       ,#{OWN_GODS_CD}
		       ,#{OWN_GODS_DIVS_MAN}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateAfmngMaster">
		UPDATE	rms.dbo.ED_EXEM_AFMNG_END_MST
		<trim prefix="SET" suffixOverrides=",">
			<if test='AFMNG_END_MNG_NO != null'>AFMNG_END_MNG_NO = #{AFMNG_END_MNG_NO} ,</if>
			<if test='ORDR_DT != null'>ORDR_DT = #{ORDR_DT} ,</if>
			<if test='DECL_DDAY != null'>DECL_DDAY = #{DECL_DDAY} ,</if>
			<if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
			<if test='OWN_GODS_NM != null'>OWN_GODS_NM = #{OWN_GODS_NM} ,</if>
			<if test='DECL_REQ_DT != null'>DECL_REQ_DT = #{DECL_REQ_DT} ,</if>
			<if test='DECL_CUSTOMS_CD != null'>DECL_CUSTOMS_CD = #{DECL_CUSTOMS_CD} ,</if>
			<if test='DECL_DIVS_MAN != null'>DECL_DIVS_MAN = #{DECL_DIVS_MAN} ,</if>
			<if test='DECL_RCPT_DT != null'>DECL_RCPT_DT = #{DECL_RCPT_DT} ,</if>
			<if test='DECL_CMPL_DT != null'>DECL_CMPL_DT = #{DECL_CMPL_DT} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='STAT != null'>STAT = #{STAT} ,</if>
			<if test='DECL_CUSTOMS_NM != null'>DECL_CUSTOMS_NM = #{DECL_CUSTOMS_NM} ,</if>
			<if test='OWN_GODS_CD != null'>OWN_GODS_CD = #{OWN_GODS_CD} ,</if>
			<if test='OWN_GODS_DIVS_MAN != null'>OWN_GODS_DIVS_MAN = #{OWN_GODS_DIVS_MAN} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_EXEM_AFMNG_END_MST = #{KEY_ED_EXEM_AFMNG_END_MST}
	</update>

    <select id="selectAfmngItemMaster" resultType="map">
		select *
		from rms.dbo.ED_EXEM_AFMNG_END_DTL
		<where>
            AND useYn = 'Y'
            <if test='AFMNG_END_MNG_NO != null and AFMNG_END_MNG_NO != ""'>AND AFMNG_END_MNG_NO = #{AFMNG_END_MNG_NO}</if>
        </where>
		order by AFMNG_END_SEQNO
	</select>

    <insert id="insertAfmngCodeMaster">
		INSERT INTO rms.dbo.ED_EXEM_AFMNG_END_DTL
		       ([GRP_COMP_CD]
				,[AFMNG_END_MNG_NO]
				,[AFMNG_END_SEQNO]
				,[DECL_DT]
				,[IMPT_DECL_NO]
				,[LAN]
				,[QTY]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm])
		VALUES
		       (#{GRP_COMP_CD}
		       ,#{AFMNG_END_MNG_NO}
			   ,#{AFMNG_END_SEQNO}
			   ,#{DECL_DT}
			   ,#{IMPT_DECL_NO}
			   ,#{LAN}
			   ,#{QTY}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateAfmngCodeMaster">
		UPDATE	rms.dbo.ED_EXEM_AFMNG_END_DTL
		<trim prefix="SET" suffixOverrides=",">
			<if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
			<if test='AFMNG_END_MNG_NO != null'>AFMNG_END_MNG_NO = #{AFMNG_END_MNG_NO} ,</if>
			<if test='AFMNG_END_SEQNO != null'>AFMNG_END_SEQNO = #{AFMNG_END_SEQNO} ,</if>
			<if test='DECL_DT != null'>DECL_DT = #{DECL_DT} ,</if>
			<if test='IMPT_DECL_NO != null'>IMPT_DECL_NO = #{IMPT_DECL_NO} ,</if>
			<if test='LAN != null'>LAN = #{LAN} ,</if>
			<if test='QTY != null'>QTY = #{QTY} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		<if test='KEY_ED_EXEM_AFMNG_END_DTL != null'>WHERE KEY_ED_EXEM_AFMNG_END_DTL = #{KEY_ED_EXEM_AFMNG_END_DTL}</if>
		<if test='AFMNG_END_MNG_NO1 != null'>WHERE AFMNG_END_MNG_NO = #{AFMNG_END_MNG_NO1}</if>
	</update>

    <select id="selectMaxSeqAfmng" resultType="map">
		select
		ISNULL(MAX(AFMNG_END_SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_EXEM_AFMNG_END_DTL
		<where>
		    AND useYn = 'Y'
            <if test='AFMNG_END_MNG_NO != null and AFMNG_END_MNG_NO != ""'>AND AFMNG_END_MNG_NO = #{AFMNG_END_MNG_NO}</if>
        </where>
	</select>

    <select id="selectReExpobjMaster" resultType="map">
		select
		*
		from rms.dbo.ED_REEXPOBJCLOSE_ORDR
		<where>
            AND useYn = 'Y'
            <if test='ORDR_DT1 != null and ORDR_DT1 != ""'>AND ORDR_DT like #{ORDR_DT1} + '%'</if>
            <if test='ImExGbn1 != null and ImExGbn1 != ""'>AND ImExGbn = #{ImExGbn1}</if>
            <if test='JOB_NM1 != null and JOB_NM1 != ""'>AND JOB_NM LIKE '%'+ #{JOB_NM1} + '%'</if>
            <if test='RMRK1 != null and RMRK1 != ""'>AND RMRK LIKE '%'+ #{RMRK1} + '%'</if>
            <if test='taxNum != null and taxNum != ""'>AND GRP_COMP_CD = #{taxNum}</if>
        </where>
		order by KEY_ED_REEXPOBJCLOSE_ORDR desc
	</select>

    <select id="selectReExpobjItemMaster" resultType="map">
		select
		a.KEY_ED_REEXPOBJCLOSE_DTL,
		a.IMP_OK_DT,
		substring(a.IMP_OK_DT,0,5)+'-'+substring(a.IMP_OK_DT,5,2)+'-'+substring(a.IMP_OK_DT,7,2) as 'IMP_OK_DT1',
		case when (a.IMPT_DECL_NO != '') then a.IMPT_DECL_NO
		else '' end as 'IMPT_DECL_NO',
		a.LAN,
		a.HNG,
		char(9)+a.LAN as 'LAN1',
		char(9)+a.HNG as 'HNG1',
		a.BL_NO,
		a.QTY,
		a.ITEM_CD,
		a.ITEM_NM,
		a.addUserNm,
		a.addDtm,
		substring(a.addDtm,0,5)+'-'+substring(a.addDtm,5,2)+'-'+substring(a.addDtm,7,2) as 'addDtm1',
		b.ImExGbn
		from rms.dbo.ED_REEXPOBJCLOSE_DTL a, rms.dbo.ED_REEXPOBJCLOSE_ORDR b
		<where>
		    and a.ORDR_NO = b.ORDR_NO
            AND a.useYn = 'Y'
            and b.useYn = 'Y'
            <if test='ORDR_NO != null and ORDR_NO != ""'>AND a.ORDR_NO = #{ORDR_NO}</if>
            <if test='taxNum != null and taxNum != ""'>AND a.GRP_COMP_CD = #{taxNum}</if>
        </where>
		order by a.DTL_SEQNO
	</select>

    <select id="selectReExpobjAddItemMaster" resultType="map">
		select b.DECL_CMPL_DT,
		case when (b.IMPT_DECL_NO != '') then b.IMPT_DECL_NO
		else '' end as 'IMPT_DECL_NO',
		c.LAN, c.HNG, b.BL_NO, c.QTY, c.ITEM_CD, c.Impum_gukyk2 as 'ITEM_NM', c.REFUND_QTY, c.addUserNm, c.addDtm, c.RMID_QTY
		from rms.dbo.ED_IMPT_ORDR b, rms.dbo.ED_IMPT_DECL_HNG c
		<where>
            AND b.useYn = 'Y'
            and c.useYn = 'Y'
			and b.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "BlNo"'>AND b.BL_NO LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "Singo"'>AND b.IMPT_DECL_NO LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "ItemCd"'>AND c.ITEM_CD LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "ItemNm"'>AND c.ITEM_NM LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
        </where>
	</select>

    <select id="selectReExpobjAddItemMaster1" resultType="map">
		select a.DECL_CMPL_DT,
		case when (a.EXPT_DECL_NO != '') then a.EXPT_DECL_NO
		else '' end as 'IMPT_DECL_NO',
		b.LAN, b.HNG, a.INV_NO1 as 'BL_NO', b.QTY, b.PROD_CD as 'ITEM_CD', b.PROD_NM as 'ITEM_NM'
		from rms.dbo.ED_EXPT_ORDR a, rms.dbo.ED_EXPT_DECL_HNG b
		<where>
            AND a.useYn = 'Y'
            and b.useYn = 'Y'
			and a.EXPT_ORDR_MNG_NO = b.EXPT_ORDR_MNG_NO
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "BlNo"'>AND a.INV_NO1 LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "Singo"'>AND a.EXPT_DECL_NO LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "ItemCd"'>AND b.PROD_CD LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "ItemNm"'>AND b.PROD_NM LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
        </where>
	</select>

    <select id="selectMfcMaster" resultType="map">
		select
		*,
		CASE WHEN ISNULL(PROC_STAT,'')='07001' THEN '적용중' ELSE '신고대기' END AS 'PROC_STAT1'
		from rms.dbo.ED_REFUND_MFC_ORDR
		<where>
            AND useYn = 'Y'
            <if test='ORDR_DT != null and ORDR_DT != ""'>AND ORDR_DT = #{ORDR_DT}</if>
            <if test='JOB_NM != null and JOB_NM != ""'>AND JOB_NM LIKE '%'+ #{JOB_NM} + '%'</if>
        </where>
		order by KEY_ED_REFUND_MFC_ORDR desc
	</select>

    <select id="selectMfcItemMaster" resultType="map">
		select *
		from rms.dbo.ED_REFUND_MFC_ITEM
		<where>
            AND useYn = 'Y'
            <if test='ORDR_NO != null and ORDR_NO != ""'>AND ORDR_NO = #{ORDR_NO}</if>
        </where>
		order by PROD_SEQNO
	</select>

    <select id="selectMfcCodeMaster" resultType="map">
		select
		c.Decl_cmpl_dt, c.IMPT_DECL_NO, a.LAN, a.HNG, a.HS_CD, a.SHORT_FG, c.BL_NO, b.PROD_CD, b.PROD_NM, b.QTY, a.REFUND_QTY
		from rms.dbo.ED_REFUND_MFC_IMPT_DESC a, rms.dbo.ED_REFUND_MFC_ITEM b, rms.dbo.ED_IMPT_ORDR c
		<where>
            AND a.useYn = 'Y'
            AND b.useYn = 'Y'
            AND c.useYn = 'Y'
            and a.ORDR_NO = b.ORDR_NO
			and a.PROD_SEQNO = b.PROD_SEQNO
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
            <if test='ORDR_NO != null and ORDR_NO != ""'>AND a.ORDR_NO = #{ORDR_NO}</if>
            <if test='PROD_SEQNO != null and PROD_SEQNO != ""'>AND a.PROD_SEQNO = #{PROD_SEQNO}</if>
        </where>
		order by a.IMPT_SEQNO
	</select>

    <select id="selectOrgOrdrMaster" resultType="map">
		select
		*,
		CASE WHEN ISNULL(PROC_STAT,'')='07001' THEN '적용중' ELSE '신고대기' END AS 'PROC_STAT1'
		from rms.dbo.ED_REFUND_ORG_ORDR
		<where>
            AND useYn = 'Y'
            <if test='ORDR_DT != null and ORDR_DT != ""'>AND ORDR_DT = #{ORDR_DT}</if>
            <if test='JOB_NM != null and JOB_NM != ""'>AND JOB_NM LIKE '%'+ #{JOB_NM} + '%'</if>
        </where>
		order by KEY_ED_REFUND_ORG_ORDR desc
	</select>

    <select id="selectOrgOrdrList" resultType="map">
		select a.EXPT_DECL_NO, a.HS_CD, a.EXPT_AMT, a.EXPT_QTY, sum(b.REFUND_TTAX) as 'REFUND_TTAX'
		from(
			select REFUND_ORDR_MNG_NO, EXPT_DECL_NO, HS_CD, sum(EXPT_AMT) as 'EXPT_AMT', sum(EXPT_QTY) as 'EXPT_QTY' from rms.dbo.ED_REFUND_ORG_EXP_DESC
			<where>
	            AND useYn = 'Y'
	            <if test='REFUND_ORDR_MNG_NO != null and REFUND_ORDR_MNG_NO != ""'>AND REFUND_ORDR_MNG_NO = #{REFUND_ORDR_MNG_NO}</if>
	        </where>
			group by REFUND_ORDR_MNG_NO, EXPT_DECL_NO, HS_CD ) a, rms.dbo.ED_REFUND_ORG_IMP_DESC b
		where a.REFUND_ORDR_MNG_NO = b.REFUND_ORDR_MNG_NO
		and a.EXPT_DECL_NO = b.EXPT_DECL_NO
		and a.HS_CD = b.HS_CD
		AND b.useYn = 'Y'
		group by a.EXPT_DECL_NO, a.HS_CD, a.EXPT_AMT, a.EXPT_QTY
		order by a.EXPT_DECL_NO, a.HS_CD
	</select>

    <select id="selectOrgExpoList" resultType="map">
		select
		*
		from rms.dbo.ED_REFUND_ORG_EXP_DESC
		<where>
            AND useYn = 'Y'
            <if test='REFUND_ORDR_MNG_NO != null and REFUND_ORDR_MNG_NO != ""'>AND REFUND_ORDR_MNG_NO = #{REFUND_ORDR_MNG_NO}</if>
            <if test='EXPT_DECL_NO != null and EXPT_DECL_NO != ""'>AND EXPT_DECL_NO = #{EXPT_DECL_NO}</if>
            <if test='HS_CD != null and HS_CD != ""'>AND HS_CD = #{HS_CD}</if>
        </where>
		order by KEY_ED_REFUND_ORG_EXP_DESC desc
	</select>

    <select id="selectOrgImpoList" resultType="map">
		select
		*
		from rms.dbo.ED_REFUND_ORG_IMP_DESC
		<where>
            AND useYn = 'Y'
            <if test='REFUND_ORDR_MNG_NO != null and REFUND_ORDR_MNG_NO != ""'>AND REFUND_ORDR_MNG_NO = #{REFUND_ORDR_MNG_NO}</if>
            <if test='EXPT_DECL_NO != null and EXPT_DECL_NO != ""'>AND EXPT_DECL_NO = #{EXPT_DECL_NO}</if>
            <if test='HS_CD != null and HS_CD != ""'>AND HS_CD = #{HS_CD}</if>
        </where>
		order by KEY_ED_REFUND_ORG_IMP_DESC desc
	</select>

    <select id="selectCoMaster" resultType="map">
		select
		*,
		CASE WHEN ISNULL(PROC_STAT,'')='07001' THEN '적용중' ELSE '종료' END AS 'PROC_STAT1'
		from rms.dbo.ED_CO_MST
		<where>
            AND useYn = 'Y'
            <if test='STRT_DT != null and STRT_DT != ""'>AND STRT_DT = #{STRT_DT}</if>
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "CO_NO"'>AND CO_NO LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "FRGN_COMP_NM"'>AND FRGN_COMP_NM LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
            <if test='EXIM_DIV != null and EXIM_DIV != ""'>AND EXIM_DIV = #{EXIM_DIV}</if>
            <if test='PROC_STAT != null and PROC_STAT != ""'>AND PROC_STAT = #{PROC_STAT}</if>
            <if test='FTA_CD != null'>AND FTA_CD = #{FTA_CD}</if>
            <if test='taxNum != null'>AND GRP_COMP_CD = #{taxNum}</if>
        </where>
		order by KEY_ED_CO_MST desc
	</select>

    <select id="selectMaxCoMst" resultType="map">
		select
		substring(MAX(CO_ORDR_MNG_NO),3,8) as 'max',
		ISNULL(substring(MAX(CO_ORDR_MNG_NO),3,10)+1,'') as 'CO_ORDR_MNG_NO'
		from rms.dbo.ED_CO_MST
	</select>

    <insert id="insertCoMaster">
		INSERT INTO rms.dbo.ED_CO_MST
		       ([GRP_COMP_CD]
				,[CO_ORDR_MNG_NO]
				,[EXIM_DIV]
				,[PROC_STAT]
				,[CO_YEAR]
				,[OWN_GODS_CD]
				,[OWN_GODS_NM]
				,[CO_NO]
				,[STRT_DT]
				,[END_DT]
				,[RMRK]
				,[FRGN_COMP_CD]
				,[FRGN_COMP_NM]
				,[FTA_CD]
				,[NOTFTA_FG]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{taxNum}
		       ,#{CO_ORDR_MNG_NO}
				,#{EXIM_DIV}
				,#{PROC_STAT}
				,''
				,'3128112960'
				,'EDWARDS'
				,#{CO_NO}
				,#{STRT_DT}
				,#{END_DT}
				,#{RMRK}
				,''
				,#{FRGN_COMP_NM}
				,#{FTA_CD}
				,#{NOTFTA_FG}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateCoMaster">
		UPDATE	rms.dbo.ED_CO_MST
		<trim prefix="SET" suffixOverrides=",">
			<if test='CO_ORDR_MNG_NO != null'>CO_ORDR_MNG_NO = #{CO_ORDR_MNG_NO} ,</if>
			<if test='EXIM_DIV != null'>EXIM_DIV = #{EXIM_DIV} ,</if>
			<if test='PROC_STAT != null'>PROC_STAT = #{PROC_STAT} ,</if>
			<if test='CO_NO != null'>CO_NO = #{CO_NO} ,</if>
			<if test='STRT_DT != null'>STRT_DT = #{STRT_DT} ,</if>
			<if test='END_DT != null'>END_DT = #{END_DT} ,</if>
			<if test='RMRK != null'>RMRK = #{RMRK} ,</if>
			<if test='FRGN_COMP_NM != null'>FRGN_COMP_NM = #{FRGN_COMP_NM} ,</if>
			<if test='FTA_CD != null'>FTA_CD = #{FTA_CD} ,</if>
			<if test='NOTFTA_FG != null'>NOTFTA_FG = #{NOTFTA_FG} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_CO_MST = #{KEY_ED_CO_MST}
	</update>

    <select id="selectCoItemMaster" resultType="map">
		select *
		from rms.dbo.ED_CO_DTL
		<where>
            AND useYn = 'Y'
            <if test='CO_ORDR_MNG_NO != null and CO_ORDR_MNG_NO != ""'>AND CO_ORDR_MNG_NO = #{CO_ORDR_MNG_NO}</if>
        </where>
		order by SEQNO
	</select>

    <select id="selectMaxSeqCo" resultType="map">
		select
		ISNULL(MAX(SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_CO_DTL
		<where>
		    AND useYn = 'Y'
            <if test='CO_ORDR_MNG_NO != null and CO_ORDR_MNG_NO != ""'>AND CO_ORDR_MNG_NO = #{CO_ORDR_MNG_NO}</if>
        </where>
	</select>

    <insert id="insertCoItemMaster">
		INSERT INTO rms.dbo.ED_CO_DTL
		       ([GRP_COMP_CD]
				,[CO_ORDR_MNG_NO]
				,[SEQNO]
				,[ITEM_CD]
				,[ITEM_NM]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm])
		VALUES
		       (#{taxNum}
		       ,#{CO_ORDR_MNG_NO}
				,#{SEQNO}
				,#{ITEM_CD}
				,#{ITEM_NM}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime})
	</insert>

    <update id="updateCoItemMaster">
		UPDATE	rms.dbo.ED_CO_DTL
		<trim prefix="SET" suffixOverrides=",">
			<if test='CO_ORDR_MNG_NO != null'>CO_ORDR_MNG_NO = #{CO_ORDR_MNG_NO} ,</if>
			<if test='ITEM_CD != null'>ITEM_CD = #{ITEM_CD} ,</if>
			<if test='ITEM_NM != null'>ITEM_NM = #{ITEM_NM} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_CO_DTL = #{KEY_ED_CO_DTL}
	</update>

    <select id="selectExpoMaster" resultType="map">
		select
		a.*,
		CASE WHEN ISNULL(a.PROC_STAT,'')='08003' THEN '신고완료'
		WHEN ISNULL(a.PROC_STAT,'')='08002' THEN '신고대기'
		WHEN ISNULL(a.PROC_STAT,'')='08004' THEN '신고중'
		WHEN ISNULL(a.PROC_STAT,'')='08011' THEN '작성'
		WHEN ISNULL(a.PROC_STAT,'')='08012' THEN '요청'
		WHEN ISNULL(a.PROC_STAT,'')='08013' THEN '확정'
		ELSE '준비' END AS 'PROC_STAT1',
		case when
		(select count(b.ORIG_STAT_OBJ_FG) from rms.[dbo].[ED_EXPT_INV] b where b.EXPT_ORDR_MNG_NO = a.EXPT_ORDR_MNG_NO and b.useYn='Y' and b.ORIG_STAT_OBJ_FG ='Y') > 0 then 'Y'
		else 'N' end as 'wonCount'
		from rms.dbo.ED_EXPT_ORDR a
		<where>
            AND a.useYn = 'Y'
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "Invoice"'>AND (a.INV_NO1 LIKE '%'+ #{NODATA} + '%' or a.INV_NO2 LIKE '%'+ #{NODATA} + '%')</when>
	                <when test='NOCHK == "Singo"'>AND a.EXPT_DECL_NO LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
        	<if test='MANCHK != null and MANCHK != "" and (MANDATA != null and MANDATA != "")'>
	            <choose>
	                <when test='MANCHK == "Hwaju"'>AND a.OWN_GODS_DIVS_MAN_NM LIKE '%'+ #{MANDATA} + '%'</when>
	                <when test='MANCHK == "Singo"'>AND a.DECL_DIVS_MAN LIKE '%'+ #{MANDATA} + '%'</when>
	            </choose>
        	</if>
            <if test='PROC_STAT != null and PROC_STAT != ""'>AND a.PROC_STAT = #{PROC_STAT}</if>
            <if test='other != null and other != ""'>AND a.PROC_STAT in (${other})</if>
            <if test='DAYCHK != null and DAYCHK != "" and (FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
                <choose>
	                <when test='DAYCHK == "Order"'>AND a.ORDR_DT BETWEEN #{FROM_DT} AND #{TO_DT}</when>
	                <when test='DAYCHK == "Suri"'>AND a.DECL_CMPL_DTTM BETWEEN #{FROM_DT} AND #{TO_DT}</when>
	                <when test='DAYCHK == "Request"'>AND SUBSTRING(a.ITEM_REQ_DTTM,0,9) BETWEEN #{FROM_DT} AND #{TO_DT}</when>
	                <when test='DAYCHK == "Confirm"'>AND SUBSTRING(a.ITEM_FIX_DTTM,0,9) BETWEEN #{FROM_DT} AND #{TO_DT}</when>
	                <when test='DAYCHK == "Mconfirm"'>AND SUBSTRING(a.DECL_FIX_DTTM,0,9) BETWEEN #{FROM_DT} AND #{TO_DT}</when>
	            </choose>
        	</if>
        	<if test='KEY_ED_EXPT_ORDR != null and KEY_ED_EXPT_ORDR != ""'>AND a.KEY_ED_EXPT_ORDR = #{KEY_ED_EXPT_ORDR}</if>
        	<if test='taxNum != null and taxNum != ""'>AND a.GRP_COMP_CD = #{taxNum}</if>
        </where>
		order by a.PROC_STAT desc, a.ORDR_DT desc, a.INV_NO1
	</select>

    <select id="selectExpoInvMaster" resultType="map">
		select
		b.Morigin1, b.Mhs_kind, b.Mhs_rate, b.Mconfirm_flag,
		CASE WHEN ISNULL(a.HS_CD,'')='' THEN 'Y'
		ELSE 'N' END AS 'hsCheck',
		a.*,
		CASE WHEN a.KitGbn='C1' THEN '일반'
		WHEN a.KitGbn='C2' THEN '원상태'
		WHEN a.KitGbn='C3' THEN '제조'
		WHEN a.KitGbn='C4' THEN '기납원상태' ELSE '' END AS 'KitGbn1'
		from rms.dbo.ED_EXPT_INV a left outer join CPS.[dbo].[MAAA100] b
		on a.PROD_CD = b.Mmodel_code
		and b.Mco_com=#{taxNum}
		<where>
		    and a.useYn='Y'
            <if test='KEY_ED_EXPT_INV != null and KEY_ED_EXPT_INV != ""'>AND a.KEY_ED_EXPT_INV = #{KEY_ED_EXPT_INV}</if>
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND a.EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
            <if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>AND a.ORIG_STAT_OBJ = #{ORIG_STAT_OBJ}</if>
            <if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>and (a.ExEmNo is null or a.ExEmNo = '')</if>
            <if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>and convert(INT,a.NOT_ORIG_STAT_QTY) > 0</if>
            <if test='HS_CD != null and HS_CD != ""'>AND a.HS_CD = ''</if>
            <if test='drawCheck != null and drawCheck != ""'>AND (a.drawCheck = '' or a.drawCheck is null)</if>
        </where>
		order by a.EXPT_INV_SEQNO
	</select>

    <select id="selectExpoLanMaster" resultType="map">
		select
		*
		from rms.dbo.ED_EXPT_DECL_LAN
		<where>
            AND useYn = 'Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
        </where>
		order by LAN
	</select>

    <select id="selectExpoHangMaster" resultType="map">
		select
		*
		from rms.dbo.ED_EXPT_DECL_HNG
		<where>
            AND useYn = 'Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
            <if test='LAN != null and LAN != ""'>AND LAN = #{LAN}</if>
        </where>
		order by HNG
	</select>

    <select id="selectExpoImpoMaster" resultType="map">
		select
		c.IMPT_ORDR_MNG_NO, c.DECL_CMPL_DTTM, c.IMPT_DECL_NO, a.LAN, a.HNG, c.BL_NO,  b.HS_CD, b.ORIG,  a.ITEM_CD, a.ITEM_NM, d.IMPT_RMID_QTY, d.EXPT_QTY,
		b.MARK_DSN, b.MARK_YN, b.BRND_NM, d.KEY_ED_ORIG_STAT_IMPT_DESC,
		d.EXPT_ORDR_MNG_NO, d.EXPT_INV_SEQNO, d.IMPT_ORDR_MNG_NO, d.IMPT_LAN, d.IMPT_HNG,'' as 'SERIAL_NO','' as 'ExEmNo'
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c, rms.dbo.ED_ORIG_STAT_IMPT_DESC d
		<where>
            AND a.useYn = 'Y'
            AND b.useYn = 'Y'
            AND c.useYn = 'Y'
            AND d.useYn = 'Y'
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = d.IMPT_ORDR_MNG_NO
			and a.LAN = b.LAN
			and a.LAN = d.IMPT_LAN
			and a.HNG = d.IMPT_HNG
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND d.EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
            <if test='EXPT_INV_SEQNO != null and EXPT_INV_SEQNO != ""'>AND d.EXPT_INV_SEQNO = #{EXPT_INV_SEQNO}</if>
        </where>
        union all
		select
		IMPT_ORDR_MNG_NO, IMPT_CMPL_DT as 'DECL_CMPL_DTTM', IMPT_DECL_NO, IMPT_LAN as 'LAN', IMPT_HNG as 'HNG', BL_NO, '' as 'HS_CD','' as 'ORIG', PROD_CD as 'ITEM_CD', PROD_NM as 'ITEM_NM',0,EXPT_QTY as 'EXPT_QTY',
		'','','',0,'',0,'','','', SERIAL_NO, ExEmNo
		from rms.[dbo].[ED_REEXPT_MASTER]
		<where>
		    and useYn='Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
            <if test='EXPT_INV_SEQNO != null and EXPT_INV_SEQNO != ""'>AND EXPT_INV_SEQNO = #{EXPT_INV_SEQNO}</if>
        </where>
        order by c.DECL_CMPL_DTTM desc
	</select>

    <select id="selectImpoMaster" resultType="map">
		select
		b.IS_cargoStatus,b.IS_ETA, b.IS_ATA, b.IS_carryInDateDepot, b.IS_urgent, b.IS_workScopeRequirement,
		a.*,
		CASE WHEN ISNULL(a.PROC_STAT,'')='08003' THEN '신고완료'
		WHEN ISNULL(a.PROC_STAT,'')='08002' THEN '신고대기'
		WHEN ISNULL(a.PROC_STAT,'')='08004' THEN '신고중'
		WHEN ISNULL(a.PROC_STAT,'')='08011' THEN '작성'
		WHEN ISNULL(a.PROC_STAT,'')='08012' THEN '요청'
		WHEN ISNULL(a.PROC_STAT,'')='08013' THEN '확정'
		ELSE '준비' END AS 'PROC_STAT1'
		from rms.dbo.ED_IMPT_ORDR a left outer join rms.dbo.KTbl_ImSchedule b
		on a.BL_NO = b.IS_BLNo
		and a.IMPT_ORDR_MNG_NO = b.IS_REF1
		and  b.IS_taxPayerRegistrationNo = #{taxNum}
		<where>
            AND a.useYn = 'Y'
            <if test='KEY_ED_IMPT_ORDR != null and KEY_ED_IMPT_ORDR != ""'>AND KEY_ED_IMPT_ORDR = #{KEY_ED_IMPT_ORDR}</if>
            <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%'+ #{IMPT_DECL_NO} + '%'</if>
            <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%'+ #{BL_NO} + '%'</if>
            <if test='HS_CD != null and HS_CD != ""'>AND IMPT_ORDR_MNG_NO in (select IMPT_ORDR_MNG_NO from rms.[dbo].[ED_IMPT_INV] where useYn='Y' and HS_CD like '%'+ #{HS_CD} + '%')</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND IMPT_ORDR_MNG_NO in (select IMPT_ORDR_MNG_NO from rms.[dbo].[ED_IMPT_INV] where useYn='Y' and ITEM_CD like '%'+ #{ITEM_CD} + '%')</if>
            <if test='EXP_NM != null and EXP_NM != ""'>AND EXP_NM LIKE '%'+ #{EXP_NM} + '%'</if>
            <if test='PROC_STAT != null and PROC_STAT != ""'>AND PROC_STAT = #{PROC_STAT}</if>
            <if test='other != null and other != ""'>AND PROC_STAT in (${other})</if>
            <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
            AND ORDR_DT BETWEEN #{FROM_DT} AND #{TO_DT}
        	</if>
        	<if test='taxNum != null and taxNum != ""'>AND GRP_COMP_CD = #{taxNum}</if>
        </where>
		order by PROC_STAT desc, ORDR_DT desc
	</select>

    <select id="selectImpoInvMaster" resultType="map">
		select
		*,
		impum_gukyk2+' '+impum_gukyk3 as 'gukyk',
		round(QTY,1) as 'QTY1',
		round(EXEM_QTY,1) as 'EXEM_QTY1',
		round(NOT_EXEM_QTY,1) as 'NOT_EXEM_QTY1'
		from rms.dbo.ED_IMPT_INV
		<where>
            AND useYn = 'Y'
            <if test='KEY_ED_IMPT_INV != null and KEY_ED_IMPT_INV != ""'>AND KEY_ED_IMPT_INV = #{KEY_ED_IMPT_INV}</if>
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
            <if test='INV_NO != null and INV_NO != ""'>AND INV_NO = #{INV_NO}</if>
            <if test='EXEMMent != null and EXEMMent != ""'>AND EXEM = #{EXEMMent}</if>
            <if test='ReEx != null and ReEx != ""'>AND (SERIAL_NO = '' or SERIAL_NO is null)</if>
            <if test='ExEmNo != null and ExEmNo != ""'>AND ExEmNo != ''</if>
            <if test='EXEM != null and EXEM != ""'>AND EXEM = #{EXEM}</if>
            <if test='EXEM != null and EXEM != ""'>AND Mhs_rate <![CDATA[ > ]]> 0</if>
        </where>
		order by IMPT_INV_SEQNO
	</select>

    <select id="selectImpoInvSumMaster" resultType="map">
		select
		INV_NO, SUM(QTY) as 'QTY',SUM(AMT) as 'AMT',SUM(AMT_PRICE) as 'AMT_PRICE'
		from rms.dbo.ED_IMPT_INV
		<where>
            AND useYn = 'Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
        </where>
		group by INV_NO
	</select>

    <select id="selectImpoLanMaster" resultType="map">
		select
		*
		from rms.dbo.ED_IMPT_DECL_LAN
		<where>
            AND useYn = 'Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
        </where>
		order by LAN
	</select>

    <select id="selectImpoHangMaster" resultType="map">
		select
		*
		from rms.dbo.ED_IMPT_DECL_HNG
		<where>
            AND useYn = 'Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
            <if test='LAN != null and LAN != ""'>AND LAN = #{LAN}</if>
            <if test='HNG != null and HNG != ""'>AND HNG = #{HNG}</if>
            <if test='IMPT_SINGO_NO != null and IMPT_SINGO_NO != ""'>AND IMPT_SINGO_NO = #{IMPT_SINGO_NO}</if>
        </where>
		order by HNG
	</select>

    <select id="selectImpoGamMaster" resultType="map">
		select a.RCMD_GODS_INFO, b.SEQNO, d.EXEM_PLAN_MNG_NO, d.PLAN_YY, d.PLAN_MM, c.USE_QTY
		from rms.dbo.ED_EXEM_RCMD_INFO a, rms.dbo.ED_EXEM_RCMD_INFO_DTL b, rms.dbo.ED_EXEM_DEMD_PLAN_ITEM c, rms.dbo.ED_EXEM_DEMD_PLAN d
		<where>
            AND a.useYn = 'Y'
            AND b.useYn = 'Y'
            AND c.useYn = 'Y'
            AND d.useYn = 'Y'
            and a.EXEM_MNG_NO = b.EXEM_MNG_NO
            and a.EXEM_MNG_NO = c.EXEM_MNG_NO
            and b.RCMD_NO = c.RCMD_NO
			and c.EXEM_PLAN_MNG_NO = d.EXEM_PLAN_MNG_NO
			and b.ITEM_CD = c.ITEM_CD
			<if test='COMP_CD != null and COMP_CD != ""'>AND d.OWN_GODS_CD = #{COMP_CD}</if>
            <if test='COMP_CD != null and COMP_CD != ""'>AND a.COMP_CD = #{COMP_CD}</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND c.ITEM_CD = #{ITEM_CD}</if>
            <if test='ORDR_DT != null and ORDR_DT != ""'>AND d.APLY_STRT_DT <![CDATA[ <= ]]> #{ORDR_DT} and (d.APLY_END_DT <![CDATA[ >= ]]> #{ORDR_DT} or d.APLY_END_DT = '')</if>
        </where>
	</select>

    <select id="selectFtaMaster" resultType="map">
		select *
		from rms.dbo.ED_fta_pact
		<where>
            AND useYn = 'Y'
            <if test='PACT_CD != null and PACT_CD != ""'>AND PACT_CD LIKE '%'+ #{PACT_CD} + '%'</if>
            <if test='PACT_NM != null and PACT_NM != ""'>AND PACT_NM LIKE '%'+ #{PACT_NM} + '%'</if>
            <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by KEY_ED_fta_pact
	</select>

    <insert id="insertFtaMaster">
		INSERT INTO rms.dbo.ED_fta_pact
		       ([PACT_CD]
		       ,[PACT_NM]
		       ,[SFCT_ISSU_FG]
		       ,[EFCT_DT]
		       ,[ENFR_DT]
		       ,[APPLY_STD]
		       ,[AUTO_MATCH_CONO]
		       ,[useYn]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm]
		       ,[COMP_CD])
		VALUES
		       (#{PACT_CD}
		       ,#{PACT_NM}
		       ,#{SFCT_ISSU_FG}
		       ,#{EFCT_DT}
		       ,#{ENFR_DT}
		       ,#{APPLY_STD}
		       ,#{AUTO_MATCH_CONO}
		       ,'Y'
		       ,#{ID}
		       ,#{userNm}
		       ,#{currentDatetime}
		       ,#{taxNum})
	</insert>

    <update id="updateFtaMaster">
		UPDATE	rms.dbo.ED_fta_pact
		<trim prefix="SET" suffixOverrides=",">
			<if test='PACT_CD != null'>PACT_CD = #{PACT_CD} ,</if>
			<if test='PACT_NM != null'>PACT_NM = #{PACT_NM} ,</if>
			<if test='SFCT_ISSU_FG != null'>SFCT_ISSU_FG = #{SFCT_ISSU_FG} ,</if>
			<if test='EFCT_DT != null'>EFCT_DT = #{EFCT_DT} ,</if>
			<if test='ENFR_DT != null'>ENFR_DT = #{ENFR_DT} ,</if>
			<if test='APPLY_STD != null'>APPLY_STD = #{APPLY_STD} ,</if>
			<if test='AUTO_MATCH_CONO != null'>AUTO_MATCH_CONO = #{AUTO_MATCH_CONO} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_fta_pact = #{KEY_ED_fta_pact}
	</update>

    <select id="selectImpoPopMaster" resultType="map">
		select
		a.KEY_ED_IMPT_DECL_HNG, c.IMPT_ORDR_MNG_NO, c.DECL_CMPL_DTTM, c.IMPT_DECL_NO, c.BL_NO, a.LAN, b.HS_CD, b.ORIG, a.HNG, a.ITEM_CD, a.ITEM_NM, a.QTY, a.RMID_QTY,
		a.QTY_UNIT, a.PRCE,
		b.MARK_DSN, b.MARK_YN, b.BRND_NM, b.Mhs_rate
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c
		<where>
            AND a.useYn = 'Y'
            AND b.useYn = 'Y'
            AND c.useYn = 'Y'
            and (a.checkYn != '0' or a.checkYn is null)
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.LAN = b.LAN
			and a.RMID_QTY != '0'
			<if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
			<if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD = #{HS_CD}</if>
			<if test='ORIG != null and ORIG != ""'>AND b.ORIG = #{ORIG}</if>
			<if test='gam != null and gam != ""'>AND b.EXEM_DIV = 'N'</if>
			<if test='gn != null and gn != ""'>AND c.Impo_gyelje != 'GN'</if>
			<if test='day != null and day != ""'>AND c.DECL_CMPL_DTTM <![CDATA[ >= ]]> #{twoYear}</if>
			<if test='month != null and month != ""'>AND c.DECL_CMPL_DTTM <![CDATA[ >= ]]> #{3Month}</if>
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "BlNo"'>AND c.BL_NO LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "Singo"'>AND c.IMPT_DECL_NO LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
        </where>
		order by c.DECL_CMPL_DTTM
	</select>

    <select id="selectImpoPopMaster1" resultType="map">
		select
		a.KEY_ED_IMPT_DECL_HNG, c.IMPT_ORDR_MNG_NO, c.DECL_CMPL_DTTM, c.IMPT_DECL_NO, c.BL_NO, a.LAN, b.HS_CD, b.ORIG, a.HNG, a.ITEM_CD, a.ITEM_NM, a.QTY, a.RMID_QTY,
		a.QTY_UNIT, a.PRCE,
		b.MARK_DSN, b.MARK_YN, b.BRND_NM, b.Mhs_rate
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c, rms.dbo.ED_REEXPOBJCLOSE_DTL d
		<where>
            AND a.useYn = 'Y'
            AND b.useYn = 'Y'
            AND c.useYn = 'Y'
            AND d.useYn = 'Y'
            and (a.checkYn != '0' or a.checkYn is null)
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and c.IMPT_DECL_NO = d.IMPT_DECL_NO
			and a.LAN = d.LAN
			and a.HNG = d.HNG
			and a.LAN = b.LAN
			and a.RMID_QTY != '0'
			<if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
			<if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD = #{HS_CD}</if>
			<if test='ORIG != null and ORIG != ""'>AND b.ORIG = #{ORIG}</if>
			<if test='gam != null and gam != ""'>AND b.EXEM_DIV = 'N'</if>
			<if test='gn != null and gn != ""'>AND c.Impo_gyelje != 'GN'</if>
			<if test='day != null and day != ""'>AND c.DECL_CMPL_DTTM <![CDATA[ >= ]]> #{twoYear}</if>
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "BlNo"'>AND c.BL_NO LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "Singo"'>AND c.IMPT_DECL_NO LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
        </where>
		order by c.DECL_CMPL_DTTM
	</select>

    <update id="updateExpoInv">
		UPDATE	rms.dbo.ED_EXPT_INV
		<trim prefix="SET" suffixOverrides=",">
		    <if test='ORIG_STAT_OBJ != null'>ORIG_STAT_OBJ = #{ORIG_STAT_OBJ} ,</if>
		    <if test='ORIG_STAT_OBJ != null'>ORIG_STAT_OBJ_FG = 'Y' ,</if>
		    <if test='ORIG_STAT_OBJ != null'>INDV_REFN_FG = 'N' ,</if>
			<if test='EXPT_QTY != null'>ORIG_STAT_QTY = ORIG_STAT_QTY + #{EXPT_QTY} ,</if>
			<if test='EXPT_QTY != null'>ORIG_QTY = ORIG_QTY + #{EXPT_QTY} ,</if>
			<if test='EXPT_QTY != null'>NOT_ORIG_STAT_QTY = NOT_ORIG_STAT_QTY - #{EXPT_QTY} ,</if>
			<if test='RE_QTY != null'>ORIG_STAT_QTY = ORIG_STAT_QTY - #{RE_QTY} ,</if>
			<if test='RE_QTY != null'>ORIG_QTY = ORIG_QTY - #{RE_QTY} ,</if>
			<if test='RE_QTY != null'>NOT_ORIG_STAT_QTY = NOT_ORIG_STAT_QTY + #{RE_QTY} ,</if>
			<if test='RE_QTY != null'>ORIG_STAT_OBJ_FG = 'N' ,</if>
			<if test='RE_QTY != null'>ORIG_STAT_OBJ = '대상' ,</if>
			<if test='RE_QTY != null'>drawCheck = null ,</if>
			<if test='singoCheck != null'>singoCheck = #{singoCheck} ,</if>
			<if test='drawCheck != null'>drawCheck = 'Y' ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
		and EXPT_INV_SEQNO = #{EXPT_INV_SEQNO}
	</update>

    <update id="updateImpoHng">
		UPDATE	rms.dbo.ED_IMPT_DECL_HNG
		<trim prefix="SET" suffixOverrides=",">
		    <if test='EXPT_QTY != null'>EXPT_QTY = EXPT_QTY + #{EXPT_QTY} ,</if>
			<if test='EXPT_QTY != null'>RMID_QTY = RMID_QTY - #{EXPT_QTY} ,</if>
			<if test='RE_QTY != null'>EXPT_QTY = EXPT_QTY - #{RE_QTY} ,</if>
			<if test='RE_QTY != null'>RMID_QTY = RMID_QTY + #{RE_QTY} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
		and LAN = #{IMPT_LAN}
		and HNG = #{IMPT_HNG}
	</update>

    <update id="updateImpoHng1">
		UPDATE	rms.dbo.ED_IMPT_DECL_HNG
		set OLD_RMID_QTY = RMID_QTY ,
			RMID_QTY = '0',
			editUserNm = #{userNm} ,
			editDtm = #{currentDatetime}
		WHERE IMPT_SINGO_NO = #{IMPT_SINGO_NO}
		and LAN = #{IMPT_LAN}
		and HNG = #{IMPT_HNG}
	</update>

    <update id="updateImpoHng2">
		UPDATE	rms.dbo.ED_IMPT_DECL_HNG
		set RMID_QTY = OLD_RMID_QTY,
			editUserNm = #{userNm} ,
			editDtm = #{currentDatetime}
		WHERE IMPT_SINGO_NO = #{IMPT_SINGO_NO}
		and LAN = #{IMPT_LAN}
		and HNG = #{IMPT_HNG}
	</update>

    <update id="updateImpoHng3">
		UPDATE	rms.dbo.ED_IMPT_DECL_HNG
		<trim prefix="SET" suffixOverrides=",">
		    <if test='ReQTY != null'>EXPT_QTY = EXPT_QTY + #{ReQTY} ,</if>
			<if test='ReQTY != null'>RMID_QTY = RMID_QTY - #{ReQTY} ,</if>
			<if test='turnQty != null'>EXPT_QTY = EXPT_QTY - #{turnQty} ,</if>
			<if test='turnQty != null'>RMID_QTY = RMID_QTY + #{turnQty} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
		and LAN = #{LAN}
		and HNG = #{HNG}
	</update>

    <select id="selectMaxOrigStat" resultType="map">
		select
		ISNULL(MAX(SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_ORIG_STAT_IMPT_DESC
		<where>
		    and useYn = 'Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
            <if test='EXPT_INV_SEQNO != null and EXPT_INV_SEQNO != ""'>AND EXPT_INV_SEQNO = #{EXPT_INV_SEQNO}</if>
        </where>
	</select>

    <select id="selectDrawOrigStat" resultType="map">
		select
		OneGwan_tax, Onetotal_tax
		from rms.dbo.ED_IMPT_DECL_HNG
		<where>
		    and useYn = 'Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
            <if test='IMPT_LAN != null and IMPT_LAN != ""'>AND LAN = #{IMPT_LAN}</if>
            <if test='IMPT_HNG != null and IMPT_HNG != ""'>AND HNG = #{IMPT_HNG}</if>
        </where>
	</select>

    <insert id="insertOrigStat">
		INSERT INTO rms.dbo.ED_ORIG_STAT_IMPT_DESC
		       ([GRP_COMP_CD]
				,[EXPT_ORDR_MNG_NO]
				,[EXPT_INV_SEQNO]
				,[SEQNO]
				,[IMPT_ORDR_MNG_NO]
				,[IMPT_LAN]
				,[IMPT_HNG]
				,[EXPT_QTY]
				,[EXPT_LAN]
				,[EXPT_HNG]
				,[IMPT_RMID_QTY]
				,[IMPT_DECL_NO]
				,[QTY_UNIT]
				,[OneGwan_tax]
				,[Onetotal_tax]
				,[RefGwan_tax]
				,[RefTotal_tax]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm]
				)
		VALUES
		       (#{taxNum}
				,#{EXPT_ORDR_MNG_NO}
				,#{EXPT_INV_SEQNO}
				,#{SEQNO}
				,#{IMPT_ORDR_MNG_NO}
				,#{IMPT_LAN}
				,#{IMPT_HNG}
				,#{EXPT_QTY}
				,#{EXPT_LAN}
				,#{EXPT_HNG}
				,#{IMPT_RMID_QTY}
				,#{IMPT_DECL_NO}
				,#{QTY_UNIT}
				,#{OneGwan_tax}
				,#{Onetotal_tax}
				,ROUND(${OneGwan_tax} * ${EXPT_QTY},0)
				,ROUND(${Onetotal_tax} * ${EXPT_QTY},0)
				,'Y'
		        ,#{ID}
		        ,#{userNm}
		        ,#{currentDatetime})
	</insert>

    <update id="updateOrigStat">
		UPDATE	rms.dbo.ED_ORIG_STAT_IMPT_DESC
		<trim prefix="SET" suffixOverrides=",">
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_ORIG_STAT_IMPT_DESC = #{KEY_ED_ORIG_STAT_IMPT_DESC}
	</update>

    <select id="selectExpoLanHng" resultType="map">
		select b.LAN, b.HNG
		from rms.dbo.ED_EXPT_DECL_LAN a, rms.dbo.ED_EXPT_DECL_HNG b
		<where>
		    and a.useYn = 'Y'
		    and b.useYn = 'Y'
		    and a.EXPT_ORDR_MNG_NO = b.EXPT_ORDR_MNG_NO
		    and a.LAN = b.LAN
			and a.EXPT_DIV = 'Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND b.EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
            <if test='EXPT_INV_SEQNO != null and EXPT_INV_SEQNO != ""'>AND b.EXPT_INV_SEQNO = #{EXPT_INV_SEQNO}</if>
        </where>
	</select>

    <update id="updateExpoMaster">
		UPDATE	rms.dbo.ED_EXPT_ORDR
		<trim prefix="SET" suffixOverrides=",">
		    <if test='PROC_STAT != null'>PROC_STAT = #{PROC_STAT} ,</if>
		    <if test='ID != null'>ITEM_FIX_ID = #{ID} ,</if>
			<if test='userNm != null'>ITEM_FIX_NM = #{userNm} ,</if>
			<if test='currentDatetime != null'>ITEM_FIX_DTTM = #{currentDatetime} ,</if>
			<if test='currentDatetime1 != null'>ITEM_FIX_DTTM = '' ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
			<if test='currentDatetime1 != null'>editDtm = #{currentDatetime1} ,</if>
			<if test='currentDatetime2 != null'>editDtm = #{currentDatetime2} ,</if>
		</trim>
		WHERE KEY_ED_EXPT_ORDR = #{KEY_ED_EXPT_ORDR}
	</update>

    <update id="updateImpoMaster">
		UPDATE	rms.dbo.ED_IMPT_ORDR
		<trim prefix="SET" suffixOverrides=",">
		    <if test='PROC_STAT != null'>PROC_STAT = #{PROC_STAT} ,</if>
		    <if test='ID != null'>ITEM_FIX_ID = #{ID} ,</if>
			<if test='userNm != null'>ITEM_FIX_NM = #{userNm} ,</if>
			<if test='currentDatetime != null'>ITEM_FIX_DTTM = #{currentDatetime} ,</if>
			<if test='currentDatetime1 != null'>ITEM_FIX_DTTM = '' ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
			<if test='currentDatetime1 != null'>editDtm = #{currentDatetime1} ,</if>
			<if test='currentDatetime2 != null'>editDtm = #{currentDatetime2} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
		</trim>
		WHERE KEY_ED_IMPT_ORDR = #{KEY_ED_IMPT_ORDR}
	</update>

    <select id="selectCheckQty" resultType="map">
		select
		c.IMPT_ORDR_MNG_NO, a.LAN, a.HNG, a.QTY, a.RMID_QTY, c.IMPT_DECL_NO
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c
		<where>
		    and a.useYn = 'Y'
		    and b.useYn = 'Y'
		    and c.useYn = 'Y'
		    and (a.checkYn != '0' or a.checkYn is null)
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.LAN = b.LAN
			and a.RMID_QTY != '0'
			AND c.DECL_CMPL_DT <![CDATA[ >= ]]> #{twoYear}
			AND c.Impo_gyelje != 'GN'
			AND b.EXEM_DIV = 'N'
			and a.RMID_QTY <![CDATA[ > ]]> 0.999
			AND b.Mhs_rate <![CDATA[ > ]]> 0
			and c.Impo_gele_gubun = '11'
			and c.Impo_jingsu_type != '14'
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
            <if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD = #{HS_CD}</if>
            <if test='ORIG != null and ORIG != ""'>AND b.ORIG = #{ORIG}</if>
            <if test='Mhs_rate != null and Mhs_rate != ""'>AND b.Mhs_rate = #{Mhs_rate}</if>
            <if test='Mhs_rateE != null and Mhs_rateE != ""'>AND b.Mhs_rate not in ${Mhs_rateE}</if>
        </where>
        order by c.DECL_CMPL_DT
	</select>

    <select id="selectOrgCheck" resultType="map">
		select PROD_CD, ORIG
		from rms.dbo.ED_EXPT_INV
		<where>
		    and useYn = 'Y'
            <if test='PROD_CD != null and PROD_CD != ""'>AND PROD_CD = #{PROD_CD}</if>
        </where>
        group by PROD_CD, ORIG
	</select>

    <select id="selectOrigStat" resultType="map">
		select * from rms.dbo.ED_ORIG_STAT_IMPT_DESC
		<where>
		    and useYn = 'Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
            <if test='EXPT_INV_SEQNO != null and EXPT_INV_SEQNO != ""'>AND EXPT_INV_SEQNO = #{EXPT_INV_SEQNO}</if>
        </where>
	</select>

    <select id="selectEdwardsImpoSum" resultType="map">
    	SELECT COUNT(CASE WHEN EditDtm    LIKE #{today} + '%' AND ImJubsuDtm is null                              THEN ImJubsuDtm ELSE NULL END) as 'im01', 
	         COUNT(CASE WHEN ImJubsuDtm LIKE #{today} + '%'                                                     THEN ImJubsuDtm ELSE NULL END) as 'im02', 
			 COUNT(CASE WHEN ImJubsuDtm LIKE #{today} + '%' and ImOkDtm = ''                                    THEN ImJubsuDtm ELSE NULL END) as 'im03', 
			 COUNT(CASE WHEN ImOkDtm LIKE #{today} + '%'                                                        THEN ImOkDtm    ELSE NULL END) as 'im04', 
			 COUNT(CASE WHEN EditDtm BETWEEN #{strFromDate} AND #{strToDate}+'999999' AND ImJubsuDtm is null                   THEN ImJubsuDtm ELSE NULL END) as 'im05', 
			 COUNT(CASE WHEN EditDtm BETWEEN #{strFromDate} AND #{strToDate}+'999999' AND ImJubsuDtm != ''                     THEN ImJubsuDtm ELSE NULL END) as 'im06', 
			 COUNT(CASE WHEN EditDtm BETWEEN #{strFromDate} AND #{strToDate}+'999999' AND ImJubsuDtm != '' AND ImOkDtm is null THEN ImJubsuDtm ELSE NULL END) as 'im07', 
			 COUNT(CASE WHEN EditDtm BETWEEN #{strFromDate} AND #{strToDate}+'999999' AND ImOkDtm != ''                        THEN ImJubsuDtm ELSE NULL END) as 'im08'    
           FROM CPS.dbo.IMAC100    
	   WHERE ImNapSaup = #{taxNum}  
	     AND UseYn='Y'  
	</select>

    <select id="selectEdwardsImpoSumBack" resultType="map">
		select
		sum(a) as 'im01', sum(b) as 'im02', sum(c) as 'im03', sum(d) as 'im04',
		sum(e) as 'im05', sum(f) as 'im06', sum(g) as 'im07', sum(h) as 'im08'
		from (
			select COUNT(Impo_jubsu_date) as 'a', '' as 'b', '' as 'c', '' as 'd', '' as 'e', '' as 'f', '' as 'g', '' as 'h'
			from ${_defaultDB}.kcba.impo1
			where Impo_napse_saup = #{taxNum}
			and EditDtTime LIKE #{today} + '%'
			and Impo_jubsu_date = ''
			union all
			select '' as 'a', COUNT(Impo_jubsu_date) as 'b', '' as 'c', '' as 'd', '' as 'e', '' as 'f', '' as 'g', '' as 'h'
			from ${_defaultDB}.kcba.impo1
			where Impo_napse_saup = #{taxNum}
			and Impo_jubsu_date LIKE #{today} + '%'
			union all
			select '' as 'a', '' as 'b', COUNT(Impo_jubsu_date) as 'c', '' as 'd', '' as 'e', '' as 'f', '' as 'g', '' as 'h'
			from ${_defaultDB}.kcba.impo1
			where Impo_napse_saup = #{taxNum}
			and Impo_jubsu_date LIKE #{today} + '%'
			and Impo_ok_date = ''
			union all
			select '' as 'a', '' as 'b', '' as 'c', COUNT(Impo_ok_date) as 'd', '' as 'e', '' as 'f', '' as 'g', '' as 'h'
			from ${_defaultDB}.kcba.impo1
			where Impo_napse_saup = #{taxNum}
			and Impo_ok_date LIKE #{today} + '%'
			union all
			select '' as 'a', '' as 'b', '' as 'c', '' as 'd', COUNT(Impo_jubsu_date) as 'e', '' as 'f', '' as 'g', '' as 'h'
			from ${_defaultDB}.kcba.impo1
			where Impo_napse_saup = #{taxNum}
			and EditDtTime BETWEEN #{strFromDate} AND #{strToDate}
			and Impo_jubsu_date = ''
			union all
			select '' as 'a', '' as 'b', '' as 'c', '' as 'd', '' as 'e', COUNT(Impo_jubsu_date) as 'f', '' as 'g', '' as 'h'
			from ${_defaultDB}.kcba.impo1
			where Impo_napse_saup = #{taxNum}
			and EditDtTime BETWEEN #{strFromDate} AND #{strToDate}
			and Impo_jubsu_date != ''
			union all
			select '' as 'a', '' as 'b', '' as 'c', '' as 'd', '' as 'e', '' as 'f', COUNT(Impo_jubsu_date) as 'g', '' as 'h'
			from ${_defaultDB}.kcba.impo1
			where Impo_napse_saup = #{taxNum}
			and EditDtTime BETWEEN #{strFromDate} AND #{strToDate}
			and Impo_jubsu_date != ''
			and Impo_ok_date = ''
			union all
			select '' as 'a', '' as 'b', '' as 'c', '' as 'd', '' as 'e', '' as 'f', '' as 'g', COUNT(Impo_jubsu_date) as 'h'
			from ${_defaultDB}.kcba.impo1
			where Impo_napse_saup = #{taxNum}
			and EditDtTime BETWEEN #{strFromDate} AND #{strToDate}
			and Impo_ok_date != ''
		) a
	</select>

    <select id="selectEdwardsExpoSum" resultType="map">
    	SELECT 
	         COUNT(CASE WHEN EditDtm LIKE #{today} + '%' AND SendResult = ''                                    THEN SendResult ELSE NULL END) AS 'ex01',  
	         COUNT(CASE WHEN EditDtm LIKE #{today} + '%' AND SendResult = '완료' AND ExOkDtm = ''                THEN ExOkDtm    ELSE NULL END) AS 'ex02',  
			 COUNT(CASE WHEN ExOkDtm LIKE #{today} + '%'                                                        THEN ExOkDtm    ELSE NULL END) AS 'ex03', 
			 COUNT(CASE WHEN EditDtm BETWEEN #{strFromDate} AND #{strToDate} +'999999' AND SendResult = ''                 THEN SendResult ELSE NULL END) AS 'ex04',
			 COUNT(CASE WHEN EditDtm BETWEEN #{strFromDate} AND #{strToDate} +'999999' AND SendResult='완료'and ExOkDtm=''  THEN ExOkDtm    ELSE NULL END) AS 'ex05', 
			 COUNT(CASE WHEN EditDtm BETWEEN #{strFromDate} AND #{strToDate} +'999999' AND ExOkDtm != ''                   THEN ExOkDtm    ELSE NULL END) AS 'ex06'
		FROM CPS.dbo.EXAC100
	   WHERE (ExDaeSaup = #{taxNum} or ExJeJoSaup = #{taxNum}) --★☆★ WHERE절에 사용되는 사업자번호가 union all 끼리 동일해야 함.
		 AND UseYn='Y'
	</select>

    <select id="selectEdwardsExpoSumBack" resultType="map">
		select
		sum(a) as 'ex01', sum(b) as 'ex02', sum(c) as 'ex03',
		sum(d) as 'ex04', sum(e) as 'ex05', sum(f) as 'ex06'
		from (
			select COUNT(Expo_junsong_result) as 'a', '' as 'b', '' as 'c', '' as 'd', '' as 'e', '' as 'f'
			from ${_defaultDB}.kcba.expo1
			where (Expo_SuchulSaupNo = #{taxNum} or Expo_whaju_saup = #{taxNum})
			and EditDtTime LIKE #{today} + '%'
			and Expo_junsong_result = ''
			union all
			select '' as 'a', COUNT(Expo_ok_date) as 'b', '' as 'c', '' as 'd', '' as 'e', '' as 'f'
			from ${_defaultDB}.kcba.expo1
			where (Expo_SuchulSaupNo = #{taxNum} or Expo_whaju_saup = #{taxNum})
			and EditDtTime LIKE #{today} + '%'
			and Expo_junsong_result = '완료'
			and Expo_ok_date = ''
			union all
			select '' as 'a', '' as 'b', COUNT(Expo_ok_date) as 'c', '' as 'd', '' as 'e', '' as 'f'
			from ${_defaultDB}.kcba.expo1
			where (Expo_SuchulSaupNo = #{taxNum} or Expo_whaju_saup = #{taxNum})
			and Expo_ok_date LIKE #{today} + '%'
			union all
			select '' as 'a', '' as 'b', '' as 'c', COUNT(Expo_junsong_result) as 'd', '' as 'e', '' as 'f'
			from ${_defaultDB}.kcba.expo1
			where (Expo_SuchulSaupNo = #{taxNum} or Expo_whaju_saup = #{taxNum})
			and EditDtTime BETWEEN #{strFromDate} AND #{strToDate}
			and Expo_junsong_result = ''
			union all
			select '' as 'a', '' as 'b', '' as 'c', '' as 'd', COUNT(Expo_ok_date) as 'e', '' as 'f'
			from ${_defaultDB}.kcba.expo1
			where (Expo_SuchulSaupNo = #{taxNum} or Expo_whaju_saup = #{taxNum})
			and EditDtTime BETWEEN #{strFromDate} AND #{strToDate}
			and Expo_junsong_result = '완료'
			and Expo_ok_date = ''
			union all
			select '' as 'a', '' as 'b', '' as 'c', '' as 'd', '' as 'e', COUNT(Expo_ok_date) as 'f'
			from ${_defaultDB}.kcba.expo1
			where (Expo_SuchulSaupNo = #{taxNum} or Expo_whaju_saup = #{taxNum})
			and EditDtTime BETWEEN #{strFromDate} AND #{strToDate}
			and Expo_ok_date != ''
		) a
	</select>

    <update id="updateImpoCommentMaster">
		UPDATE	rms.dbo.ED_IMPT_ORDR
		<trim prefix="SET" suffixOverrides=",">
			<if test='MemoDeal != null'>MemoDeal = #{MemoDeal} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_IMPT_ORDR = #{KEY_ED_IMPT_ORDR}
	</update>

    <update id="updateImpoNewCommentMaster">
		UPDATE	rms.dbo.KTbl_ImSchedule
		<trim prefix="SET" suffixOverrides=",">
			<if test='IS_customerComment != null'>IS_customerComment = #{IS_customerComment} ,</if>
			<if test='userNm != null'>IS_editUserName = #{userNm} ,</if>
			<if test='currentDatetime != null'>is_editUserDateTime = #{currentDatetime} ,</if>
		</trim>
		WHERE IS_Key = #{IS_Key}
	</update>

    <select id="selectSchedule" resultType="map">
		select
			KEY_ED_IMPT_ORDR,
			BL_NO,
			Impo_mbl_no,
			Impo_mrn_no,
			DocRcvDt,
			UrgencyYN,
			ISNULL((select a.CD_ABB from soo_MST.dbo.TBR_SYS_CODE a where a.MCD ='IMP_CSCL_PLAN_CD' and a.CD = Impo_plan), '') AS 'Impo_plan',
			CASE WHEN ISNULL(StatusFlag,'')='001' THEN '서류보완'
			WHEN ISNULL(StatusFlag,'')='002' THEN '요건확인'
			WHEN ISNULL(StatusFlag,'')='003' THEN '비용확인'
			WHEN ISNULL(StatusFlag,'')='004' THEN '입항대기'
			WHEN ISNULL(StatusFlag,'')='005' THEN '반입대기'
			WHEN ISNULL(StatusFlag,'')='006' THEN '세관검사'
			WHEN ISNULL(StatusFlag,'')='007' THEN '기타'
			ELSE '' END AS 'StatusFlag',
			StatusNm,
			PendingYN,
			PendingNm,
			Impo_ip_sc_date,
			SINGO_REQ_DT,
			MemoCus,
			MemoDeal,
			Impo_banip_date,
			CASE WHEN ISNULL(PROC_STAT,'')='08003' THEN '신고완료'
			WHEN ISNULL(PROC_STAT,'')='08002' THEN '신고대기'
			WHEN ISNULL(PROC_STAT,'')='08004' THEN '신고중'
			WHEN ISNULL(PROC_STAT,'')='08011' THEN '작성'
			WHEN ISNULL(PROC_STAT,'')='08012' THEN '요청'
			WHEN ISNULL(PROC_STAT,'')='08013' THEN '확정'
			ELSE '준비' END AS 'PROC_STAT1',
			Impo_mf_date,
			Impo_iphang_date,
			Impo_unsong_date,
			Impo_banchul_date,
			Impo_jubsu_date,
			Impo_ok_dttm,
			impo_csDt,
			Impo_jungsan_date,
			impo_cs
		from rms.dbo.ED_IMPT_ORDR
		<where>
		    and useYn = 'Y'
		    <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
	            <choose>
	                <when test='_DateType == "DocRcvDt"'>AND DocRcvDt BETWEEN #{strFromDate} AND #{strToDate}</when>
	                <when test='_DateType == "Impo_ip_sc_date"'>AND Impo_ip_sc_date BETWEEN #{strFromDate} AND #{strToDate}</when>
	                <when test='_DateType == "SINGO_REQ_DT"'>AND SINGO_REQ_DT BETWEEN #{strFromDate} AND #{strToDate}</when>
	            </choose>
        	</if>
            <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
            <if test='UrgencyYN != null and UrgencyYN != ""'>AND UrgencyYN = #{UrgencyYN}</if>
            <if test='Impo_plan != null and Impo_plan != ""'>AND Impo_plan = #{Impo_plan}</if>
            <if test='StatusFlag != null and StatusFlag != ""'>AND StatusFlag = #{StatusFlag}</if>
            <if test='PendingYN != null and PendingYN != ""'>AND PendingYN = #{PendingYN}</if>
        </where>
	</select>

    <select id="selectNewSchedule" resultType="map">
		select
			*,
			CASE WHEN IS_extandedCarryDueDate != '' THEN convert(varchar(10),DATEDIFF(DD,GETDATE(),LEFT(IS_extandedCarryDueDate,8)))
			WHEN convert(int,DATEDIFF(DD,GETDATE(),LEFT(IS_transportDueDate,8)) ) <![CDATA[ < ]]> 0 THEN '-1'
			WHEN IS_carryOutDate != '' THEN '0'
			ELSE convert(int,DATEDIFF(DD,GETDATE(),LEFT(IS_transportDueDate,8)) )
			END as banchul,
			CASE WHEN convert(int,DATEDIFF(DD,GETDATE(),LEFT(IS_ncomDueDate,8)) ) <![CDATA[ < ]]> 0 THEN '-1'
			WHEN IS_cusPaymentDate != '' THEN '0'
			ELSE DATEDIFF(DD,GETDATE(),LEFT(IS_ncomDueDate,8)) END as napbu
		from rms.dbo.KTbl_ImSchedule
		<where>
		    and IS_taxPayerRegistrationNo = '3128112960'
            <if test='IS_BLNo != null and IS_BLNo != ""'>AND IS_BLNo LIKE '%' + #{IS_BLNo} + '%'</if>
            <if test='IS_urgent != null and IS_urgent != ""'>AND IS_urgent = #{IS_urgent}</if>
            <if test='IS_ETD != null and IS_ETD != ""'>AND IS_ETD = ''</if>
            <if test='transportDueDate != null and transportDueDate != ""'>and (DATEDIFF(DD,GETDATE(),LEFT(IS_transportDueDate,8)) <![CDATA[ > ]]> 0 or DATEDIFF(DD,GETDATE(),LEFT(IS_extandedCarryDueDate,8)) <![CDATA[ > ]]> 0) and IS_carryOutDate=''</if>
            <if test='clearanceStatus != null and clearanceStatus != ""'>and IS_clearanceStatus='수입신고전'</if>
            <if test='ncomDueDate != null and ncomDueDate != ""'>and DATEDIFF(DD,GETDATE(),LEFT(IS_ncomDueDate,8)) <![CDATA[ > ]]> 0 and IS_ncomGet='N'</if>
            <if test='progressCode != null and progressCode != ""'>and IS_progressCode = '9999'</if>
            <if test='mi != null and mi != ""'>and IS_progressCode = '' and IS_ETD != ''</if>
        </where>
        <trim prefix="ORDER BY">
          <if test='transportDueDate != null and transportDueDate != ""'> convert(int,CASE WHEN IS_extandedCarryDueDate != '' THEN convert(varchar(10),DATEDIFF(DD,GETDATE(),LEFT(IS_extandedCarryDueDate,8))) ELSE convert(varchar(10),DATEDIFF(DD,GETDATE(),LEFT(IS_transportDueDate,8)) ) END)</if>
        </trim>
	</select>

    <select id="selectNewSchedule1" resultType="map">
		select
			*,
			CASE WHEN IS_extandedCarryDueDate != '' THEN convert(varchar(10),DATEDIFF(DD,GETDATE(),LEFT(IS_extandedCarryDueDate,8)))
			WHEN convert(int,DATEDIFF(DD,GETDATE(),LEFT(IS_transportDueDate,8)) ) <![CDATA[ < ]]> 0 THEN '-1'
			WHEN IS_carryOutDate != '' THEN '0'
			ELSE convert(int,DATEDIFF(DD,GETDATE(),LEFT(IS_transportDueDate,8)) )
			END as banchul,
			CASE WHEN convert(int,DATEDIFF(DD,GETDATE(),LEFT(IS_ncomDueDate,8)) ) <![CDATA[ < ]]> 0 THEN '-1'
			WHEN IS_cusPaymentDate != '' THEN '0'
			ELSE DATEDIFF(DD,GETDATE(),LEFT(IS_ncomDueDate,8)) END as napbu
		from rms.dbo.KTbl_ImSchedule
		<where>
		    and IS_taxPayerRegistrationNo = '3128112960'
            <if test='IS_BLNo != null and IS_BLNo != ""'>AND IS_BLNo LIKE '%' + #{IS_BLNo} + '%'</if>
            <if test='IS_urgent != null and IS_urgent != ""'>AND IS_urgent = #{IS_urgent}</if>
            <if test='(eklUser != null and eklUser != "") or (vendorCode != null and vendorCode != "") or (itemCode != null and itemCode != "")'>
                AND IS_BLNo in (select BL_NO from rms.dbo.ED_IMPT_ORDR
                  <where>
                      and useYn='Y'
                      <if test='eklUser != null and eklUser != ""'>AND OWN_GODS_DIVS_MAN_NM LIKE '%' + #{eklUser} + '%'</if>
                      <if test='vendorCode != null and vendorCode != ""'>AND EXP_CD LIKE '%' + #{vendorCode} + '%'</if>
                      <if test='itemCode != null and itemCode != ""'>AND IMPT_ORDR_MNG_NO in (select b.IMPT_ORDR_MNG_NO from rms.dbo.ED_IMPT_DECL_HNG b where b.IMPT_ORDR_MNG_NO = IMPT_ORDR_MNG_NO and b.ITEM_CD LIKE '%' + #{itemCode} + '%' group by b.IMPT_ORDR_MNG_NO)</if>
                  </where>
                )
            </if>
            <if test='IS_ETD != null and IS_ETD != ""'>AND IS_ETD = ''</if>
            <if test='transportDueDate != null and transportDueDate != ""'>and (DATEDIFF(DD,GETDATE(),LEFT(IS_transportDueDate,8)) <![CDATA[ > ]]> 0 or DATEDIFF(DD,GETDATE(),LEFT(IS_extandedCarryDueDate,8)) <![CDATA[ > ]]> 0) and IS_carryOutDate=''</if>
            <if test='clearanceStatus != null and clearanceStatus != ""'>and IS_clearanceStatus='수입신고전'</if>
            <if test='ncomDueDate != null and ncomDueDate != ""'>and DATEDIFF(DD,GETDATE(),LEFT(IS_ncomDueDate,8)) <![CDATA[ > ]]> 0 and IS_ncomGet='N'</if>
            <if test='progressCode != null and progressCode != ""'>and IS_progressCode = '9999'</if>
            <if test='mi != null and mi != ""'>and IS_progressCode = '' and IS_ETD != ''</if>
        </where>
        <trim prefix="ORDER BY">
          <if test='transportDueDate != null and transportDueDate != ""'> convert(int,CASE WHEN IS_extandedCarryDueDate != '' THEN convert(varchar(10),DATEDIFF(DD,GETDATE(),LEFT(IS_extandedCarryDueDate,8))) ELSE convert(varchar(10),DATEDIFF(DD,GETDATE(),LEFT(IS_transportDueDate,8)) ) END)</if>
        </trim>
	</select>

    <select id="selectItemExemDescList" resultType="map">
		select
			b.BL_NO,
			b.DECL_CMPL_DTTM,
			b.IMPT_DECL_NO,
			a.LAN,
			a.HNG,
			round(a.EXEM_QTY,1) as 'EXEM_QTY',
			round(a.EXPT_EXEC_QTY,1) as 'EXPT_EXEC_QTY'
		from rms.dbo.ED_ITEM_EXEM_DESC	a, rms.dbo.ED_IMPT_ORDR b
		<where>
		    and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
		    and a.useYn = 'Y'
		    and b.useYn = 'Y'
            <if test='EXEM_PLAN_MNG_NO != null and EXEM_PLAN_MNG_NO != ""'>AND a.EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO}</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
        </where>
	</select>

    <select id="selectDemdPlanItem" resultType="map">
		select *
	    from rms.dbo.ED_EXEM_DEMD_PLAN_ITEM
		where EXEM_PLAN_MNG_NO in (select EXEM_PLAN_MNG_NO from rms.dbo.ED_EXEM_DEMD_PLAN
		where OWN_GODS_CD = #{OWN_GODS_CD}
		and useYn = 'Y'
		and PROC_STAT='07001')
		and item_cd = #{ITEM_CD}
	</select>

    <update id="updateDemdPlanItem">
		UPDATE	rms.dbo.ED_EXEM_DEMD_PLAN_ITEM
		<trim prefix="SET" suffixOverrides=",">
		    <if test='EXPT_QTY != null'>USE_QTY = USE_QTY + #{EXPT_QTY} ,</if>
			<if test='EXPT_QTY != null'>RMID_QTY = RMID_QTY - #{EXPT_QTY} ,</if>
			<if test='RE_QTY != null'>USE_QTY = USE_QTY - #{RE_QTY} ,</if>
			<if test='RE_QTY != null'>RMID_QTY = RMID_QTY + #{RE_QTY} ,</if>
			<if test='ADD_QTY != null'>QTY = QTY + #{ADD_QTY} ,</if>
			<if test='ADD_QTY != null'>RMID_QTY = RMID_QTY + #{ADD_QTY} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		<where>
            <if test='EXEM_PLAN_MNG_NO != null and EXEM_PLAN_MNG_NO != ""'>AND EXEM_PLAN_MNG_NO = #{EXEM_PLAN_MNG_NO}</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD = #{ITEM_CD}</if>
        </where>
	</update>

    <select id="selectMaxExemDesc" resultType="map">
		select
		ISNULL(MAX(EXEM_SEQNO)+1,'') as 'EXEM_SEQNO'
		from rms.dbo.ED_ITEM_EXEM_DESC
		<where>
		    and useYn='Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD = #{ITEM_CD}</if>
        </where>
	</select>

    <select id="selectExemDesc" resultType="map">
		select
		*
		from rms.dbo.ED_ITEM_EXEM_DESC
		<where>
		    and useYn='Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
            <if test='IMPT_INV_SEQNO != null and IMPT_INV_SEQNO != ""'>AND IMPT_INV_SEQNO = #{IMPT_INV_SEQNO}</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD = #{ITEM_CD}</if>
        </where>
	</select>

    <update id="updateExemDesc">
		UPDATE	rms.dbo.ED_ITEM_EXEM_DESC
		<trim prefix="SET" suffixOverrides=",">
		    <if test='EXECQTY != null'>EXPT_EXEC_QTY = EXPT_EXEC_QTY + #{EXECQTY} ,</if>
		    <if test='EXECQTY != null'>EXEM_RMID_QTY = EXEM_RMID_QTY - #{EXECQTY} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_ITEM_EXEM_DESC = #{KEY_ED_ITEM_EXEM_DESC}
	</update>

    <insert id="insertExemDesc">
		INSERT INTO rms.dbo.ED_ITEM_EXEM_DESC
		       ([GRP_COMP_CD]
				,[EXEM_PLAN_MNG_NO]
				,[EXEM_SEQNO]
				,[Mcount_No]
				,[ITEM_CD]
				,[IMPT_ORDR_MNG_NO]
				,[LAN]
				,[HNG]
				,[IMPT_INV_SEQNO]
				,[EXEM_QTY]
				,[EXPT_EXEC_QTY]
				,[EXEM_RMID_QTY]
				,[useYn]
				,[addUserId]
				,[addUserNm]
				,[addDtm]
				)
		VALUES
		       ('3128112960',
		        #{EXEM_PLAN_MNG_NO},
				#{EXEM_SEQNO},
				'',
				#{ITEM_CD},
				#{IMPT_ORDR_MNG_NO},
				#{LAN},
				#{HNG},
				#{IMPT_INV_SEQNO},
				#{EXEM_QTY},
				#{EXPT_EXEC_QTY},
				#{EXEM_RMID_QTY},
				'Y',
		        #{ID},
		        #{userNm},
		        #{currentDatetime})
	</insert>

    <update id="updateImptInv">
		UPDATE	rms.dbo.ED_IMPT_INV
		<trim prefix="SET" suffixOverrides=",">
		    <if test='EXPT_QTY != null'>EXEM_QTY = EXEM_QTY + #{EXPT_QTY} ,</if>
			<if test='EXPT_QTY != null'>NOT_EXEM_QTY = NOT_EXEM_QTY - #{EXPT_QTY} ,</if>
			<if test='EXPT_QTY != null'>EXEM = '감면' ,</if>
			<if test='EXPT_QTY != null'>EXEM_FG = 'Y' ,</if>
			<if test='RE_QTY != null'>EXEM_QTY = EXEM_QTY - #{RE_QTY} ,</if>
			<if test='RE_QTY != null'>NOT_EXEM_QTY = NOT_EXEM_QTY + #{RE_QTY} ,</if>
			<if test='RE_QTY != null'>EXEM = '대상' ,</if>
			<if test='RE_QTY != null'>EXEM_FG = 'N' ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
		and IMPT_INV_SEQNO = #{IMPT_INV_SEQNO}
		and ITEM_CD = #{ITEM_CD}
		and INV_NO = #{INV_NO}
	</update>

    <select id="selectExecImptList" resultType="map">
        select
			b.BL_NO,
			b.DECL_CMPL_DTTM,
			b.IMPT_DECL_NO,
			a.LAN,
			a.HNG,
			a.QTY
		from rms.dbo.ED_EXEM_EXEC_IMPT_LIST a, rms.dbo.ED_IMPT_ORDR b
		<where>
		    and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.useYn = 'Y'
			and b.useYn = 'Y'
            <if test='EXEM_EXEC_MNG_NO != null and EXEM_EXEC_MNG_NO != ""'>AND a.EXEM_EXEC_MNG_NO = #{EXEM_EXEC_MNG_NO}</if>
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
            <if test='PROD_CD != null and PROD_CD != ""'>AND a.PROD_CD = #{PROD_CD}</if>
        </where>
	</select>

    <select id="selectMaxOrdr" resultType="map">
		select
		substring(MAX(EXPT_ORDR_MNG_NO),3,8) as 'max',
		RIGHT('000000' + CAST(RIGHT(ISNULL(MAX(EXPT_ORDR_MNG_NO), 0), 6) + 1 AS VARCHAR), 6) as 'EXPT_ORDR_MNG_NO'
		from rms.dbo.ED_EXPT_ORDR
		where useYn='Y'
	</select>

    <insert id="insertExpoOrder">
		INSERT INTO rms.dbo.ED_EXPT_ORDR
		       ([EXPT_ORDR_MNG_NO],
				[GRP_COMP_CD],
				[ORDR_DT],
				[PROC_STAT],
				[OWN_GODS_CD],
				[OWN_GODS_NM],
				[OWN_GODS_DIVS_MAN],
				[OWN_GODS_DIVS_MAN_NM],
				[DECL_CUSTOMS_CD],
				[DECL_DIVS_MAN],
				[DECL_DDAY],
				[INV_NO1],
				[INV_NO2],
				[INV_DT],
				[OBJ_NAT],
				[CUR_UNIT],
				[INCOTERMS],
				[TOT_WT],
				[PKG_QTY],
				[EX_FTA_CD],
				[WH_CD],
				[Expo_geyak_no1],
				[Expo_geyak_no2],
				[Expo_chamjo_no],
				[Expo_suchulja_code],
				[Expo_suchulja_sangho],
				[Expo_SuchulSaupNo],
				[Expo_SuChulJa_Gbn],
				[Expo_whaju_code],
				[Expo_whaju_sangho],
				[Expo_trust_code],
				[Expo_trust_sangho],
				[Expo_daecode],
				[Expo_daesangho],
				[Expo_GuMaeJa_SangHo],
				[Expo_GuMaeJa_Code],
				[Expo_GyelJe_Input],
				[Expo_Fre_money],
				[Expo_Fre_Input],
				[Expo_Ins_money],
				[Expo_Ins_Input],
				[Expo_segwan],
				[Expo_gwa],
				[Expo_singo_gbn],
				[Expo_gurae_gbn],
				[Expo_jong],
				[Expo_gyelje],
				[expo_how_check],
				[Expo_industry],
				[Expo_MokJuk_Code],
				[Expo_HangGu_Code],
				[Expo_UnSong_Type],
				[Expo_UnSong_Box],
				[Expo_whan_sin],
				[Expo_whan_gan2],
				[Expo_imsigae_yn],
				[Expo_Jukip_YN],
				[Expo_Old_Yn],
				[expo_preStartDt],
				[MoveYN],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[FORWARD_NM],
				[Plant],
				[ShippingMode],
				[NameOfShipto],
				[ReImExGbn]
				)
		VALUES
		       (#{EXPT_ORDR_MNG_NO},
				#{GRP_COMP_CD},
				#{ORDR_DT},
				#{PROC_STAT},
				#{OWN_GODS_CD},
				#{OWN_GODS_NM},
				#{OWN_GODS_DIVS_MAN},
				#{OWN_GODS_DIVS_MAN_NM},
				#{DECL_CUSTOMS_CD},
				#{DECL_DIVS_MAN},
				#{DECL_DDAY},
				#{INV_NO1},
				#{INV_NO2},
				#{INV_DT},
				#{OBJ_NAT},
				#{CUR_UNIT},
				#{INCOTERMS},
				#{TOT_WT},
				#{PKG_QTY},
				#{EX_FTA_CD},
				#{WH_CD},
				#{Expo_geyak_no1},
				#{Expo_geyak_no2},
				#{Expo_chamjo_no},
				#{Expo_suchulja_code},
				#{Expo_suchulja_sangho},
				#{Expo_SuchulSaupNo},
				#{Expo_SuChulJa_Gbn},
				#{Expo_whaju_code},
				#{Expo_whaju_sangho},
				#{Expo_trust_code},
				#{Expo_trust_sangho},
				#{Expo_daecode},
				#{Expo_daesangho},
				#{Expo_GuMaeJa_SangHo},
				#{Expo_GuMaeJa_Code},
				#{Expo_GyelJe_Input},
				#{Expo_Fre_money},
				#{Expo_Fre_Input},
				#{Expo_Ins_money},
				#{Expo_Ins_Input},
				#{Expo_segwan},
				#{Expo_gwa},
				#{Expo_singo_gbn},
				#{Expo_gurae_gbn},
				#{Expo_jong},
				#{Expo_gyelje},
				#{expo_how_check},
				#{Expo_industry},
				#{Expo_MokJuk_Code},
				#{Expo_HangGu_Code},
				#{Expo_UnSong_Type},
				#{Expo_UnSong_Box},
				#{Expo_whan_sin},
				#{Expo_whan_gan2},
				#{Expo_imsigae_yn},
				#{Expo_Jukip_YN},
				#{Expo_Old_Yn},
				#{expo_preStartDt},
				#{MoveYN},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{FORWARD_NM},
				#{Plant},
				#{ShippingMode},
				#{NameOfShipto},
				#{ReImExGbn})
	</insert>

    <update id="updateExpoOrder">
		UPDATE	rms.dbo.ED_EXPT_ORDR
		<trim prefix="SET" suffixOverrides=",">
		    <if test='EXPT_ORDR_MNG_NO != null'>EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO} ,</if>
			<if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
			<if test='ORDR_DT != null'>ORDR_DT = #{ORDR_DT} ,</if>
			<if test='PROC_STAT != null'>PROC_STAT = #{PROC_STAT} ,</if>
			<if test='OWN_GODS_CD != null'>OWN_GODS_CD = #{OWN_GODS_CD} ,</if>
			<if test='OWN_GODS_NM != null'>OWN_GODS_NM = #{OWN_GODS_NM} ,</if>
			<if test='OWN_GODS_DIVS_MAN != null'>OWN_GODS_DIVS_MAN = #{OWN_GODS_DIVS_MAN} ,</if>
			<if test='OWN_GODS_DIVS_MAN_NM != null'>OWN_GODS_DIVS_MAN_NM = #{OWN_GODS_DIVS_MAN_NM} ,</if>
			<if test='DECL_CUSTOMS_CD != null'>DECL_CUSTOMS_CD = #{DECL_CUSTOMS_CD} ,</if>
			<if test='DECL_DIVS_MAN != null'>DECL_DIVS_MAN = #{DECL_DIVS_MAN} ,</if>
			<if test='DECL_DDAY != null'>DECL_DDAY = #{DECL_DDAY} ,</if>
			<if test='INV_NO1 != null'>INV_NO1 = #{INV_NO1} ,</if>
			<if test='INV_NO2 != null'>INV_NO2 = #{INV_NO2} ,</if>
			<if test='INV_DT != null'>INV_DT = #{INV_DT} ,</if>
			<if test='OBJ_NAT != null'>OBJ_NAT = #{OBJ_NAT} ,</if>
			<if test='CUR_UNIT != null'>CUR_UNIT = #{CUR_UNIT} ,</if>
			<if test='INCOTERMS != null'>INCOTERMS = #{INCOTERMS} ,</if>
			<if test='TOT_WT != null'>TOT_WT = #{TOT_WT} ,</if>
			<if test='PKG_QTY != null'>PKG_QTY = #{PKG_QTY} ,</if>
			<if test='EX_FTA_CD != null'>EX_FTA_CD = #{EX_FTA_CD} ,</if>
			<if test='WH_CD != null'>WH_CD = #{WH_CD} ,</if>
			<if test='Expo_geyak_no1 != null'>Expo_geyak_no1 = #{Expo_geyak_no1} ,</if>
			<if test='Expo_geyak_no2 != null'>Expo_geyak_no2 = #{Expo_geyak_no2} ,</if>
			<if test='Expo_chamjo_no != null'>Expo_chamjo_no = #{Expo_chamjo_no} ,</if>
			<if test='Expo_suchulja_code != null'>Expo_suchulja_code = #{Expo_suchulja_code} ,</if>
			<if test='Expo_suchulja_sangho != null'>Expo_suchulja_sangho = #{Expo_suchulja_sangho} ,</if>
			<if test='Expo_SuchulSaupNo != null'>Expo_SuchulSaupNo = #{Expo_SuchulSaupNo} ,</if>
			<if test='Expo_SuChulJa_Gbn != null'>Expo_SuChulJa_Gbn = #{Expo_SuChulJa_Gbn} ,</if>
			<if test='Expo_whaju_code != null'>Expo_whaju_code = #{Expo_whaju_code} ,</if>
			<if test='Expo_whaju_sangho != null'>Expo_whaju_sangho = #{Expo_whaju_sangho} ,</if>
			<if test='Expo_trust_code != null'>Expo_trust_code = #{Expo_trust_code} ,</if>
			<if test='Expo_trust_sangho != null'>Expo_trust_sangho = #{Expo_trust_sangho} ,</if>
			<if test='Expo_daecode != null'>Expo_daecode = #{Expo_daecode} ,</if>
			<if test='Expo_daesangho != null'>Expo_daesangho = #{Expo_daesangho} ,</if>
			<if test='Expo_GuMaeJa_SangHo != null'>Expo_GuMaeJa_SangHo = #{Expo_GuMaeJa_SangHo} ,</if>
			<if test='Expo_GuMaeJa_Code != null'>Expo_GuMaeJa_Code = #{Expo_GuMaeJa_Code} ,</if>
			<if test='Expo_GyelJe_Input != null'>Expo_GyelJe_Input = #{Expo_GyelJe_Input} ,</if>
			<if test='Expo_Fre_money != null'>Expo_Fre_money = #{Expo_Fre_money} ,</if>
			<if test='Expo_Fre_Input != null'>Expo_Fre_Input = #{Expo_Fre_Input} ,</if>
			<if test='Expo_Ins_money != null'>Expo_Ins_money = #{Expo_Ins_money} ,</if>
			<if test='Expo_Ins_Input != null'>Expo_Ins_Input = #{Expo_Ins_Input} ,</if>
			<if test='Expo_segwan != null'>Expo_segwan = #{Expo_segwan} ,</if>
			<if test='Expo_gwa != null'>Expo_gwa = #{Expo_gwa} ,</if>
			<if test='Expo_singo_gbn != null'>Expo_singo_gbn = #{Expo_singo_gbn} ,</if>
			<if test='Expo_gurae_gbn != null'>Expo_gurae_gbn = #{Expo_gurae_gbn} ,</if>
			<if test='Expo_jong != null'>Expo_jong = #{Expo_jong} ,</if>
			<if test='Expo_gyelje != null'>Expo_gyelje = #{Expo_gyelje} ,</if>
			<if test='expo_how_check != null'>expo_how_check = #{expo_how_check} ,</if>
			<if test='Expo_industry != null'>Expo_industry = #{Expo_industry} ,</if>
			<if test='Expo_MokJuk_Code != null'>Expo_MokJuk_Code = #{Expo_MokJuk_Code} ,</if>
			<if test='Expo_HangGu_Code != null'>Expo_HangGu_Code = #{Expo_HangGu_Code} ,</if>
			<if test='Expo_UnSong_Type != null'>Expo_UnSong_Type = #{Expo_UnSong_Type} ,</if>
			<if test='Expo_UnSong_Box != null'>Expo_UnSong_Box = #{Expo_UnSong_Box} ,</if>
			<if test='Expo_whan_sin != null'>Expo_whan_sin = #{Expo_whan_sin} ,</if>
			<if test='Expo_whan_gan2 != null'>Expo_whan_gan2 = #{Expo_whan_gan2} ,</if>
			<if test='Expo_imsigae_yn != null'>Expo_imsigae_yn = #{Expo_imsigae_yn} ,</if>
			<if test='Expo_Jukip_YN != null'>Expo_Jukip_YN = #{Expo_Jukip_YN} ,</if>
			<if test='Expo_Old_Yn != null'>Expo_Old_Yn = #{Expo_Old_Yn} ,</if>
			<if test='expo_preStartDt != null'>expo_preStartDt = #{expo_preStartDt} ,</if>
			<if test='MoveYN != null'>MoveYN = #{MoveYN} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
			<if test='FORWARD_NM != null'>FORWARD_NM = #{FORWARD_NM} ,</if>
			<if test='Plant != null'>Plant = #{Plant} ,</if>
			<if test='ShippingMode != null'>ShippingMode = #{ShippingMode} ,</if>
			<if test='NameOfShipto != null'>NameOfShipto = #{NameOfShipto} ,</if>
			<if test='ReImExGbn != null'>ReImExGbn = #{ReImExGbn} ,</if>
		</trim>
		WHERE KEY_ED_EXPT_ORDR = #{KEY_ED_EXPT_ORDR}
	</update>

    <select id="selectMaxExptInv" resultType="map">
		select
		RIGHT('000' + CAST(RIGHT(ISNULL(MAX(EXPT_INV_SEQNO), 0), 3) + 1 AS VARCHAR), 3) as 'EXPT_INV_SEQNO'
		from rms.dbo.ED_EXPT_INV
		<where>
			and useYn = 'Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
        </where>
	</select>

    <insert id="insertExpoInv">
		INSERT INTO rms.dbo.ED_EXPT_INV
		       ([EXPT_ORDR_MNG_NO],
				[EXPT_INV_SEQNO],
				[STAT],
				[ORIG_STAT_OBJ_FG],
				[ORIG_STAT_OBJ],
				[INDV_REFN_FG],
				[PROD_CD],
				[PROD_NM],
				[Mcount_No],
				[QTY],
				[ORIG_STAT_QTY],
				[NOT_ORIG_STAT_QTY],
				[AMT_PRICE],
				[AMT],
				[ORIG],
				[HS_CD],
				[INV_CO_NO],
				[APLY_PACT],
				[ORIG_PACT],
				[GRP_COMP_CD],
				[SERIAL_NO],
				[ORIG_CERT_FG],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[QTY_UNIT],
				[Expum_pum_b],
				[Expum_pum_c],
				[INV_NO],
				[ORIG_QTY]
				)
		VALUES
		       (#{EXPT_ORDR_MNG_NO},
				#{EXPT_INV_SEQNO},
				#{STAT},
				#{ORIG_STAT_OBJ_FG},
				#{ORIG_STAT_OBJ},
				#{INDV_REFN_FG},
				#{PROD_CD},
				#{PROD_NM},
				#{McountNo},
				#{QTY},
				#{ORIG_STAT_QTY},
				#{NOT_ORIG_STAT_QTY},
				#{AMT_PRICE},
				#{AMT},
				#{ORIG},
				#{HS_CD},
				#{INV_CO_NO},
				#{APLY_PACT},
				#{ORIG_PACT},
				#{GRP_COMP_CD},
				#{SERIAL_NO},
				#{ORIG_CERT_FG},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{QTY_UNIT},
				#{Expum_pum_b},
				#{Expum_pum_c},
				#{INV_NO},
				#{ORIG_STAT_QTY})
	</insert>

    <update id="updateExpoInv1">
		UPDATE	rms.dbo.ED_EXPT_INV
		<trim prefix="SET" suffixOverrides=",">
		    <if test='STAT != null'>STAT = #{STAT} ,</if>
		    <if test='ORIG_STAT_OBJ_FG != null'>ORIG_STAT_OBJ_FG = #{ORIG_STAT_OBJ_FG} ,</if>
		    <if test='ORIG_STAT_OBJ != null'>ORIG_STAT_OBJ = #{ORIG_STAT_OBJ} ,</if>
		    <if test='INDV_REFN_FG != null'>INDV_REFN_FG = #{INDV_REFN_FG} ,</if>
		    <if test='PROD_CD != null'>PROD_CD = #{PROD_CD} ,</if>
		    <if test='PROD_NM != null'>PROD_NM = #{PROD_NM} ,</if>
		    <if test='McountNo != null'>Mcount_No = #{McountNo} ,</if>
		    <if test='QTY != null'>QTY = #{QTY} ,</if>
		    <if test='ORIG_STAT_QTY != null'>ORIG_STAT_QTY = #{ORIG_STAT_QTY} ,</if>
		    <if test='ORIG_STAT_QTY != null'>ORIG_QTY = #{ORIG_STAT_QTY} ,</if>
		    <if test='NOT_ORIG_STAT_QTY != null'>NOT_ORIG_STAT_QTY = #{NOT_ORIG_STAT_QTY} ,</if>
		    <if test='AMT_PRICE != null'>AMT_PRICE = #{AMT_PRICE} ,</if>
		    <if test='AMT != null'>AMT = #{AMT} ,</if>
		    <if test='ORIG != null'>ORIG = #{ORIG} ,</if>
		    <if test='HS_CD != null'>HS_CD = #{HS_CD} ,</if>
		    <if test='SERIAL_NO != null'>SERIAL_NO = #{SERIAL_NO} ,</if>
		    <if test='INV_CO_NO != null'>INV_CO_NO = #{INV_CO_NO} ,</if>
		    <if test='APLY_PACT != null'>APLY_PACT = #{APLY_PACT} ,</if>
		    <if test='ORIG_PACT != null'>ORIG_PACT = #{ORIG_PACT} ,</if>
		    <if test='ORIG_CERT_FG != null'>ORIG_CERT_FG = #{ORIG_CERT_FG} ,</if>
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
		    <if test='QTY_UNIT != null'>QTY_UNIT = #{QTY_UNIT} ,</if>
		    <if test='Expum_pum_b != null'>Expum_pum_b = #{Expum_pum_b} ,</if>
		    <if test='Expum_pum_c != null'>Expum_pum_c = #{Expum_pum_c} ,</if>
		    <if test='INV_NO != null'>INV_NO = #{INV_NO} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
			<if test='ExEmNo != null'>ExEmNo = #{ExEmNo} ,</if>
			<if test='ETC_RSN != null'>ETC_RSN = #{ETC_RSN} ,</if>
		</trim>
		WHERE EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
		and EXPT_INV_SEQNO = #{EXPT_INV_SEQNO}
		and useYn='Y'
	</update>

    <select id="selectMaxImOrdr" resultType="map">
		select
		substring(MAX(IMPT_ORDR_MNG_NO),3,8) as 'max',
		RIGHT('000000' + CAST(RIGHT(ISNULL(MAX(IMPT_ORDR_MNG_NO), 0), 6) + 1 AS VARCHAR), 6) as 'IMPT_ORDR_MNG_NO'
		from rms.dbo.ED_IMPT_ORDR
		where useYn='Y'
	</select>

    <insert id="insertImpoOrder">
		INSERT INTO rms.dbo.ED_IMPT_ORDR
		       ([GRP_COMP_CD],
				[IMPT_ORDR_MNG_NO],
				[ORDR_DT],
				[PROC_STAT],
				[OWN_GODS_CD],
				[OWN_GODS_NM],
				[OWN_GODS_DIVS_MAN],
				[OWN_GODS_DIVS_MAN_NM],
				[BL_NO],
				[BL_DIVS],
				[BL_SEQNO],
				[EXTR_NAT],
				[DECL_CUSTOMS_CD],
				[DECL_CUSTOMS_NM],
				[DECL_DIVS_MAN],
				[DECL_DIVS_MAN_NM],
				[EXP_CD],
				[EXP_NM],
				[INCOTERMS],
				[CUR_UNIT],
				[TOT_WT],
				[PKG_QTY],
				[IM_FTA_CD],
				[Impo_suipja_code],
				[Impo_suipja_sangho],
				[Impo_SuipSaupNo],
				[Impo_gyelje_input],
				[Impo_fre_money],
				[Impo_fre],
				[Impo_ins_input],
				[Impo_segwan],
				[Impo_gwa],
				[Impo_plan],
				[Impo_singo_gubun],
				[Impo_gele_gubun],
				[Impo_jonglu],
				[Impo_wonsanji_yn],
				[Impo_gakyk_yn],
				[Impo_gyelje],
				[Impo_iphang_date],
				[Impo_hanggu_code],
				[Impo_unsong_type],
				[Impo_unsong_box],
				[Impo_jingsu_type],
				[Impo_pojang_danwi],
				[MoveYN],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[Impo_banip_date],
				[Impo_plus_yul_gubun],
				[Impo_plus_money],
				[Impo_plus_yul],
				[ReImExGbn]
				)
		VALUES
		       (#{GRP_COMP_CD},
				#{IMPT_ORDR_MNG_NO},
				#{ORDR_DT},
				#{PROC_STAT},
				#{OWN_GODS_CD},
				#{OWN_GODS_NM},
				#{OWN_GODS_DIVS_MAN},
				#{OWN_GODS_DIVS_MAN_NM},
				#{BL_NO},
				#{BL_DIVS},
				#{BL_SEQNO},
				#{EXTR_NAT},
				#{DECL_CUSTOMS_CD},
				#{DECL_CUSTOMS_NM},
				#{DECL_DIVS_MAN},
				#{DECL_DIVS_MAN_NM},
				#{EXP_CD},
				#{EXP_NM},
				#{INCOTERMS},
				#{CUR_UNIT},
				#{TOT_WT},
				#{PKG_QTY},
				#{IM_FTA_CD},
				#{Impo_suipja_code},
				#{Impo_suipja_sangho},
				#{Impo_SuipSaupNo},
				#{Impo_gyelje_input},
				#{Impo_fre_money},
				#{Impo_fre},
				#{Impo_ins_input},
				#{Impo_segwan},
				#{Impo_gwa},
				#{Impo_plan},
				#{Impo_singo_gubun},
				#{Impo_gele_gubun},
				#{Impo_jonglu},
				#{Impo_wonsanji_yn},
				#{Impo_gakyk_yn},
				#{Impo_gyelje},
				#{Impo_iphang_date},
				#{Impo_hanggu_code},
				#{Impo_unsong_type},
				#{Impo_unsong_box},
				#{Impo_jingsu_type},
				#{Impo_pojang_danwi},
				#{MoveYN},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{Impo_banip_date},
				#{Impo_plus_yul_gubun},
				#{Impo_plus_money},
				#{Impo_plus_yul},
				#{ReImExGbn})
	</insert>

    <update id="updateImpoOrder">
		UPDATE	rms.dbo.ED_IMPT_ORDR
		<trim prefix="SET" suffixOverrides=",">
		    <if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
			<if test='IMPT_ORDR_MNG_NO != null'>IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO} ,</if>
			<if test='ORDR_DT != null'>ORDR_DT = #{ORDR_DT} ,</if>
			<if test='PROC_STAT != null'>PROC_STAT = #{PROC_STAT} ,</if>
			<if test='OWN_GODS_CD != null'>OWN_GODS_CD = #{OWN_GODS_CD} ,</if>
			<if test='OWN_GODS_NM != null'>OWN_GODS_NM = #{OWN_GODS_NM} ,</if>
			<if test='OWN_GODS_DIVS_MAN != null'>OWN_GODS_DIVS_MAN = #{OWN_GODS_DIVS_MAN} ,</if>
			<if test='OWN_GODS_DIVS_MAN_NM != null'>OWN_GODS_DIVS_MAN_NM = #{OWN_GODS_DIVS_MAN_NM} ,</if>
			<if test='BL_NO != null'>BL_NO = #{BL_NO} ,</if>
			<if test='BL_DIVS != null'>BL_DIVS = #{BL_DIVS} ,</if>
			<if test='BL_SEQNO != null'>BL_SEQNO = #{BL_SEQNO} ,</if>
			<if test='EXTR_NAT != null'>EXTR_NAT = #{EXTR_NAT} ,</if>
			<if test='DECL_CUSTOMS_CD != null'>DECL_CUSTOMS_CD = #{DECL_CUSTOMS_CD} ,</if>
			<if test='DECL_CUSTOMS_NM != null'>DECL_CUSTOMS_NM = #{DECL_CUSTOMS_NM} ,</if>
			<if test='DECL_DIVS_MAN != null'>DECL_DIVS_MAN = #{DECL_DIVS_MAN} ,</if>
			<if test='DECL_DIVS_MAN_NM != null'>DECL_DIVS_MAN_NM = #{DECL_DIVS_MAN_NM} ,</if>
			<if test='EXP_CD != null'>EXP_CD = #{EXP_CD} ,</if>
			<if test='EXP_NM != null'>EXP_NM = #{EXP_NM} ,</if>
			<if test='INCOTERMS != null'>INCOTERMS = #{INCOTERMS} ,</if>
			<if test='CUR_UNIT != null'>CUR_UNIT = #{CUR_UNIT} ,</if>
			<if test='TOT_WT != null'>TOT_WT = #{TOT_WT} ,</if>
			<if test='PKG_QTY != null'>PKG_QTY = #{PKG_QTY} ,</if>
			<if test='IM_FTA_CD != null'>IM_FTA_CD = #{IM_FTA_CD} ,</if>
			<if test='Impo_suipja_code != null'>Impo_suipja_code = #{Impo_suipja_code} ,</if>
			<if test='Impo_suipja_sangho != null'>Impo_suipja_sangho = #{Impo_suipja_sangho} ,</if>
			<if test='Impo_SuipSaupNo != null'>Impo_SuipSaupNo = #{Impo_SuipSaupNo} ,</if>
			<if test='Impo_gyelje_input != null'>Impo_gyelje_input = #{Impo_gyelje_input} ,</if>
			<if test='Impo_fre_money != null'>Impo_fre_money = #{Impo_fre_money} ,</if>
			<if test='Impo_fre != null'>Impo_fre = #{Impo_fre} ,</if>
			<if test='Impo_ins_input != null'>Impo_ins_input = #{Impo_ins_input} ,</if>
			<if test='Impo_segwan != null'>Impo_segwan = #{Impo_segwan} ,</if>
			<if test='Impo_gwa != null'>Impo_gwa = #{Impo_gwa} ,</if>
			<if test='Impo_plan != null'>Impo_plan = #{Impo_plan} ,</if>
			<if test='Impo_singo_gubun != null'>Impo_singo_gubun = #{Impo_singo_gubun} ,</if>
			<if test='Impo_gele_gubun != null'>Impo_gele_gubun = #{Impo_gele_gubun} ,</if>
			<if test='Impo_jonglu != null'>Impo_jonglu = #{Impo_jonglu} ,</if>
			<if test='Impo_wonsanji_yn != null'>Impo_wonsanji_yn = #{Impo_wonsanji_yn} ,</if>
			<if test='Impo_gakyk_yn != null'>Impo_gakyk_yn = #{Impo_gakyk_yn} ,</if>
			<if test='Impo_gyelje != null'>Impo_gyelje = #{Impo_gyelje} ,</if>
			<if test='Impo_iphang_date != null'>Impo_iphang_date = #{Impo_iphang_date} ,</if>
			<if test='Impo_hanggu_code != null'>Impo_hanggu_code = #{Impo_hanggu_code} ,</if>
			<if test='Impo_unsong_type != null'>Impo_unsong_type = #{Impo_unsong_type} ,</if>
			<if test='Impo_unsong_box != null'>Impo_unsong_box = #{Impo_unsong_box} ,</if>
			<if test='Impo_jingsu_type != null'>Impo_jingsu_type = #{Impo_jingsu_type} ,</if>
			<if test='Impo_pojang_danwi != null'>Impo_pojang_danwi = #{Impo_pojang_danwi} ,</if>
			<if test='MoveYN != null'>MoveYN = #{MoveYN} ,</if>
			<if test='Impo_banip_date != null'>Impo_banip_date = #{Impo_banip_date} ,</if>
			<if test='Impo_plus_yul_gubun != null'>Impo_plus_yul_gubun = #{Impo_plus_yul_gubun} ,</if>
			<if test='Impo_plus_money != null'>Impo_plus_money = #{Impo_plus_money} ,</if>
			<if test='Impo_plus_yul != null'>Impo_plus_yul = #{Impo_plus_yul} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
			<if test='ReImExGbn != null'>ReImExGbn = #{ReImExGbn} ,</if>
		</trim>
		WHERE KEY_ED_IMPT_ORDR = #{KEY_ED_IMPT_ORDR}
	</update>

    <select id="selectMaxImptInv" resultType="map">
		select
		RIGHT('000' + CAST(RIGHT(ISNULL(MAX(IMPT_INV_SEQNO), 0), 3) + 1 AS VARCHAR), 3) as 'IMPT_INV_SEQNO'
		from rms.dbo.ED_IMPT_INV
		<where>
			and useYn = 'Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
        </where>
	</select>

    <insert id="insertImpoInv">
		INSERT INTO rms.dbo.ED_IMPT_INV
		       ([GRP_COMP_CD],
				[IMPT_ORDR_MNG_NO],
				[IMPT_INV_SEQNO],
				[INV_NO],
				[Mcount_No],
				[ITEM_CD],
				[QTY],
				[QTY_UNIT],
				[EXEM_QTY],
				[NOT_EXEM_QTY],
				[AMT_PRICE],
				[AMT],
				[HS_CD],
				[ORIG],
				[RSN_CD],
				[ETC_RSN],
				[LAW_CD],
				[Mhs_rate],
				[ORIG_CERT_FG],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[impum_gukyk1],
				[impum_gukyk2],
				[impum_gukyk3],
				[SERIAL_NO],
				[ExEmNo],
				[SoNo],
				[EndUserName]
				)
		VALUES
		       (#{GRP_COMP_CD},
				#{IMPT_ORDR_MNG_NO},
				#{IMPT_INV_SEQNO},
				#{INV_NO},
				#{McountNo},
				#{ITEM_CD},
				#{QTY},
				#{QTY_UNIT},
				#{EXEM_QTY},
				#{NOT_EXEM_QTY},
				#{AMT_PRICE},
				#{AMT},
				#{HS_CD},
				#{ORIG},
				#{RSN_CD},
				#{ETC_RSN},
				#{LAW_CD},
				#{Mhs_rate},
				#{ORIG_CERT_FG},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{impum_gukyk1},
				#{impum_gukyk2},
				#{impum_gukyk3},
				#{SERIAL_NO},
				#{ExEmNo},
				#{SoNo},
				#{EndUserName})
	</insert>

    <update id="updateImpoInv1">
		UPDATE	rms.dbo.ED_IMPT_INV
		<trim prefix="SET" suffixOverrides=",">
		    <if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
		    <if test='IMPT_ORDR_MNG_NO != null'>IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO} ,</if>
		    <if test='IMPT_INV_SEQNO != null'>IMPT_INV_SEQNO = #{IMPT_INV_SEQNO} ,</if>
		    <if test='INV_NO != null'>INV_NO = #{INV_NO} ,</if>
		    <if test='McountNo != null'>Mcount_No = #{McountNo} ,</if>
		    <if test='ITEM_CD != null'>ITEM_CD = #{ITEM_CD} ,</if>
		    <if test='QTY != null'>QTY = #{QTY} ,</if>
		    <if test='QTY_UNIT != null'>QTY_UNIT = #{QTY_UNIT} ,</if>
		    <if test='EXEM_QTY != null'>EXEM_QTY = #{EXEM_QTY} ,</if>
		    <if test='NOT_EXEM_QTY != null'>NOT_EXEM_QTY = #{NOT_EXEM_QTY} ,</if>
		    <if test='AMT_PRICE != null'>AMT_PRICE = #{AMT_PRICE} ,</if>
		    <if test='AMT != null'>AMT = #{AMT} ,</if>
		    <if test='HS_CD != null'>HS_CD = #{HS_CD} ,</if>
		    <if test='ORIG != null'>ORIG = #{ORIG} ,</if>
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
		    <if test='RSN_CD != null'>RSN_CD = #{RSN_CD} ,</if>
		    <if test='ETC_RSN != null'>ETC_RSN = #{ETC_RSN} ,</if>
		    <if test='LAW_CD != null'>LAW_CD = #{LAW_CD} ,</if>
		    <if test='Mhs_rate != null'>Mhs_rate = #{Mhs_rate} ,</if>
		    <if test='ORIG_CERT_FG != null'>ORIG_CERT_FG = #{ORIG_CERT_FG} ,</if>
		    <if test='impum_gukyk1 != null'>impum_gukyk1 = #{impum_gukyk1} ,</if>
		    <if test='impum_gukyk2 != null'>impum_gukyk2 = #{impum_gukyk2} ,</if>
		    <if test='impum_gukyk3 != null'>impum_gukyk3 = #{impum_gukyk3} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
			<if test='SERIAL_NO != null'>SERIAL_NO = #{SERIAL_NO} ,</if>
			<if test='ExEmNo != null'>ExEmNo = #{ExEmNo} ,</if>
			<if test='SoNo != null'>SoNo = #{SoNo} ,</if>
			<if test='EndUserName != null'>EndUserName = #{EndUserName} ,</if>
		</trim>
		WHERE IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
		and IMPT_INV_SEQNO = #{IMPT_INV_SEQNO}
		and useYn='Y'
	</update>

    <update id="updateImpoInv2">
		UPDATE	rms.dbo.ED_IMPT_INV
		<trim prefix="SET" suffixOverrides=",">
		    <if test='ReQTY != null'>ReQty = #{ReQTY} ,</if>
		    <if test='turnQty != null'>ReQty = ReQty - #{turnQty} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE KEY_ED_IMPT_INV = #{KEY_ED_IMPT_INV}
	</update>

    <select id="selectImportStatusList" resultType="map">
        /* 수입통관현황 (Import Status) */
        select * from
		(
	        SELECT
			ImKey as 'Impo_key', ImRecvResult as 'Impo_receive_result', ImCsType as 'Impo_cs', ImNapSangho as 'Impo_napse_sangho', ImBlNo as 'Impo_bl_no',
			ImMblNo as 'Impo_mbl_no', ImSingoNo as 'Impo_singo_no',
			ImIphangDt as 'Impo_iphang_date', ImBanipDtm as 'Impo_banip_date', ImSingoDt as 'Impo_singo_date', ImOkDtm as 'Impo_Ok_date', ImJubsuDtm as 'Impo_jubsu_date',
			ImFileNo1 as 'Impo_file_no1', ImGongSangho as 'Impo_gonggub_sangho', ImJukchulNm as 'Impo_jukchl_name', ImHangguNm as 'Impo_hanggu_name', ImJangchiNm as 'Impo_jangch_name',
			ImPacSu as 'Impo_pojang_su', ImJungTotal as 'Impo_total_jung', ImForwarderSangho as 'Impo_Forwarder_sangho', ImSingoGbn as 'impo_singo_gubun', ImIndoType as 'Impo_indo_jogun',
			ImPayTotal as 'Impo_Gyelje_Input', ImTotalTax as 'Impo_total_tax', ImFreWon as 'Impo_fre_won', ImCifWon as 'Impo_cif_total_won', ImCifUsd as 'Impo_cif_total_usd', ImTax as 'Impo_gwan_tax', ImVatTotal as 'Impo_vat_tax',
			(ImTotalTax-(ImTax+ImVatTotal)) AS 'Impo_etc_tax', ImSegwan as 'impo_segwan',
			ISNULL((SELECT a.CusHnm FROM CPS.[dbo].[CDAB100M] a WITH (NOLOCK) WHERE a.CusCd = ImSegwan and a.UseYn='Y'), '') AS 'segwanName',
			ISNULL((SELECT top 1 a.ImLanGuraeNm FROM CPS.dbo.IMAC120 a WITH (NOLOCK) WHERE a.ImKey = ImKey AND a.ImLan = '001' and a.UseYn = 'Y'), '') AS 'imlanGuraePum',
			ImSuipCode as 'Impo_suipja_code', 'ncustoms_ca' as 'defaultDB',
			ImNapSaup as 'Impo_napse_saup'
			FROM CPS.dbo.IMAC100 WITH (NOLOCK)
			where UseYn='Y'
			union all
			SELECT
			Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
			Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
			Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
			Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun, Impo_indo_jogun,
			Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
			(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
			ISNULL((SELECT segwan_name FROM ncustoms_ed.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
			ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ed.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
			Impo_suipja_code, 'ncustoms_ed' as 'defaultDB',
			Impo_napse_saup
			FROM ncustoms_ed.[kcba].[impo1] WITH (NOLOCK)
		) a
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.ImNapSangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND left(a.Impo_iphang_date,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND left(a.Impo_singo_date,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND left(a.Impo_Ok_date,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND left(a.Impo_banip_date,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_Ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_Ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
    </select>

    <select id="selectImportStatusListBack" resultType="map">
        /* 수입통관현황 (Import Status) */
        select * from
		(
        SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun, Impo_indo_jogun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ${_defaultDB}.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ${_defaultDB}.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		Impo_suipja_code, #{_defaultDB} as 'defaultDB',
		Impo_napse_saup
		FROM ${_defaultDB}.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun, Impo_indo_jogun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_ed.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ed.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		Impo_suipja_code, 'ncustoms_ed' as 'defaultDB',
		Impo_napse_saup
		FROM ncustoms_ed.[kcba].[impo1] WITH (NOLOCK)
		) a
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
    </select>

    <select id="selectImportStatusList1" resultType="map">
        /* 수입통관현황 (Import Status) 자재코드검색 */
        select * from
		(
	        SELECT
			b.ImKey as 'Impo_key', b.ImRecvResult as 'Impo_receive_result', b.ImCsType as 'Impo_cs', b.ImNapSangho as 'Impo_napse_sangho', b.ImBlNo as 'Impo_bl_no', b.ImMblNo as 'Impo_mbl_no', b.ImSingoNo as 'Impo_singo_no',
			b.ImIphangDt as 'Impo_iphang_date', b.ImBanipDtm as 'Impo_banip_date', b.ImSingoDt as 'Impo_singo_date', b.ImOkDtm as 'Impo_Ok_date', b.ImJubsuDtm as 'Impo_jubsu_date',
			b.ImFileNo1 as 'Impo_file_no1', b.ImGongSangho as 'Impo_gonggub_sangho', b.ImJukchulNm as 'Impo_jukchl_name', b.ImHangguNm as 'Impo_hanggu_name', b.ImJangchiNm as 'Impo_jangch_name',
			b.ImPacSu as 'Impo_pojang_su', b.ImJungTotal as 'Impo_total_jung', b.ImForwarderSangho as 'Impo_Forwarder_sangho', b.ImSingoGbn as 'impo_singo_gubun', b.ImIndoType as 'Impo_indo_jogun',
			b.ImPayTotal as 'Impo_Gyelje_Input', b.ImTotalTax as 'Impo_total_tax', b.ImFreWon as 'Impo_fre_won', b.ImCifWon as 'Impo_cif_total_won', b.ImCifUsd as 'Impo_cif_total_usd', b.ImTax as 'Impo_gwan_tax', b.ImVatTotal as 'Impo_vat_tax',
			(b.ImTotalTax-(b.ImTax+b.ImVatTotal)) AS 'Impo_etc_tax', b.ImSegwan as 'impo_segwan',
			ISNULL((SELECT a.CusHnm FROM CPS.[dbo].[CDAB100M] a WITH (NOLOCK) WHERE a.CusCd = ImSegwan and a.UseYn='Y'), '') AS 'segwanName',
			ISNULL((SELECT a.ImLanGuraeNm FROM CPS.dbo.IMAC120 a WITH (NOLOCK) WHERE a.ImKey = ImKey AND a.ImLan = '001' and a.UseYn = 'Y'), '') AS 'imlanGuraePum',
			b.ImSuipCode as 'Impo_suipja_code', 'ncustoms_ca' as 'defaultDB',
			b.ImNapSaup as 'Impo_napse_saup'
			FROM CPS.dbo.IMAC100 b, CPS.dbo.IMAC110 c
			where b.ImKey = c.ImKey
			and c.ImPumModelCode LIKE '%' + #{impumJajaeCode} + '%'
			group by b.ImKey, b.ImRecvResult, b.ImCsType, b.ImNapSangho, b.ImBlNo, b.ImMblNo, b.ImSingoNo,
			b.ImIphangDt, b.ImBanipDtm, b.ImSingoDt, b.ImOkDtm, b.ImJubsuDtm,
			b.ImFileNo1, b.ImGongSangho, b.ImJukchulNm, b.ImHangguNm, b.ImJangchiNm,
			b.ImPacSu, b.ImJungTotal, b.ImForwarderSangho, b.ImSingoGbn, b.ImIndoType,
			b.ImPayTotal, b.ImTotalTax, b.ImFreWon, b.ImCifWon, b.ImCifUsd, b.ImTax, b.ImVatTotal, b.ImSegwan,
			b.ImSuipCode, b.ImNapSaup
			union all
			SELECT
			b.Impo_key, b.Impo_receive_result, b.Impo_cs, b.Impo_napse_sangho, b.Impo_bl_no, b.Impo_mbl_no, b.Impo_singo_no,
			b.Impo_iphang_date, b.Impo_banip_date, b.Impo_singo_date, b.Impo_Ok_date, b.Impo_jubsu_date,
			b.Impo_file_no1, b.Impo_gonggub_sangho, b.Impo_jukchl_name, b.Impo_hanggu_name, b.Impo_jangch_name,
			b.Impo_pojang_su, b.Impo_total_jung, b.Impo_Forwarder_sangho, b.impo_singo_gubun, b.Impo_indo_jogun,
			b.Impo_Gyelje_Input, b.Impo_total_tax, b.Impo_fre_won, b.Impo_cif_total_won, b.Impo_cif_total_usd, b.Impo_gwan_tax, b.Impo_vat_tax,
			(b.Impo_total_tax-(b.Impo_gwan_tax+b.Impo_vat_tax)) AS 'Impo_etc_tax', b.impo_segwan,
			ISNULL((SELECT segwan_name FROM ncustoms_ed.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = b.impo_segwan), '') AS 'segwanName',
			ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ed.[kcba].[Impo2] WITH (NOLOCK) WHERE b.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
			b.Impo_suipja_code, 'ncustoms_ed' as 'defaultDB',
			b.Impo_napse_saup
			FROM ncustoms_ed.[kcba].[impo1] b, ncustoms_ed.[kcba].[Impo3] c
			where b.Impo_key = c.Impum_key
			and c.Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'
			group by b.Impo_key, b.Impo_receive_result, b.Impo_cs, b.Impo_napse_sangho, b.Impo_bl_no, b.Impo_mbl_no, b.Impo_singo_no,
			b.Impo_iphang_date, b.Impo_banip_date, b.Impo_singo_date, b.Impo_Ok_date, b.Impo_jubsu_date,
			b.Impo_file_no1, b.Impo_gonggub_sangho, b.Impo_jukchl_name, b.Impo_hanggu_name, b.Impo_jangch_name,
			b.Impo_pojang_su, b.Impo_total_jung, b.Impo_Forwarder_sangho, b.impo_singo_gubun, b.Impo_indo_jogun,
			b.Impo_Gyelje_Input, b.Impo_total_tax, b.Impo_fre_won, b.Impo_cif_total_won, b.Impo_cif_total_usd, b.Impo_gwan_tax, b.Impo_vat_tax, b.impo_segwan,
			b.Impo_suipja_code, b.Impo_napse_saup
		) a
        WHERE ISNULL(a.ImJubsuDtm, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        and b.UseYn='Y'
        and c.UseYn='Y'
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.ImNapSaup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.ImNapSaup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.ImNapSangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.ImBlNo LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.ImSingoNo LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.ImFileNo1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND left(a.ImIphangDt,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND left(a.ImSingoDt,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND left(a.ImOkDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND left(a.ImBanipDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.ImOkDtm, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.ImSingoDt = CONVERT(VARCHAR, GETDATE(), 112) OR a.ImOkDtm = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.ImSingoGbn LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.ImCsType in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.ImSegwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.ImSegwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.ImSegwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.ImSegwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.ImSegwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.ImSegwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.ImSegwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.ImSegwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.ImSegwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.ImSegwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.ImSegwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.ImSegwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.ImSegwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.ImSegwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.ImGongSangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.ImForwarderSangho LIKE '%' + #{forwarder} + '%'</if>
    </select>

    <select id="selectImportStatusList1Back" resultType="map">
        /* 수입통관현황 (Import Status) 자재코드검색 */
        select * from
		(
        SELECT
		b.Impo_key, b.Impo_receive_result, b.Impo_cs, b.Impo_napse_sangho, b.Impo_bl_no, b.Impo_mbl_no, b.Impo_singo_no,
		b.Impo_iphang_date, b.Impo_banip_date, b.Impo_singo_date, b.Impo_Ok_date, b.Impo_jubsu_date,
		b.Impo_file_no1, b.Impo_gonggub_sangho, b.Impo_jukchl_name, b.Impo_hanggu_name, b.Impo_jangch_name,
		b.Impo_pojang_su, b.Impo_total_jung, b.Impo_Forwarder_sangho, b.impo_singo_gubun, b.Impo_indo_jogun,
		b.Impo_Gyelje_Input, b.Impo_total_tax, b.Impo_fre_won, b.Impo_cif_total_won, b.Impo_cif_total_usd, b.Impo_gwan_tax, b.Impo_vat_tax,
		(b.Impo_total_tax-(b.Impo_gwan_tax+b.Impo_vat_tax)) AS 'Impo_etc_tax', b.impo_segwan,
		ISNULL((SELECT segwan_name FROM ${_defaultDB}.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = b.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ${_defaultDB}.[kcba].[Impo2] WITH (NOLOCK) WHERE b.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		b.Impo_suipja_code, #{_defaultDB} as 'defaultDB',
		b.Impo_napse_saup
		FROM ${_defaultDB}.[kcba].[Impo1] b, ${_defaultDB}.[kcba].[Impo3] c
		where b.Impo_key = c.Impum_key
		and c.Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'
		group by b.Impo_key, b.Impo_receive_result, b.Impo_cs, b.Impo_napse_sangho, b.Impo_bl_no, b.Impo_mbl_no, b.Impo_singo_no,
		b.Impo_iphang_date, b.Impo_banip_date, b.Impo_singo_date, b.Impo_Ok_date, b.Impo_jubsu_date,
		b.Impo_file_no1, b.Impo_gonggub_sangho, b.Impo_jukchl_name, b.Impo_hanggu_name, b.Impo_jangch_name,
		b.Impo_pojang_su, b.Impo_total_jung, b.Impo_Forwarder_sangho, b.impo_singo_gubun, b.Impo_indo_jogun,
		b.Impo_Gyelje_Input, b.Impo_total_tax, b.Impo_fre_won, b.Impo_cif_total_won, b.Impo_cif_total_usd, b.Impo_gwan_tax, b.Impo_vat_tax, b.impo_segwan,
		b.Impo_suipja_code, b.Impo_napse_saup
		union all
		SELECT
		b.Impo_key, b.Impo_receive_result, b.Impo_cs, b.Impo_napse_sangho, b.Impo_bl_no, b.Impo_mbl_no, b.Impo_singo_no,
		b.Impo_iphang_date, b.Impo_banip_date, b.Impo_singo_date, b.Impo_Ok_date, b.Impo_jubsu_date,
		b.Impo_file_no1, b.Impo_gonggub_sangho, b.Impo_jukchl_name, b.Impo_hanggu_name, b.Impo_jangch_name,
		b.Impo_pojang_su, b.Impo_total_jung, b.Impo_Forwarder_sangho, b.impo_singo_gubun, b.Impo_indo_jogun,
		b.Impo_Gyelje_Input, b.Impo_total_tax, b.Impo_fre_won, b.Impo_cif_total_won, b.Impo_cif_total_usd, b.Impo_gwan_tax, b.Impo_vat_tax,
		(b.Impo_total_tax-(b.Impo_gwan_tax+b.Impo_vat_tax)) AS 'Impo_etc_tax', b.impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_ed.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = b.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ed.[kcba].[Impo2] WITH (NOLOCK) WHERE b.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		b.Impo_suipja_code, 'ncustoms_ed' as 'defaultDB',
		b.Impo_napse_saup
		FROM ncustoms_ed.[kcba].[impo1] b, ncustoms_ed.[kcba].[Impo3] c
		where b.Impo_key = c.Impum_key
		and c.Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'
		group by b.Impo_key, b.Impo_receive_result, b.Impo_cs, b.Impo_napse_sangho, b.Impo_bl_no, b.Impo_mbl_no, b.Impo_singo_no,
		b.Impo_iphang_date, b.Impo_banip_date, b.Impo_singo_date, b.Impo_Ok_date, b.Impo_jubsu_date,
		b.Impo_file_no1, b.Impo_gonggub_sangho, b.Impo_jukchl_name, b.Impo_hanggu_name, b.Impo_jangch_name,
		b.Impo_pojang_su, b.Impo_total_jung, b.Impo_Forwarder_sangho, b.impo_singo_gubun, b.Impo_indo_jogun,
		b.Impo_Gyelje_Input, b.Impo_total_tax, b.Impo_fre_won, b.Impo_cif_total_won, b.Impo_cif_total_usd, b.Impo_gwan_tax, b.Impo_vat_tax, b.impo_segwan,
		b.Impo_suipja_code, b.Impo_napse_saup
		) a
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
    </select>

    <select id="selectImportStatusDetail1" resultType="map">
        /* 수입통관현황 (Import Status) */
        select * from
		(
	        SELECT
			a.ImKey as 'Imlan_key', a.ImLan as 'Imlan_jechl_lan', a.ImLanHsCode as 'Imlan_hs', a.ImLanHsGbn as 'Imlan_seyul_gubun',
			a.ImLanGwanRate as 'Imlan_gwan_seyula', a.ImLanGuraeNm as 'Imlan_gurae_pum', a.ImLanBrandNm as 'Imlan_model',
			a.ImLanPay as 'Imlan_cost', a.ImLanHwanTotal as 'Imlan_mulryang', a.ImLanHwanUnit as 'Imlan_mulryang_danwi',
			a.ImLanJung as 'Imlan_jung', a.ImLanCifWon as 'Imlan_cif_won', a.ImLanCifUsd as 'Imlan_cif_usd', a.ImLanGwanTax as 'Imlan_gwan_tax',
			a.ImLanVatTax as 'Imlan_vat_tax', a.ImLanCsTest1 as 'Imlan_cs_gumsa1', a.ImLanFTADesc as 'imlan_fta_obj',
			(select MAX(ImLan) FROM CPS.dbo.IMAC120 where ImKey = #{Impokey}) as 'maxLan',
			'ncustoms_ca' as 'defaultDB'
			FROM CPS.dbo.IMAC120 a WITH (NOLOCK)
			where a.UseYn='Y'
			union all
			SELECT
			Imlan_key, Imlan_jechl_lan, Imlan_hs, Imlan_seyul_gubun, Imlan_gwan_seyula, Imlan_gurae_pum, Imlan_model,
			Imlan_cost, Imlan_mulryang, Imlan_mulryang_danwi, Imlan_jung, Imlan_cif_won, Imlan_cif_usd, Imlan_gwan_tax,
			Imlan_vat_tax, Imlan_cs_gumsa1, imlan_fta_obj,
			(select MAX(Imlan_jechl_lan) FROM ncustoms_ed.[kcba].[Impo2] where Imlan_key = #{Impokey}) as 'maxLan',
			#{_defaultDB} as 'defaultDB'
			FROM ncustoms_ed.[kcba].[impo2] a WITH (NOLOCK)
		) b
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND b.Imlan_key = #{Impokey}</if>
    </select>

    <select id="selectImportStatusDetail1Back" resultType="map">
        /* 수입통관현황 (Import Status) */
        select * from
		(
        SELECT
		*,
		(select MAX(Imlan_jechl_lan) FROM ${_defaultDB}.[kcba].[Impo2] where Imlan_key = #{Impokey}) as 'maxLan',
		#{_defaultDB} as 'defaultDB'
		FROM ${_defaultDB}.[kcba].[Impo2] a WITH (NOLOCK)
		union all
		SELECT
		*,
		(select MAX(Imlan_jechl_lan) FROM ${_defaultDB}.[kcba].[Impo2] where Imlan_key = #{Impokey}) as 'maxLan',
		#{_defaultDB} as 'defaultDB'
		FROM ncustoms_ed.[kcba].[impo2] a WITH (NOLOCK)
		) b
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND b.Imlan_key = #{Impokey}</if>
    </select>

    <select id="selectImportStatusDetail2" resultType="map">
        /* 수입통관현황 (Import Status) */
        select * from
		(
	        SELECT
			a.ImKey as 'Impum_key', a.ImPumLan as 'Impum_lan', a.ImLine as 'Impum_heang', a.ImPumModelCode as 'Impum_jajae_code',
			a.ImSu as 'Impum_su', a.ImSuUnit as 'Impum_su_danwi', a.ImDanga as 'Impum_danga', a.ImAmt as 'Impum_Amt',
			a.ImSungbun3 as 'Impum_sungbun3', a.ImGukyk2 as 'Impum_gukyk2', a.ImGukyk3 as 'Impum_gukyk3', a.ImSungbun1 as 'Impum_sungbun1', a.ImSungbun2 as 'Impum_sungbun2',
			a.ImGukyk2 as 'Impum_gukyk1',
			(select SUM(ImSu) FROM CPS.dbo.IMAC110 where ImKey = #{Impokey} and ImPumLan = #{Impum_lan}) as 'sumSu',
			(select SUM(ImAmt) FROM CPS.dbo.IMAC110 where ImKey = #{Impokey} and ImPumLan = #{Impum_lan}) as 'sumAmt'
			FROM CPS.dbo.IMAC110 a WITH (NOLOCK)
			where a.UseYn='Y'
			union all
			SELECT
			Impum_key, Impum_lan, Impum_heang, Impum_jajae_code, Impum_su, Impum_su_danwi, Impum_danga, Impum_Amt,
			Impum_sungbun3, Impum_gukyk2, Impum_gukyk3, Impum_sungbun1, Impum_sungbun2, Impum_gukyk1,
			(select SUM(Impum_su) FROM ncustoms_ed.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumSu',
			(select SUM(Impum_amt) FROM ncustoms_ed.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumAmt'
			FROM ncustoms_ed.[kcba].[impo3] a WITH (NOLOCK)
		) b
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND b.Impum_key = #{Impokey}</if>
        <if test='Impum_lan != null and Impum_lan != ""'>AND b.Impum_lan = #{Impum_lan}</if>
        order by b.Impum_lan, b.Impum_heang
    </select>

    <select id="selectImportStatusDetail2Back" resultType="map">
        /* 수입통관현황 (Import Status) */
        select * from
		(
        SELECT
		*,
		(select SUM(Impum_su) FROM ${_defaultDB}.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumSu',
		(select SUM(Impum_amt) FROM ${_defaultDB}.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumAmt'
		FROM ${_defaultDB}.[kcba].[Impo3] a WITH (NOLOCK)
		union all
		SELECT
		*,
		(select SUM(Impum_su) FROM ${_defaultDB}.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumSu',
		(select SUM(Impum_amt) FROM ${_defaultDB}.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumAmt'
		FROM ncustoms_ed.[kcba].[impo3] a WITH (NOLOCK)
		) b
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND b.Impum_key = #{Impokey}</if>
        <if test='Impum_lan != null and Impum_lan != ""'>AND b.Impum_lan = #{Impum_lan}</if>
        order by b.Impum_lan, b.Impum_heang
    </select>

    <select id="selectExportStatusList" resultType="map" fetchSize="100">
        /* 수출 통관정보 상태조회 */
        select * from
		(
	        SELECT
	        ExacKey as 'Expo_key', ExIvNo1 as 'Expo_iv_no', RecvResult as 'Expo_res_result', ExGeleCode as 'Expo_gurae_gbn', ExJongluCode as 'Expo_jong',
	        ExSingoNo as 'Expo_singo_no',
	        ExSingoDate as 'Expo_singo_date',
	        ExOkDtm as 'Expo_ok_date',
	        AddUserNm as 'UserNM', ExUnsongType as 'Expo_unsong_type',
	        ExForwardSangho as 'forward_sangho', ExBuyerSangho as 'Expo_gumaeja_sangho', ExMooJukNm as 'Expo_mokjuk_name', ExLoadingName as 'Expo_hanggu_name',
	        ExIndoType as 'Expo_indojo', ExPayUnit as 'Expo_gyelje_money', ExPayTotal as 'Expo_gyelje_input', ExPoJangSu as 'Expo_pojang_su', ExJungTotal as 'Expo_total_jung',
	        ExSunJukDate as 'Expo_sunjuk_date',
	        ExLoadedYN as 'expo_Loaded_YN',
	        ExLeaveDate as 'expo_LoadedDt',
	        ExDaeSaup as 'Expo_SuchulSaupNo',
	        ExFileNo1 as 'Expo_geyak_no1', ExFileNo2 as 'Expo_geyak_no2', ExSegwan as 'Expo_segwan', ExGwa as 'Expo_gwa', ExFobUsd as 'Expo_total_usd', ExFobWon as 'Expo_total_won',
	        ExDaeSangHo as 'Expo_suchulja_sangho', ExJeJoPartNm as 'Expo_whaju_sangho',
	        ISNULL((SELECT top 1 a.ExLanGuraeNm FROM CPS.dbo.EXAC120 a WITH (NOLOCK) WHERE a.ExacKey = ExacKey AND a.ExLan = '001' and a.UseYn='Y'), '') AS 'exlanEgukyk',
	        ExJeJoSaup as 'Expo_whaju_saup', '' as 'BFLOADDT', ExChamjoNo as 'Expo_chamjo_no', ExDaeCode as 'Expo_suchulja_code',
	        ExJeJoPartCode as 'Expo_whaju_code', ExWhaJuSangHo as 'Expo_trust_sangho', ExWhaJuPartCode as 'Expo_trust_code', ExWhaJuSaup as 'Expo_trust_saup',
	        'ncustoms_ca' as 'defaultDB', ExHBlNo as 'EXPO_BLNO'
	        FROM CPS.dbo.EXAC100 WITH (NOLOCK)
	        where UseYn='Y'
	        union all
	        SELECT
	        Expo_key, Expo_iv_no, Expo_res_result, Expo_gurae_gbn, Expo_jong,
	        Expo_singo_no as 'Expo_singo_no',
	        Expo_singo_date as 'Expo_singo_date',
	        Expo_ok_date as 'Expo_ok_date',
	        UserNM, Expo_unsong_type,
	        forward_sangho, Expo_gumaeja_sangho, Expo_mokjuk_name, Expo_hanggu_name,
	        Expo_indojo, Expo_gyelje_money, Expo_gyelje_input, Expo_pojang_su, Expo_total_jung,
	        rms.dbo.fn_NEW_DATE_VIEW('D1',Expo_sunjuk_date) as 'Expo_sunjuk_date',
	        expo_Loaded_YN,
	        rms.dbo.fn_NEW_DATE_VIEW('D1',expo_LoadedDt) as 'expo_LoadedDt',
	        Expo_SuchulSaupNo,
	        Expo_geyak_no1, Expo_geyak_no2, Expo_segwan, Expo_gwa, Expo_total_usd, Expo_total_won,
	        Expo_suchulja_sangho, Expo_whaju_sangho,
	        ISNULL((SELECT Exlan_egukyk FROM ncustoms_ed.[kcba].[Expo2] WITH (NOLOCK) WHERE Expo_key = Exlan_key AND Exlan_lan = '001'), '') AS 'exlanEgukyk',
	        Expo_whaju_saup,BFLOADDT,Expo_chamjo_no,Expo_suchulja_code,Expo_whaju_code,Expo_trust_sangho,Expo_trust_code,Expo_trust_saup,
	        'ncustoms_ed' as 'defaultDB', EXPO_BLNO
	        FROM ncustoms_ed.[kcba].[Expo1] WITH (NOLOCK)
        ) a
        WHERE 1 = 1
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND (a.Expo_SuchulSaupNo IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y') or Expo_whaju_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y'))</when>
                <otherwise>AND a.Expo_SuchulSaupNo = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='expoIvNo != null and expoIvNo != ""'>AND (a.Expo_geyak_no1 LIKE '%' + #{expoIvNo} + '%' or a.Expo_geyak_no2 LIKE '%' + #{expoIvNo} + '%')</if>
        <if test='expoSingoNo != null and expoSingoNo != ""'>AND a.Expo_singo_no LIKE '%' + #{expoSingoNo} + '%' /* 수출신고번호 */</if>
        <if test='expoGumaejaSangho != null and expoGumaejaSangho != ""'>AND a.Expo_gumaeja_sangho LIKE '%' + #{expoGumaejaSangho} + '%' /* 구매자상호 */</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Expo_singo_date_Day"'>AND left(a.Expo_singo_date,8) BETWEEN #{strFromDate} AND #{strToDate} /* 신고일 */</when>
                <when test='_DateType == "Expo_ok_date_Day"'>AND left(a.Expo_ok_date,8) BETWEEN #{strFromDate} AND #{strToDate} /* 수리일 */</when>
                <when test='_DateType == "expo_LoadedDt_Day"'>AND left(a.expo_LoadedDt,8) BETWEEN #{strFromDate} AND #{strToDate} /* 선적일 */</when>
                <when test='_DateType == "expoSunjukDate_Day"'>AND left(a.Expo_sunjuk_date,8) BETWEEN #{strFromDate} AND #{strToDate} /* 적재의무기한 */</when>
            </choose>
        </if>
        <if test='expoLoadedYn != null and expoLoadedYn != ""'>AND a.expo_Loaded_YN LIKE '%' + #{expoLoadedYn} + '%'</if>
        <if test='expoGeyakNo1 != null and expoGeyakNo1 != ""'>AND a.Expo_geyak_no1 LIKE '%' + #{expoGeyakNo1} + '%'</if>
        <if test='expoGeyakNo2 != null and expoGeyakNo2 != ""'>AND a.Expo_geyak_no2 LIKE '%' + #{expoGeyakNo2} + '%'</if>
        <if test='expoSegwan != null and expoSegwan != ""'>AND a.Expo_segwan = #{expoSegwan}</if>
        <if test='expoGroupSegwan != null and expoGroupSegwan != ""'>
            <choose>
                <when test='expoGroupSegwan == "경기"'>AND a.Expo_segwan in (012,014,021,131)</when>
                <when test='expoGroupSegwan == "구미"'>AND a.Expo_segwan in (120,121)</when>
                <when test='expoGroupSegwan == "대전"'>AND a.Expo_segwan in (080,081,082,150)</when>
                <when test='expoGroupSegwan == "부산"'>AND a.Expo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='expoGroupSegwan == "서울"'>AND a.Expo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='expoGroupSegwan == "여수"'>AND a.Expo_segwan in (060,062,070,071)</when>
                <when test='expoGroupSegwan == "울산"'>AND a.Expo_segwan in (110,122)</when>
                <when test='expoGroupSegwan == "인천"'>AND a.Expo_segwan in (013,020,023,040,041)</when>
                <when test='expoGroupSegwan == "창원"'>AND a.Expo_segwan in (050,052,053,056)</when>
                <when test='expoGroupSegwan == "천안"'>AND a.Expo_segwan in (152)</when>
                <when test='expoGroupSegwan == "청주"'>AND a.Expo_segwan in (151,153)</when>
                <when test='expoGroupSegwan == "파주"'>AND a.Expo_segwan in (017)</when>
                <when test='expoGroupSegwan == "평택"'>AND a.Expo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='expoGwa != null and expoGwa != ""'>AND a.Expo_gwa LIKE '%' + #{expoGwa} + '%'</if>
        <if test='expoChamjoNo != null and expoChamjoNo != ""'>AND a.Expo_chamjo_no LIKE '%' + #{expoChamjoNo} + '%'</if>
        <if test='expoSuchuljaSangho != null and expoSuchuljaSangho != ""'>AND a.Expo_suchulja_sangho LIKE '%' + #{expoSuchuljaSangho} + '%'</if>
        <if test='expoSuchuljaCode != null and expoSuchuljaCode != ""'>AND a.Expo_suchulja_code LIKE '%' + #{expoSuchuljaCode} + '%'</if>
        <if test='expoSuchulSaupNo != null and expoSuchulSaupNo != ""'>AND a.Expo_SuchulSaupNo LIKE '%' + #{expoSuchulSaupNo} + '%'</if>
        <if test='expoWhajuSangho != null and expoWhajuSangho != ""'>AND a.Expo_whaju_sangho LIKE '%' + #{expoWhajuSangho} + '%'</if>
        <if test='expoWhajuCode != null and expoWhajuCode != ""'>AND a.Expo_whaju_code LIKE '%' + #{expoWhajuCode} + '%'</if>
        <if test='expoWhajuSaup != null and expoWhajuSaup != ""'>AND a.Expo_whaju_saup LIKE '%' + #{expoWhajuSaup} + '%'</if>
        <if test='expoTrustSangho != null and expoTrustSangho != ""'>AND a.Expo_trust_sangho LIKE '%' + #{expoTrustSangho} + '%'</if>
        <if test='expoTrustCode != null and expoTrustCode != ""'>AND a.Expo_trust_code LIKE '%' + #{expoTrustCode} + '%'</if>
        <if test='expoTrustSaup != null and expoTrustSaup != ""'>AND a.Expo_trust_saup LIKE '%' + #{expoTrustSaup} + '%'</if>
    </select>

    <select id="selectExportStatusListBack" resultType="map" fetchSize="100">
        /* 수출 통관정보 상태조회 */
        select * from
		(
        SELECT
        Expo_key, Expo_iv_no, Expo_res_result, Expo_gurae_gbn, Expo_jong,
        Expo_singo_no as 'Expo_singo_no',
        rms.dbo.fn_NEW_DATE_VIEW('D1',Expo_singo_date) as 'Expo_singo_date',
        rms.dbo.fn_NEW_DATE_VIEW('D1',Expo_ok_date) as 'Expo_ok_date',
        UserNM, Expo_unsong_type,
        forward_sangho, Expo_gumaeja_sangho, Expo_mokjuk_name, Expo_hanggu_name,
        Expo_indojo, Expo_gyelje_money, Expo_gyelje_input, Expo_pojang_su, Expo_total_jung,
        rms.dbo.fn_NEW_DATE_VIEW('D1',Expo_sunjuk_date) as 'Expo_sunjuk_date',
        expo_Loaded_YN,
        rms.dbo.fn_NEW_DATE_VIEW('D1',expo_LoadedDt) as 'expo_LoadedDt',
        Expo_SuchulSaupNo,
        Expo_geyak_no1, Expo_geyak_no2, Expo_segwan, Expo_gwa, Expo_total_usd, Expo_total_won,
        Expo_suchulja_sangho, Expo_whaju_sangho,
        ISNULL((SELECT Exlan_egukyk FROM ${_defaultDB}.[kcba].[Expo2] WITH (NOLOCK) WHERE Expo_key = Exlan_key AND Exlan_lan = '001'), '') AS 'exlanEgukyk',
        Expo_whaju_saup,BFLOADDT,Expo_chamjo_no,Expo_suchulja_code,Expo_whaju_code,Expo_trust_sangho,Expo_trust_code,Expo_trust_saup,
        #{_defaultDB} as 'defaultDB', EXPO_BLNO
        FROM ${_defaultDB}.[kcba].[Expo1] WITH (NOLOCK)
        union all
        SELECT
        Expo_key, Expo_iv_no, Expo_res_result, Expo_gurae_gbn, Expo_jong,
        Expo_singo_no as 'Expo_singo_no',
        rms.dbo.fn_NEW_DATE_VIEW('D1',Expo_singo_date) as 'Expo_singo_date',
        rms.dbo.fn_NEW_DATE_VIEW('D1',Expo_ok_date) as 'Expo_ok_date',
        UserNM, Expo_unsong_type,
        forward_sangho, Expo_gumaeja_sangho, Expo_mokjuk_name, Expo_hanggu_name,
        Expo_indojo, Expo_gyelje_money, Expo_gyelje_input, Expo_pojang_su, Expo_total_jung,
        rms.dbo.fn_NEW_DATE_VIEW('D1',Expo_sunjuk_date) as 'Expo_sunjuk_date',
        expo_Loaded_YN,
        rms.dbo.fn_NEW_DATE_VIEW('D1',expo_LoadedDt) as 'expo_LoadedDt',
        Expo_SuchulSaupNo,
        Expo_geyak_no1, Expo_geyak_no2, Expo_segwan, Expo_gwa, Expo_total_usd, Expo_total_won,
        Expo_suchulja_sangho, Expo_whaju_sangho,
        ISNULL((SELECT Exlan_egukyk FROM ncustoms_ed.[kcba].[Expo2] WITH (NOLOCK) WHERE Expo_key = Exlan_key AND Exlan_lan = '001'), '') AS 'exlanEgukyk',
        Expo_whaju_saup,BFLOADDT,Expo_chamjo_no,Expo_suchulja_code,Expo_whaju_code,Expo_trust_sangho,Expo_trust_code,Expo_trust_saup,
        'ncustoms_ed' as 'defaultDB', EXPO_BLNO
        FROM ncustoms_ed.[kcba].[Expo1] WITH (NOLOCK)
        ) a
        WHERE 1 = 1
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND (a.Expo_SuchulSaupNo IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y') or Expo_whaju_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y'))</when>
                <otherwise>AND (a.Expo_SuchulSaupNo = #{taxNum} or a.Expo_whaju_saup = #{taxNum})</otherwise>
            </choose>
        </if>
        <if test='expoIvNo != null and expoIvNo != ""'>AND (a.Expo_geyak_no1 LIKE '%' + #{expoIvNo} + '%' or a.Expo_geyak_no2 LIKE '%' + #{expoIvNo} + '%')</if>
        <if test='expoSingoNo != null and expoSingoNo != ""'>AND a.Expo_singo_no LIKE '%' + #{expoSingoNo} + '%' /* 수출신고번호 */</if>
        <if test='expoGumaejaSangho != null and expoGumaejaSangho != ""'>AND a.Expo_gumaeja_sangho LIKE '%' + #{expoGumaejaSangho} + '%' /* 구매자상호 */</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Expo_singo_date_Day"'>AND a.Expo_singo_date BETWEEN #{strFromDate} AND #{strToDate} /* 신고일 */</when>
                <when test='_DateType == "Expo_ok_date_Day"'>AND a.Expo_ok_date BETWEEN #{strFromDate} AND #{strToDate} /* 수리일 */</when>
                <when test='_DateType == "expo_LoadedDt_Day"'>AND a.expo_LoadedDt BETWEEN #{strFromDate} AND #{strToDate} /* 선적일 */</when>
                <when test='_DateType == "bfloaddt_Day"'>AND a.BFLOADDT BETWEEN #{strFromDate} AND #{strToDate} /* 출항일자 */</when>
                <when test='_DateType == "expoSunjukDate_Day"'>AND a.Expo_sunjuk_date BETWEEN #{strFromDate} AND #{strToDate} /* 적재의무기한 */</when>
            </choose>
        </if>
        <if test='expoLoadedYn != null and expoLoadedYn != ""'>AND a.expo_Loaded_YN LIKE '%' + #{expoLoadedYn} + '%'</if>
        <if test='expoGeyakNo1 != null and expoGeyakNo1 != ""'>AND a.Expo_geyak_no1 LIKE '%' + #{expoGeyakNo1} + '%'</if>
        <if test='expoGeyakNo2 != null and expoGeyakNo2 != ""'>AND a.Expo_geyak_no2 LIKE '%' + #{expoGeyakNo2} + '%'</if>
        <if test='expoSegwan != null and expoSegwan != ""'>AND a.Expo_segwan = #{expoSegwan}</if>
        <if test='expoGroupSegwan != null and expoGroupSegwan != ""'>
            <choose>
                <when test='expoGroupSegwan == "경기"'>AND a.Expo_segwan in (012,014,021,131)</when>
                <when test='expoGroupSegwan == "구미"'>AND a.Expo_segwan in (120,121)</when>
                <when test='expoGroupSegwan == "대전"'>AND a.Expo_segwan in (080,081,082,150)</when>
                <when test='expoGroupSegwan == "부산"'>AND a.Expo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='expoGroupSegwan == "서울"'>AND a.Expo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='expoGroupSegwan == "여수"'>AND a.Expo_segwan in (060,062,070,071)</when>
                <when test='expoGroupSegwan == "울산"'>AND a.Expo_segwan in (110,122)</when>
                <when test='expoGroupSegwan == "인천"'>AND a.Expo_segwan in (013,020,023,040,041)</when>
                <when test='expoGroupSegwan == "창원"'>AND a.Expo_segwan in (050,052,053,056)</when>
                <when test='expoGroupSegwan == "천안"'>AND a.Expo_segwan in (152)</when>
                <when test='expoGroupSegwan == "청주"'>AND a.Expo_segwan in (151,153)</when>
                <when test='expoGroupSegwan == "파주"'>AND a.Expo_segwan in (017)</when>
                <when test='expoGroupSegwan == "평택"'>AND a.Expo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='expoGwa != null and expoGwa != ""'>AND a.Expo_gwa LIKE '%' + #{expoGwa} + '%'</if>
        <if test='expoChamjoNo != null and expoChamjoNo != ""'>AND a.Expo_chamjo_no LIKE '%' + #{expoChamjoNo} + '%'</if>
        <if test='expoSuchuljaSangho != null and expoSuchuljaSangho != ""'>AND a.Expo_suchulja_sangho LIKE '%' + #{expoSuchuljaSangho} + '%'</if>
        <if test='expoSuchuljaCode != null and expoSuchuljaCode != ""'>AND a.Expo_suchulja_code LIKE '%' + #{expoSuchuljaCode} + '%'</if>
        <if test='expoSuchulSaupNo != null and expoSuchulSaupNo != ""'>AND a.Expo_SuchulSaupNo LIKE '%' + #{expoSuchulSaupNo} + '%'</if>
        <if test='expoWhajuSangho != null and expoWhajuSangho != ""'>AND a.Expo_whaju_sangho LIKE '%' + #{expoWhajuSangho} + '%'</if>
        <if test='expoWhajuCode != null and expoWhajuCode != ""'>AND a.Expo_whaju_code LIKE '%' + #{expoWhajuCode} + '%'</if>
        <if test='expoWhajuSaup != null and expoWhajuSaup != ""'>AND a.Expo_whaju_saup LIKE '%' + #{expoWhajuSaup} + '%'</if>
        <if test='expoTrustSangho != null and expoTrustSangho != ""'>AND a.Expo_trust_sangho LIKE '%' + #{expoTrustSangho} + '%'</if>
        <if test='expoTrustCode != null and expoTrustCode != ""'>AND a.Expo_trust_code LIKE '%' + #{expoTrustCode} + '%'</if>
        <if test='expoTrustSaup != null and expoTrustSaup != ""'>AND a.Expo_trust_saup LIKE '%' + #{expoTrustSaup} + '%'</if>
    </select>

    <select id="selectExportDeclarationDetailList" resultType="map">
        /* 수출 통관정보 Declaration 디테일 조회 */
        SELECT datas.*
        FROM (
	        SELECT ROW_NUMBER() OVER (ORDER BY a.ExacKey, a.ExLan) AS 'rownum',
	        a.ExacKey as 'Exlan_key', a.ExLan as 'Exlan_lan', a.ExLanHsCode as 'Exlan_hs', a.ExLanGuraeNm as 'Exlan_egukyk', a.ExlanIvNo as 'Exlan_whan_jepum',
	        a.ExLanPay as 'Exlan_gyelje_gum', a.ExLanPoJangSu as 'Exlan_pojang_su', a.ExLanPoJangUnit as 'Exlan_pojang_danwi', a.ExLanJung as 'Exlan_jung',
	        a.ExlanFobUsd as 'Exlan_fob_usd', a.ExlanFobWon as 'Exlan_fob_won'
	        FROM CPS.dbo.EXAC120 a WITH (NOLOCK)
	        WHERE a.ExacKey = #{exlanKey} /* Exlan_key(PK) */
	        and a.UseYn = 'Y'
	        <if test='exlanLan != null and exlanLan != ""'>AND a.ExLan = #{expoKey} /* Exlan_lan(PK) */</if>
	        union all
	        SELECT ROW_NUMBER() OVER (ORDER BY a.Exlan_key, a.Exlan_lan) AS 'rownum',
	        a.Exlan_key, a.Exlan_lan, a.Exlan_hs, a.Exlan_egukyk, a.Exlan_whan_jepum,
	        a.Exlan_gyelje_gum, a.Exlan_pojang_su, a.Exlan_pojang_danwi, a.Exlan_jung,
	        a.Exlan_fob_usd, a.Exlan_fob_won
	        FROM ncustoms_ed.[kcba].[Expo2] a WITH (NOLOCK)
	        WHERE a.Exlan_key = #{exlanKey} /* Exlan_key(PK) */
	        <if test='exlanLan != null and exlanLan != ""'>AND a.Exlan_lan = #{expoKey} /* Exlan_lan(PK) */</if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectExportDeclarationDetailListBack" resultType="map">
        /* 수출 통관정보 Declaration 디테일 조회 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.Exlan_key, a.Exlan_lan) AS 'rownum',
        a.Exlan_key, a.Exlan_lan, a.Exlan_hs, a.Exlan_egukyk, a.Exlan_whan_jepum,
        a.Exlan_gyelje_gum, a.Exlan_pojang_su, a.Exlan_pojang_danwi, a.Exlan_jung,
        a.Exlan_fob_usd, a.Exlan_fob_won
        FROM ${_defaultDB}.[kcba].[Expo2] a WITH (NOLOCK)
        WHERE a.Exlan_key = #{exlanKey} /* Exlan_key(PK) */
        <if test='exlanLan != null and exlanLan != ""'>AND a.Exlan_lan = #{expoKey} /* Exlan_lan(PK) */</if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectExportDeclarationSubDetailList" resultType="map">
        /* 수출 통관정보 Declaration 서브디테일 조회 */
        SELECT datas.*
        FROM (
	        SELECT ROW_NUMBER() OVER (ORDER BY a.ExacKey, a.ExPumLan, a.ExPumLine) AS 'rownum',
	        a.ExacKey as 'Expum_key', a.ExPumLan as 'Expum_lan', a.ExPumLine as 'Expum_haeng', a.ExPumGukyk1 as 'Expum_pum_a', a.ExPumSu as 'Expum_su', a.ExPumSuUnit as 'Expum_su_danwi',
	        a.ExPumDanga as 'Expum_danga', a.ExPumAmt as 'Expum_gyelje_gum', a.ExPumGukyk2 as 'Expum_pum_b', a.ExPumGukyk3 as 'Expum_pum_c', a.ExPumGukyk4 as 'Expum_pum_d', a.ExPumGukyk5 as 'Expum_pum_e',
	        a.ExPumGukyk6 as 'Expum_pum_f', a.ExPumGukyk7 as 'Expum_pum_g', a.ExPumGukyk8 as 'Expum_pum_h', a.ExPumSungbun1 as 'Expum_sungbun_a', a.ExPumSungbun2 as 'Expum_sungbun_b'
	        FROM CPS.dbo.EXAC110 a WITH (NOLOCK)
	        WHERE a.ExacKey = #{expumKey} /* Expum_key(PK) */
	        and a.UseYn = 'Y'
	        <if test='expumLan != null and expumLan != ""'>AND a.ExPumLan = #{expumLan} /* Expum_lan(PK) */</if>
	        <if test='expumHaeng != null and expumHaeng != ""'>AND a.ExPumLine = #{expumHaeng} /* Expum_haeng(PK) */</if>
	        union all
	        SELECT ROW_NUMBER() OVER (ORDER BY a.Expum_key, a.Expum_lan, a.Expum_haeng) AS 'rownum',
	        a.Expum_key, a.Expum_lan, a.Expum_haeng, a.Expum_pum_a, a.Expum_su, a.Expum_su_danwi,
	        a.Expum_danga, a.Expum_gyelje_gum, a.Expum_pum_b, a.Expum_pum_c, a.Expum_pum_d, a.Expum_pum_e,
	        a.Expum_pum_f, a.Expum_pum_g, a.Expum_pum_h, a.Expum_sungbun_a, a.Expum_sungbun_b
	        FROM ncustoms_ed.[kcba].[Expo3] a WITH (NOLOCK)
	        WHERE a.Expum_key = #{expumKey} /* Expum_key(PK) */
	        <if test='expumLan != null and expumLan != ""'>AND a.Expum_lan = #{expumLan} /* Expum_lan(PK) */</if>
	        <if test='expumHaeng != null and expumHaeng != ""'>AND a.Expum_haeng = #{expumHaeng} /* Expum_haeng(PK) */</if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectExportDeclarationSubDetailListBack" resultType="map">
        /* 수출 통관정보 Declaration 서브디테일 조회 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.Expum_key, a.Expum_lan, a.Expum_haeng) AS 'rownum',
        a.Expum_key, a.Expum_lan, a.Expum_haeng, a.Expum_pum_a, a.Expum_su, a.Expum_su_danwi,
        a.Expum_danga, a.Expum_gyelje_gum, a.Expum_pum_b, a.Expum_pum_c, a.Expum_pum_d, a.Expum_pum_e,
        a.Expum_pum_f, a.Expum_pum_g, a.Expum_pum_h, a.Expum_sungbun_a, a.Expum_sungbun_b
        FROM ${_defaultDB}.[kcba].[Expo3] a WITH (NOLOCK)
        WHERE a.Expum_key = #{expumKey} /* Expum_key(PK) */
        <if test='expumLan != null and expumLan != ""'>AND a.Expum_lan = #{expumLan} /* Expum_lan(PK) */</if>
        <if test='expumHaeng != null and expumHaeng != ""'>AND a.Expum_haeng = #{expumHaeng} /* Expum_haeng(PK) */</if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectExpoStatisticList" resultType="map" fetchSize="100">
        /* 수출 통계 조회 */
        SELECT
        *
        FROM rms.dbo.ED_EXPT_V_COM
        <where>
            and ExpoSingoNo !=''
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ExpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND ExpoGumaejaSangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_singo_no != null and expo_singo_no != ""'>AND ExpoSingoNo LIKE '%' + #{expo_singo_no} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND OwnGodsNm LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='expo_mokjuk_code != null and expo_mokjuk_code != ""'>AND ExpoMokjukCd LIKE '%' + #{expo_mokjuk_code} + '%'</if>
	        <if test='expo_bl_no != null and expo_bl_no != ""'>AND ExpoBlNo LIKE '%' + #{expo_bl_no} + '%'</if>
	        <if test='invoiceNo != null and invoiceNo != ""'>AND (InvNo1 LIKE '%' + #{invoiceNo} + '%' or InvNo2 LIKE '%' + #{invoiceNo} + '%')</if>
	        <if test='exlan_hs != null and exlan_hs != ""'>AND ExpoSingoNo in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_LAN where ExlanHs LIKE '%' + #{exlan_hs} + '%')</if>
	        <if test='exlan_lan != null and exlan_lan != ""'>AND ExpoSingoNo in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_LAN where ExlanLan LIKE '%' + #{exlan_lan} + '%')</if>
	        <if test='expum_jepum_code != null and expum_jepum_code != ""'>AND ExpoSingoNo in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_HNG where ExpumJepumCode LIKE '%' + #{expum_jepum_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by ExpoOkDt
    </select>

    <select id="selectExpoStatisticListCount" resultType="map">
        /* 수출 통계 조회 */
        SELECT
        count(KeyEdExptView) as 'COUNT'
        FROM rms.dbo.ED_EXPT_V_COM
        <where>
            and ExpoSingoNo !=''
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ExpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND ExpoGumaejaSangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_singo_no != null and expo_singo_no != ""'>AND ExpoSingoNo LIKE '%' + #{expo_singo_no} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND OwnGodsNm LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='expo_mokjuk_code != null and expo_mokjuk_code != ""'>AND ExpoMokjukCd LIKE '%' + #{expo_mokjuk_code} + '%'</if>
	        <if test='expo_bl_no != null and expo_bl_no != ""'>AND ExpoBlNo LIKE '%' + #{expo_bl_no} + '%'</if>
	        <if test='invoiceNo != null and invoiceNo != ""'>AND (InvNo1 LIKE '%' + #{invoiceNo} + '%' or InvNo2 LIKE '%' + #{invoiceNo} + '%')</if>
	        <if test='exlan_hs != null and exlan_hs != ""'>AND ExpoSingoNo in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_LAN where ExlanHs LIKE '%' + #{exlan_hs} + '%')</if>
	        <if test='exlan_lan != null and exlan_lan != ""'>AND ExpoSingoNo in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_LAN where ExlanLan LIKE '%' + #{exlan_lan} + '%')</if>
	        <if test='expum_jepum_code != null and expum_jepum_code != ""'>AND ExpoSingoNo in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_HNG where ExpumJepumCode LIKE '%' + #{expum_jepum_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectExpoStatisticLanList" resultType="map" fetchSize="100">
        /* 수출 란 통계 조회 */
        SELECT *
        FROM rms.dbo.ED_EXPT_V_LAN
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ExpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND ExpoGumaejaSangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_singo_no != null and expo_singo_no != ""'>AND ExpoSingoNo LIKE '%' + #{expo_singo_no} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND OwnGodsNm LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='invoiceNo != null and invoiceNo != ""'>AND (ExpoGeyakNo1 LIKE '%' + #{invoiceNo} + '%' or ExpoGeyakNo2 LIKE '%' + #{invoiceNo} + '%')</if>
	        <if test='exlan_hs != null and exlan_hs != ""'>AND ExlanHs LIKE '%' +  #{exlan_hs} + '%'</if>
	        <if test='exlan_lan != null and exlan_lan != ""'>AND ExlanLan = #{exlan_lan}</if>
	        <if test='expo_bl_no != null and expo_bl_no != ""'>AND ExpoBlNo LIKE '%' + #{expo_bl_no} + '%'</if>
	        <if test='expo_mokjuk_code != null and expo_mokjuk_code != ""'>AND ExpoSingoNo  in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_COM where ExpoMokjukCd LIKE '%' + #{expo_mokjuk_code} + '%')</if>
	        <if test='expum_jepum_code != null and expum_jepum_code != ""'>AND ExpoSingoNo+ExlanLan in (select ExpoSingoNo+ExlanLan FROM rms.dbo.ED_EXPT_V_HNG where ExpumJepumCode LIKE '%' + #{expum_jepum_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by ExpoOkDt, ExlanLan
    </select>

    <select id="selectExpoStatisticLanListCount" resultType="map">
        /* 수출 란 통계 조회 */
        SELECT
        count(KeyEdExptViewLan) as 'COUNT'
        FROM rms.dbo.ED_EXPT_V_LAN
        <where>
	        1 = 1
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ExpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND ExpoGumaejaSangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_singo_no != null and expo_singo_no != ""'>AND ExpoSingoNo LIKE '%' + #{expo_singo_no} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND OwnGodsNm LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='invoiceNo != null and invoiceNo != ""'>AND (ExpoGeyakNo1 LIKE '%' + #{invoiceNo} + '%' or ExpoGeyakNo2 LIKE '%' + #{invoiceNo} + '%')</if>
	        <if test='exlan_hs != null and exlan_hs != ""'>AND ExlanHs = #{exlan_hs}</if>
	        <if test='exlan_lan != null and exlan_lan != ""'>AND ExlanLan = #{exlan_lan}</if>
	        <if test='expo_bl_no != null and expo_bl_no != ""'>AND ExpoBlNo LIKE '%' + #{expo_bl_no} + '%'</if>
	        <if test='expo_mokjuk_code != null and expo_mokjuk_code != ""'>AND ExpoSingoNo  in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_COM where ExpoMokjukCd LIKE '%' + #{expo_mokjuk_code} + '%')</if>
	        <if test='expum_jepum_code != null and expum_jepum_code != ""'>AND ExpoSingoNo+ExlanLan in (select ExpoSingoNo+ExlanLan FROM rms.dbo.ED_EXPT_V_HNG where ExpumJepumCode LIKE '%' + #{expum_jepum_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectExpoStatisticItemList" resultType="map" fetchSize="100">
        /* 수출 행 통계 조회 */
        SELECT *
        FROM rms.dbo.ED_EXPT_V_HNG
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ExpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND ExpoGumaejaSangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_singo_no != null and expo_singo_no != ""'>AND ExpoSingoNo LIKE '%' + #{expo_singo_no} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND OwnGodsNm LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='invoiceNo != null and invoiceNo != ""'>AND (ExpoGeyakNo1 LIKE '%' + #{invoiceNo} + '%' or ExpoGeyakNo2 LIKE '%' + #{invoiceNo} + '%')</if>
	        <if test='exlan_hs != null and exlan_hs != ""'>AND ExlanHs LIKE '%' + #{exlan_hs} + '%'</if>
	        <if test='exlan_lan != null and exlan_lan != ""'>AND ExlanLan = #{exlan_lan}</if>
	        <if test='expo_bl_no != null and expo_bl_no != ""'>AND ExpoBlNo LIKE '%' + #{expo_bl_no} + '%'</if>
	        <if test='expum_jepum_code != null and expum_jepum_code != ""'>AND ExpumJepumCode LIKE '%' + #{expum_jepum_code} + '%'</if>
	        <if test='expo_mokjuk_code != null and expo_mokjuk_code != ""'>AND ExpoSingoNo  in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_COM where ExpoMokjukCd LIKE '%' + #{expo_mokjuk_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by ExpoOkDt, ExlanHs, ExpumHeang
    </select>

    <select id="selectExpoStatisticItemListCount" resultType="map">
        /* 수출 행 통계 조회 */
        SELECT
        count(KeyEdExptViewHng) as 'COUNT'
        FROM rms.dbo.ED_EXPT_V_HNG
        <where>
	        1 = 1
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ExpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND ExpoGumaejaSangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_singo_no != null and expo_singo_no != ""'>AND ExpoSingoNo LIKE '%' + #{expo_singo_no} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND OwnGodsNm LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='invoiceNo != null and invoiceNo != ""'>AND (ExpoGeyakNo1 LIKE '%' + #{invoiceNo} + '%' or ExpoGeyakNo2 LIKE '%' + #{invoiceNo} + '%')</if>
	        <if test='exlan_hs != null and exlan_hs != ""'>AND ExlanHs = #{exlan_hs}</if>
	        <if test='exlan_lan != null and exlan_lan != ""'>AND ExlanLan = #{exlan_lan}</if>
	        <if test='expo_bl_no != null and expo_bl_no != ""'>AND ExpoBlNo LIKE '%' + #{expo_bl_no} + '%'</if>
	        <if test='expum_jepum_code != null and expum_jepum_code != ""'>AND ExpumJepumCode LIKE '%' + #{expum_jepum_code} + '%'</if>
	        <if test='expo_mokjuk_code != null and expo_mokjuk_code != ""'>AND ExpoSingoNo  in (select ExpoSingoNo FROM rms.dbo.ED_EXPT_V_COM where ExpoMokjukCd LIKE '%' + #{expo_mokjuk_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectExpoTeukStatisticList" resultType="map">
        /* 특송 수출 통계 조회 */
        select
		Expo_ok_date
		, Expo_suchulja_sangho
		, rms.dbo.fn_SINGO_NO_VIEW('E',Expo_singo_no) as 'Expo_singo_no'
		, Expo_mokjuk_code
		, Expo_gumaeja_sangho
		, Expo_gurae_gbn
		, Expo_total_jung
		, Expo_pojang_su
		, Expo_jung_danwi
		, Expo_hanggu_name
		, Expo_gyelje
		, Expo_gyelje_money
		, Expo_gyelje_input
		, Expo_gyelje_exch
		, Expo_total_usd
		, Expo_total_won
		, expo_suchulja_tong
		, EXPO_BLNO
		, rms.dbo.fn_NEW_DATE_VIEW('D1',Expo_ok_date) as 'expo_ok_date1'
		 FROM  ncustoms_ed.kcba.expo1
        <where>
            and Expo_SuChulJa_code = 'ELS'
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND Expo_ok_date BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND Expo_gumaeja_sangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND Expo_suchulja_sangho LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='expo_mokjuk_code != null and expo_mokjuk_code != ""'>AND Expo_mokjuk_code LIKE '%' + #{expo_mokjuk_code} + '%'</if>
        </where>
        order by Expo_ok_date
    </select>

    <select id="selectExpoTeukStatisticLanList" resultType="map">
        /* 특송 수출 란 통계 조회 */
        SELECT
        a.Expo_ok_date
		, a.Expo_suchulja_sangho
		, rms.dbo.fn_SINGO_NO_VIEW('E',a.Expo_singo_no) as 'Expo_singo_no'
		, a.Expo_mokjuk_code
		, a.Expo_gumaeja_sangho
		, b.Exlan_lan
		, b.Exlan_hs
		, b.exlan_wonsanji
		, b.Exlan_jung
		, b.Exlan_su
		, b.Exlan_fob_usd
		, b.Exlan_fob_won
		, b.Exlan_imposingono
		, b.Exlan_impolanno
		, a.EXPO_BLNO
        , rms.dbo.fn_NEW_DATE_VIEW('D1',a.Expo_ok_date) as 'expo_ok_date1'
        FROM ncustoms_ed.kcba.expo1 a, ncustoms_ed.kcba.expo2 b
        <where>
	        and a.Expo_SuChulJa_code = 'ELS'
			and a.expo_key = b.exlan_key
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.Expo_ok_date BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND a.Expo_gumaeja_sangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND a.Expo_suchulja_sangho LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='exlan_hs != null and exlan_hs != ""'>AND b.Exlan_hs = #{exlan_hs}</if>
	        <if test='exlan_lan != null and exlan_lan != ""'>AND b.Exlan_lan = #{exlan_lan}</if>
        </where>
        order by Expo_ok_date
    </select>

    <select id="selectExpoTeukStatisticItemList" resultType="map">
        /* 특송 수출 행 통계 조회 */
        select
		a.Expo_ok_date
		, a.Expo_suchulja_sangho
		, rms.dbo.fn_SINGO_NO_VIEW('E',a.Expo_singo_no) as 'Expo_singo_no'
		, a.Expo_mokjuk_code
		, a.Expo_gumaeja_sangho
		, b.Exlan_lan
		, b.Exlan_hs
		, b.exlan_wonsanji
		, b.Exlan_jung
		, b.Exlan_su
		, b.Exlan_fob_usd
		, b.Exlan_fob_won
		, b.Exlan_imposingono
		, b.Exlan_impolanno
		, c.Expum_haeng
		, c.Expum_pum_a
		, c.Expum_pum_b
		, c.Expum_pum_c
		, c.Expum_su_danwi
		, c.Expum_su
		, c.Expum_danga
		, c.Expum_gyelje_gum
		, a.EXPO_BLNO
		, rms.dbo.fn_NEW_DATE_VIEW('D1',a.Expo_ok_date) as 'expo_ok_date1'
		 FROM  ncustoms_ed.kcba.expo1 a, ncustoms_ed.kcba.expo2 b, ncustoms_ed.kcba.expo3 c
        <where>
	        and a.Expo_SuChulJa_code = 'ELS'
			and a.expo_key = b.exlan_key
			and a.expo_key = c.Expum_key
			and b.Exlan_lan = c.Expum_lan
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.Expo_ok_date BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='expo_gumaeja_sangho != null and expo_gumaeja_sangho != ""'>AND a.Expo_gumaeja_sangho LIKE '%' + #{expo_gumaeja_sangho} + '%'</if>
	        <if test='expo_whaju_sangho != null and expo_whaju_sangho != ""'>AND a.Expo_suchulja_sangho LIKE '%' + #{expo_whaju_sangho} + '%'</if>
	        <if test='exlan_hs != null and exlan_hs != ""'>AND b.Exlan_hs = #{exlan_hs}</if>
	        <if test='exlan_lan != null and exlan_lan != ""'>AND b.Exlan_lan = #{exlan_lan}</if>
	        <if test='expum_jepum_code != null and expum_jepum_code != ""'>AND c.Expum_pum_a LIKE '%' + #{expum_jepum_code} + '%'</if>
        </where>
        order by Expo_ok_date
    </select>

    <select id="selectImpoCountCheck" resultType="map">
        /* 원상태계산시 수입수량 체크 */
        select
		c.IMPT_ORDR_MNG_NO
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c
		where a.useYn = 'Y'
		    and b.useYn = 'Y'
		    and c.useYn = 'Y'
            and (a.checkYn != '0' or a.checkYn is null)
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.LAN = b.LAN
			and a.RMID_QTY != '0'
			AND a.ITEM_CD = #{PROD_CD}
			AND b.ORIG =#{ORIG}
			AND c.DECL_CMPL_DTTM <![CDATA[ > ]]> #{CheckDate}
    </select>

    <select id="selectSeyulCheck" resultType="map">
        /* 원상태수량계산 세율체크 */
        select k.Imlan_gwan_seyulc from (
	        select a.Imlan_gwan_seyulc
	        from ncustoms_ed.kcba.impo2 a, ncustoms_ed.kcba.impo3 b, ncustoms_ed.kcba.impo1 c
			where a.imlan_key=b.impum_key
			and a.imlan_jechl_lan = b.impum_lan
			and a.imlan_key = c.impo_key
			and a.Imlan_gwan_seyulc <![CDATA[ > ]]> 0
			and b.impum_jajae_code = #{PROD_CD}
			and c.impo_ok_date <![CDATA[ > ]]> #{CheckDate}
			union all
			select a.ImLanTaxRate as 'Imlan_gwan_seyulc'
			from CPS.dbo.IMAC120 a, CPS.dbo.IMAC110 b, CPS.dbo.IMAC100 c
			where a.ImKey = b.ImKey
			and a.ImLan = b.ImPumLan
			and a.ImKey = c.ImKey
			and a.UseYn = 'Y'
			and b.UseYn = 'Y'
			and c.UseYn = 'Y'
			and a.ImLanTaxRate <![CDATA[ > ]]> 0
			and b.ImPumModelCode = #{PROD_CD}
			and left(c.ImOkDtm,8) <![CDATA[ > ]]> #{CheckDate}
		) k
		group by k.Imlan_gwan_seyulc
    </select>

    <select id="selectSeyulCheckBack" resultType="map">
        /* 원상태수량계산 세율체크 */
        select k.Imlan_gwan_seyulc from (
	        select a.Imlan_gwan_seyulc from ncustoms_ed.kcba.impo2 a, ncustoms_ed.kcba.impo3 b, ncustoms_ed.kcba.impo1 c
			where a.imlan_key=b.impum_key
			and a.imlan_jechl_lan = b.impum_lan
			and a.imlan_key = c.impo_key
			and a.Imlan_gwan_seyulc <![CDATA[ > ]]> 0
			and b.impum_jajae_code = #{PROD_CD}
			and c.impo_ok_date <![CDATA[ > ]]> #{CheckDate}
			union all
			select a.Imlan_gwan_seyulc from ncustoms_ca.kcba.impo2 a, ncustoms_ca.kcba.impo3 b, ncustoms_ca.kcba.impo1 c
			where a.imlan_key=b.impum_key
			and a.imlan_jechl_lan = b.impum_lan
			and a.imlan_key = c.impo_key
			and a.Imlan_gwan_seyulc <![CDATA[ > ]]> 0
			and b.impum_jajae_code = #{PROD_CD}
			and c.impo_ok_date <![CDATA[ > ]]> #{CheckDate}
		) k
		group by k.Imlan_gwan_seyulc
    </select>

    <select id="selectWonsanjiCheck" resultType="map">
        /* 원상태수량계산 원산지체크 */
        select k.imlan_wonsanji_code from (
	        select a.imlan_wonsanji_code
	        from ncustoms_ed.kcba.impo2 a, ncustoms_ed.kcba.impo3 b, ncustoms_ed.kcba.impo1 c
			where a.imlan_key=b.impum_key
			and a.imlan_jechl_lan = b.impum_lan
			and a.imlan_key = c.impo_key
			and b.impum_jajae_code=#{PROD_CD}
			and c.impo_ok_date <![CDATA[ > ]]> #{CheckDate}
			union all
			select a.ImLanWonsangiCode as 'imlan_wonsanji_code'
			from CPS.dbo.IMAC120 a, CPS.dbo.IMAC110 b, CPS.dbo.IMAC100 c
			where a.ImKey=b.ImKey
			and a.ImLan = b.ImPumLan
			and a.ImKey = c.ImKey
			and a.UseYn = 'Y'
			and b.UseYn = 'Y'
			and c.UseYn = 'Y'
			and b.ImPumModelCode=#{PROD_CD}
			and left(c.ImOkDtm,8) <![CDATA[ > ]]> #{CheckDate}
		) k
		group by k.imlan_wonsanji_code
    </select>

    <select id="selectWonsanjiCheckBack" resultType="map">
        /* 원상태수량계산 원산지체크 */
        select k.imlan_wonsanji_code from (
	        select a.imlan_wonsanji_code from ncustoms_ed.kcba.impo2 a, ncustoms_ed.kcba.impo3 b, ncustoms_ed.kcba.impo1 c
			where a.imlan_key=b.impum_key
			and a.imlan_jechl_lan = b.impum_lan
			and a.imlan_key = c.impo_key
			and b.impum_jajae_code=#{PROD_CD}
			and c.impo_ok_date <![CDATA[ > ]]> #{CheckDate}
			union all
			select a.imlan_wonsanji_code from ncustoms_ca.kcba.impo2 a, ncustoms_ca.kcba.impo3 b, ncustoms_ca.kcba.impo1 c
			where a.imlan_key=b.impum_key
			and a.imlan_jechl_lan = b.impum_lan
			and a.imlan_key = c.impo_key
			and b.impum_jajae_code=#{PROD_CD}
			and c.impo_ok_date <![CDATA[ > ]]> #{CheckDate}
		) k
		group by k.imlan_wonsanji_code
    </select>

    <select id="selectCoNo" resultType="map">
        /* 수출 원산지증명번호 체크 */
        select a.CO_NO, b.ITEM_CD
        from rms.dbo.ED_CO_MST a, rms.dbo.ED_CO_DTL b
        <where>
			and a.CO_ORDR_MNG_NO = b.CO_ORDR_MNG_NO
			and a.EXIM_DIV = #{EXIM_DIV}
			and a.PROC_STAT='07001'
			and b.ITEM_CD = #{ITEM_CD}
			and a.useYn = 'Y'
			and b.useYn = 'Y'
			<if test='FRGN_COMP_CD != null and FRGN_COMP_CD != ""'>AND a.FRGN_COMP_CD = #{FRGN_COMP_CD}</if>
			<if test='FTA_CD != null and FTA_CD != ""'>AND a.FTA_CD = #{FTA_CD}</if>
		</where>
    </select>

    <select id="selectRcmdInfo" resultType="map">
        /* 추천정보 매핑 */
        select b.EXEM_MNG_NO, b.RCMD_NO
        from rms.dbo.ED_EXEM_RCMD_INFO a, rms.dbo.ED_EXEM_RCMD_INFO_DTL b
        <where>
        and a.useYn='Y'
        and b.useYn='Y'
        and a.EXEM_MNG_NO = b.EXEM_MNG_NO
        and a.COMP_CD = b.COMP_CD
        and a.USE_FG = 'Y'
        and a.COMP_CD = #{COMP_CD}
        and b.ITEM_CD = #{ITEM_CD}
		</where>
    </select>

    <insert id="insertDemdCodeItem">
		INSERT INTO rms.dbo.ED_EXEM_DEMD_PLAN_ITEM
		       ([GRP_COMP_CD],
				[EXEM_PLAN_MNG_NO],
				[ITEM_CD],
				[ITEM_NM],
				[Mcount_No],
				[STAT],
				[RCMD_NO],
				[QTY],
				[USE_QTY],
				[RMID_QTY],
				[RCMD_FG],
				[EXEM_MNG_NO],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm]
				)
		VALUES
		       (#{GRP_COMP_CD},
				#{EXEM_PLAN_MNG_NO},
				#{ITEM_CD},
				#{ITEM_NM},
				#{Mcount_No},
				#{STAT},
				#{RCMD_NO},
				#{QTY},
				#{USE_QTY},
				#{RMID_QTY},
				#{RCMD_FG},
				#{EXEM_MNG_NO},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm})
	</insert>

    <update id="updateExpoInv2">
		UPDATE	rms.dbo.ED_EXPT_INV
		<trim prefix="SET" suffixOverrides=",">
		    <if test='STAT != null'>STAT = #{STAT} ,</if>
		    <if test='ORIG_STAT_OBJ_FG != null'>ORIG_STAT_OBJ_FG = #{ORIG_STAT_OBJ_FG} ,</if>
		    <if test='ORIG_STAT_OBJ != null'>ORIG_STAT_OBJ = #{ORIG_STAT_OBJ} ,</if>
		    <if test='INDV_REFN_FG != null'>INDV_REFN_FG = #{INDV_REFN_FG} ,</if>
		    <if test='PROD_CD != null'>PROD_CD = #{PROD_CD} ,</if>
		    <if test='PROD_NM != null'>PROD_NM = #{PROD_NM} ,</if>
		    <if test='McountNo != null'>Mcount_No = #{McountNo} ,</if>
		    <if test='QTY != null'>QTY = #{QTY} ,</if>
		    <if test='ORIG_STAT_QTY != null'>ORIG_STAT_QTY = #{ORIG_STAT_QTY} ,</if>
		    <if test='ORIG_STAT_QTY != null'>ORIG_QTY = #{ORIG_STAT_QTY} ,</if>
		    <if test='NOT_ORIG_STAT_QTY != null'>NOT_ORIG_STAT_QTY = #{NOT_ORIG_STAT_QTY} ,</if>
		    <if test='AMT_PRICE != null'>AMT_PRICE = #{AMT_PRICE} ,</if>
		    <if test='AMT != null'>AMT = #{AMT} ,</if>
		    <if test='ORIG != null'>ORIG = #{ORIG} ,</if>
		    <if test='HS_CD != null'>HS_CD = #{HS_CD} ,</if>
		    <if test='APLY_PACT != null'>APLY_PACT = #{APLY_PACT} ,</if>
		    <if test='ORIG_PACT != null'>ORIG_PACT = #{ORIG_PACT} ,</if>
		    <if test='SERIAL_NO != null'>SERIAL_NO = #{SERIAL_NO} ,</if>
		    <if test='INV_CO_NO != null'>INV_CO_NO = #{INV_CO_NO} ,</if>
		    <if test='ORIG_CERT_FG != null'>ORIG_CERT_FG = #{ORIG_CERT_FG} ,</if>
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
		    <if test='QTY_UNIT != null'>QTY_UNIT = #{QTY_UNIT} ,</if>
		    <if test='Expum_pum_b != null'>Expum_pum_b = #{Expum_pum_b} ,</if>
		    <if test='Expum_pum_c != null'>Expum_pum_c = #{Expum_pum_c} ,</if>
		    <if test='INV_NO != null'>INV_NO = #{INV_NO} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
		and useYn='Y'
	</update>

    <update id="updateExpoInv3">
		UPDATE	rms.dbo.ED_EXPT_INV
		<trim prefix="SET" suffixOverrides=",">
		    <if test='ReQTY != null'>ORIG_STAT_QTY = ORIG_STAT_QTY + #{ReQTY} ,</if>
		    <if test='ReQTY != null'>ORIG_QTY = ORIG_QTY + #{ReQTY} ,</if>
			<if test='ReQTY != null'>NOT_ORIG_STAT_QTY = NOT_ORIG_STAT_QTY - #{ReQTY} ,</if>
			<if test='turnQty != null'>ORIG_STAT_QTY = ORIG_STAT_QTY - #{turnQty} ,</if>
			<if test='turnQty != null'>ORIG_QTY = ORIG_QTY - #{turnQty} ,</if>
			<if test='turnQty != null'>NOT_ORIG_STAT_QTY = NOT_ORIG_STAT_QTY + #{turnQty} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE KEY_ED_EXPT_INV = #{KEY_ED_EXPT_INV}
		and useYn='Y'
	</update>

    <update id="updateExpoInv4">
		UPDATE	rms.dbo.ED_EXPT_INV
		<trim prefix="SET" suffixOverrides=",">
		    <if test='ReQTY != null'>ORIG_STAT_QTY = ORIG_STAT_QTY + #{ReQTY} ,</if>
			<if test='ReQTY != null'>NOT_ORIG_STAT_QTY = NOT_ORIG_STAT_QTY - #{ReQTY} ,</if>
			<if test='ReQTY != null'>ORIG_STAT_OBJ_FG = #{ORIG_STAT_OBJ_FG},</if>
			<if test='ReQTY != null'>ORIG_STAT_OBJ = #{ORIG_STAT_OBJ},</if>
			<if test='ExEmNo != null'>ExEmNo = #{ExEmNo} ,</if>
			<if test='SoNo != null'>SoNo = #{SoNo} ,</if>
			<if test='EndUserName != null'>EndUserName = #{EndUserName} ,</if>
			<if test='turnQty != null'>ORIG_STAT_QTY = ORIG_STAT_QTY - #{turnQty} ,</if>
			<if test='turnQty != null'>NOT_ORIG_STAT_QTY = NOT_ORIG_STAT_QTY + #{turnQty} ,</if>
			<if test='turnQty != null'>ExEmNo = '' ,</if>
			<if test='turnQty != null'>SoNo = '' ,</if>
			<if test='turnQty != null'>EndUserName = '' ,</if>
			<if test='turnQty != null'>ORIG_STAT_OBJ_FG = #{ORIG_STAT_OBJ_FG},</if>
			<if test='turnQty != null'>ORIG_STAT_OBJ = #{ORIG_STAT_OBJ},</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE KEY_ED_EXPT_INV = #{KEY_ED_EXPT_INV}
		and useYn='Y'
	</update>

    <select id="selectMaxReExpo" resultType="map">
		select
		substring(MAX(ORDR_NO),3,8) as 'max',
		ISNULL(substring(MAX(ORDR_NO),3,10)+1,'') as 'ORDR_NO'
		from rms.dbo.ED_REEXPOBJCLOSE_ORDR
		<where>
		    AND useYn = 'Y'
		</where>
	</select>

    <insert id="insertReExpoMaster">
		INSERT INTO rms.dbo.ED_REEXPOBJCLOSE_ORDR
		       ([GRP_COMP_CD],
				[ORDR_NO],
				[ORDR_DT],
				[JOB_NM],
				[OWN_GODS_CD],
				[OWN_GODS_NM],
				[OWN_GODS_DIVS_MAN],
				[RMRK],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[ImExGbn]
				)
		VALUES
		       (#{GRP_COMP_CD},
				#{ORDR_NO},
				#{ORDR_DT},
				#{JOB_NM},
				#{OWN_GODS_CD},
				#{OWN_GODS_NM},
				#{OWN_GODS_DIVS_MAN},
				#{RMRK},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{ImExGbn})
	</insert>

    <update id="updateReExpoMaster">
		UPDATE	rms.dbo.ED_REEXPOBJCLOSE_ORDR
		<trim prefix="SET" suffixOverrides=",">
		    <if test='GRP_COMP_CD != null'>GRP_COMP_CD = #{GRP_COMP_CD} ,</if>
		    <if test='ORDR_NO != null'>ORDR_NO = #{ORDR_NO} ,</if>
		    <if test='ORDR_DT != null'>ORDR_DT = #{ORDR_DT} ,</if>
		    <if test='JOB_NM != null'>JOB_NM = #{JOB_NM} ,</if>
		    <if test='OWN_GODS_CD != null'>OWN_GODS_CD = #{OWN_GODS_CD} ,</if>
		    <if test='OWN_GODS_NM != null'>OWN_GODS_NM = #{OWN_GODS_NM} ,</if>
		    <if test='OWN_GODS_DIVS_MAN != null'>OWN_GODS_DIVS_MAN = #{OWN_GODS_DIVS_MAN} ,</if>
		    <if test='RMRK != null'>RMRK = #{RMRK} ,</if>
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
			<if test='ImExGbn != null'>ImExGbn = #{ImExGbn} ,</if>
		</trim>
		WHERE KEY_ED_REEXPOBJCLOSE_ORDR = #{KEY_ED_REEXPOBJCLOSE_ORDR}
	</update>

    <select id="selectMaxDtlSeq" resultType="map">
		select
		ISNULL(MAX(DTL_SEQNO)+1,1) as 'max'
		from rms.dbo.ED_REEXPOBJCLOSE_DTL
		<where>
		    AND useYn = 'Y'
		    <if test='ORDR_NO != null'>and ORDR_NO = #{ORDR_NO}</if>
		</where>
	</select>

    <insert id="insertReExpoDetail">
		INSERT INTO rms.dbo.ED_REEXPOBJCLOSE_DTL
		       ([GRP_COMP_CD],
				[ORDR_NO],
				[DTL_SEQNO],
				[IMP_OK_DT],
				[IMPT_DECL_NO],
				[LAN],
				[HNG],
				[QTY],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[BL_NO],
				[ITEM_CD],
				[ITEM_NM]
				)
		VALUES
		       (#{GRP_COMP_CD},
				#{ORDR_NO},
				#{DTL_SEQNO},
				#{IMP_OK_DT},
				#{IMPT_DECL_NO},
				#{LAN},
				#{HNG},
				#{QTY},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{BL_NO},
				#{ITEM_CD},
				#{ITEM_NM})
	</insert>

    <update id="deleteReExpoDetail">
		UPDATE	rms.dbo.ED_REEXPOBJCLOSE_DTL
		<trim prefix="SET" suffixOverrides=",">
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		<where>
		    and 1 = 1
			<if test='KEY_ED_REEXPOBJCLOSE_DTL != null and KEY_ED_REEXPOBJCLOSE_DTL != ""'>AND KEY_ED_REEXPOBJCLOSE_DTL = #{KEY_ED_REEXPOBJCLOSE_DTL}</if>
			<if test='ORDR_NO != null and ORDR_NO != ""'>AND ORDR_NO = #{ORDR_NO}</if>
		</where>
	</update>

    <select id="selectDrawCheck4" resultType="map">
		select top 1 c.*
		from CPS.[dbo].[BSAP190] d,
		(select
		b.Morigin1, b.Mhs_kind, b.Mhs_rate, b.Mconfirm_flag,
		CASE WHEN ISNULL(a.HS_CD,'')='' THEN 'Y'
		ELSE 'N' END AS 'hsCheck',
		a.*
		from rms.dbo.ED_EXPT_INV a left outer join CPS.[dbo].[MAAA100] b
		on a.PROD_CD = b.Mmodel_code
		where a.useYn='Y'
		and b.Mco_com in ('3128112960','1298123036') ) c, rms.dbo.ED_DRAW_MST e
		<where>
		    and d.UseYn = 'Y'
		    and d.hsCode = c.HS_CD
		    and d.Asterisk1YN ='Y'
		    and d.Asterisk2YN ='Y'
		    and d.hsCode = e.hsCode
		    and c.PROD_CD = e.itemCode
		    and c.PROD_CD in ('A50738016','A50739000','C35103000','D39700000','M58805742')
			and c.EXPT_ORDR_MNG_NO=#{EXPT_ORDR_MNG_NO}
			and (c.ExEmNo is null or c.ExEmNo = '')
			<if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>AND c.ORIG_STAT_OBJ = #{ORIG_STAT_OBJ}</if>
			<if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>and convert(INT,c.NOT_ORIG_STAT_QTY) > 0</if>
			<if test='PROD_CD != null and PROD_CD != ""'>AND c.PROD_CD = #{PROD_CD}</if>
			<if test='HS_CD != null and HS_CD != ""'>AND c.HS_CD = #{HS_CD}</if>
		</where>
	</select>

    <select id="selectDrawCheck3" resultType="map">
		select c.*
		from CPS.[dbo].[BSAP190] d,
		(select
		b.Morigin1, b.Mhs_kind, b.Mhs_rate, b.Mconfirm_flag,
		CASE WHEN ISNULL(a.HS_CD,'')='' THEN 'Y'
		ELSE 'N' END AS 'hsCheck',
		a.*
		from rms.dbo.ED_EXPT_INV a left outer join CPS.[dbo].[MAAA100] b
		on a.PROD_CD = b.Mmodel_code
		where a.useYn='Y'
		and b.Mco_com in ('3128112960','1298123036') ) c, rms.dbo.ED_DRAW_MST e
		<where>
		    and d.UseYn = 'Y'
		    and d.hsCode = c.HS_CD
		    and d.Asterisk1YN ='Y'
		    and d.Asterisk2YN ='Y'
		    and d.hsCode = e.hsCode
		    and c.PROD_CD = e.itemCode
		    and e.per = '100'
			and c.EXPT_ORDR_MNG_NO=#{EXPT_ORDR_MNG_NO}
			and (c.ExEmNo is null or c.ExEmNo = '')
			<if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>AND c.ORIG_STAT_OBJ = #{ORIG_STAT_OBJ}</if>
			<if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>and convert(INT,c.NOT_ORIG_STAT_QTY) > 0</if>
			<if test='PROD_CD != null and PROD_CD != ""'>AND c.PROD_CD = #{PROD_CD}</if>
			<if test='HS_CD != null and HS_CD != ""'>AND c.HS_CD = #{HS_CD}</if>
		</where>
	</select>

    <select id="selectDrawCheck2" resultType="map">
		select c.*
		from CPS.[dbo].[BSAP190] d,
		(select
		b.Morigin1, b.Mhs_kind, b.Mhs_rate, b.Mconfirm_flag,
		CASE WHEN ISNULL(a.HS_CD,'')='' THEN 'Y'
		ELSE 'N' END AS 'hsCheck',
		a.*
		from rms.dbo.ED_EXPT_INV a left outer join CPS.[dbo].[MAAA100] b
		on a.PROD_CD = b.Mmodel_code
		where a.useYn='Y'
		and b.Mco_com in ('3128112960','1298123036') ) c, rms.dbo.ED_DRAW_MST e
		<where>
		    and d.UseYn = 'Y'
		    and d.hsCode = c.HS_CD
		    and d.Asterisk1YN ='N'
		    and d.Asterisk2YN ='Y'
		    and d.hsCode = e.hsCode
		    and c.PROD_CD = e.itemCode
			and c.EXPT_ORDR_MNG_NO=#{EXPT_ORDR_MNG_NO}
			and (c.ExEmNo is null or c.ExEmNo = '')
			<if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>AND c.ORIG_STAT_OBJ = #{ORIG_STAT_OBJ}</if>
			<if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>and convert(INT,c.NOT_ORIG_STAT_QTY) > 0</if>
			<if test='PROD_CD != null and PROD_CD != ""'>AND c.PROD_CD = #{PROD_CD}</if>
			<if test='HS_CD != null and HS_CD != ""'>AND c.HS_CD = #{HS_CD}</if>
		</where>
	</select>

    <select id="selectDrawCheck1" resultType="map">
		select c.*
		from CPS.[dbo].[BSAP190] d,
		(select
		b.Morigin1, b.Mhs_kind, b.Mhs_rate, b.Mconfirm_flag,
		CASE WHEN ISNULL(a.HS_CD,'')='' THEN 'Y'
		ELSE 'N' END AS 'hsCheck',
		a.*
		from rms.dbo.ED_EXPT_INV a left outer join CPS.[dbo].[MAAA100] b
		on a.PROD_CD = b.Mmodel_code
		where a.useYn='Y'
		and b.Mco_com in ('3128112960','1298123036') ) c
		<where>
		    and d.UseYn = 'Y'
		    and d.hsCode = c.HS_CD
		    and d.Asterisk1YN ='Y'
			and c.EXPT_ORDR_MNG_NO=#{EXPT_ORDR_MNG_NO}
			and (c.ExEmNo is null or c.ExEmNo = '')
			<if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>AND c.ORIG_STAT_OBJ = #{ORIG_STAT_OBJ}</if>
			<if test='ORIG_STAT_OBJ != null and ORIG_STAT_OBJ != ""'>and convert(INT,c.NOT_ORIG_STAT_QTY) > 0</if>
			<if test='PROD_CD != null and PROD_CD != ""'>AND c.PROD_CD = #{PROD_CD}</if>
			<if test='HS_CD != null and HS_CD != ""'>AND c.HS_CD = #{HS_CD}</if>
		</where>
	</select>

    <select id="selectCheckQty1" resultType="map">
		select
		c.IMPT_ORDR_MNG_NO, a.LAN, a.HNG, a.QTY, a.RMID_QTY, c.IMPT_DECL_NO
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c
		<where>
		    and a.useYn = 'Y'
		    and b.useYn = 'Y'
		    and c.useYn = 'Y'
		    and (a.checkYn != '0' or a.checkYn is null)
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.LAN = b.LAN
			AND c.DECL_CMPL_DT <![CDATA[ >= ]]> #{twoYear}
			AND c.Impo_gyelje != 'GN'
			AND b.EXEM_DIV = 'N'
			and a.RMID_QTY <![CDATA[ > ]]> 0.999
			and c.Impo_gele_gubun = '11'
			and c.Impo_jingsu_type != '14'
			and c.DECL_CMPL_DT != ''
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
            <if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD = #{HS_CD}</if>
            <if test='HS_CD_ALL != null and HS_CD_ALL != ""'>AND b.HS_CD in ${HS_CD_ALL}</if>
            <if test='ORIG != null and ORIG != ""'>AND b.ORIG = #{ORIG}</if>
            <if test='Mhs_rate != null and Mhs_rate != ""'>AND b.Mhs_rate = #{Mhs_rate}</if>
            <if test='Mhs_rateE != null and Mhs_rateE != ""'>AND b.Mhs_rate not in ${Mhs_rateE}</if>
        </where>
        order by c.DECL_CMPL_DT, a.LAN, a.HNG
	</select>

    <select id="selectCheckQty11" resultType="map">
		select
		c.IMPT_ORDR_MNG_NO, a.LAN, a.HNG, a.QTY, a.RMID_QTY, c.IMPT_DECL_NO
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c
		<where>
		    and a.useYn = 'Y'
		    and b.useYn = 'Y'
		    and c.useYn = 'Y'
		    and (a.checkYn != '0' or a.checkYn is null)
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.LAN = b.LAN
			AND c.DECL_CMPL_DT <![CDATA[ >= ]]> #{twoYear}
			AND c.Impo_gyelje != 'GN'
			AND b.EXEM_DIV = 'N'
			and a.RMID_QTY <![CDATA[ > ]]> 0.999
			and c.Impo_gele_gubun = '11'
			and c.Impo_jingsu_type != '14'
			and c.DECL_CMPL_DT != ''
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
            <if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD in ${HS_CD}</if>
            <if test='ORIG != null and ORIG != ""'>AND b.ORIG = #{ORIG}</if>
            <if test='Mhs_rate != null and Mhs_rate != ""'>AND b.Mhs_rate = #{Mhs_rate}</if>
            <if test='Mhs_rateE != null and Mhs_rateE != ""'>AND b.Mhs_rate not in ${Mhs_rateE}</if>
        </where>
        order by c.DECL_CMPL_DT, a.LAN, a.HNG
	</select>

    <select id="selectItemMaster" resultType="map">
		select
		Mcount_no, Mmodel_2+' '+Mmodel_3 as 'Mmodel'
		from CPS.[dbo].[MAAA100]
		<where>
		    and Mco_com in ('3128112960','1298123036')
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND Mmodel_code = #{ITEM_CD}</if>
        </where>
	</select>

    <select id="selectImpoStatisticList" resultType="map" fetchSize="100">
        /* 수입 통계 조회 */
        SELECT
        *
        FROM rms.dbo.ED_IMPT_V_COM
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ImpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND ExpCd LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND ImpoSingoNo LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OwnGodsNm LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND ImpoBlNo LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='impo_jukchl_code != null and impo_jukchl_code != ""'>AND ImpoJukchlCd = #{impo_jukchl_code}</if>
	        <if test='imlan_hs != null and imlan_hs != ""'>AND ImpoBlNo in (select ImpoBlNo FROM rms.dbo.ED_IMPT_V_LAN where ImlanHs LIKE '%' + #{imlan_hs} + '%')</if>
	        <if test='imlan_gwan_gam_buho != null and imlan_gwan_gam_buho != ""'>AND ImpoBlNo in (select ImpoBlNo FROM rms.dbo.ED_IMPT_V_LAN where ImlanGwanGamBuho LIKE '%' + #{imlan_gwan_gam_buho} + '%')</if>
	        <if test='impum_jajae_code != null and impum_jajae_code != ""'>AND ImpoBlNo in (select ImpoBlNo FROM rms.dbo.ED_IMPT_V_HNG where ImpumGukyk1 LIKE '%' + #{impum_jajae_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by ImpoOkDt, ImpoSingoNo
    </select>

    <select id="selectImpoStatisticListCount" resultType="map">
        /* 수입 통계 조회 */
        SELECT
        count(KeyEdImptVcom) as 'COUNT'
        FROM rms.dbo.ED_IMPT_V_COM
        <where>
            1 = 1
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ImpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND ExpCd LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND ImpoSingoNo LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OwnGodsNm LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND ImpoBlNo LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='impo_jukchl_code != null and impo_jukchl_code != ""'>AND ImpoJukchlCd = #{impo_jukchl_code}</if>
	        <if test='imlan_hs != null and imlan_hs != ""'>AND ImpoBlNo in (select ImpoBlNo FROM rms.dbo.ED_IMPT_V_LAN where ImlanHs LIKE '%' + #{imlan_hs} + '%')</if>
	        <if test='imlan_gwan_gam_buho != null and imlan_gwan_gam_buho != ""'>AND ImpoBlNo in (select ImpoBlNo FROM rms.dbo.ED_IMPT_V_LAN where ImlanGwanGamBuho LIKE '%' + #{imlan_gwan_gam_buho} + '%')</if>
	        <if test='impum_jajae_code != null and impum_jajae_code != ""'>AND ImpoBlNo in (select ImpoBlNo FROM rms.dbo.ED_IMPT_V_HNG where ImpumGukyk1 LIKE '%' + #{impum_jajae_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectImpoStatisticLanList" resultType="map" fetchSize="100">
        /* 수입 란 통계 조회 */
        SELECT
        *
        FROM rms.dbo.ED_IMPT_V_LAN
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ImpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND ExpCd LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND ImpoSingoNo LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OwnGodsNm LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND ImpoBlNo LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='imlan_hs != null and imlan_hs != ""'>AND ImlanHs LIKE '%' + #{imlan_hs} + '%'</if>
	        <if test='imlan_gwan_gam_buho != null and imlan_gwan_gam_buho != ""'>AND ImlanGwanGamBuho LIKE '%' + #{imlan_gwan_gam_buho} + '%'</if>
	        <if test='impum_jajae_code != null and impum_jajae_code != ""'>AND ImpoBlNo+ImlanJechlLan in (select ImpoBlNo+ImlanJechlLan FROM rms.dbo.ED_IMPT_V_HNG where ImpumGukyk1 LIKE '%' + #{impum_jajae_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by ImpoOkDt, ImpoSingoNo, ImlanJechlLan
    </select>

    <select id="selectImpoStatisticLanListCount" resultType="map">
        /* 수입 란 통계 조회 */
        SELECT
        count(KeyEdImptVlan) as 'COUNT'
        FROM rms.dbo.ED_IMPT_V_LAN
        <where>
            1 = 1
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ImpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND ExpCd LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND ImpoSingoNo LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OwnGodsNm LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND ImpoBlNo LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='imlan_hs != null and imlan_hs != ""'>AND ImlanHs LIKE '%' + #{imlan_hs} + '%'</if>
	        <if test='imlan_gwan_gam_buho != null and imlan_gwan_gam_buho != ""'>AND ImlanGwanGamBuho LIKE '%' + #{imlan_gwan_gam_buho} + '%'</if>
	        <if test='impum_jajae_code != null and impum_jajae_code != ""'>AND ImpoBlNo+ImlanJechlLan in (select ImpoBlNo+ImlanJechlLan FROM rms.dbo.ED_IMPT_V_HNG where ImpumGukyk1 LIKE '%' + #{impum_jajae_code} + '%')</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectImpoStatisticItemList" resultType="map" fetchSize="100">
        /* 수입 행 통계 조회 */
        SELECT
        *
        FROM rms.dbo.ED_IMPT_V_HNG
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ImpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND ExpCd LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND ImpoSingoNo LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OwnGodsNm LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND ImpoBlNo LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='imlan_hs != null and imlan_hs != ""'>AND ImlanHs LIKE '%' + #{imlan_hs} + '%'</if>
	        <if test='imlan_gwan_gam_buho != null and imlan_gwan_gam_buho != ""'>AND ImlanGwanGamBuho LIKE '%' + #{imlan_gwan_gam_buho} + '%'</if>
	        <if test='impum_jajae_code != null and impum_jajae_code != ""'>AND ImpumGukyk1 LIKE '%' + #{impum_jajae_code} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by ImpoOkDt, ImpoSingoNo, ImlanJechlLan, ImpumHeang
    </select>

    <select id="selectImpoStatisticItemListCount" resultType="map">
        /* 수입 행 통계 조회 */
        SELECT
        count(KeyEdImptVhng) as 'COUNT'
        FROM rms.dbo.ED_IMPT_V_HNG
        <where>
            1 = 1
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND left(ImpoOkDt,8) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND ExpCd LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND ImpoSingoNo LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OwnGodsNm LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND ImpoBlNo LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='imlan_hs != null and imlan_hs != ""'>AND ImlanHs LIKE '%' + #{imlan_hs} + '%'</if>
	        <if test='imlan_gwan_gam_buho != null and imlan_gwan_gam_buho != ""'>AND ImlanGwanGamBuho LIKE '%' + #{imlan_gwan_gam_buho} + '%'</if>
	        <if test='impum_jajae_code != null and impum_jajae_code != ""'>AND ImpumGukyk1 LIKE '%' + #{impum_jajae_code} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectImpoTeukStatisticList" resultType="map">
        /* 특송 수입 통계 조회 */
        select
		a.Impo_ok_date
		, a.Impo_suipja_sangho
		, a.Impo_singo_no
		, a.Impo_bl_no
		, a.Impo_hanggu_name
		, a.Impo_jukchl_code
		, a.Impo_gonggub_sangho
		, a.Impo_gele_gubun
		, a.Impo_total_jung
		, a.impo_pojang_su
		, a.Impo_pojang_danwi
		, a.Impo_jingsu_type
		, a.Impo_hanggu_code
		, a.Impo_indo_jogun
		, a.Impo_gyelje_money
		, a.Impo_gyelje_input
		, a.impo_exch_yul
		, a.Impo_cif_total_won
		, a.Impo_gwan_tax
		, a.Impo_teuk_tax
		, a.Impo_ju_tax
		, a.Impo_oil_tax
		, a.Impo_nong_tax
		, a.Impo_edu_tax
		, a.Impo_vat_tax
		, a.Impo_total_tax
		, a.Impo_napse_sangho
		, a.Impo_napse_tong
		, rms.dbo.fn_NEW_DATE_VIEW('D1',a.Impo_ok_date) as 'Impo_ok_date1'
		 from ncustoms_ed.kcba.impo1 a
        <where>
            and a.Impo_suipja_code = 'ELS'
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.Impo_ok_date BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND a.Impo_singo_no LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND a.Impo_suipja_sangho LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND a.Impo_bl_no LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='impo_jukchl_code != null and impo_jukchl_code != ""'>AND a.Impo_jukchl_code LIKE '%' + #{impo_jukchl_code} + '%'</if>
        </where>
        order by a.Impo_ok_date
    </select>

    <select id="selectImpoTeukStatisticLanList" resultType="map">
        /* 특송 수입 란 통계 조회 */
        select
		 a.Impo_ok_date,
		 a.Impo_suipja_sangho,
		 a.Impo_napse_sangho,
		 a.Impo_singo_no,
		 a.Impo_bl_no,
		 a.Impo_hanggu_name,
		 a.Impo_gonggub_sangho,
		 a.Impo_gyelje_money,
		 b.Imlan_jechl_lan,
		 b.Imlan_hs,
		 b.Imlan_wonsanji_code,
		 b.Imlan_seyul_gubun,
		 b.Imlan_cif_won,
		 b.Imlan_gwan_tax,
		 b.Imlan_gyeng_gwan,
		 b.Imlan_gwan_seyula,
		 b.Imlan_gwan_gyeng_yul,
		 b.Imlan_gwan_gam_buho,
		 rms.dbo.fn_NEW_DATE_VIEW('D1',a.Impo_ok_date) as 'Impo_ok_date1'
		from ncustoms_ed.kcba.impo1 a, ncustoms_ed.kcba.impo2 b
        <where>
            and a.impo_key = b.imlan_key
			and a.Impo_suipja_code = 'ELS'
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.Impo_ok_date BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND a.Impo_singo_no LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND a.Impo_suipja_sangho LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND a.Impo_bl_no LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='impo_jukchl_code != null and impo_jukchl_code != ""'>AND a.Impo_jukchl_code LIKE '%' + #{impo_jukchl_code} + '%'</if>
	        <if test='imlan_hs != null and imlan_hs != ""'>AND b.Imlan_hs LIKE '%' + #{imlan_hs} + '%'</if>
        </where>
        order by a.Impo_ok_date
    </select>

    <select id="selectImpoTeukStatisticItemList" resultType="map">
        /* 특송 수입 행 통계 조회 */
        select
		a.Impo_ok_date
		, a.Impo_suipja_sangho
		, a.Impo_napse_sangho
		, a.Impo_singo_no
		, a.Impo_bl_no
		, a.Impo_hanggu_name
		, a.Impo_gonggub_sangho
		, a.Impo_gyelje_money
		, b.Imlan_jechl_lan
		, b.Imlan_hs
		, b.Imlan_wonsanji_code
		, b.Imlan_seyul_gubun
		, b.Imlan_cif_won
		, b.Imlan_gwan_tax
		, b.Imlan_gyeng_gwan
		, b.Imlan_gwan_seyula
		, b.Imlan_gwan_gyeng_yul
		, c.Impum_heang
		, c.Impum_gukyk1
		, c.Impum_gukyk2
		, c.Impum_gukyk3
		, c.Impum_su_danwi
		, c.Impum_su
		, c.Impum_danga
		, c.Impum_amt
		, rms.dbo.fn_NEW_DATE_VIEW('D1',a.Impo_ok_date) as 'Impo_ok_date1'
		 from ncustoms_ed.kcba.impo1 a,
		 ncustoms_ed.kcba.impo2 b,
		 ncustoms_ed.kcba.impo3 c
        <where>
            and a.impo_key = b.imlan_key
			and a.impo_key = c.impum_key
			and b.imlan_key = c.impum_key
			and b.Imlan_jechl_lan = c.Impum_lan
			and a.Impo_suipja_code = 'ELS'
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.Impo_ok_date BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_CD != null and EXP_CD != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{EXP_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND a.Impo_singo_no LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND a.Impo_suipja_sangho LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='impo_bl_no != null and impo_bl_no != ""'>AND a.Impo_bl_no LIKE '%' + #{impo_bl_no} + '%'</if>
	        <if test='impo_jukchl_code != null and impo_jukchl_code != ""'>AND a.Impo_jukchl_code LIKE '%' + #{impo_jukchl_code} + '%'</if>
	        <if test='imlan_hs != null and imlan_hs != ""'>AND b.Imlan_hs LIKE '%' + #{imlan_hs} + '%'</if>
	        <if test='impum_jajae_code != null and impum_jajae_code != ""'>AND c.Impum_gukyk1 LIKE '%' + #{impum_jajae_code} + '%'</if>
        </where>
        order by a.Impo_ok_date
    </select>

    <select id="selectItemList" resultType="map" fetchSize="100">
		/* 자재 마스터 조회
		SELECT
		case when a.useYn='Y' then '사용' else '사용안함' end as 'useYn',
		a.Mmodel_code, a.Mmodel_2+a.Mmodel_3 AS 'Mmodel',
		a.ItemNmHAN, a.Mhs_code, a.MmakerCD, a.Mmaker, a.Morigin1, a.RefundYN, a.OrigExpYN
		FROM CPS.[dbo].[MAAA100] a WITH (NOLOCK) */

		SELECT
		a.useYn,
		a.Mmodel_code, a.Myog_flag, a.Mstd_goods, REPLACE(REPLACE(a.Mmodel_2+a.Mmodel_3, CHAR(13), ''), CHAR(10), '') AS 'Mmodel',
		a.Mmodel_1, a.Mmodel_2, a.Mmodel_3 , a.Mingredient_1, a.Mingredient_2, a.Mingredient_3,
		a.Mhs_code, a.Mhs_kind, a.Mhs_rate, a.Munitprice, a.Mindo_code, a.Munitprice_current,
		a.Morigin1, a.RefundYN, a.OrigExpYN, a.fta_text, a.Mshipper, a.Mremark1, a.Mremark2
		FROM CPS.[dbo].[MAAA100] a WITH (NOLOCK)
		WHERE 1 = 1
		<if test='mcountNo != null and mcountNo != ""'>AND a.Mcount_no = #{mcountNo} /* 관리번호(PK) */</if>
		<if test='mmodelCode != null and mmodelCode != ""'>AND a.Mmodel_code LIKE '%' + #{mmodelCode} + '%' /* 자재코드 */</if>
		<if test='mgerGoods != null and mgerGoods != ""'>AND a.Mger_goods LIKE '%' + #{mgerGoods} + '%' /* 거래품명 */</if>
		<if test='mhsCode != null and mhsCode != ""'>AND a.Mhs_code LIKE '%' + #{mhsCode} + '%' /* 세번부호 */</if>
		<if test='mshipper != null and mshipper != ""'>AND a.Mshipper LIKE '%' + #{mshipper} + '%' /* 해외거래처 */</if>
		<if test='mcoCode != null and mcoCode != ""'>AND a.Mco_code LIKE '%' + #{mcoCode} + '%' /* 납세자코드 */</if>
		<if test='mcoName != null and mcoName != ""'>AND a.Mco_name LIKE '%' + #{mcoName} + '%' /* 납세자상호 */</if>
		<if test='mcoCom != null and mcoCom != ""'>AND a.Mco_com LIKE '%' + #{mcoCom} + '%' /* 납세자사업자번호 */</if>
		<if test='mcoComAll != null and mcoComAll != ""'>AND a.Mco_com in (
		    select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID}
		)</if>
		<if test='mtcano != null and mtcano != ""'>AND a.Mtcano LIKE '%' + #{mtcano} + '%' /* 신고자부호 */</if>
		<if test='mprovisional != null and mprovisional != ""'>AND a.Mprovisional LIKE '%' + #{mprovisional} + '%' /* 잠정 */</if>
		<if test='mtekFlag != null and mtekFlag != ""'>AND a.Mtek_flag LIKE '%' + #{mtekFlag} + '%' /* 내국세여부 */</if>
		<if test='mNegukGubun != null and mNegukGubun != ""'>AND a.M_neguk_gubun LIKE '%' + #{mNegukGubun} + '%' /* 내국세구분 */</if>
		<if test='mNegukCode != null and mNegukCode != ""'>AND a.M_neguk_code LIKE '%' + #{mNegukCode} + '%' /* 내국세코드 */</if>
		<if test='_mNegukCode != null and _mNegukCode != ""'>AND ISNULL(a.M_neguk_code, '') != '' /* 내국세대상건(속도) */</if>
		<if test='myogFlag != null and myogFlag != ""'>AND a.Myog_flag LIKE '%' + #{myogFlag} + '%' /* 요건여부 */</if>
		<if test='ftaYn != null and ftaYn != ""'>AND a.fta_yn LIKE '%' + #{ftaYn} + '%' /* FTA적용여부 */</if>
		<if test='mingredient1 != null and mingredient1 != ""'>AND a.Mingredient_1 LIKE '%' + #{mingredient1} + '%' /* 성분1 */</if>
		<if test='munitpriceCurrent != null and munitpriceCurrent != ""'>AND a.Munitprice_current LIKE '%' + #{munitpriceCurrent} + '%' /* 통화단위 */</if>
		<if test='mindoCode != null and mindoCode != ""'>AND a.Mindo_code LIKE '%' + #{mindoCode} + '%' /* 인도조건 */</if>
		<if test='partType != null and partType != "ALL" and (part != null and part != "")'>
			<choose>
				<when test='partType == "team"'>AND a.TeamKey LIKE '%' + #{part} + '%' /* 부서코드 */</when>
				<when test='partType == "person"'>AND a.EditUserNm LIKE '%' + #{part} + '%' /* 수정자명 */</when>
			</choose>
		</if>
		/*20160830시작*/
		<if test='mshipperCode != null and mshipperCode != ""'>AND a.Mshipper_code LIKE '%' + #{mshipperCode} + '%' /* 해외거래처 부호 */</if>
		<if test='mmaker != null and mmaker != ""'>AND a.Mmaker LIKE '%' + #{mmaker} + '%' /* 제조자 상호명 */</if>
		<if test='mhsKind != null and mhsKind != ""'>AND a.Mhs_kind LIKE '%' + #{mhsKind} + '%' /* 세종구분 */</if>
		<if test='mhsRate != null and mhsRate != ""'>AND a.Mhs_rate LIKE '%' + #{mhsRate} + '%' /* 관세율 */</if>
		<if test='mstdGood != null and mstdGood != ""'>AND a.Mstd_good LIKE '%' + #{mstdGood} + '%' /* 표준품명 */</if>
		<if test='mspCode != null and mspCode != ""'>AND a.Msp_code LIKE '%' + #{mspCode} + '%' /* 상표코드 */</if>
		<if test='mqtyUt != null and mqtyUt != ""'>AND a.Mqty_ut LIKE '%' + #{mqtyUt} + '%' /* 수량단위 */</if>
		<if test='munitprice != null and munitprice != ""'>AND a.Munitprice LIKE '%' + #{munitprice} + '%' /* 단가 */</if>
		<if test='mdrawUnit != null and mdrawUnit != ""'>AND a.Mdraw_unit LIKE '%' + #{mdrawUnit} + '%' /* 환급물량단위 */</if>
		<if test='mcusEntry1 != null and mcusEntry1 != ""'>AND a.Mcus_entry1 LIKE '%' + #{mcusEntry1} + '%' /* 관세사기재란-거래관계 */</if>
		<if test='mcusEntry2 != null and mcusEntry2 != ""'>AND a.Mcus_entry2 LIKE '%' + #{mcusEntry2} + '%' /* 관세사기재란-품명규격세번 */</if>
		<if test='mcusEntry3 != null and mcusEntry3 != ""'>AND a.Mcus_entry3 LIKE '%' + #{mcusEntry3} + '%' /* 관세사기재란-검사의견 */</if>
		<if test='mconfirmUser != null and mconfirmUser != ""'>AND a.Mconfirm_user LIKE '%' + #{mconfirmUser} + '%' /* 확정자 */</if>
		<if test='mreviewFlag != null and mreviewFlag != ""'>AND a.Mreview_flag LIKE '%' + #{mreviewFlag} + '%' /* 재검토여부 */</if>
		<if test='mreviewCause != null and mreviewCause != ""'>AND a.Mreview_cause LIKE '%' + #{mreviewCause} + '%' /* 재검토사유 */</if>
		<if test='mremark1 != null and mremark1 != ""'>AND a.Mremark1 LIKE '%' + #{mremark1} + '%' /* 통관요령 */</if>
		<if test='mremark2 != null and mremark2 != ""'>AND a.Mremark2 LIKE '%' + #{mremark2} + '%' /* 물품정보 */</if>
		<if test='mattached1 != null and mattached1 != ""'>AND a.Mattached1 LIKE '%' + #{mattached1} + '%' /* 파일첨무유무 */</if>
		<if test='mattached2 != null and mattached2 != ""'>AND a.Mattached2 LIKE '%' + #{mattached2} + '%' /* hs상이사유 */</if>
		<if test='mattached3 != null and mattached3 != ""'>AND a.Mattached3 LIKE '%' + #{mattached3} + '%' /* 상대국hs */</if>
		<if test='mattached4 != null and mattached4 != ""'>AND a.Mattached4 LIKE '%' + #{mattached4} + '%' /* 참조사이트1 */</if>
		<if test='mattached5 != null and mattached5 != ""'>AND a.Mattached5 LIKE '%' + #{mattached5} + '%' /* 참조사이트2 */</if>
		<if test='mcusFlag != null and mcusFlag != ""'>AND a.Mcus_flag LIKE '%' + #{mcusFlag} + '%' /* 관세감면여부 */</if>
		<if test='myogOkNo != null and myogOkNo != ""'>AND a.Myog_ok_no LIKE '%' + #{myogOkNo} + '%' /* 요건내용 */</if>
		<if test='mNegukGubun != null and mNegukGubun != ""'>AND a.M_neguk_gubun LIKE '%' + #{mNegukGubun} + '%' /* 내국세구분 */</if>
		<if test='mEduYn != null and mEduYn != ""'>AND a.M_edu_yn LIKE '%' + #{mEduYn} + '%' /* 교육세과세구분부호 */</if>
		<if test='mNongYn != null and mNongYn != ""'>AND a.M_nong_yn LIKE '%' + #{mNongYn} + '%' /* 농특세과세구분부호 */</if>
		<if test='mWeiPri != null and mWeiPri != ""'>AND a.MWei_Pri LIKE '%' + #{mWeiPri} + '%' /* 순중량 */</if>
		<if test='mainKey != null and mainKey != ""'>AND a.Main_key LIKE '%' + #{mainKey} + '%' /* 미사용 */</if>
		<if test='ftaText != null and ftaText != ""'>AND a.fta_text LIKE '%' + #{ftaText} + '%' /* FTA 참조사항 */</if>
		<if test='sampleYn != null and sampleYn != ""'>AND a.sample_yn LIKE '%' + #{sampleYn} + '%' /* 유환,무환구분 */</if>
		<if test='maddSpecCount != null and maddSpecCount != ""'>AND a.madd_spec_count LIKE '%' + #{maddSpecCount} + '%' /* 추가등록개수 */</if>
		<if test='maddSpecContent != null and maddSpecContent != ""'>AND a.madd_spec_content LIKE '%' + #{maddSpecContent} + '%' /* 추가등록내용 */</if>
		<if test='minusYn != null and minusYn != ""'>AND a.minus_yn LIKE '%' + #{minusYn} + '%' /* 공제요소구분 */</if>
		<if test='mVatFlag != null and mVatFlag != ""'>AND a.MVat_Flag LIKE '%' + #{mVatFlag} + '%' /* 부가세구분부호 */</if>
		<if test='mVatReductionCode != null and mVatReductionCode != ""'>AND a.MVat_Reduction_Code LIKE '%' + #{mVatReductionCode} + '%' /* 부가세감면부호 */</if>
		<if test='mpurposeFlag != null and mpurposeFlag != ""'>AND a.Mpurpose_Flag LIKE '%' + #{mpurposeFlag} + '%' /* 용도대상구분 */</if>
		<if test='mpurposeNo != null and mpurposeNo != ""'>AND a.Mpurpose_No LIKE '%' + #{mpurposeNo} + '%' /* 용도대상구분 참조사항 */</if>
		<if test='mGoodscode != null and mGoodscode != ""'>AND a.mGoodscode LIKE '%' + #{mGoodscode} + '%' /* 표준품명 코드 */</if>
		<if test='mSpeccode != null and mSpeccode != ""'>AND a.mSpeccode LIKE '%' + #{mSpeccode} + '%' /* 표준품명 스팩코드 */</if>
		<if test='mprocessFlag != null and mprocessFlag != ""'>AND a.mprocess_flag LIKE '%' + #{mprocessFlag} + '%' /* 처리구분 */</if>
		/*20160830끝*/

		<if test='mmodel != null and mmodel != ""'>
			AND (a.Mmodel_1 LIKE '%' + #{mmodel} + '%' OR a.Mmodel_2 LIKE '%' + #{mmodel} + '%' OR a.Mmodel_3 LIKE '%' + #{mmodel} + '%' OR
			a.Mingredient_1 LIKE '%' + #{mmodel} + '%' OR a.Mingredient_2 LIKE '%' + #{mmodel} + '%' OR a.Mingredient_3 LIKE '%' + #{mmodel} + '%') /* 규격+성분 */
		</if>

		<if test='msangpyo != null and msangpyo != ""'>AND a.Msangpyo LIKE '%' + #{msangpyo} + '%' /* 상표명 */</if>
		<if test='mconfirmFlag != null and mconfirmFlag != ""'>AND a.Mconfirm_flag LIKE '%' + #{mconfirmFlag} + '%' /* 확정상태 */</if>
		<if test='mdivisionCode != null and mdivisionCode != ""'>AND a.Mdivision_code LIKE '%' + #{mdivisionCode} + '%' /* 사업부 */</if>
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
			<choose>
				<when test='_DateType == "Mreg_date"'>AND a.Mreg_date BETWEEN #{strFromDate} AND #{strToDate} /* 등록일자 */</when>
				<when test='_DateType == "Mconfirm_date"'>AND a.Mconfirm_date BETWEEN #{strFromDate} AND #{strToDate} /* 확정일자 */</when>
				<when test='_DateType == "last_date"'>AND LEFT(a.EditDtm, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
			</choose>
		</if>
		<if test='hsStatus != null and hsStatus != ""'>AND a.HsStatus LIKE '%' + #{hsStatus} + '%'</if>
		<if test='tpStatus != null and tpStatus != ""'>AND a.TpStatus LIKE '%' + #{tpStatus} + '%'</if>
		<if test='useYn != null and useYn != ""'>
		    <choose>
				<when test='useYn == "A"'>AND a.useYn in ('Y','X')</when>
				<when test='useYn == "Y"'>AND a.useYn = #{useYn}</when>
				<when test='useYn == "N"'>AND a.useYn = #{useYn}</when>
				<when test='useYn == "X"'>AND a.useYn = #{useYn}</when>
			</choose>
		</if>
	</select>

    <select id="selectImpoInvList" resultType="map" fetchSize="100">
        /* 수입 Invoice 통계내역 */
        select
		  rms.dbo.fn_NEW_DATE_VIEW('D1',a.Impo_iphang_date) as 'Impo_iphang_date'
		, rms.dbo.fn_NEW_DATE_VIEW('D1',a.DECL_CMPL_DT) as 'DECL_CMPL_DT'
		, a.PLantNo as 'PLantNo'
		, right(a.OWN_GODS_NM,3) as 'OWN_GODS_NM'
		, a.IMPT_DECL_NO as 'IMPT_DECL_NO'
		, a.BL_NO as 'BL_NO'
		, case when a.BL_DIVS='Y' then '분할' else '' end as 'BL_DIVS'
		, case when a.Impo_unsong_type='40' then '항공' when a.Impo_unsong_type='10' then '해상' else '' end as 'Impo_hanggu_gubun'
		, case when a.Impo_unsong_type='40' then 'AIR' when a.Impo_unsong_type='10' then 'SEA' else '' end as 'hanggu_gubun'
		, a.EXP_CD as 'EXP_CD'
		, (select top 1 BZTP from rms.dbo.ED_COMP where COMP_CD = a.EXP_CD and useYn='Y' and USE_FG='Y') as 'BZTP'
		, a.Impo_gele_gubun as 'Impo_gele_gubun'
		, a.TOT_WT as 'TOT_WT'
		, a.PKG_QTY as 'PKG_QTY'
		, a.Impo_jingsu_type as 'Impo_jingsu_type'
		, a.INCOTERMS as 'INCOTERMS'
		, a.CUR_UNIT as 'CUR_UNIT'
		, b.INV_NO
		, sum(b.AMT) as 'AMT'
		, sum(b.AMT) / (convert(float,a.Impo_gyelje_input)-convert(float,a.ShippingCharge))*convert(float,a.ShippingCharge) as 'ShippingCharge'
		, sum(b.AMT) / (convert(float,a.Impo_gyelje_input)-convert(float,a.ShippingCharge))*convert(float,a.Impo_gyelje_input) as 'Impo_gyelje_input'
		, (SELECT  STUFF((SELECT ','+ INV_CO_NO FROM rms.dbo.ED_IMPT_INV where inv_no=b.INV_NO and INV_CO_NO !='' and useYn='Y' group by INV_CO_NO FOR XML PATH('')), 1, 1, '')) as 'INV_CO_NO'
		, case when (select count(*) from (select c.ObdNO from rms.dbo.ED_IMPT_INV c where c.UseYn='Y' and c.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO and c.INV_NO=b.INV_NO group by c.ObdNO) d) > 1 then '' else (select top 1 c.ObdNO from rms.dbo.ED_IMPT_INV c where c.UseYn='Y' and c.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO and c.INV_NO=b.INV_NO) end as 'ObdNO'
		 from rms.dbo.ED_IMPT_ORDR as a, rms.dbo.ED_IMPT_INV as b
        <where>
            and a.UseYn='Y'
            and b.UseYn='Y'
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_NM != null and EXP_NM != ""'>AND a.EXP_NM LIKE '%' + #{EXP_NM} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND a.IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND a.OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND a.BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='INV_NO != null and INV_NO != ""'>AND b.INV_NO LIKE '%' + #{INV_NO} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND a.GRP_COMP_CD = #{taxNum}</if>
        </where>
        group by a.Impo_iphang_date, a.DECL_CMPL_DT, a.PLantNo, a.OWN_GODS_NM, a.IMPT_DECL_NO, a.BL_NO, a.BL_DIVS, a.Impo_unsong_type, a.ShippingCharge, a.Impo_gyelje_input,
				 a.EXP_CD, a.Impo_gele_gubun, a.TOT_WT, a.PKG_QTY, a.Impo_jingsu_type, a.INCOTERMS, a.CUR_UNIT, b.INV_NO, b.IMPT_ORDR_MNG_NO
		order by DECL_CMPL_DT, Impo_iphang_date, IMPT_DECL_NO, b.INV_NO
    </select>

    <select id="selectImpoInvListCount" resultType="map">
        /* 수입 Invoice 통계내역 카운트*/
        select
		  count(*) as 'COUNT'
		 from rms.dbo.ED_IMPT_ORDR as a, rms.dbo.ED_IMPT_INV as b
        <where>
            and a.UseYn='Y'
            and b.UseYn='Y'
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='EXP_NM != null and EXP_NM != ""'>AND a.EXP_NM LIKE '%' + #{EXP_NM} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND a.IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND a.OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND a.BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='INV_NO != null and INV_NO != ""'>AND b.INV_NO LIKE '%' + #{INV_NO} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND a.GRP_COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectImpoExpressInvList" resultType="map" fetchSize="100">
        /* Express Invoice 통계내역 */
        select
		  *
		 from rms.dbo.ED_IMPT_INV_EXPRESS
        <where>
            and useYn='Y'
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND CDtm BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='INV_NO != null and INV_NO != ""'>AND INV_NO LIKE '%' + #{INV_NO} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by CDtm, ETA, IMPT_DECL_NO, INV_NO
    </select>

    <select id="selectImpoExpressInvListCount" resultType="map">
        /* Express Invoice 통계내역 카운트*/
        select
		  count(*) as 'COUNT'
		 from rms.dbo.ED_IMPT_INV_EXPRESS
        <where>
            and useYn='Y'
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND CDtm BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='INV_NO != null and INV_NO != ""'>AND INV_NO LIKE '%' + #{INV_NO} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <update id="updateImpoExpressInvList">
		UPDATE	rms.dbo.ED_IMPT_INV_EXPRESS
		<trim prefix="SET" suffixOverrides=",">
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='userId != null'>editUserId = #{userId} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_IMPT_INV_EXPRESS = #{KEY_ED_IMPT_INV_EXPRESS}
	</update>

    <select id="selectImpoGamList" resultType="map" fetchSize="100">
        /* 감면 수입물품내역 통계내역 */
        select
		case when d.EXEM_RMID_QTY=0 then '완료' else '미완료' end as 'status',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.DECL_CMPL_DT) as 'DECL_CMPL_DT',
		a.OWN_GODS_NM,
		a.IMPT_DECL_NO as 'IMPT_DECL_NO',
		a.BL_NO,
		b.LAN,
		b.HS_CD,
		'반도체제조용' as 'semi',
		c.HNG,
		c.ITEM_CD,
		c.ITEM_NM,
		c.QTY,
		d.EXPT_EXEC_QTY,
		d.EXEM_RMID_QTY,
		c.QTY_UNIT
		from
		rms.dbo.ED_IMPT_ORDR a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_DECL_HNG c, rms.dbo.ED_ITEM_EXEM_DESC d
        <where>
            and a.useYn='Y'
            and b.useYn='Y'
            and c.useYn='Y'
            and d.useYn='Y'
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = d.IMPT_ORDR_MNG_NO
			and b.LAN = c.LAN
			and b.LAN = d.LAN
			and c.HNG = d.HNG
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD LIKE '%' + #{HS_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND a.IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND a.OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND a.BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='ITEM_CD != null and ITEM_CD != ""'>AND c.ITEM_CD LIKE '%' + #{ITEM_CD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND a.GRP_COMP_CD = #{taxNum}</if>
        </where>
		order by a.DECL_CMPL_DT, a.BL_NO
    </select>

    <select id="selectImpoGamListCount" resultType="map">
        /* 감면 수입물품내역 통계내역 */
        select
		count(*) as 'COUNT'
		from rms.dbo.ED_IMPT_ORDR a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_DECL_HNG c, rms.dbo.ED_ITEM_EXEM_DESC d
        <where>
            and a.useYn='Y'
            and b.useYn='Y'
            and c.useYn='Y'
            and d.useYn='Y'
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = d.IMPT_ORDR_MNG_NO
			and b.LAN = c.LAN
			and b.LAN = d.LAN
			and c.HNG = d.HNG
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND a.DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD LIKE '%' + #{HS_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND a.IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND a.OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND a.BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='ITEM_CD != null and ITEM_CD != ""'>AND c.ITEM_CD LIKE '%' + #{ITEM_CD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND a.GRP_COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectCoExpoIssueList" resultType="map" fetchSize="100">
        /* 수출 CO발급정보내역 */
        select
		c.INV_NO1,
		case when d.INV_CO_NO != '' then d.INV_CO_NO else '' end as 'wonNo',
		case when d.INV_CO_DT != '' then d.INV_CO_DT else c.INV_DT end as 'INV_DT',
		c.EXPT_DECL_NO as 'EXPT_DECL_NO',
		c.Expo_singo_date,
		d.PROD_CD,
		d.PROD_NM,
		d.HS_CD,
		d.QTY,
		d.AMT,
		d.ORIG,
		c.Expo_GuMaeJa_SangHo,
		case when d.APLY_PACT = 'FEU' then 'KR-EU' when d.APLY_PACT = 'FUS' then 'KR-US'
		when d.APLY_PACT = 'FIN' then 'KR-IN' when d.APLY_PACT = 'FVN' then 'KR-VN'
		when d.APLY_PACT = 'FGB' then 'KR-GB' when d.APLY_PACT = 'APTA' then 'KR-APTA'
		when d.APLY_PACT = 'FCN' then 'KR-CN' else '' end as 'APLY_PACT',
		'B' as 'gijun',
		d.Memo as 'etc',
		case when d.INV_CO_DT != '' then rms.dbo.fn_NEW_DATE_VIEW('D1',d.INV_CO_DT) else rms.dbo.fn_NEW_DATE_VIEW('D1',c.INV_DT) end as 'INV_DT1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',c.Expo_singo_date) as 'Expo_singo_date1',
		c.EXPO_BLNO,
		c.EXPO_HBLNO,
		d.KitCode
		from rms.dbo.ED_EXPT_ORDR c, rms.dbo.ED_EXPT_INV d
        <where>
            and c.useYn='Y'
            and d.useYn='Y'
            and c.EXPT_ORDR_MNG_NO = d.EXPT_ORDR_MNG_NO
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND c.DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='INV_NO1 != null and INV_NO1 != ""'>AND c.INV_NO1 LIKE '%' + #{INV_NO1} + '%'</if>
	        <if test='FTA_CD != null and FTA_CD != ""'>AND d.APLY_PACT = #{FTA_CD}</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND c.OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='wonNo != null and wonNo != ""'>AND (d.INV_CO_NO LIKE '%' + #{wonNo} + '%' or c.INV_NO1 LIKE '%' + #{wonNo} + '%')</if>
	        <if test='PROD_CD != null and PROD_CD != ""'>AND d.PROD_CD LIKE '%' + #{PROD_CD} + '%'</if>
	        <if test='(INV_CO_NO != null and INV_CO_NO != "") and INV_CO_NO == "Y"'>AND d.INV_CO_NO != ''</if>
	        <if test='(INV_CO_NO != null and INV_CO_NO != "") and INV_CO_NO == "N"'>AND d.INV_CO_NO = ''</if>
	        <if test='taxNum != null and taxNum != ""'>AND c.GRP_COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectCoImpoIssueList" resultType="map" fetchSize="100">
        /* 수입 CO발급정보내역 */
        select
		b.INV_CO_DT,
		substring(a.Impo_ok_dttm,0,9) as 'Impo_ok_dttm',
		a.BL_NO,
		case when b.INV_CO_NO != '' then b.INV_CO_NO else b.INV_NO end as 'wonNo',
		a.IMPT_DECL_NO as 'IMPT_DECL_NO',
		b.ORIG,
		b.ITEM_NM,
		b.ITEM_CD,
		b.QTY,
		a.EXP_NM,
		a.EXTR_NAT,
		case when b.ORIG_PACT = 'FEU' then 'KR-EU' when b.ORIG_PACT = 'FUS' then 'KR-US' else 'KR-CN' end as 'ORIG_PACT',
		b.INV_NO,
		'8' as 'basic',
		c.Mhs_rate,
		c.TTAX,
		c.VTAX,
		'' as 'etc',
		rms.dbo.fn_NEW_DATE_VIEW('D1',b.INV_CO_DT) as 'INV_CO_DT1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',substring(a.Impo_ok_dttm,0,9)) as 'Impo_ok_dttm1'
		from rms.dbo.ED_IMPT_ORDR a, rms.dbo.ED_IMPT_INV b, rms.dbo.ED_IMPT_DECL_LAN c, rms.dbo.ED_IMPT_DECL_HNG d
        <where>
            and a.useYn='Y'
            and b.useYn='Y'
            and c.useYn='Y'
            and d.useYn='Y'
            and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = d.IMPT_ORDR_MNG_NO
			and b.IMPT_INV_SEQNO = d.IMPT_INV_SEQNO
			and c.LAN = d.LAN
			and b.ORIG_PACT !=''
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND substring(a.Impo_ok_dttm,0,9) BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='INV_NO != null and INV_NO != ""'>AND b.INV_NO LIKE '%' + #{INV_NO} + '%'</if>
	        <if test='FTA_CD != null and FTA_CD != ""'>AND b.ORIG_PACT = #{FTA_CD}</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND a.OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='wonNo != null and wonNo != ""'>AND (b.INV_CO_NO LIKE '%' + #{wonNo} + '%' or b.INV_NO LIKE '%' + #{wonNo} + '%')</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND a.BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND a.GRP_COMP_CD = #{taxNum}</if>
        </where>
        order by substring(a.Impo_ok_dttm,0,9), a.BL_NO
    </select>

    <select id="selectDrawMaster" resultType="map">
		select *
		from rms.dbo.ED_DRAW_MST
		<where>
			and useYn='Y'
			<if test='hsCode != null and hsCode != ""'>AND hsCode = #{hsCode}</if>
			<if test='itemCode != null and itemCode != ""'>AND itemCode = #{itemCode}</if>
			<if test='year != null and year != ""'>AND year = #{year}</if>
		</where>
		order by seyul desc
	</select>

    <select id="threeMonthRmidQty" resultType="map">
		select
		case when isNull(SUM(a.RMID_QTY),0)=0 then 0 else SUM(a.RMID_QTY) end  as 'RMID_QTY'
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c
		<where>
		    and a.useYn = 'Y'
            and b.useYn='Y'
            and c.useYn='Y'
		    and (a.checkYn != '0' or a.checkYn is null)
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.LAN = b.LAN
			AND c.DECL_CMPL_DT <![CDATA[ >= ]]> #{twoYear}
			AND c.Impo_gyelje != 'GN'
			AND b.EXEM_DIV = 'N'
			and a.RMID_QTY <![CDATA[ > ]]> 0.999
			and c.Impo_gele_gubun = '11'
			and c.Impo_jingsu_type != '14'
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
            <if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD = #{HS_CD}</if>
            <if test='HS_CD_ALL != null and HS_CD_ALL != ""'>AND b.HS_CD in ${HS_CD_ALL}</if>
            <if test='ORIG != null and ORIG != ""'>AND b.ORIG = #{ORIG}</if>
            <if test='Mhs_rate != null and Mhs_rate != ""'>AND b.Mhs_rate = #{Mhs_rate}</if>
        </where>
	</select>

    <select id="threeMonthRmidQty11" resultType="map">
		select
		case when isNull(SUM(a.RMID_QTY),0)=0 then 0 else SUM(a.RMID_QTY) end  as 'RMID_QTY'
		from rms.dbo.ED_IMPT_DECL_HNG a, rms.dbo.ED_IMPT_DECL_LAN b, rms.dbo.ED_IMPT_ORDR c
		<where>
		    and a.useYn = 'Y'
            and b.useYn='Y'
            and c.useYn='Y'
		    and (a.checkYn != '0' or a.checkYn is null)
			and a.IMPT_ORDR_MNG_NO = c.IMPT_ORDR_MNG_NO
			and a.IMPT_ORDR_MNG_NO = b.IMPT_ORDR_MNG_NO
			and a.LAN = b.LAN
			AND c.DECL_CMPL_DT <![CDATA[ >= ]]> #{twoYear}
			AND c.Impo_gyelje != 'GN'
			AND b.EXEM_DIV = 'N'
			and a.RMID_QTY <![CDATA[ > ]]> 0.999
			and c.Impo_gele_gubun = '11'
			and c.Impo_jingsu_type != '14'
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND a.ITEM_CD = #{ITEM_CD}</if>
            <if test='HS_CD != null and HS_CD != ""'>AND b.HS_CD in ${HS_CD}</if>
            <if test='ORIG != null and ORIG != ""'>AND b.ORIG = #{ORIG}</if>
            <if test='Mhs_rate != null and Mhs_rate != ""'>AND b.Mhs_rate = #{Mhs_rate}</if>
        </where>
	</select>

    <select id="selectBomDrawList" resultType="map">
		select
		*
		from rms.dbo.ED_BOM_DRAW
		<where>
            AND useYn = 'Y'
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "JEPUM_CD"'>AND JEPUM_CD LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "RgCode"'>AND RgCode LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "ITEM_CD"'>AND ITEM_CD LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
            <if test='FrDay != null and FrDay != ""'>AND FrDay = #{FrDay}</if>
        </where>
		order by KEY_ED_BOM_DRAW
	</select>

    <select id="selectMaxBomDraw" resultType="map">
		select
		ISNULL(LEFT(MAX(BOM_DRAW_MNG_NO),4),'X') as 'max',
		ISNULL(MAX(BOM_DRAW_MNG_NO)+1,'') as 'BOM_DRAW_MNG_NO'
		from rms.dbo.ED_BOM_DRAW
		<where>
		    AND useYn = 'Y'
		</where>
	</select>

    <select id="selectMaxBomDrawSeq" resultType="map">
		select
		ISNULL(MAX(SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_BOM_DRAW
		<where>
		    and useYn='Y'
            <if test='BOM_DRAW_MNG_NO != null and BOM_DRAW_MNG_NO != ""'>AND BOM_DRAW_MNG_NO = #{BOM_DRAW_MNG_NO}</if>
        </where>
	</select>

    <insert id="insertBomDraw">
		INSERT INTO rms.dbo.ED_BOM_DRAW
		       ([GRP_COMP_CD],
				[BOM_DRAW_MNG_NO],
				[SEQNO],
				[JEPUM_CD],
				[FrDay],
				[ToDay],
				[LevelUsg],
				[ITEM_CD],
				[RgCode],
				[JEPUM_QTY_UNIT],
				[ITEM_QtyUnit],
				[Basic],
				[BasicUsg],
				[RefRate],
				[AgDivi],
				[AgRate],
				[UsgCal],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm])
		VALUES
		       ('3128112960',
		       #{BOM_DRAW_MNG_NO},
		       #{SEQNO},
		       #{JEPUM_CD},
		       #{FrDay},
		       #{ToDay},
		       #{LevelUsg},
		       #{ITEM_CD},
		       #{RgCode},
		       #{JEPUM_QTY_UNIT},
		       #{ITEM_QtyUnit},
		       #{Basic},
		       #{BasicUsg},
		       #{RefRate},
		       #{AgDivi},
		       #{AgRate},
		       #{UsgCal},
		       'Y',
		       #{addUserId},
		       #{addUserNm},
		       #{addDtm})
	</insert>

    <select id="selectItemExemEnd" resultType="map">
		select * from rms.dbo.ED_ITEM_EXEM_DESC
		<where>
		    and EXEM_RMID_QTY <![CDATA[ > ]]> 0
		    and useYn='Y'
            <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD = #{ITEM_CD}</if>
        </where>
        order by EXEM_PLAN_MNG_NO, IMPT_ORDR_MNG_NO
	</select>

    <select id="selectMaxExecImpt" resultType="map">
		select
		ISNULL(MAX(EXEC_IMPT_SEQNO)+1,'') as 'SEQNO'
		from rms.dbo.ED_EXEM_EXEC_IMPT_LIST
		<where>
		    AND useYn = 'Y'
            <if test='EXEM_EXEC_MNG_NO != null and EXEM_EXEC_MNG_NO != ""'>AND EXEM_EXEC_MNG_NO = #{EXEM_EXEC_MNG_NO}</if>
        </where>
	</select>

    <insert id="insertExecImptList">
		INSERT INTO rms.dbo.ED_EXEM_EXEC_IMPT_LIST
		       ([EXEM_EXEC_MNG_NO],
				[GRP_COMP_CD],
				[PROD_CD],
				[ITEM_CD],
				[EXEC_IMPT_SEQNO],
				[EXEC_DT],
				[QTY],
				[IMPT_ORDR_MNG_NO],
				[IMPT_INV_SEQNO],
				[LAN],
				[HNG],
				[EXEC_SEQNO],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm]
				)
		VALUES
		       (#{EXEM_EXEC_MNG_NO},
				#{GRP_COMP_CD},
				#{PROD_CD},
				#{ITEM_CD},
				#{EXEC_IMPT_SEQNO},
				#{EXEC_DT},
				#{QTY},
				#{IMPT_ORDR_MNG_NO},
				#{IMPT_INV_SEQNO},
				#{LAN},
				#{HNG},
				#{EXEC_SEQNO},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm})
	</insert>

    <insert id="insertExemExecItem">
		INSERT INTO rms.dbo.ED_EXEM_EXEC_ITEM
		       ([GRP_COMP_CD],
				[EXEM_EXEC_MNG_NO],
				[EXEC_DT],
				[PROD_CD],
				[ITEM_CD],
				[EXEC_SEQNO],
				[PROD_NM],
				[ITEM_NM],
				[QTY],
				[EXEC_QTY],
				[RMID_QTY],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm])
		VALUES
		       (#{GRP_COMP_CD},
				#{EXEM_EXEC_MNG_NO},
				#{EXEC_DT},
				#{PROD_CD},
				#{ITEM_CD},
				#{EXEC_SEQNO},
				#{PROD_NM},
				#{ITEM_NM},
				#{QTY},
				#{EXEC_QTY},
				#{RMID_QTY},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm})
	</insert>

    <select id="selectImpoGamExecList" resultType="map" fetchSize="100">
        /* 감면 수입물품이행처리내역 통계내역 */
        select
		*,
		rms.dbo.fn_NEW_DATE_VIEW('D1',DECL_CMPL_DT) as 'DECL_CMPL_DT1',
		IMPT_DECL_NO as 'IMPT_DECL_NO1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',EXEC_DT) as 'EXEC_DT1'
		from
		rms.dbo.ED_IMPT_GAM_EXEC_VIEW
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='HS_CD != null and HS_CD != ""'>AND HS_CD LIKE '%' + #{HS_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD LIKE '%' + #{ITEM_CD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by DECL_CMPL_DT, BL_NO, LAN, HNG, EXEM_EXEC_MNG_NO
    </select>

    <select id="selectImpoGamExecListCount" resultType="map">
        /* 감면 수입물품이행처리내역 통계내역 */
        select
		count(*) as 'COUNT'
		from rms.dbo.ED_IMPT_GAM_EXEC_VIEW
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='HS_CD != null and HS_CD != ""'>AND HS_CD LIKE '%' + #{HS_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD LIKE '%' + #{ITEM_CD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectImpoNoGamList" resultType="map" fetchSize="100">
        /* 비감면 수입물품내역 통계내역 */
        select
		*,
		rms.dbo.fn_NEW_DATE_VIEW('D1',DECL_CMPL_DT) as 'DECL_CMPL_DT1'
		from rms.dbo.ED_IMPT_NOGAM_VIEW
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='HS_CD != null and HS_CD != ""'>AND HS_CD LIKE '%' + #{HS_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD LIKE '%' + #{ITEM_CD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by DECL_CMPL_DT, IMPT_DECL_NO, LAN, HNG
    </select>

    <select id="selectImpoNoGamListCount" resultType="map">
        /* 비감면 수입물품내역 통계내역 */
        select
		count(*) as 'COUNT'
		from rms.dbo.ED_IMPT_NOGAM_VIEW
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='HS_CD != null and HS_CD != ""'>AND HS_CD LIKE '%' + #{HS_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD LIKE '%' + #{ITEM_CD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectImpoNoGamExecList" resultType="map" fetchSize="100">
        /* 비감면 수입물품처리내역 통계내역 */
        select
		*,
		rms.dbo.fn_NEW_DATE_VIEW('D1',DECL_CMPL_DT) as 'DECL_CMPL_DT2',
		rms.dbo.fn_NEW_DATE_VIEW('D1',DECL_CMPL_DT1) as 'DECL_CMPL_DT3'
		from rms.dbo.ED_IMPT_NOGAM_EXEC_VIEW
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='HS_CD != null and HS_CD != ""'>AND HS_CD LIKE '%' + #{HS_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD LIKE '%' + #{ITEM_CD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by DECL_CMPL_DT, IMPT_DECL_NO, LAN, HNG
    </select>

    <select id="selectImpoNoGamExecListCount" resultType="map">
        /* 비감면 수입물품처리내역 통계내역 */
        select
		count(*) as 'COUNT'
		from rms.dbo.ED_IMPT_NOGAM_EXEC_VIEW
        <where>
	        <if test='(FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
	            AND DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}
	        </if>
	        <if test='HS_CD != null and HS_CD != ""'>AND HS_CD LIKE '%' + #{HS_CD} + '%'</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO LIKE '%' + #{IMPT_DECL_NO} + '%'</if>
	        <if test='OWN_GODS_NM != null and OWN_GODS_NM != ""'>AND OWN_GODS_NM LIKE '%' + #{OWN_GODS_NM} + '%'</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
	        <if test='ITEM_CD != null and ITEM_CD != ""'>AND ITEM_CD LIKE '%' + #{ITEM_CD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
    </select>

    <select id="selectReExpobjItemMasterAll" resultType="map">
		select
		substring(a.ORDR_DT,0,5)+'-'+substring(a.ORDR_DT,5,2)+'-'+substring(a.ORDR_DT,7,2) as 'ORDR_DT',
		a.JOB_NM,
		a.RMRK,
		substring(b.IMP_OK_DT,0,5)+'-'+substring(b.IMP_OK_DT,5,2)+'-'+substring(b.IMP_OK_DT,7,2) as 'IMP_OK_DT',
		b.IMPT_DECL_NO as 'IMPT_DECL_NO',
		char(9)+b.LAN as 'LAN',
		char(9)+b.HNG as 'HNG',
		b.BL_NO,
		b.QTY,
		b.ITEM_CD,
		b.ITEM_NM,
		b.addUserNm,
		substring(b.addDtm,0,5)+'-'+substring(b.addDtm,5,2)+'-'+substring(b.addDtm,7,2) as 'addDtm',
		a.ImExGbn
		from rms.dbo.ED_REEXPOBJCLOSE_ORDR a, rms.dbo.ED_REEXPOBJCLOSE_DTL b
		<where>
            and a.ORDR_NO = b.ORDR_NO
			and a.useYn = 'Y'
			and b.useYn = 'Y'
			<if test='ORDR_DT1 != null and ORDR_DT1 != ""'>AND a.ORDR_DT = #{ORDR_DT1}</if>
            <if test='ImExGbn1 != null and ImExGbn1 != ""'>AND a.ImExGbn = #{ImExGbn1}</if>
            <if test='JOB_NM1 != null and JOB_NM1 != ""'>AND a.JOB_NM LIKE '%'+ #{JOB_NM1} + '%'</if>
            <if test='RMRK1 != null and RMRK1 != ""'>AND a.RMRK LIKE '%'+ #{RMRK1} + '%'</if>
        </where>
        order by a.ORDR_DT desc
	</select>

    <select id="selectImptItem" resultType="map">
		select c.BL_NO, d.ITEM_CD, d.ITEM_NM, c.DECL_CMPL_DT, d.QTY, c.GRP_COMP_CD
		from rms.dbo.ED_IMPT_ORDR c, rms.dbo.ED_IMPT_DECL_HNG d
		<where>
		    and c.useYn='Y'
		    and d.useYn='Y'
		    and c.IMPT_ORDR_MNG_NO = d.IMPT_ORDR_MNG_NO
            and c.IMPT_DECL_NO = #{IMPT_DECL_NO}
			and d.LAN = #{LAN}
			and d.HNG = #{HNG}
        </where>
	</select>

    <select id="selectExptItem" resultType="map">
		select c.INV_NO1, d.PROD_CD, d.PROD_NM
		from rms.dbo.ED_EXPT_ORDR c, rms.dbo.ED_EXPT_DECL_HNG d
		<where>
		    and c.useYn='Y'
		    and d.useYn='Y'
		    and c.EXPT_ORDR_MNG_NO = d.EXPT_ORDR_MNG_NO
            and c.EXPT_DECL_NO = #{IMPT_DECL_NO}
			and d.LAN = #{LAN}
			and d.HNG = #{HNG}
        </where>
	</select>

    <select id="selectExpoDrawStatisticList" resultType="map" fetchSize="100">
		select *,
        rms.dbo.fn_NEW_DATE_VIEW('D1',ExpoOkDate) as 'ExpoOkDate1',
        rms.dbo.fn_NEW_DATE_VIEW('D1',ImpoOkDate) as 'ImpoOkDate1',
        rms.dbo.fn_NEW_DATE_VIEW('D1',DrawOkDate) as 'DrawOkDate1',
        rms.dbo.fn_NEW_DATE_VIEW('D1',DrawSetDate) as 'DrawSetDate1',
        rms.dbo.fn_NEW_DATE_VIEW('D1',DrawJubSuDate) as 'DrawJubSuDate1',
        rms.dbo.fn_NEW_DATE_VIEW('D1',YangDoDate) as 'YangDoDate1'
		from rms.dbo.ED_DRAW_REF
		<where>
		    and useYn='Y'
		    <if test='_DateType != null and _DateType != "ALL" and (FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
			<choose>
				<when test='_DateType == "ExpoOkDate"'>AND ExpoOkDate BETWEEN #{FROM_DT} AND #{TO_DT}</when>
				<when test='_DateType == "DrawOkDate"'>AND DrawOkDate BETWEEN #{FROM_DT} AND #{TO_DT}</when>
			</choose>
			</if>
	        <if test='ExpoSingoNo != null and ExpoSingoNo != ""'>AND ExpoSingoNo LIKE '%' + #{ExpoSingoNo} + '%'</if>
	        <if test='ImpoSingoNo != null and ImpoSingoNo != ""'>AND ImpoSingoNo LIKE '%' + #{ImpoSingoNo} + '%'</if>
	        <if test='ExpoForm != null and ExpoForm != ""'>AND ExpoForm = #{ExpoForm}</if>
	        <if test='ExpoHS != null and ExpoHS != ""'>AND ExpoHS LIKE '%' + #{ExpoHS} + '%'</if>
	        <if test='ItemCD != null and ItemCD != ""'>AND ItemCD LIKE '%' + #{ItemCD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by ExpoOkDate
	</select>

    <select id="selectExpoDrawStatisticListCount" resultType="map">
		select count(*) as 'COUNT'
		from rms.dbo.ED_DRAW_REF
		<where>
		    and useYn='Y'
		    <if test='_DateType != null and _DateType != "ALL" and (FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
			<choose>
				<when test='_DateType == "ExpoOkDate"'>AND ExpoOkDate BETWEEN #{FROM_DT} AND #{TO_DT}</when>
				<when test='_DateType == "DrawOkDate"'>AND DrawOkDate BETWEEN #{FROM_DT} AND #{TO_DT}</when>
			</choose>
			</if>
	        <if test='ExpoSingoNo != null and ExpoSingoNo != ""'>AND ExpoSingoNo LIKE '%' + #{ExpoSingoNo} + '%'</if>
	        <if test='ImpoSingoNo != null and ImpoSingoNo != ""'>AND ImpoSingoNo LIKE '%' + #{ImpoSingoNo} + '%'</if>
	        <if test='ExpoForm != null and ExpoForm != ""'>AND ExpoForm = #{ExpoForm}</if>
	        <if test='ExpoHS != null and ExpoHS != ""'>AND ExpoHS LIKE '%' + #{ExpoHS} + '%'</if>
	        <if test='ItemCD != null and ItemCD != ""'>AND ItemCD LIKE '%' + #{ItemCD} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
	</select>

    <select id="selectCommonCode" resultType="map">
        /* 수출 통계 조회 */
        SELECT
        Cd, CdPrtNm
        from CPS.dbo.CDAA100D
        <where>
            and useYn = 'Y'
	        <if test='Mcd != null and Mcd != ""'>AND Mcd = #{Mcd}</if>
        </where>
    </select>

    <update id="updateBomDraw">
		UPDATE	rms.dbo.ED_BOM_DRAW
		<trim prefix="SET" suffixOverrides=",">
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE KEY_ED_BOM_DRAW = #{KEY_ED_BOM_DRAW}
	</update>

    <insert id="insertDB">
		INSERT INTO rms.dbo.ED_BOM_DRAW
		       ([GRP_COMP_CD],
				[BOM_DRAW_MNG_NO],
				[SEQNO],
				[JEPUM_CD],
				[FrDay],
				[ToDay],
				[LevelUsg],
				[ITEM_CD],
				[RgCode],
				[JEPUM_QTY_UNIT],
				[ITEM_QtyUnit],
				[Basic],
				[BasicUsg],
				[RefRate],
				[AgDivi],
				[AgRate],
				[UsgCal],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm])
		VALUES
		       (#{GRP_COMP_CD},
		       #{BOM_DRAW_MNG_NO},
		       #{SEQNO},
		       #{JEPUM_CD},
		       #{FrDay},
		       #{ToDay},
		       #{LevelUsg},
		       #{ITEM_CD},
		       #{RgCode},
		       #{JEPUM_QTY_UNIT},
		       #{ITEM_QtyUnit},
		       #{Basic},
		       #{BasicUsg},
		       #{RefRate},
		       #{AgDivi},
		       #{AgRate},
		       #{UsgCal},
		       'Y',
		       #{addUserId},
		       #{addUserNm},
		       #{addDtm})
	</insert>

    <select id="selectExportKpiList" resultType="map" fetchSize="100">
		select
		a.expo_singo_no as 'expt_noti_no',
		b.INV_NO1,
		a.expo_gumaeja_sangho,
		b.NameOfShipto,
		b.Plant,
		b.INCOTERMS,
		rms.dbo.fn_NEW_DATE_VIEW('D1',b.INV_DT) as 'INV_DT',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.expo_ok_date) as 'expo_ok_date',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.expo_LoadedDt) as 'expo_LoadedDt',
		(select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) as 'workday',
		case when (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ < ]]> 3 then 'Pass'
		when (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ > ]]> 2 then 'Fail'
		else '' end as 'pass'
		from ncustoms_ed.kcba.expo1 a, rms.dbo.ED_EXPT_ORDR b
		<where>
		    AND a.expo_singo_no = b.EXPT_DECL_NO
			and b.useYn='Y'
			<if test='taxNum != null and taxNum != ""'>AND a.expo_suchulSaupno = #{taxNum}</if>
			<if test='_DateType != null and _DateType != "ALL" and (strFromDate1 != null and strFromDate1 != "") and (strToDate1 != null and strToDate1 != "")'>
			<choose>
				<when test='_DateType == "ok_Day"'>AND a.expo_ok_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
				<when test='_DateType == "sunjuk_Day"'>AND a.expo_LoadedDt BETWEEN #{strFromDate1} AND #{strToDate1}</when>
				<when test='_DateType == "invoice_Day"'>AND b.INV_DT BETWEEN #{strFromDate1} AND #{strToDate1}</when>
			</choose>
			</if>
            <if test='invNo != null and invNo != ""'>AND b.INV_NO1 LIKE '%' + #{invNo} + '%'</if>
            <if test='Plant != null and Plant != ""'>AND b.Plant LIKE '%' + #{Plant} + '%'</if>
            <if test='expoSingoNo != null and expoSingoNo != ""'>AND a.expo_singo_no LIKE '%' + #{expoSingoNo} + '%'</if>
            <if test='Result != null and Result != "ALL"'>
			<choose>
				<when test='Result == "Pass"'>AND (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ < ]]> 3</when>
				<when test='Result == "Fail"'>AND (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ > ]]> 2</when>
			</choose>
			</if>
        </where>
		union all
		select
		a.ExSingoNo as 'expt_noti_no',
		b.INV_NO1,
		a.ExBuyerSangho as 'expo_gumaeja_sangho',
		b.NameOfShipto,
		b.Plant,
		b.INCOTERMS,
		rms.dbo.fn_NEW_DATE_VIEW('D1',b.INV_DT) as 'INV_DT',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.ExOkDtm) as 'expo_ok_date',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.ExLeaveDate) as 'expo_LoadedDt',
		(select SUM(CdSort)-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.ExOkDtm) as 'workday',
		case when (select SUM(CdSort)-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.ExOkDtm) <![CDATA[ < ]]> 3 then 'Pass'
		when (select SUM(CdSort)-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.ExOkDtm) <![CDATA[ > ]]> 2 then 'Fail'
		else '' end as 'pass'
		from CPS.dbo.EXAC100 a, rms.dbo.ED_EXPT_ORDR b
		<where>
		    and a.UseYn = 'Y'
		    AND a.ExSingoNo = b.EXPT_DECL_NO
			and b.useYn='Y'
			<if test='taxNum != null and taxNum != ""'>AND a.ExDaeSaup = #{taxNum}</if>
			<if test='_DateType != null and _DateType != "ALL" and (strFromDate1 != null and strFromDate1 != "") and (strToDate1 != null and strToDate1 != "")'>
			<choose>
				<when test='_DateType == "ok_Day"'>AND left(a.ExOkDtm,8) BETWEEN #{strFromDate1} AND #{strToDate1}</when>
				<when test='_DateType == "sunjuk_Day"'>AND left(a.ExLeaveDate,8) BETWEEN #{strFromDate1} AND #{strToDate1}</when>
				<when test='_DateType == "invoice_Day"'>AND b.INV_DT BETWEEN #{strFromDate1} AND #{strToDate1}</when>
			</choose>
			</if>
            <if test='invNo != null and invNo != ""'>AND b.INV_NO1 LIKE '%' + #{invNo} + '%'</if>
            <if test='Plant != null and Plant != ""'>AND b.Plant LIKE '%' + #{Plant} + '%'</if>
            <if test='expoSingoNo != null and expoSingoNo != ""'>AND a.ExSingoNo LIKE '%' + #{expoSingoNo} + '%'</if>
            <if test='Result != null and Result != "ALL"'>
			<choose>
				<when test='Result == "Pass"'>AND (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.ExOkDtm) <![CDATA[ < ]]> 3</when>
				<when test='Result == "Fail"'>AND (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.ExOkDtm) <![CDATA[ > ]]> 2</when>
			</choose>
			</if>
        </where>
	</select>

    <select id="selectExportKpiListBack" resultType="map" fetchSize="100">
		select
		a.expo_singo_no as 'expt_noti_no',
		b.INV_NO1,
		a.expo_gumaeja_sangho,
		b.NameOfShipto,
		b.Plant,
		b.INCOTERMS,
		rms.dbo.fn_NEW_DATE_VIEW('D1',b.INV_DT) as 'INV_DT',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.expo_ok_date) as 'expo_ok_date',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.expo_LoadedDt) as 'expo_LoadedDt',
		(select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) as 'workday',
		case when (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ < ]]> 3 then 'Pass'
		when (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ > ]]> 2 then 'Fail'
		else '' end as 'pass'
		from ncustoms_ed.kcba.expo1 a, rms.dbo.ED_EXPT_ORDR b
		<where>
		    AND a.expo_singo_no = b.EXPT_DECL_NO
			and a.expo_suchulSaupno in ('3128112960','1298123036')
			and b.useYn='Y'
			<if test='_DateType != null and _DateType != "ALL" and (strFromDate1 != null and strFromDate1 != "") and (strToDate1 != null and strToDate1 != "")'>
			<choose>
				<when test='_DateType == "ok_Day"'>AND a.expo_ok_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
				<when test='_DateType == "sunjuk_Day"'>AND a.expo_LoadedDt BETWEEN #{strFromDate1} AND #{strToDate1}</when>
				<when test='_DateType == "invoice_Day"'>AND b.INV_DT BETWEEN #{strFromDate1} AND #{strToDate1}</when>
			</choose>
			</if>
            <if test='invNo != null and invNo != ""'>AND b.INV_NO1 LIKE '%' + #{invNo} + '%'</if>
            <if test='Plant != null and Plant != ""'>AND b.Plant LIKE '%' + #{Plant} + '%'</if>
            <if test='expoSingoNo != null and expoSingoNo != ""'>AND a.expo_singo_no LIKE '%' + #{expoSingoNo} + '%'</if>
            <if test='Result != null and Result != "ALL"'>
			<choose>
				<when test='Result == "Pass"'>AND (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ < ]]> 3</when>
				<when test='Result == "Fail"'>AND (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ > ]]> 2</when>
			</choose>
			</if>
        </where>
		union all
		select
		a.expo_singo_no as 'expt_noti_no',
		b.INV_NO1,
		a.expo_gumaeja_sangho,
		b.NameOfShipto,
		b.Plant,
		b.INCOTERMS,
		rms.dbo.fn_NEW_DATE_VIEW('D1',b.INV_DT) as 'INV_DT',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.expo_ok_date) as 'expo_ok_date',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.expo_LoadedDt) as 'expo_LoadedDt',
		(select SUM(CdSort)-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) as 'workday',
		case when (select SUM(CdSort)-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ < ]]> 3 then 'Pass'
		when (select SUM(CdSort)-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ > ]]> 2 then 'Fail'
		else '' end as 'pass'
		from ncustoms_ca.kcba.expo1 a, rms.dbo.ED_EXPT_ORDR b
		<where>
		    AND a.expo_singo_no = b.EXPT_DECL_NO
			and a.expo_suchulSaupno in ('3128112960','1298123036')
			and b.useYn='Y'
			<if test='_DateType != null and _DateType != "ALL" and (strFromDate1 != null and strFromDate1 != "") and (strToDate1 != null and strToDate1 != "")'>
			<choose>
				<when test='_DateType == "ok_Day"'>AND a.expo_ok_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
				<when test='_DateType == "sunjuk_Day"'>AND a.expo_LoadedDt BETWEEN #{strFromDate1} AND #{strToDate1}</when>
				<when test='_DateType == "invoice_Day"'>AND b.INV_DT BETWEEN #{strFromDate1} AND #{strToDate1}</when>
			</choose>
			</if>
            <if test='invNo != null and invNo != ""'>AND b.INV_NO1 LIKE '%' + #{invNo} + '%'</if>
            <if test='Plant != null and Plant != ""'>AND b.Plant LIKE '%' + #{Plant} + '%'</if>
            <if test='expoSingoNo != null and expoSingoNo != ""'>AND a.expo_singo_no LIKE '%' + #{expoSingoNo} + '%'</if>
            <if test='Result != null and Result != "ALL"'>
			<choose>
				<when test='Result == "Pass"'>AND (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ < ]]> 3</when>
				<when test='Result == "Fail"'>AND (select SUM(convert(int,CdPrtNm))-1 from CPS.dbo.CDAF100D where CDAFMKey='172' and Cd <![CDATA[ >= ]]> b.INV_DT and Cd <![CDATA[ <= ]]> a.expo_ok_date) <![CDATA[ > ]]> 2</when>
			</choose>
			</if>
        </where>
	</select>

    <select id="selectExpoDrawStatisticList1" resultType="map" fetchSize="100">
		select
		*
		from rms.[dbo].[ED_DRAW_V]
		<where>
		    <if test='_DateType != null and _DateType != "ALL" and (FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
			<choose>
				<when test='_DateType == "ExpoOkDate"'>AND DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}</when>
			</choose>
			</if>
	        <if test='ExpoSingoNo != null and ExpoSingoNo != ""'>AND EXPT_DECL_NO LIKE '%' + #{ExpoSingoNo} + '%'</if>
	        <if test='ImpoSingoNo != null and ImpoSingoNo != ""'>AND IMPT_DECL_NO LIKE '%' + #{ImpoSingoNo} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by EXPT_DECL_NO, EXPT_LAN, EXPT_HNG
	</select>

    <select id="selectExpoDrawStatisticList1Count" resultType="map">
		select
		count(*) as 'COUNT'
		from rms.[dbo].[ED_DRAW_V]
		<where>
		    <if test='_DateType != null and _DateType != "ALL" and (FROM_DT != null and FROM_DT != "") and (TO_DT != null and TO_DT != "")'>
			<choose>
				<when test='_DateType == "ExpoOkDate"'>AND DECL_CMPL_DT BETWEEN #{FROM_DT} AND #{TO_DT}</when>
			</choose>
			</if>
	        <if test='ExpoSingoNo != null and ExpoSingoNo != ""'>AND EXPT_DECL_NO LIKE '%' + #{ExpoSingoNo} + '%'</if>
	        <if test='ImpoSingoNo != null and ImpoSingoNo != ""'>AND IMPT_DECL_NO LIKE '%' + #{ImpoSingoNo} + '%'</if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
	</select>

    <select id="selectReExpoList" resultType="map">
		select
		INV_NO,
		EXPT_DECL_NO,
		EXPT_LAN,
		EXPT_HNG,
		EXPT_CMPL_DT,
		EXPT_QTY,
		EXPT_GURAE_GBN,
		NameOfShipto,
		SERIAL_NO,
		PROD_CD,
		PROD_NM,
		EXPT_ORDR_MNG_NO,
		KEY_ED_REIMPT_MASTER,
		RMID_QTY
		from rms.[dbo].[ED_REIMPT_MASTER]
		<where>
		    and useYn = 'Y'
		    and INV_NO != ''
	        <if test='SERIAL_NO != null and SERIAL_NO != ""'>AND SERIAL_NO LIKE '%' + #{SERIAL_NO} + '%'</if>
	        <if test='SERIAL_NO1 != null and SERIAL_NO1 != ""'>AND SERIAL_NO = #{SERIAL_NO1}</if>
	        <if test='singoNo != null and singoNo != ""'>AND EXPT_DECL_NO LIKE '%' + #{singoNo} + '%'</if>
	        <if test='invoice != null and invoice != ""'>AND INV_NO LIKE '%' + #{invoice} + '%'</if>
	        <if test='item != null and item != ""'>AND PROD_CD LIKE '%' + #{item} + '%'</if>
	        <if test='(strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
				AND EXPT_CMPL_DT BETWEEN #{strFromDate} AND #{strToDate}
			</if>
			<if test='KEY_ED_REIMPT_MASTER != null and KEY_ED_REIMPT_MASTER != ""'>AND KEY_ED_REIMPT_MASTER = #{KEY_ED_REIMPT_MASTER}</if>
			<if test='NoDelete != null and NoDelete != ""'>AND (datalength(EXPT_ORDR_MNG_NO) <![CDATA[ > ]]> 0  or datalength(IMPT_ORDR_MNG_NO) <![CDATA[ > ]]> 0)</if>
        </where>
	</select>

    <update id="updateExpoHng">
		UPDATE	rms.dbo.ED_EXPT_DECL_HNG
		<trim prefix="SET" suffixOverrides=",">
			<if test='ReQTY != null'>ReQty = #{ReQTY} ,</if>
			<if test='turnQty != null'>ReQty = ReQty - #{turnQty} ,</if>
			<if test='ID != null'>editUserId = #{ID} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
		and LAN = #{LAN}
		and HNG = #{HNG}
	</update>

    <select id="selectItemPumpCheck" resultType="map">
		select
		Mmodel_code
		from CPS.[dbo].[MAAA100]
		where Mco_com in ('3128112960','1298123036')
		  and OrigExpYN = 'Y'
		  and Mhs_code = '8414109090'
		  and Mmodel_code in (
		    select PROD_CD from rms.[dbo].[ED_EXPT_INV]
			<where>
			    and  useYn='Y'
			    <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
			</where>
		 )
	</select>

    <select id="selectMyunCheck" resultType="map">
		select ItemCd
		from rms.[dbo].[ED_CSTM]
		where RsnCdEx in ('Z','X')
		and ItemCd in (select PROD_CD from rms.[dbo].[ED_EXPT_INV]
		where ((ExEmNo is null or ExEmNo = '') or (SoNo is null or SoNo = '') or (EndUserName is null or EndUserName = ''))
		and RSN_CD in ('Z','X')
		and useYn='Y'
		and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO})
		and useYn='Y'
	</select>

    <select id="selectMyunCheck3" resultType="map">
		select ItemCd
		from rms.[dbo].[ED_CSTM]
		where RsnCdEx in ('Z','X')
		and ItemCd in (select PROD_CD from rms.[dbo].[ED_EXPT_INV]
		where RSN_CD in ('Z','X')
		and useYn='Y'
		and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO})
		and useYn='Y'
	</select>

    <select id="selectMyunCheck1" resultType="map">
		select ItemCd
		from rms.[dbo].[ED_CSTM]
		where RsnCdEx in ('Z','X')
		and ItemCd in (select ITEM_CD from rms.[dbo].[ED_IMPT_INV]
		where (((ExEmNo != '') and (SoNo is null or SoNo = '') and (EndUserName is null or EndUserName = ''))
		or ((ExEmNo is null or ExEmNo = '') and (SoNo != '') and (EndUserName is null or EndUserName = ''))
		or ((ExEmNo is null or ExEmNo = '') and (SoNo is null or SoNo = '') and (EndUserName != ''))
		or ((ExEmNo != '') and (SoNo != '') and (EndUserName is null or EndUserName = ''))
		or ((ExEmNo is null or ExEmNo = '') and (SoNo != '') and (EndUserName != ''))
		or ((ExEmNo != '') and (SoNo is null or SoNo = '') and (EndUserName != '')))
		and useYn='Y'
		and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO})
		and useYn='Y'
	</select>

    <select id="selectMyunCheck2" resultType="map">
		select ItemCd
		from rms.[dbo].[ED_CSTM]
		where RsnCdEx in ('Z','X')
		and ItemCd in (select ITEM_CD from rms.[dbo].[ED_IMPT_INV]
		where SoNo is null
		and useYn='Y'
		and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO})
		and useYn='Y'
	</select>

    <select id="selectExSerialCheck" resultType="map">
		select PROD_CD from rms.[dbo].[ED_EXPT_INV]
		where (SERIAL_NO = '' or SERIAL_NO is null)
		and useYn='Y'
		and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
		<!-- and PROD_CD not in (
		select a.PROD_CD from rms.[dbo].[ED_EXPT_INV] a, rms.[dbo].[ED_CSTMNOTYOG_DTL] b
		where (a.SERIAL_NO = '' or a.SERIAL_NO is null)
		and a.EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
		and b.RSN_CD in ('Z')
		and b.cstm_mng_no in (select cstm_mng_no
		from rms.[dbo].[ED_CSTMNOTYOG]
		where EXIM_DIV='EX'
		and useYn='Y')
		and a.PROD_CD = b.ITEM_CD) -->
	</select>

    <select id="selectExSerialCheck1" resultType="map">
		select PROD_CD from rms.[dbo].[ED_EXPT_INV]
		where NOT_ORIG_STAT_QTY != 0
		and useYn='Y'
		and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
	</select>

    <select id="selectExSerialCheck2" resultType="map">
		select PROD_CD from rms.[dbo].[ED_EXPT_INV]
		where (SERIAL_NO != '' and SERIAL_NO is not null)
		and useYn='Y'
		and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
	</select>

    <select id="selectExSerialCheck3" resultType="map">
    	select 
    		case when sum(bb) - sum(aa) > 0 then 'Y' else 'N' end as 'check'
		from (
			select 
				count(*) as 'aa', 0 as 'bb' 
			from rms.[dbo].[ED_EXPT_INV]
			where useYn='Y'
			and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
			and SERIAL_NO != ''
			union all
			select 
				0 as 'aa', count(*) as 'bb' 
			from rms.[dbo].[ED_REEXPT_MASTER]
			where useYn='Y'
			and ((EHEANG_END_DT is null or EHEANG_END_DT='')
			and (YONGDO_DT is null or YONGDO_DT=''))
			and COMP_CD = #{taxNum}
			and SERIAL_NO in (
				select SERIAL_NO from rms.[dbo].[ED_EXPT_INV]
				where useYn='Y'
				and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
				and SERIAL_NO != ''
			)
		) c
	</select>

    <select id="selectExSerialNotCheck" resultType="map">
		select PROD_CD from rms.[dbo].[ED_EXPT_INV]
		where (SERIAL_NO != '' and SERIAL_NO is not null)
		and useYn='Y'
		and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}
	</select>

    <select id="selectImSerialCheck" resultType="map">
		select ITEM_CD from rms.[dbo].[ED_IMPT_INV]
		where (SERIAL_NO = '' or SERIAL_NO is null)
		and useYn='Y'
		and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
	</select>

    <select id="selectImSerialCheck1" resultType="map">
		select ITEM_CD from rms.[dbo].[ED_IMPT_INV]
		where ReQty = 0
		and useYn='Y'
		and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
	</select>

    <select id="selectImSerialCheck2" resultType="map">
		select ITEM_CD from rms.[dbo].[ED_IMPT_INV]
		where (SERIAL_NO != '' and SERIAL_NO is not null)
		and useYn='Y'
		and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
	</select>

    <select id="selectImSerialCheck3" resultType="map">
		select * from rms.[dbo].[ED_REEXPT_MASTER]
		where useYn='Y'
		and ((EHEANG_END_DT is null or EHEANG_END_DT='')
		and (YONGDO_DT is null or YONGDO_DT=''))
		and SERIAL_NO in (
		  select SERIAL_NO from rms.[dbo].[ED_IMPT_INV]
		  where useYn='Y'
		  and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO})
	</select>

    <select id="selectImSerialNotCheck" resultType="map">
		select ITEM_CD from rms.[dbo].[ED_IMPT_INV]
		where (SERIAL_NO != '' and SERIAL_NO is not null)
		and useYn='Y'
		and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
	</select>
	
	<select id="selectOrigCheck" resultType="map">
		select 
			IMPT_ORDR_MNG_NO 
		from rms.[dbo].[ED_IMPT_INV]
		where useYn = 'Y'
		and ORIG in ('KR','CX')
		and HS_CD like '841410%'
		and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
	</select>

    <select id="selectReImpoList" resultType="map">
		select
		BL_NO,
		IMPT_DECL_NO,
		IMPT_LAN,
		IMPT_HNG,
		IMPT_CMPL_DT,
		IMPT_QTY,
		RMID_QTY,
		IMPT_GURAE_GBN,
		SERIAL_NO,
		PROD_CD,
		PROD_NM,
		IMPT_ORDR_MNG_NO,
		KEY_ED_REEXPT_MASTER,
		ExEmNo,
		SoNo,
		EndUserName
		from rms.[dbo].[ED_REEXPT_MASTER]
		<where>
		    and useYn='Y'
		    and BL_NO !=''
	        <if test='SERIAL_NO != null and SERIAL_NO != ""'>AND SERIAL_NO LIKE '%' + #{SERIAL_NO} + '%'</if>
	        <if test='SERIAL_NO1 != null and SERIAL_NO1 != ""'>AND SERIAL_NO = #{SERIAL_NO1}</if>
	        <if test='singoNo != null and singoNo != ""'>AND IMPT_DECL_NO LIKE '%' + #{singoNo} + '%'</if>
	        <if test='blNo != null and blNo != ""'>AND BL_NO LIKE '%' + #{blNo} + '%'</if>
	        <if test='item != null and item != ""'>AND PROD_CD LIKE '%' + #{item} + '%'</if>
	        <if test='ExEmNo != null and ExEmNo != ""'>AND ExEmNo LIKE '%' + #{ExEmNo} + '%'</if>
	        <if test='SoNo != null and SoNo != ""'>AND SoNo LIKE '%' + #{SoNo} + '%'</if>
	        <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
	        <if test='IMPT_INV_SEQNO != null and IMPT_INV_SEQNO != ""'>AND IMPT_INV_SEQNO = #{IMPT_INV_SEQNO}</if>
	        <if test='KEY_ED_REEXPT_MASTER != null and KEY_ED_REEXPT_MASTER != ""'>AND KEY_ED_REEXPT_MASTER = #{KEY_ED_REEXPT_MASTER}</if>
	        <if test='BL_NO != null and BL_NO != ""'>AND BL_NO = #{BL_NO}</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO = #{IMPT_DECL_NO}</if>
	        <if test='LAN != null and LAN != ""'>AND IMPT_LAN = #{LAN}</if>
	        <if test='HNG != null and HNG != ""'>AND IMPT_HNG = #{HNG}</if>
	        <if test='(strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
				AND IMPT_CMPL_DT BETWEEN #{strFromDate} AND #{strToDate}
			</if>
			<if test='NoDelete != null and NoDelete != ""'>AND (datalength(EXPT_ORDR_MNG_NO) <![CDATA[ > ]]> 0  or datalength(IMPT_ORDR_MNG_NO) <![CDATA[ > ]]> 0)</if>
        </where>
	</select>

    <select id="selectReImpoList1" resultType="map">
		select
		BL_NO,
		IMPT_DECL_NO,
		IMPT_LAN,
		IMPT_HNG,
		IMPT_CMPL_DT,
		IMPT_QTY,
		RMID_QTY,
		IMPT_GURAE_GBN,
		SERIAL_NO,
		PROD_CD,
		PROD_NM,
		IMPT_ORDR_MNG_NO,
		IMPT_INV_SEQNO,
		ExEmNo,
		SoNo,
		EndUserName
		from rms.[dbo].[ED_REEXPT_MASTER]
		<where>
		    and useYn='Y'
		    and BL_NO !=''
		    and (ExEmNo is not null or ExEmNo != '')
		    and (EHEANG_END_DT = '' or EHEANG_END_DT is null)
	        <if test='SERIAL_NO != null and SERIAL_NO != ""'>AND SERIAL_NO LIKE '%' + #{SERIAL_NO} + '%'</if>
	        <if test='singoNo != null and singoNo != ""'>AND IMPT_DECL_NO LIKE '%' + #{singoNo} + '%'</if>
	        <if test='blNo != null and blNo != ""'>AND BL_NO LIKE '%' + #{blNo} + '%'</if>
	        <if test='item != null and item != ""'>AND PROD_CD LIKE '%' + #{item} + '%'</if>
	        <if test='ExEmNo != null and ExEmNo != ""'>AND ExEmNo LIKE '%' + #{ExEmNo} + '%'</if>
	        <if test='SoNo != null and SoNo != ""'>AND SoNo LIKE '%' + #{SoNo} + '%'</if>
	        <if test='(strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
				AND IMPT_CMPL_DT BETWEEN #{strFromDate} AND #{strToDate}
			</if>
        </where>
        group by BL_NO,IMPT_DECL_NO,
		IMPT_LAN,
		IMPT_HNG,
		IMPT_CMPL_DT,
		IMPT_QTY,
		RMID_QTY,
		IMPT_GURAE_GBN,
		SERIAL_NO,
		PROD_CD,
		PROD_NM,
		IMPT_ORDR_MNG_NO,
		IMPT_INV_SEQNO,
		ExEmNo,
		SoNo,
		EndUserName
	</select>

    <select id="selectReImpoCheckList" resultType="map">
		select
		*,
		rms.dbo.fn_NEW_DATE_VIEW('D1',EXPT_CMPL_DT) as 'EXPT_CMPL_DT1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',IMPT_CMPL_DT) as 'IMPT_CMPL_DT1',
		CASE WHEN RMID_QTY=0 THEN 'CLOSE'
			WHEN CONVERT(CHAR(8), DATEADD(yy,2,EXPT_CMPL_DT), 112) <![CDATA[ < ]]> CONVERT(CHAR(8), GETDATE(), 112) THEN 'CLOSE'
			ELSE 'OPEN' END AS 'STATUS'
		from rms.[dbo].[ED_REIMPT_MASTER]
		<where>
		    and useYn='Y'
		    and INV_NO !=''
		    <if test='_DateType != null and _DateType != "" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
			<choose>
			    <when test='_DateType == "addDtm"'>AND addDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate}+ '235959'</when>
				<when test='_DateType == "EXPT_CMPL_DT"'>AND EXPT_CMPL_DT BETWEEN #{strFromDate} AND #{strToDate}</when>
				<when test='_DateType == "IMPT_CMPL_DT"'>AND IMPT_CMPL_DT BETWEEN #{strFromDate} AND #{strToDate}</when>
			</choose>
			</if>
	        <if test='_DocType != null and _DocType != "" and (NODATA != null and NODATA != "")'>
			<choose>
				<when test='_DocType == "INV_NO"'>AND INV_NO like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "BL_NO"'>AND BL_NO like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "SERIAL_NO"'>AND SERIAL_NO like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "EXPT_DECL_NO"'>AND EXPT_DECL_NO like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "IMPT_DECL_NO"'>AND IMPT_DECL_NO like '%' + #{NODATA} + '%'</when>
			</choose>
			</if>
			<if test='_StatusType != null and _StatusType != ""'>
			<choose>
			    <when test='_StatusType == "OPEN"'>AND (RMID_QTY != 0 and CONVERT(CHAR(8), DATEADD(yy,2,EXPT_CMPL_DT), 112) <![CDATA[ >= ]]> CONVERT(CHAR(8), GETDATE(), 112))</when>
				<when test='_StatusType == "CLOSE"'>AND (RMID_QTY=0 or CONVERT(CHAR(8), DATEADD(yy,2,EXPT_CMPL_DT), 112) <![CDATA[ < ]]> CONVERT(CHAR(8), GETDATE(), 112))</when>
			</choose>
			</if>
			<if test='BL_NO != null and BL_NO != ""'>AND BL_NO LIKE '%' + #{BL_NO} + '%'</if>
			<if test='IMPT_INV_SEQNO != null and IMPT_INV_SEQNO != ""'>AND IMPT_INV_SEQNO LIKE '%' + #{IMPT_INV_SEQNO} + '%'</if>
			<if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND IMPT_ORDR_MNG_NO LIKE '%' + #{IMPT_ORDR_MNG_NO} + '%'</if>
			<if test='KEY_ED_REIMPT_MASTER != null and KEY_ED_REIMPT_MASTER != ""'>AND KEY_ED_REIMPT_MASTER = #{KEY_ED_REIMPT_MASTER}</if>
			<if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by EXPT_CMPL_DT
	</select>

    <select id="selectReExpoCheckList" resultType="map">
		select
		*,
		rms.dbo.fn_NEW_DATE_VIEW('D1',IMPT_CMPL_DT) as 'IMPT_CMPL_DT1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',REEX_END_DT) as 'REEX_END_DT1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',EHEANG_END_DT) as 'EHEANG_END_DT1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',YONGDO_DT) as 'YONGDO_DT1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',EXPT_CMPL_DT) as 'EXPT_CMPL_DT1',
		CASE WHEN REEX_END_DT != '' and (EHEANG_END_DT = '' or EHEANG_END_DT is null) then  DATEDIFF(DD,GETDATE(),LEFT(REEX_END_DT,8))
		else '' end as 'dayCheck',
		CASE WHEN EHEANG_END_DT != '' then '이행보고 완료'
		WHEN YONGDO_DT != '' then '용도외사용 승인'
		else '이행보고 필요' end as 'STATUS'
		from rms.[dbo].[ED_REEXPT_MASTER]
		<where>
		    and useYn='Y'
		    and BL_NO != ''
		    <if test='_DateType != null and _DateType != "" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
			<choose>
			    <when test='_DateType == "addDtm"'>AND addDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate}+ '235959'</when>
				<when test='_DateType == "EXPT_CMPL_DT"'>AND EXPT_CMPL_DT BETWEEN #{strFromDate} AND #{strToDate}</when>
				<when test='_DateType == "IMPT_CMPL_DT"'>AND IMPT_CMPL_DT BETWEEN #{strFromDate} AND #{strToDate}</when>
			</choose>
			</if>
	        <if test='_DocType != null and _DocType != "" and (NODATA != null and NODATA != "")'>
			<choose>
				<when test='_DocType == "INV_NO"'>AND INV_NO like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "BL_NO"'>AND BL_NO like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "SERIAL_NO"'>AND SERIAL_NO like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "SoNo"'>AND SoNo like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "ExEmNo"'>AND ExEmNo like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "EndUserName"'>AND EndUserName like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "EXPT_DECL_NO"'>AND EXPT_DECL_NO like '%' + #{NODATA} + '%'</when>
				<when test='_DocType == "IMPT_DECL_NO"'>AND IMPT_DECL_NO like '%' + #{NODATA} + '%'</when>
			</choose>
			</if>
			<if test='_StatusType != null and _StatusType != ""'>
			<choose>
			    <when test='_StatusType == "A"'>AND (isNull(EHEANG_END_DT,'') ='' and isNull(YONGDO_DT,'') = '')</when>
				<when test='_StatusType == "B"'>AND EHEANG_END_DT != ''</when>
				<when test='_StatusType == "C"'>AND YONGDO_DT != ''</when>
			</choose>
			</if>
			<if test='INV_NO != null and INV_NO != ""'>AND INV_NO LIKE '%' + #{INV_NO} + '%'</if>
			<if test='EXPT_INV_SEQNO != null and EXPT_INV_SEQNO != ""'>AND EXPT_INV_SEQNO LIKE '%' + #{EXPT_INV_SEQNO} + '%'</if>
			<if test='KEY_ED_REEXPT_MASTER != null and KEY_ED_REEXPT_MASTER != ""'>AND KEY_ED_REEXPT_MASTER = #{KEY_ED_REEXPT_MASTER}</if>
			<if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
        order by IMPT_CMPL_DT, IMPT_DECL_NO, IMPT_LAN, IMPT_HNG
	</select>

    <update id="updateReExpo">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		<trim prefix="SET" suffixOverrides=",">
		    <if test='EXPT_INVNO != null'>INV_NO = #{EXPT_INVNO} ,</if>
			<if test='EXPT_INV_SEQNO != null'>EXPT_INV_SEQNO = #{EXPT_INV_SEQNO} ,</if>
			<if test='Expo_gurae_gbn != null'>EXPT_GURAE_GBN = #{Expo_gurae_gbn} ,</if>
			<if test='NameOfShipto != null'>NameOfShipto = #{NameOfShipto} ,</if>
			<if test='EXPT_ORDR_MNG_NO != null'>EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO} ,</if>
			<if test='ReQTY != null'>EXPT_QTY = #{ReQTY} ,</if>
			<if test='checkQty != null'>RMID_QTY = #{checkQty} ,</if>
			<if test='Back != null'>INV_NO = '' ,</if>
			<if test='Back != null'>EXPT_INV_SEQNO = '' ,</if>
			<if test='Back != null'>EXPT_QTY = 0 ,</if>
			<if test='Back != null'>EXPT_GURAE_GBN = '' ,</if>
			<if test='Back != null'>NameOfShipto = '' ,</if>
			<if test='Back != null'>EXPT_ORDR_MNG_NO = '' ,</if>
			<if test='turnQty != null'>RMID_QTY = RMID_QTY + #{turnQty} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
			<if test='Expt_decl_no != null'>EXPT_DECL_NO = #{Expt_decl_no} ,</if>
			<if test='Expt_cmpl_dt != null'>EXPT_CMPL_DT = #{Expt_cmpl_dt} ,</if>
			<if test='Expt_lan != null'>EXPT_LAN = #{Expt_lan} ,</if>
			<if test='Expt_hng != null'>EXPT_HNG = #{Expt_hng} ,</if>
			<if test='Reex_end_dt != null'>REEX_END_DT = #{Reex_end_dt} ,</if>
			<if test='Eheang_end_dt != null'>EHEANG_END_DT = #{Eheang_end_dt} ,</if>
			<if test='Yongdo_dt != null'>YONGDO_DT = #{Yongdo_dt} ,</if>
			<if test='Delay_seq != null'>DELAY_SEQ = #{Delay_seq} ,</if>
			<if test='confirmChk != null'>confirmChk = #{confirmChk} ,</if>
			<if test='BL_NO != null'>BL_NO = #{BL_NO} ,</if>
			<if test='IMPT_DECL_NO != null'>IMPT_DECL_NO = #{IMPT_DECL_NO} ,</if>
			<if test='IMPT_LAN != null'>IMPT_LAN = #{IMPT_LAN} ,</if>
			<if test='IMPT_HNG != null'>IMPT_HNG = #{IMPT_HNG} ,</if>
			<if test='IMPT_CMPL_DT != null'>IMPT_CMPL_DT = #{IMPT_CMPL_DT} ,</if>
			<if test='IMPT_QTY != null'>IMPT_QTY = #{IMPT_QTY} ,</if>
			<if test='SERIAL_NO != null'>SERIAL_NO = #{SERIAL_NO} ,</if>
			<if test='IMPT_GURAE_GBN != null'>IMPT_GURAE_GBN = #{IMPT_GURAE_GBN} ,</if>
			<if test='PROD_CD != null'>PROD_CD = #{PROD_CD} ,</if>
			<if test='PROD_NM != null'>PROD_NM = #{PROD_NM} ,</if>
			<if test='SoNo != null'>SoNo = #{SoNo} ,</if>
			<if test='EndUserName != null'>EndUserName = #{EndUserName} ,</if>
			<if test='ExEmNo != null'>ExEmNo = #{ExEmNo} ,</if>
		</trim>
		WHERE KEY_ED_REEXPT_MASTER = #{KEY_ED_REEXPT_MASTER}
	</update>

    <update id="updateReExpo1">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		<trim prefix="SET" suffixOverrides=",">
			<if test='confirmChk != null'>confirmChk = #{confirmChk} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		<where>
		    AND useYn = 'Y'
		    <if test='EXPT_ORDR_MNG_NO != null'>and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
		    <if test='IMPT_ORDR_MNG_NO != null'>and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
		</where>
	</update>

    <update id="updateReExpo2">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		<trim prefix="SET" suffixOverrides=",">
		    <if test='EXPT_INVNO != null'>INV_NO = #{EXPT_INVNO} ,</if>
			<if test='EXPT_INV_SEQNO != null'>EXPT_INV_SEQNO = #{EXPT_INV_SEQNO} ,</if>
			<if test='Expo_gurae_gbn != null'>EXPT_GURAE_GBN = #{Expo_gurae_gbn} ,</if>
			<if test='NameOfShipto != null'>NameOfShipto = #{NameOfShipto} ,</if>
			<if test='EXPT_ORDR_MNG_NO != null'>EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO} ,</if>
			<if test='ReQTY != null'>EXPT_QTY = #{ReQTY} ,</if>
			<if test='checkQty != null'>RMID_QTY = #{checkQty} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE BL_NO = #{BL_NO}
		and IMPT_DECL_NO = #{IMPT_DECL_NO}
		and IMPT_LAN = #{LAN}
		and IMPT_HNG = #{HNG}
		and useYn = 'Y'
	</update>

    <update id="updateReExpo3">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		<trim prefix="SET" suffixOverrides=",">
			<if test='checkQty != null'>RMID_QTY = #{checkQty} ,</if>
			<if test='turnQty != null'>RMID_QTY = RMID_QTY + #{turnQty} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE BL_NO = #{BL_NO}
		and IMPT_DECL_NO = #{IMPT_DECL_NO}
		and IMPT_LAN = #{LAN}
		and IMPT_HNG = #{HNG}
		and useYn = 'Y'
	</update>

    <insert id="insertReExpo">
		INSERT INTO rms.dbo.[ED_REEXPT_MASTER]
		       ([IMPT_ORDR_MNG_NO],
				[IMPT_INV_SEQNO],
				[BL_NO],
				[IMPT_DECL_NO],
				[IMPT_LAN],
				[IMPT_HNG],
				[IMPT_CMPL_DT],
				[IMPT_QTY],
				[IMPT_GURAE_GBN],
				[REEX_END_DT],
				[EHEANG_END_DT],
				[YONGDO_DT],
				[DELAY_SEQ],
				[SoNo],
				[EndUserName],
				[ExEmNo],
				[SERIAL_NO],
				[PROD_CD],
				[PROD_NM],
				[RMID_QTY],
				[INV_NO],
				[EXPT_DECL_NO],
				[EXPT_CMPL_DT],
				[EXPT_QTY],
				[EXPT_GURAE_GBN],
				[NameOfShipto],
				[EXPT_LAN],
				[EXPT_HNG],
				[EXPO_KEY],
				[IMPO_KEY],
				[EXPT_ORDR_MNG_NO],
				[EXPT_INV_SEQNO],
				[EXPT_QTY_UNIT],
				[IMPT_QTY_UNIT],
				[REEX_END_DT_LAST],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[confirmChk],
				[COMP_CD])
		select top 1 IMPT_ORDR_MNG_NO,
				IMPT_INV_SEQNO,
				BL_NO,
				IMPT_DECL_NO,
				IMPT_LAN,
				IMPT_HNG,
				IMPT_CMPL_DT,
				IMPT_QTY,
				IMPT_GURAE_GBN,
				REEX_END_DT,
				EHEANG_END_DT,
				YONGDO_DT,
				DELAY_SEQ,
				SoNo,
				EndUserName,
				ExEmNo,
				SERIAL_NO,
				PROD_CD,
				PROD_NM,
				RMID_QTY,
				'${EXPT_INVNO}',
				EXPT_DECL_NO,
				EXPT_CMPL_DT,
				${ReQTY},
				'${Expo_gurae_gbn}',
				'${NameOfShipto}',
				EXPT_LAN,
				EXPT_HNG,
				EXPO_KEY,
				IMPO_KEY,
				'${EXPT_ORDR_MNG_NO}',
				'${EXPT_INV_SEQNO}',
				EXPT_QTY_UNIT,
				IMPT_QTY_UNIT,
				REEX_END_DT_LAST,
				'Y',
				'${addUserId}',
				'${addUserNm}',
				'${addDtm}',
				'N',
				COMP_CD
				from rms.[dbo].[ED_REEXPT_MASTER]
				WHERE BL_NO = #{BL_NO}
				and IMPT_DECL_NO = #{IMPT_DECL_NO}
				and IMPT_LAN = #{LAN}
				and IMPT_HNG = #{HNG}
				and useYn='Y'
	</insert>

    <insert id="insertReExpo1">
		INSERT INTO rms.dbo.[ED_REEXPT_MASTER]
		       ([IMPT_ORDR_MNG_NO],
				[IMPT_INV_SEQNO],
				[BL_NO],
				[IMPT_QTY],
				[IMPT_GURAE_GBN],
				[SoNo],
				[EndUserName],
				[ExEmNo],
				[SERIAL_NO],
				[PROD_CD],
				[PROD_NM],
				[RMID_QTY],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[confirmChk],
				[COMP_CD])
		VALUES
		       (#{IMPT_ORDR_MNG_NO},
				#{IMPT_INV_SEQNO},
				#{BL_NO},
				#{QTY},
				#{Impo_gele_gubun},
				#{SoNo},
				#{EndUserName},
				#{ExEmNo},
				#{SERIAL_NO},
				#{ITEM_CD},
				#{ITEM_NM},
				#{QTY},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{confirmChk},
				#{taxNum})
	</insert>

    <insert id="insertReExpo2">
		INSERT INTO rms.dbo.[ED_REEXPT_MASTER]
		       ([IMPT_ORDR_MNG_NO],
				[IMPT_INV_SEQNO],
				[BL_NO],
				[IMPT_DECL_NO],
				[IMPT_LAN],
				[IMPT_HNG],
				[IMPT_CMPL_DT],
				[IMPT_QTY],
				[IMPT_GURAE_GBN],
				[REEX_END_DT],
				[EHEANG_END_DT],
				[YONGDO_DT],
				[DELAY_SEQ],
				[SoNo],
				[EndUserName],
				[ExEmNo],
				[SERIAL_NO],
				[PROD_CD],
				[PROD_NM],
				[RMID_QTY],
				[INV_NO],
				[EXPT_DECL_NO],
				[EXPT_CMPL_DT],
				[EXPT_QTY],
				[EXPT_GURAE_GBN],
				[NameOfShipto],
				[EXPT_LAN],
				[EXPT_HNG],
				[EXPO_KEY],
				[IMPO_KEY],
				[EXPT_ORDR_MNG_NO],
				[EXPT_INV_SEQNO],
				[EXPT_QTY_UNIT],
				[IMPT_QTY_UNIT],
				[REEX_END_DT_LAST],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[confirmChk],
				[COMP_CD])
		select top 1 IMPT_ORDR_MNG_NO,
				IMPT_INV_SEQNO,
				BL_NO,
				IMPT_DECL_NO,
				IMPT_LAN,
				IMPT_HNG,
				IMPT_CMPL_DT,
				IMPT_QTY,
				IMPT_GURAE_GBN,
				REEX_END_DT,
				EHEANG_END_DT,
				YONGDO_DT,
				DELAY_SEQ,
				SoNo,
				EndUserName,
				ExEmNo,
				SERIAL_NO,
				PROD_CD,
				PROD_NM,
				RMID_QTY,
				'${EXPT_INVNO}',
				'${EXPT_DECL_NO}',
				'${EXPT_CMPL_DT}',
				${ReQTY},
				'${Expo_gurae_gbn}',
				'${NameOfShipto}',
				'${EXPT_LAN}',
				'${EXPT_HNG}',
				EXPO_KEY,
				IMPO_KEY,
				'',
				'',
				EXPT_QTY_UNIT,
				IMPT_QTY_UNIT,
				REEX_END_DT_LAST,
				'Y',
				'${addUserId}',
				'${addUserNm}',
				'${addDtm}',
				'Y',
				COMP_CD
				from rms.[dbo].[ED_REEXPT_MASTER]
				where IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
				and IMPT_INV_SEQNO = #{IMPT_INV_SEQNO}
				and useYn='Y'
	</insert>

    <insert id="insertReImpo">
		INSERT INTO rms.dbo.[ED_REIMPT_MASTER]
		       ([EXPT_ORDR_MNG_NO],
				[EXPT_INV_SEQNO],
				[INV_NO],
				[EXPT_QTY],
				[EXPT_GURAE_GBN],
				[NameOfShipto],
				[SERIAL_NO],
				[PROD_CD],
				[PROD_NM],
				[RMID_QTY],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[confirmChk],
				[COMP_CD])
		VALUES
		       (#{EXPT_ORDR_MNG_NO},
				#{EXPT_INV_SEQNO},
				#{INV_NO1},
				#{QTY},
				#{Expo_gurae_gbn},
				#{NameOfShipto},
				#{SERIAL_NO},
				#{PROD_CD},
				#{PROD_NM},
				#{QTY},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{confirmChk},
				#{taxNum})
	</insert>

    <update id="updateReImpo">
		UPDATE	rms.dbo.[ED_REIMPT_MASTER]
		<trim prefix="SET" suffixOverrides=",">
		    <if test='BL_NO != null'>BL_NO = #{BL_NO} ,</if>
			<if test='IMPT_INV_SEQNO != null'>IMPT_INV_SEQNO = #{IMPT_INV_SEQNO} ,</if>
			<if test='Impo_gele_gubun != null'>IMPT_GURAE_GBN = #{Impo_gele_gubun} ,</if>
			<if test='IMPT_ORDR_MNG_NO != null'>IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO} ,</if>
			<if test='ReQTY != null'>IMPT_QTY = #{ReQTY} ,</if>
			<if test='checkQty != null'>RMID_QTY = #{checkQty} ,</if>
			<if test='Back != null'>BL_NO = '' ,</if>
			<if test='Back != null'>IMPT_INV_SEQNO = '' ,</if>
			<if test='Back != null'>IMPT_QTY = 0 ,</if>
			<if test='Back != null'>IMPT_GURAE_GBN = '' ,</if>
			<if test='Back != null'>IMPT_ORDR_MNG_NO = '' ,</if>
			<if test='turnQty != null'>RMID_QTY = RMID_QTY + #{turnQty} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
			<if test='Impt_decl_no != null'>IMPT_DECL_NO = #{Impt_decl_no} ,</if>
			<if test='Impt_cmpl_dt != null'>IMPT_CMPL_DT = #{Impt_cmpl_dt} ,</if>
			<if test='Impt_lan != null'>IMPT_LAN = #{Impt_lan} ,</if>
			<if test='Impt_hng != null'>IMPT_HNG = #{Impt_hng} ,</if>
			<if test='confirmChk != null'>confirmChk = #{confirmChk} ,</if>
			<if test='INV_NO != null'>INV_NO = #{INV_NO} ,</if>
			<if test='EXPT_DECL_NO != null'>EXPT_DECL_NO = #{EXPT_DECL_NO} ,</if>
			<if test='EXPT_LAN != null'>EXPT_LAN = #{EXPT_LAN} ,</if>
			<if test='EXPT_HNG != null'>EXPT_HNG = #{EXPT_HNG} ,</if>
			<if test='EXPT_CMPL_DT != null'>EXPT_CMPL_DT = #{EXPT_CMPL_DT} ,</if>
			<if test='EXPT_QTY != null'>EXPT_QTY = #{EXPT_QTY} ,</if>
			<if test='EXPT_GURAE_GBN != null'>EXPT_GURAE_GBN = #{EXPT_GURAE_GBN} ,</if>
			<if test='NameOfShipto != null'>NameOfShipto = #{NameOfShipto} ,</if>
			<if test='SERIAL_NO != null'>SERIAL_NO = #{SERIAL_NO} ,</if>
			<if test='PROD_CD != null'>PROD_CD = #{PROD_CD} ,</if>
			<if test='PROD_NM != null'>PROD_NM = #{PROD_NM} ,</if>
		</trim>
		WHERE KEY_ED_REIMPT_MASTER = #{KEY_ED_REIMPT_MASTER}
	</update>

    <update id="updateReImpo1">
		UPDATE	rms.dbo.[ED_REIMPT_MASTER]
		<trim prefix="SET" suffixOverrides=",">
			<if test='confirmChk != null'>confirmChk = #{confirmChk} ,</if>
			<if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		<where>
		    AND useYn = 'Y'
		    <if test='EXPT_ORDR_MNG_NO != null'>and EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
		    <if test='IMPT_ORDR_MNG_NO != null'>and IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
		</where>
	</update>

    <select id="selectBomMaster1" resultType="map" fetchSize="100">
		select
		*
		from rms.dbo.[ED_BOM_MASTER]
		<where>
		    and useYn='Y'
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "BOM_CD"'>AND BOM_CD LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "ITEM_CD"'>AND ITEM_CD LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
            <if test='REVSN_DTTM != null and REVSN_DTTM != ""'>AND REVSN_DTTM = #{REVSN_DTTM}</if>
            <if test='USE_FG != null and USE_FG != ""'>AND USE_FG = #{USE_FG}</if>
            <if test='BOM_CD != null and BOM_CD != ""'>AND BOM_CD = #{BOM_CD}</if>
            <if test='REVSN_NO != null and REVSN_NO != ""'>AND REVSN_NO = #{REVSN_NO}</if>
            <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by KEY_ED_BOM_MASTER desc
	</select>

    <select id="selectBomMaster1Count" resultType="map">
		select
		count(*) as 'COUNT'
		from rms.dbo.[ED_BOM_MASTER]
		<where>
		    and useYn='Y'
            <if test='NOCHK != null and NOCHK != "" and (NODATA != null and NODATA != "")'>
	            <choose>
	                <when test='NOCHK == "BOM_CD"'>AND BOM_CD LIKE '%'+ #{NODATA} + '%'</when>
	                <when test='NOCHK == "ITEM_CD"'>AND ITEM_CD LIKE '%'+ #{NODATA} + '%'</when>
	            </choose>
        	</if>
            <if test='REVSN_DTTM != null and REVSN_DTTM != ""'>AND REVSN_DTTM = #{REVSN_DTTM}</if>
            <if test='USE_FG != null and USE_FG != ""'>AND USE_FG = #{USE_FG}</if>
            <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
	</select>

    <update id="updateBomMaster1">
		UPDATE	rms.dbo.[ED_BOM_MASTER]
		<trim prefix="SET" suffixOverrides=",">
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='userKey != null'>editUserId = #{userKey} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE KEY_ED_BOM_MASTER = #{KEY_ED_BOM_MASTER}
	</update>

    <update id="updateBomMaster2">
		UPDATE	rms.dbo.[ED_BOM_MASTER]
		<trim prefix="SET" suffixOverrides=",">
		    <if test='BOM_CD != null'>USE_FG = 'N' ,</if>
			<if test='userKey != null'>editUserId = #{userKey} ,</if>
			<if test='userNm != null'>editUserNm = #{userNm} ,</if>
			<if test='currentDatetime != null'>editDtm = #{currentDatetime} ,</if>
		</trim>
		WHERE BOM_CD = #{BOM_CD}
	</update>

    <insert id="insertBOM">
		INSERT INTO rms.dbo.[ED_BOM_MASTER]
		       ([BOM_CD],
				[BOM_NM],
				[REVSN_NO],
				[REVSN_DTTM],
				[REVSN_DTTM1],
				[QTY_UNIT],
				[DEMD_PLAN_FG],
				[USE_EXEC_FG],
				[REFUND_USE_FG],
				[ITEM_CD],
				[ITEM_NM],
				[QTY],
				[USE_FG],
				[useYn],
				[addUserId],
				[addUserNm],
				[addDtm],
				[COMP_CD])
		VALUES
		       (#{BOM_CD},
				#{BOM_NM},
				#{REVSN_NO},
				#{REVSN_DTTM},
				#{REVSN_DTTM1},
				#{QTY_UNIT},
				#{DEMD_PLAN_FG},
				#{USE_EXEC_FG},
				#{REFUND_USE_FG},
				#{ITEM_CD},
				#{ITEM_NM},
				#{QTY},
				#{USE_FG},
				#{useYn},
				#{addUserId},
				#{addUserNm},
				#{addDtm},
				#{taxNum1})
	</insert>

    <select id="selectReExpoDetail" resultType="map">
		select
		count(*) as 'count'
		from rms.dbo.[ED_REEXPOBJCLOSE_DTL]
		<where>
		    AND useYn = 'Y'
		    <if test='ORDR_NO != null'>and ORDR_NO = #{ORDR_NO}</if>
		    <if test='IMPT_DECL_NO != null'>and IMPT_DECL_NO = #{IMPT_DECL_NO}</if>
		    <if test='LAN != null'>and LAN = #{LAN}</if>
		    <if test='HNG != null'>and HNG = #{HNG}</if>
		</where>
	</select>

    <select id="selectAutoReExpo" resultType="map">
		select
		a.KEY_ED_EXPT_INV,
		a.EXPT_ORDR_MNG_NO,
		a.EXPT_INV_SEQNO,
		a.QTY,
		b.KEY_ED_REEXPT_MASTER,
		b.IMPT_ORDR_MNG_NO,
		b.IMPT_LAN,
		b.IMPT_HNG
		from rms.[dbo].[ED_EXPT_INV] a, rms.[dbo].[ED_REEXPT_MASTER] b
		<where>
		    and a.SERIAL_NO = b.SERIAL_NO
		    and a.QTY = b.IMPT_QTY
			and a.SERIAL_NO !=''
			and a.NOT_ORIG_STAT_QTY !='0'
			and a.useYn='Y'
			and b.useYn='Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND a.EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
        </where>
	</select>

    <select id="selectAutoReImpo" resultType="map">
		select
		a.KEY_ED_IMPT_INV,
		a.IMPT_ORDR_MNG_NO,
		a.IMPT_INV_SEQNO,
		a.QTY,
		b.KEY_ED_REIMPT_MASTER,
		b.EXPT_ORDR_MNG_NO,
		b.EXPT_LAN,
		b.EXPT_HNG
		from rms.[dbo].[ED_IMPT_INV] a, rms.[dbo].[ED_REIMPT_MASTER] b
		<where>
		    and a.SERIAL_NO = b.SERIAL_NO
			and a.QTY = b.EXPT_QTY
			and a.SERIAL_NO !=''
			and a.ReQty = '0'
			and a.useYn='Y'
			and b.useYn='Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND a.IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
        </where>
	</select>

	<select id="selectAutoReImpoCancel" resultType="map">
		select
		a.KEY_ED_IMPT_INV,
		a.IMPT_ORDR_MNG_NO,
		a.IMPT_INV_SEQNO,
		a.ReQty,
		b.KEY_ED_REIMPT_MASTER,
		b.EXPT_ORDR_MNG_NO,
		b.EXPT_LAN,
		b.EXPT_HNG
		from rms.[dbo].[ED_IMPT_INV] a, rms.[dbo].[ED_REIMPT_MASTER] b
		<where>
		    and a.SERIAL_NO = b.SERIAL_NO
			and a.QTY = b.EXPT_QTY
			and a.SERIAL_NO !=''
			and a.ReQty != '0'
			and a.useYn='Y'
			and b.useYn='Y'
            <if test='IMPT_ORDR_MNG_NO != null and IMPT_ORDR_MNG_NO != ""'>AND a.IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}</if>
        </where>
	</select>

	<select id="selectAutoReExpoCancel" resultType="map">
		select
		a.KEY_ED_EXPT_INV,
		a.EXPT_ORDR_MNG_NO,
		a.EXPT_INV_SEQNO,
		a.ORIG_STAT_QTY,
		b.KEY_ED_REEXPT_MASTER,
		b.IMPT_ORDR_MNG_NO,
		b.IMPT_LAN,
		b.IMPT_HNG
		from rms.[dbo].[ED_EXPT_INV] a, rms.[dbo].[ED_REEXPT_MASTER] b
		<where>
		    and a.SERIAL_NO = b.SERIAL_NO
		    and a.QTY = b.IMPT_QTY
			and a.SERIAL_NO !=''
			and a.ORIG_STAT_QTY !='0'
			and a.useYn='Y'
			and b.useYn='Y'
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND a.EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO}</if>
        </where>
	</select>

	<select id="testExcel" resultType="java.util.LinkedHashMap">
		select
		EXPT
		from rms.dbo.ED_TEST
	</select>

	<select id="selectReExpoCount" resultType="map">
		select
		SERIAL_NO,
		IMPT_ORDR_MNG_NO,
		EXPT_ORDR_MNG_NO
		from rms.[dbo].[ED_REIMPT_MASTER]
		<where>
		    and useYn = 'Y'
	        <if test='INV_NO != null and INV_NO != ""'>AND INV_NO = #{INV_NO}</if>
	        <if test='EXPT_DECL_NO != null and EXPT_DECL_NO != ""'>AND EXPT_DECL_NO = #{EXPT_DECL_NO}</if>
	        <if test='EXPT_LAN != null and EXPT_LAN != ""'>AND EXPT_LAN = #{EXPT_LAN}</if>
	        <if test='EXPT_HNG != null and EXPT_HNG != ""'>AND EXPT_HNG = #{EXPT_HNG}</if>
	        <if test='SERIAL_NO != null and SERIAL_NO != ""'>AND SERIAL_NO = #{SERIAL_NO}</if>
        </where>
	</select>

	<select id="selectReImpoCount" resultType="map">
		select
		KEY_ED_REEXPT_MASTER,
		INV_NO,
		EXPT_DECL_NO,
		EXPT_LAN,
		EXPT_HNG,
		EXPT_ORDR_MNG_NO,
		IMPT_ORDR_MNG_NO
		from rms.[dbo].[ED_REEXPT_MASTER]
		<where>
		    and useYn = 'Y'
		    <if test='BL_NO != null and BL_NO != ""'>AND BL_NO = #{BL_NO}</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO = #{IMPT_DECL_NO}</if>
	        <if test='IMPT_LAN != null and IMPT_LAN != ""'>AND IMPT_LAN = #{IMPT_LAN}</if>
	        <if test='IMPT_HNG != null and IMPT_HNG != ""'>AND IMPT_HNG = #{IMPT_HNG}</if>
	        <if test='SoNo != null and SoNo != ""'>AND SoNo = #{SoNo}</if>
	        <if test='EndUserName != null and EndUserName != ""'>AND EndUserName = #{EndUserName}</if>
	        <if test='ExEmNo != null and ExEmNo != ""'>AND ExEmNo = #{ExEmNo}</if>
	        <if test='SERIAL_NO != null and SERIAL_NO != ""'>AND SERIAL_NO = #{SERIAL_NO}</if>
	        <if test='INV_NO != null and INV_NO != ""'>AND INV_NO = #{INV_NO}</if>
	        <if test='EXPT_DECL_NO != null and EXPT_DECL_NO != ""'>AND EXPT_DECL_NO = #{EXPT_DECL_NO}</if>
	        <if test='EXPT_LAN != null and EXPT_LAN != ""'>AND EXPT_LAN = #{EXPT_LAN}</if>
	        <if test='EXPT_HNG != null and EXPT_HNG != ""'>AND EXPT_HNG = #{EXPT_HNG}</if>
	        <if test='Request != null and Request != ""'>AND IMPT_ORDR_MNG_NO is not null</if>
        </where>
	</select>

	<update id="updateReImpoCount">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		<trim prefix="SET" suffixOverrides=",">
		    <if test='REEX_END_DT != null'>REEX_END_DT = #{REEX_END_DT} ,</if>
			<if test='EHEANG_END_DT != null'>EHEANG_END_DT = #{EHEANG_END_DT} ,</if>
			<if test='YONGDO_DT != null'>YONGDO_DT = #{YONGDO_DT} ,</if>
			<if test='RMID_QTY != null'>RMID_QTY = #{RMID_QTY} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE BL_NO = #{BL_NO}
		and IMPT_DECL_NO = #{IMPT_DECL_NO}
		and IMPT_LAN = #{IMPT_LAN}
		and IMPT_HNG = #{IMPT_HNG}
		and useYn = 'Y'
	</update>

	<select id="selectReImpoCount1" resultType="map">
		select
		sum(EXPT_QTY) as 'SumExQty',
		count(*) as 'ExCount'
		from rms.[dbo].[ED_REEXPT_MASTER]
		<where>
		    and useYn = 'Y'
		    <if test='BL_NO != null and BL_NO != ""'>AND BL_NO = #{BL_NO}</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO = #{IMPT_DECL_NO}</if>
	        <if test='IMPT_LAN != null and IMPT_LAN != ""'>AND IMPT_LAN = #{IMPT_LAN}</if>
	        <if test='IMPT_HNG != null and IMPT_HNG != ""'>AND IMPT_HNG = #{IMPT_HNG}</if>
	        <if test='SoNo != null and SoNo != ""'>AND SoNo = #{SoNo}</if>
	        <if test='EndUserName != null and EndUserName != ""'>AND EndUserName = #{EndUserName}</if>
	        <if test='ExEmNo != null and ExEmNo != ""'>AND ExEmNo = #{ExEmNo}</if>
	        <if test='SERIAL_NO != null and SERIAL_NO != ""'>AND SERIAL_NO = #{SERIAL_NO}</if>
        </where>
	</select>

	<select id="selectReImpoCount2" resultType="map">
		select
		sum(EXPT_QTY) as 'SumExQty',
		count(*) as 'ExCount'
		from rms.[dbo].[ED_REEXPT_MASTER]
		<where>
		    and useYn = 'Y'
		    <if test='BL_NO != null and BL_NO != ""'>AND BL_NO = #{BL_NO}</if>
	        <if test='IMPT_DECL_NO != null and IMPT_DECL_NO != ""'>AND IMPT_DECL_NO = #{IMPT_DECL_NO}</if>
	        <if test='IMPT_LAN != null and IMPT_LAN != ""'>AND IMPT_LAN = #{IMPT_LAN}</if>
	        <if test='IMPT_HNG != null and IMPT_HNG != ""'>AND IMPT_HNG = #{IMPT_HNG}</if>
	        <if test='SoNo != null and SoNo != ""'>AND SoNo = #{SoNo}</if>
	        <if test='EndUserName != null and EndUserName != ""'>AND EndUserName = #{EndUserName}</if>
	        <if test='ExEmNo != null and ExEmNo != ""'>AND ExEmNo = #{ExEmNo}</if>
	        <if test='SERIAL_NO != null and SERIAL_NO != ""'>AND SERIAL_NO = #{SERIAL_NO}</if>
	        <if test='INV_NO != null and INV_NO != ""'>AND INV_NO != #{INV_NO}</if>
	        <if test='EXPT_DECL_NO != null and EXPT_DECL_NO != ""'>AND EXPT_DECL_NO != #{EXPT_DECL_NO}</if>
	        <if test='EXPT_LAN != null and EXPT_LAN != ""'>AND EXPT_LAN != #{EXPT_LAN}</if>
	        <if test='EXPT_HNG != null and EXPT_HNG != ""'>AND EXPT_HNG != #{EXPT_HNG}</if>
        </where>
	</select>

	<update id="updateNullInv">
		UPDATE	rms.dbo.[ED_REIMPT_MASTER]
		set INV_NO = ''
		WHERE INV_NO is null
	</update>

	<update id="updateNullDecl">
		UPDATE	rms.dbo.[ED_REIMPT_MASTER]
		set EXPT_DECL_NO = ''
		WHERE EXPT_DECL_NO is null
	</update>

	<update id="updateNullLan">
		UPDATE	rms.dbo.[ED_REIMPT_MASTER]
		set EXPT_LAN = ''
		WHERE EXPT_LAN is null
	</update>

	<update id="updateNullHng">
		UPDATE	rms.dbo.[ED_REIMPT_MASTER]
		set EXPT_HNG = ''
		WHERE EXPT_HNG is null
	</update>

	<update id="updateNullSel">
		UPDATE	rms.dbo.[ED_REIMPT_MASTER]
		set SERIAL_NO = ''
		WHERE SERIAL_NO is null
	</update>

	<update id="updateNullBl">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set BL_NO = ''
		WHERE BL_NO is null
	</update>

	<update id="updateNullImDecl">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set IMPT_DECL_NO = ''
		WHERE IMPT_DECL_NO is null
	</update>

	<update id="updateNullImLan">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set IMPT_LAN = ''
		WHERE IMPT_LAN is null
	</update>

	<update id="updateNullImHng">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set IMPT_HNG = ''
		WHERE IMPT_HNG is null
	</update>

	<update id="updateNullSo">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set SoNo = ''
		WHERE SoNo is null
	</update>

	<update id="updateNullEn">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set EndUserName = ''
		WHERE EndUserName is null
	</update>

	<update id="updateNullEx">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set ExEmNo = ''
		WHERE ExEmNo is null
	</update>

	<update id="updateNullImSl">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set SERIAL_NO = ''
		WHERE SERIAL_NO is null
	</update>

	<update id="updateNullExIv">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set INV_NO = ''
		WHERE INV_NO is null
	</update>

	<update id="updateNullExDecl">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set EXPT_DECL_NO = ''
		WHERE EXPT_DECL_NO is null
	</update>

	<update id="updateNullExLan">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set EXPT_LAN = ''
		WHERE EXPT_LAN is null
	</update>

	<update id="updateNullExHng">
		UPDATE	rms.dbo.[ED_REEXPT_MASTER]
		set EXPT_HNG = ''
		WHERE EXPT_HNG is null
	</update>

	<select id="selectQtyLogList" resultType="map">
		select
		*
		from rms.dbo.ED_QTY_LOG
		<where>
            <if test='impoSingoNo != null and impoSingoNo != ""'>AND IMPT_SINGO_NO = #{impoSingoNo}</if>
            <if test='(strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
	            AND REG_DT BETWEEN #{strFromDate} AND #{strToDate}
	        </if>
	        <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum}</if>
        </where>
		order by KEY_ED_QTY_LOG desc
	</select>

	<select id="selectKitList" resultType="map">
		select
		*,
		CASE WHEN KitSMgbn='1' THEN 'SERVICE'
		WHEN KitSMgbn='2' THEN 'MACHINED' ELSE '' END AS 'KitSMgbn1'
		from rms.[dbo].[ED_KITBOM_MST]
		<where>
		    and useYn='Y'
            <if test='KitMNGNO != null and KitMNGNO != ""'>AND KitMNGNO = #{KitMNGNO}</if>
            <if test='KitCode != null and KitCode != ""'>AND KitCode LIKE '%'+ #{KitCode} + '%'</if>
            <if test='KitHsCD != null and KitHsCD != ""'>AND KitHsCD LIKE '%'+ #{KitHsCD} + '%'</if>
            <if test='KitDesc != null and KitDesc != ""'>AND KitDesc LIKE '%'+ #{KitDesc} + '%'</if>
            <if test='ItemCd != null and ItemCd != ""'>AND KitMNGNO in ( select KitMNGNO from rms.[dbo].[ED_KITBOM_DTL] where ItemCd LIKE '%'+ #{ItemCd} + '%')</if>
        </where>
		order by KEY_ED_KITBOM_MST desc
	</select>

	<select id="selectKitItemList" resultType="map">
		select
		*,
		CASE WHEN KitGbn='C1' THEN '일반'
		WHEN KitGbn='C2' THEN '원상태'
		WHEN KitGbn='C3' THEN '제조'
		WHEN KitGbn='C4' THEN '기납원상태' ELSE '' END AS 'KitGbn1'
		from rms.[dbo].[ED_KITBOM_DTL]
		<where>
		    and useYn='Y'
            <if test='KitMNGNO != null and KitMNGNO != ""'>AND KitMNGNO = #{KitMNGNO}</if>
            <if test='KitCode != null and KitCode != ""'>AND KitCode LIKE '%'+ #{KitCode} + '%'</if>
            <if test='ItemCd != null and ItemCd != ""'>AND ItemCd LIKE '%'+ #{ItemCd} + '%'</if>
            <if test='ItemNm != null and ItemNm != ""'>AND ItemNm LIKE '%'+ #{ItemNm} + '%'</if>
            <if test='ItemHsCd != null and ItemHsCd != ""'>AND ItemHsCd LIKE '%'+ #{ItemHsCd} + '%'</if>
            <if test='KitGbn != null and KitGbn != ""'>AND KitGbn = #{KitGbn}</if>
        </where>
		order by KEY_ED_KITBOM_DTL desc
	</select>

	<select id="selectKitExcelList" resultType="map">
		select
		a.KitCode, a.KitHsCD, a.KitDesc, a.KitQtyUnit, b.ItemCd, b.ItemUseQty, b.ItemHsCd, b.ItemQtyUnit, b.AmtRate, b.ItemOri, b.ItemNm,
		CASE WHEN a.KitSMgbn='1' THEN 'SERVICE'
		WHEN a.KitSMgbn='2' THEN 'MACHINED' ELSE '' END AS 'KitSMgbn1',
		CASE WHEN KitGbn='C1' THEN '일반'
		WHEN KitGbn='C2' THEN '원상태'
		WHEN KitGbn='C3' THEN '제조'
		WHEN KitGbn='C4' THEN '기납원상태' ELSE '' END AS 'KitGbn1'
		from rms.[dbo].[ED_KITBOM_MST] a, rms.[dbo].[ED_KITBOM_DTL] b
		<where>
		    and a.KitMNGNO = b.KitMNGNO
			and a.useYn='Y'
			and b.useYn='Y'
            <if test='KitMNGNO != null and KitMNGNO != ""'>AND a.KitMNGNO = #{KitMNGNO}</if>
            <if test='KitCode != null and KitCode != ""'>AND a.KitCode LIKE '%'+ #{KitCode} + '%'</if>
            <if test='KitHsCD != null and KitHsCD != ""'>AND a.KitHsCD LIKE '%'+ #{KitHsCD} + '%'</if>
            <if test='KitDesc != null and KitDesc != ""'>AND a.KitDesc LIKE '%'+ #{KitDesc} + '%'</if>
            <if test='ItemCd != null and ItemCd != ""'>AND b.ItemCd LIKE '%'+ #{ItemCd} + '%'</if>
        </where>
		order by a.KEY_ED_KITBOM_MST desc
	</select>

	<select id="selectImInvNoCheck" resultType="map">
	    select INV_NO from rms.[dbo].[ED_IMPT_INV]
		where IMPT_ORDR_MNG_NO not in (#{IMPT_ORDR_MNG_NO})
		and useYn = 'Y'
		and INV_NO in (select INV_NO from rms.[dbo].[ED_IMPT_INV]
		where IMPT_ORDR_MNG_NO = #{IMPT_ORDR_MNG_NO}
		and useYn = 'Y'
		and INV_NO != ''
		group by INV_NO)
		group by INV_NO
	</select>

	<select id="selectGinapList" resultType="map">
	    select * from rms.[dbo].[ED_ItemGiNap]
		<where>
			and useYn='Y'
            <if test='JpCode != null and JpCode != ""'>AND JpCode LIKE '%'+ #{JpCode} + '%'</if>
            <if test='ItemCd != null and ItemCd != ""'>AND ItemCode LIKE '%'+ #{ItemCd} + '%'</if>
            <if test='taxNum != null and taxNum != ""'>AND COMP_CD = #{taxNum} </if>
        </where>
		order by KEY_ED_ItemGiNap desc
	</select>
	
	<select id="selectFCNCheck" resultType="map">
	   	select * from rms.dbo.ED_EXPT_INV
		<where>
			and useYn = 'Y'
			and ORIG_CERT_FG = 'N'
			and HS_CD = '8414109090'			
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO} </if>
        </where>
	</select>
	
	<select id="selectFCNCheck1" resultType="map">
	   	select * from rms.dbo.ED_EXPT_INV
		<where>
			and useYn = 'Y'
			and ORIG_CERT_FG = 'N'
			and PROD_CD in (
				select ITEM_CD from rms.[dbo].[ED_CO_DTL]
				where CO_ORDR_MNG_NO = 'CO2023103001'
				and useYn='Y'
			)			
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO} </if>
        </where>
	</select>
	
	<select id="selectHsCodeCheck" resultType="map">
	   	select * from rms.dbo.ED_EXPT_INV
		<where>
			and useYn = 'Y'
			and HS_CD in ('8414109010','8414109020')			
            <if test='EXPT_ORDR_MNG_NO != null and EXPT_ORDR_MNG_NO != ""'>AND EXPT_ORDR_MNG_NO = #{EXPT_ORDR_MNG_NO} </if>
        </where>
	</select>
</mapper>