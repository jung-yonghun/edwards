<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (c) SEIN
  ~ All rights reserved.
  ~ This software is the confidential and proprietary information of SEIN. ("Confidential Information").
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edwards.biz.customsManagement.ImpoCustomsMapper">
    <select id="selectImportStatusList" resultType="map">
        /* 수입통관현황 (Import Status) */
        SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_napse_saup, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun, Impo_indo_jogun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan, Impo_vat_gwapyo,
		ISNULL((SELECT segwan_name FROM ${_defaultDB}.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ${_defaultDB}.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		Impo_suipja_code, #{_defaultDB} as 'defaultDB',
		impo_gyelje_money, impo_gele_gubun, Impo_plus_yul_gubun, Impo_plus_yul, Impo_plus_money, Impo_plus_won,
		Impo_file_no1+''+Impo_file_no2 as 'Impo_file_no'
		FROM ${_defaultDB}.[kcba].[Impo1] WITH (NOLOCK)
        WHERE ISNULL(Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND (Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%' or Impo_file_no2 LIKE '%' + #{impoFileNo1} + '%')</if>
        <if test='impoFileNo1Total != null and impoFileNo1Total != ""'>AND Impo_file_no1 in ${impoFileNo1Total}</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND (ISNULL(Impo_ok_date, '') = '' and ISNULL(Impo_jubsu_date, '') = '')</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND impo_cs in ('O','R','T','W','Y')</if>
        <if test='_Unbanchul != null and _Unbanchul != ""'>AND ISNULL(Impo_upja_sangho, '') = ''</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='chamjoNo != null and chamjoNo != ""'>AND impo_chamjo_no LIKE '%' + #{chamjoNo} + '%'</if>
        <if test='impoHs != null and impoHs != ""'>AND impo_key in (select Imlan_key from ${_defaultDB}.[kcba].[Impo2] where Imlan_hs LIKE #{impoHs} + '%')</if>
        <if test='impoJajae != null and impoJajae != ""'>AND impo_key in (select Impum_key from ${_defaultDB}.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impoJajae} + '%')</if>
        <if test='imlanGuraePum != null and imlanGuraePum != ""'>AND impo_key in (select Imlan_key from ${_defaultDB}.[kcba].[Impo2] where Imlan_jechl_lan = '001' and Imlan_gurae_pum LIKE '%' + #{imlanGuraePum} + '%')</if>
        <if test='yogun != null and yogun != ""'>
            <choose>
                <when test='yogun == "Y"'>AND impo_key in (select SUIPYOGUN_KEY from ${_defaultDB}.[kcba].[IMPO41] where SUIPYOGUN_KEY in (select Impo_key from ${_defaultDB}.kcba.impo1 where impo_napse_saup = #{taxNum}))</when>
                <when test='yogun == "N"'>AND impo_key not in (select SUIPYOGUN_KEY from ${_defaultDB}.[kcba].[IMPO41] where SUIPYOGUN_KEY in (select Impo_key from ${_defaultDB}.kcba.impo1 where impo_napse_saup = #{taxNum}))</when>
            </choose>
        </if>
        <if test='impoSuipCode != null and impoSuipCode != ""'>
            <choose>
                <when test='impoSuipCode == "complete"'>AND impo_suipja_code = 'POSA'</when>
                <when test='impoSuipCode == "part"'>AND impo_suipja_code = 'POPA'</when>
                <when test='impoSuipCode == "etc"'>AND impo_suipja_code not in ('POSA','POPA')</when>
            </choose>
        </if>
        order by Impo_singo_no desc
    </select>

    <select id="selectImportStatusTotalList" resultType="map">
        /* 수입통관현황 (Import Status) impo1+impo3 */
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_napse_saup, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_indo_jogun,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		a.Impo_plus_yul_gubun, a.Impo_plus_yul, a.Impo_plus_money, a.Impo_plus_won,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_vat_gwapyo,
		ISNULL((SELECT segwan_name FROM ${_defaultDB}.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ${_defaultDB}.[kcba].[Impo2] WITH (NOLOCK) WHERE a.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		a.Impo_suipja_code, #{_defaultDB} as 'defaultDB', a.impo_gyelje_money, a.impo_gele_gubun,
		char(9)+b.Impum_lan as 'Impum_lan', char(9)+b.Impum_heang as 'Impum_heang', b.Impum_jajae_code, b.Impum_su, b.Impum_su_danwi, b.Impum_danga,
		b.Impum_amt, b.Impum_ivno, b.Impum_gukyk1, b.Impum_gukyk2, b.Impum_gukyk3, b.Impum_sungbun1, b.Impum_sungbun2, b.Impum_sungbun3, b.C31, b.IMPUM_KEYWD
		FROM ${_defaultDB}.[kcba].[Impo1] a WITH (NOLOCK), ncustoms.[kcba].[Impo3] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        and a.impo_key = b.impum_key
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND (a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%' or a.Impo_file_no2 LIKE '%' + #{impoFileNo1} + '%')</if>
        <if test='impoFileNo1Total != null and impoFileNo1Total != ""'>AND a.Impo_file_no1 in ${impoFileNo1Total}</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoSuipCode != null and impoSuipCode != ""'>
            <choose>
                <when test='impoSuipCode == "complete"'>AND a.impo_suipja_code = 'POSA'</when>
                <when test='impoSuipCode == "part"'>AND a.impo_suipja_code = 'POPA'</when>
                <when test='impoSuipCode == "etc"'>AND a.impo_suipja_code not in ('POSA','POPA')</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='chamjoNo != null and chamjoNo != ""'>AND a.impo_chamjo_no LIKE '%' + #{chamjoNo} + '%'</if>
        <if test='impoHs != null and impoHs != ""'>AND a.impo_key in (select Imlan_key from ${_defaultDB}.[kcba].[Impo2] where Imlan_hs LIKE #{impoHs} + '%')</if>
        <if test='impoJajae != null and impoJajae != ""'>AND a.impo_key in (select Impum_key from ${_defaultDB}.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impoJajae} + '%')</if>
        order by a.Impo_singo_no desc
    </select>

    <select id="selectImportStatusDetail" resultType="map">
        /* 수입통관현황 (Import Status) */
        SELECT
		*,
		ISNULL((SELECT CD_ABB FROM soo_MST.dbo.TBR_SYS_CODE WITH (NOLOCK) WHERE MCD = 'IMP_CSCL_PLAN_CD' and CD= a.Impo_plan), '') AS 'planName',
		ISNULL((SELECT CD_DESC FROM soo_MST.dbo.TBR_SYS_CODE WITH (NOLOCK) WHERE MCD = 'IMP_DCLR_TPCD' and CD= a.Impo_singo_gubun), '') AS 'singoGubunName',
		ISNULL((SELECT CD_ABB FROM soo_MST.dbo.TBR_SYS_CODE WITH (NOLOCK) WHERE MCD = 'IMP_DLNG_TPCD' and CD= a.Impo_gele_gubun), '') AS 'geleGubunName',
		ISNULL((SELECT CD_ABB FROM soo_MST.dbo.TBR_SYS_CODE WITH (NOLOCK) WHERE MCD = 'IMP_KCD' and CD= a.Impo_jonglu), '') AS 'jongluName'
		FROM ${_defaultDB}.[kcba].[Impo1] a WITH (NOLOCK)
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND a.Impo_key = #{Impokey}</if>
    </select>

    <select id="selectImportStatusDetail1" resultType="map">
        /* 수입통관현황 (Import Status) */
        SELECT
		*,
		(select MAX(Imlan_jechl_lan) FROM ${_defaultDB}.[kcba].[Impo2] where Imlan_key = #{Impokey}) as 'maxLan',
		#{_defaultDB} as 'defaultDB'
		FROM ${_defaultDB}.[kcba].[Impo2] a WITH (NOLOCK)
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND a.Imlan_key = #{Impokey}</if>
    </select>

    <select id="selectImportStatusDetail2" resultType="map">
        /* 수입통관현황 (Import Status) */
        SELECT
		*,
		(select SUM(Impum_su) FROM ${_defaultDB}.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumSu',
		(select SUM(Impum_amt) FROM ${_defaultDB}.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumAmt'
		FROM ${_defaultDB}.[kcba].[Impo3] a WITH (NOLOCK)
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND a.Impum_key = #{Impokey}</if>
        <if test='Impum_lan != null and Impum_lan != ""'>AND a.Impum_lan = #{Impum_lan}</if>
        order by a.Impum_lan, a.Impum_heang
    </select>

    <select id="selectImportStatusDetailYog" resultType="map">
        /* 수입통관현황 (Import Status)+요건 */
        SELECT
		a.*,
		b.SUIPYOGUN_NO,
		b.SUIPYOGUN_TEXT_NAME,
		b.SUIPYOGUN_BUB_CODE
		FROM ${_defaultDB}.[kcba].[Impo3] a left outer join ${_defaultDB}.[kcba].[IMPO41] b
        on a.Impum_key = b.SUIPYOGUN_KEY
        and a.Impum_lan = b.SUIPYOGUN_LAN
        and a.Impum_heang = b.SUIPYOGUN_HEANG
        where 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND a.Impum_key = #{Impokey}</if>
        <if test='Impum_lan != null and Impum_lan != ""'>AND a.Impum_lan = #{Impum_lan}</if>
        order by a.Impum_lan, a.Impum_heang
    </select>

    <select id="selectImportStatusDetail2Ex" resultType="map">
        /* 수입통관현황 (Import Status) 엑셀다운*/
        SELECT
		char(9)+a.Impum_lan as 'Impum_lan', char(9)+a.Impum_heang as 'Impum_heang', a.Impum_jajae_code, a.Impum_su, a.Impum_su_danwi, a.Impum_danga,
		a.Impum_amt, a.Impum_ivno, a.Impum_gukyk1, a.Impum_gukyk2, a.Impum_gukyk3, a.Impum_sungbun1, a.Impum_sungbun2, a.Impum_sungbun3
		FROM ${_defaultDB}.[kcba].[Impo3] a WITH (NOLOCK)
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND a.Impum_key = #{Impokey}</if>
        <if test='Impum_lan != null and Impum_lan != ""'>AND a.Impum_lan = #{Impum_lan}</if>
        order by a.Impum_lan, a.Impum_heang
    </select>

    <select id="selectImportStatusDetail4" resultType="map">
        /* impo3 + 자재마스터 */
        SELECT
		a.*,
		(select SUM(Impum_su) FROM ${_defaultDB}.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumSu',
		(select SUM(Impum_amt) FROM ${_defaultDB}.[kcba].[Impo3] where Impum_key = #{Impokey} and Impum_lan = #{Impum_lan}) as 'sumAmt',
		b.Mcount_no, b.Mhs_code, b.Mco_com
		FROM ${_defaultDB}.[kcba].[Impo3] a, CPS.[dbo].[MAAA100] b
        WHERE a.Impum_jajae_code = b.Mmodel_code
        and b.Mco_com = #{napseSaup}
        <if test='Impokey != null and Impokey != ""'>AND a.Impum_key = #{Impokey}</if>
        <if test='Impum_lan != null and Impum_lan != ""'>AND a.Impum_lan = #{Impum_lan}</if>
        order by a.Impum_lan, a.Impum_heang
    </select>

    <select id="selectImportStatusDetail3" resultType="map">
        /* 수입통관현황 (Import Status) */
        SELECT
		*
		FROM ${_defaultDB}.[kcba].[Impo4] a WITH (NOLOCK)
        WHERE 1 = 1
        <if test='Impokey != null and Impokey != ""'>AND a.Suipyogun_key = #{Impokey}</if>
        <if test='Impum_lan != null and Impum_lan != ""'>AND a.Suipyogun_lan = #{Impum_lan}</if>
        order by a.Suipyogun_heang
    </select>

    <select id="selectZeissImportStatusDetail" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 자재코드+규격+성분 칼자이스+칼자이스비전 통합*/
        SELECT datas.*
        FROM (
        SELECT
		Impum_jajae_code,
		Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 as 'Impum_gukyk',
		Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 as 'Impum_sungbun'
		FROM ncustoms.[kcba].[Impo3]
        WHERE Impum_key in (SELECT
		Impo_key
		FROM ncustoms.[kcba].[Impo1]
		where Impo_napse_saup = '2038151510'
		and impo_singoja_sangho ='세인관세법인')
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%'</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%'</if>
        union all
        SELECT
		Impum_jajae_code,
		Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 as 'Impum_gukyk',
		Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 as 'Impum_sungbun'
		FROM ncustoms_yj.[kcba].[Impo3]
        WHERE Impum_key in (SELECT
		Impo_key
		FROM ncustoms_yj.[kcba].[Impo1]
		where Impo_napse_saup = '1058677021'
		and impo_singoja_sangho ='세인관세법인')
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%'</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%'</if>
        union all
        SELECT
		Impum_jajae_code,
		Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 as 'Impum_gukyk',
		Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 as 'Impum_sungbun'
		FROM ncustoms_ic.[kcba].[Impo3]
        WHERE Impum_key in (SELECT
		Impo_key
		FROM ncustoms_ic.[kcba].[Impo1]
		where Impo_napse_saup = '2038151510'
		and impo_singoja_sangho ='세인관세법인')
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%'</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%'</if>
        ) datas
    </select>

    <select id="selectZeissImportStatusDetail1" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 자재코드+규격+성분 칼자이스 단독*/
        SELECT datas.*
        FROM (
        SELECT
		Impum_jajae_code,
		Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 as 'Impum_gukyk',
		Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 as 'Impum_sungbun'
		FROM ncustoms.[kcba].[Impo3]
        WHERE Impum_key in (SELECT
		Impo_key
		FROM ncustoms.[kcba].[Impo1]
		where Impo_napse_saup = '2038151510'
		and impo_singoja_sangho ='세인관세법인')
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%'</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%'</if>
        union all
        SELECT
		Impum_jajae_code,
		Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 as 'Impum_gukyk',
		Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 as 'Impum_sungbun'
		FROM ncustoms_ic.[kcba].[Impo3]
        WHERE Impum_key in (SELECT
		Impo_key
		FROM ncustoms_ic.[kcba].[Impo1]
		where Impo_napse_saup = '2038151510'
		and impo_singoja_sangho ='세인관세법인')
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%'</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%'</if>
        ) datas
    </select>

    <select id="selectZeissImportStatusDetail2" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 자재코드+규격+성분 칼자이스비전 단독*/
        SELECT datas.*
        FROM (
        SELECT
		Impum_jajae_code,
		Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 as 'Impum_gukyk',
		Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 as 'Impum_sungbun'
		FROM ncustoms_yj.[kcba].[Impo3]
        WHERE Impum_key in (SELECT
		Impo_key
		FROM ncustoms_yj.[kcba].[Impo1]
		where Impo_napse_saup = '1058677021'
		and impo_singoja_sangho ='세인관세법인')
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%'</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%'</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%'</if>
        ) datas
    </select>

    <select id="selectTodsItem" resultType="map">
        /* 토즈 수입통관현황 (Import Status) */
        SELECT
		a.*,
		b.Imlan_hs,
		b.Imlan_seyul_gubun,
		b.Imlan_gwan_seyula,
		b.Imlan_gurae_pum,
		b.imlan_fta_obj,
		(select cifwon from ncustoms.kcba.impo3_m where Impum_key = #{Impokey} and Impum_lan = a.Impum_lan and Impum_heang = a.Impum_heang) as 'cifwon',
		(select duty from ncustoms.kcba.impo3_m where Impum_key = #{Impokey} and Impum_lan = a.Impum_lan and Impum_heang = a.Impum_heang) as 'duty',
		(select vat from ncustoms.kcba.impo3_m where Impum_key = #{Impokey} and Impum_lan = a.Impum_lan and Impum_heang = a.Impum_heang) as 'vat'
		FROM ${_defaultDB}.[kcba].[Impo3] a, ${_defaultDB}.[kcba].[Impo2] b
        WHERE a.Impum_key = b.Imlan_key
		  and a.Impum_lan = b.Imlan_jechl_lan
        <if test='Impokey != null and Impokey != ""'>AND a.Impum_key = #{Impokey}</if>
        <if test='Impum_lan != null and Impum_lan != ""'>AND a.Impum_lan = #{Impum_lan}</if>
        order by a.Impum_lan, a.Impum_heang
    </select>

    <select id="selectZeissImportStatusList" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 칼자이스+칼자이스비전 통합*/
        SELECT datas.*
        FROM (
        select c.*, d.startLocation as 'Impo_gonggub' from
        (SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms.[kcba].[Impo2] WITH (NOLOCK) WHERE a.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
		(b.Imlan_gije1+''+b.Imlan_gije2+''+b.Imlan_gije3+''+b.Imlan_gije4+''+b.Imlan_gije5+''+b.Imlan_gije6+ ''+b.Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10) as 'Imlan_gije',
		'ncustoms' as 'defaultDB'
		FROM ncustoms.[kcba].[Impo1] a WITH (NOLOCK), ncustoms.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND (a.Impo_napse_saup = '2038151510' or a.Impo_SuipSaupNo = '2038151510')
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND (c.Impo_napse_saup = d.startTaxpayerNum or c.Impo_SuipSaupNo = d.startTaxpayerNum)
        union all
        select c.*, d.startLocation as 'Impo_gonggub' from
        (
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan,a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms_yj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_yj.[kcba].[Impo2] WITH (NOLOCK) WHERE a.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
		(b.Imlan_gije1+''+b.Imlan_gije2+''+b.Imlan_gije3+''+b.Imlan_gije4+''+b.Imlan_gije5+''+b.Imlan_gije6+ ''+b.Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10) as 'Imlan_gije',
		'ncustoms_yj' as 'defaultDB'
		FROM ncustoms_yj.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_yj.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND a.Impo_napse_saup = '1058677021'
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND c.Impo_napse_saup = d.startTaxpayerNum
        union all
        select c.*, d.startLocation as 'Impo_gonggub' from
        (
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ic.[kcba].[Impo2] WITH (NOLOCK) WHERE a.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		'' AS 'IVNO',
		'' AS 'PONO',
		(b.Imlan_gije1+''+b.Imlan_gije2+''+b.Imlan_gije3+''+b.Imlan_gije4+''+b.Imlan_gije5+''+b.Imlan_gije6+ ''+b.Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10) as 'Imlan_gije',
		'ncustoms_ic' as 'defaultDB'
		FROM ncustoms_ic.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_ic.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND (a.Impo_napse_saup = '2038151510' or a.Impo_SuipSaupNo = '2038151510')
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND (c.Impo_napse_saup = d.startTaxpayerNum or c.Impo_SuipSaupNo = d.startTaxpayerNum)
        )datas
        where 1=1
        <if test='Imlan_gije != null and Imlan_gije != ""'>and datas.Imlan_gije != '' AND datas.Imlan_gije LIKE '%' + #{Imlan_gije} + '%' /* InvNO PONO */</if>
        order by datas.Impo_singo_date desc
    </select>

    <select id="selectZeissImportStatusList1" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 칼자이스 단독*/
        SELECT datas.*
        FROM (
        select c.*, d.startLocation as 'Impo_gonggub' from
        (SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms.[kcba].[Impo2] WITH (NOLOCK) WHERE a.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
		(b.Imlan_gije1+''+b.Imlan_gije2+''+b.Imlan_gije3+''+b.Imlan_gije4+''+b.Imlan_gije5+''+b.Imlan_gije6+ ''+b.Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10) as 'Imlan_gije',
		'ncustoms' as 'defaultDB'
		FROM ncustoms.[kcba].[Impo1] a WITH (NOLOCK), ncustoms.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND (a.Impo_napse_saup = '2038151510' or a.Impo_SuipSaupNo = '2038151510')
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND (c.Impo_napse_saup = d.startTaxpayerNum or c.Impo_SuipSaupNo = d.startTaxpayerNum)
        union all
        select c.*, d.startLocation as 'Impo_gonggub' from
        (
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ic.[kcba].[Impo2] WITH (NOLOCK) WHERE a.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		'' AS 'IVNO',
		'' AS 'PONO',
		(b.Imlan_gije1+''+b.Imlan_gije2+''+b.Imlan_gije3+''+b.Imlan_gije4+''+b.Imlan_gije5+''+b.Imlan_gije6+ ''+b.Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10) as 'Imlan_gije',
		'ncustoms_ic' as 'defaultDB'
		FROM ncustoms_ic.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_ic.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND (a.Impo_napse_saup = '2038151510' or a.Impo_SuipSaupNo = '2038151510')
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND (c.Impo_napse_saup = d.startTaxpayerNum or c.Impo_SuipSaupNo = d.startTaxpayerNum)
        )datas
        where 1=1
        <if test='Imlan_gije != null and Imlan_gije != ""'>and datas.Imlan_gije != '' AND datas.Imlan_gije LIKE '%' + #{Imlan_gije} + '%' /* InvNO PONO */</if>
        order by datas.Impo_singo_date desc
    </select>

    <select id="selectZeissImportStatusList2" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 칼자이스비전 단독*/
        SELECT datas.*
        FROM (
        select c.*, d.startLocation as 'Impo_gonggub' from
        (
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms_yj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_yj.[kcba].[Impo2] WITH (NOLOCK) WHERE a.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
		(b.Imlan_gije1+''+b.Imlan_gije2+''+b.Imlan_gije3+''+b.Imlan_gije4+''+b.Imlan_gije5+''+b.Imlan_gije6+ ''+b.Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10) as 'Imlan_gije',
		'ncustoms_yj' as 'defaultDB'
		FROM ncustoms_yj.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_yj.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND a.Impo_napse_saup = '1058677021'
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND c.Impo_napse_saup = d.startTaxpayerNum
        )datas
        where 1=1
        <if test='Imlan_gije != null and Imlan_gije != ""'>and datas.Imlan_gije != '' AND datas.Imlan_gije LIKE '%' + #{Imlan_gije} + '%' /* InvNO PONO */</if>
        order by datas.Impo_singo_date desc
    </select>

    <select id="selectZeissImportStatusListExcel" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 칼자이스+칼자이스비전 통합 엑셀다운*/
        SELECT datas.*
        FROM (
        select c.*, d.startLocation as 'Impo_gonggub' from
        (SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		b.Imlan_gurae_pum AS 'imlanGuraePum',
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
		ISNULL((select
			(Imlan_gije1+''+Imlan_gije2+''+Imlan_gije3+''+Imlan_gije4+''+Imlan_gije5+''+Imlan_gije6+ ''+Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10)
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'Imlan_gije',
		'ncustoms' as 'defaultDB',
		e.Impum_jajae_code,
		e.impum_su,
		e.Impum_su_danwi,
		e.Impum_gukyk1,
		e.Impum_gukyk2,
		e.Impum_gukyk3
		FROM ncustoms.[kcba].[Impo1] a WITH (NOLOCK), ncustoms.[kcba].[Impo2] b WITH (NOLOCK), ncustoms.[kcba].[Impo3] e WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND (a.Impo_napse_saup = '2038151510' or a.Impo_SuipSaupNo = '2038151510')
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and a.Impo_key = e.impum_key
		and b.Imlan_jechl_lan = e.Impum_lan
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND (c.Impo_napse_saup = d.startTaxpayerNum or c.Impo_SuipSaupNo = d.startTaxpayerNum)
        union all
        select c.*, d.startLocation as 'Impo_gonggub' from
        (
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan,a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms_yj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		b.Imlan_gurae_pum AS 'imlanGuraePum',
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
		ISNULL((select
			(Imlan_gije1+''+Imlan_gije2+''+Imlan_gije3+''+Imlan_gije4+''+Imlan_gije5+''+Imlan_gije6+ ''+Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10)
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'Imlan_gije',
		'ncustoms_yj' as 'defaultDB',
		e.Impum_jajae_code,
		e.impum_su,
		e.Impum_su_danwi,
		e.Impum_gukyk1,
		e.Impum_gukyk2,
		e.Impum_gukyk3
		FROM ncustoms_yj.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_yj.[kcba].[Impo2] b WITH (NOLOCK), ncustoms_yj.[kcba].[Impo3] e WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND a.Impo_napse_saup = '1058677021'
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and a.Impo_key = e.impum_key
		and b.Imlan_jechl_lan = e.Impum_lan
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND c.Impo_napse_saup = d.startTaxpayerNum
        union all
        select c.*, d.startLocation as 'Impo_gonggub' from
        (
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		b.Imlan_gurae_pum AS 'imlanGuraePum',
		'' AS 'IVNO',
		'' AS 'PONO',
		ISNULL((select
			(Imlan_gije1+''+Imlan_gije2+''+Imlan_gije3+''+Imlan_gije4+''+Imlan_gije5+''+Imlan_gije6+ ''+Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10)
			from ncustoms_ic.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'Imlan_gije',
		'ncustoms_ic' as 'defaultDB',
		e.Impum_jajae_code,
		e.impum_su,
		e.Impum_su_danwi,
		e.Impum_gukyk1,
		e.Impum_gukyk2,
		e.Impum_gukyk3
		FROM ncustoms_ic.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_ic.[kcba].[Impo2] b WITH (NOLOCK), ncustoms_ic.[kcba].[Impo3] e WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND (a.Impo_napse_saup = '2038151510' or a.Impo_SuipSaupNo = '2038151510')
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and a.Impo_key = e.impum_key
		and b.Imlan_jechl_lan = e.Impum_lan
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND (c.Impo_napse_saup = d.startTaxpayerNum or c.Impo_SuipSaupNo = d.startTaxpayerNum)
        )datas
        where 1=1
        <if test='Imlan_gije != null and Imlan_gije != ""'>and datas.Imlan_gije != '' AND datas.Imlan_gije LIKE '%' + #{Imlan_gije} + '%' /* InvNO PONO */</if>
        order by datas.Impo_singo_date desc
    </select>

    <select id="selectZeissImportStatusList1Excel" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 칼자이스 단독 엑셀다운*/
        SELECT datas.*
        FROM (
        select c.*, d.startLocation as 'Impo_gonggub' from
        (SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		b.Imlan_gurae_pum AS 'imlanGuraePum',
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
		ISNULL((select
			(Imlan_gije1+''+Imlan_gije2+''+Imlan_gije3+''+Imlan_gije4+''+Imlan_gije5+''+Imlan_gije6+ ''+Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10)
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'Imlan_gije',
		'ncustoms' as 'defaultDB',
		e.Impum_jajae_code,
		e.impum_su,
		e.Impum_su_danwi,
		e.Impum_gukyk1,
		e.Impum_gukyk2,
		e.Impum_gukyk3
		FROM ncustoms.[kcba].[Impo1] a WITH (NOLOCK), ncustoms.[kcba].[Impo2] b WITH (NOLOCK), ncustoms.[kcba].[Impo3] e WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND (a.Impo_napse_saup = '2038151510' or a.Impo_SuipSaupNo = '2038151510')
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and a.Impo_key = e.impum_key
		and b.Imlan_jechl_lan = e.Impum_lan
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND (c.Impo_napse_saup = d.startTaxpayerNum or c.Impo_SuipSaupNo = d.startTaxpayerNum)
        union all
        select c.*, d.startLocation as 'Impo_gonggub' from
        (
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup, a.Impo_SuipSaupNo,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		b.Imlan_gurae_pum AS 'imlanGuraePum',
		'' AS 'IVNO',
		'' AS 'PONO',
		ISNULL((select
			(Imlan_gije1+''+Imlan_gije2+''+Imlan_gije3+''+Imlan_gije4+''+Imlan_gije5+''+Imlan_gije6+ ''+Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10)
			from ncustoms_ic.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'Imlan_gije',
		'ncustoms_ic' as 'defaultDB',
		e.Impum_jajae_code,
		e.impum_su,
		e.Impum_su_danwi,
		e.Impum_gukyk1,
		e.Impum_gukyk2,
		e.Impum_gukyk3
		FROM ncustoms_ic.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_ic.[kcba].[Impo2] b WITH (NOLOCK), ncustoms_ic.[kcba].[Impo3] e WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND (a.Impo_napse_saup = '2038151510' or a.Impo_SuipSaupNo = '2038151510')
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and a.Impo_key = e.impum_key
		and b.Imlan_jechl_lan = e.Impum_lan
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms_ic.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND (c.Impo_napse_saup = d.startTaxpayerNum or c.Impo_SuipSaupNo = d.startTaxpayerNum)
        )datas
        where 1=1
        <if test='Imlan_gije != null and Imlan_gije != ""'>and datas.Imlan_gije != '' AND datas.Imlan_gije LIKE '%' + #{Imlan_gije} + '%' /* InvNO PONO */</if>
        order by datas.Impo_singo_date desc
    </select>

    <select id="selectZeissImportStatusList2Excel" resultType="map">
        /* 칼자이스 수입통관현황 (Import Status) 칼자이스비전 단독 엑셀다운*/
        SELECT datas.*
        FROM (
        select c.*, d.startLocation as 'Impo_gonggub' from
        (
        SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no,
		a.Impo_iphang_date, a.Impo_banip_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_jubsu_date, a.impo_upja_sangho,
		a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
		a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho, a.impo_singo_gubun, a.Impo_napse_saup,
		a.Impo_Gyelje_Input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax,
		(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.impo_segwan, a.Impo_indo_jogun, a.Impo_Forwarder_Code,
		ISNULL((SELECT segwan_name FROM ncustoms_yj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = a.impo_segwan), '') AS 'segwanName',
		b.Imlan_gurae_pum AS 'imlanGuraePum',
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
		ISNULL((select
			(Imlan_gije1+''+Imlan_gije2+''+Imlan_gije3+''+Imlan_gije4+''+Imlan_gije5+''+Imlan_gije6+ ''+Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10)
			from ncustoms_yj.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'Imlan_gije',
		'ncustoms_yj' as 'defaultDB',
		e.Impum_jajae_code,
		e.impum_su,
		e.Impum_su_danwi,
		e.Impum_gukyk1,
		e.Impum_gukyk2,
		e.Impum_gukyk3
		FROM ncustoms_yj.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_yj.[kcba].[Impo2] b WITH (NOLOCK), ncustoms_yj.[kcba].[Impo3] e WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND a.Impo_napse_saup = '1058677021'
        and impo_singoja_sangho ='세인관세법인'
        and a.Impo_key = b.imlan_key
        and a.Impo_key = e.impum_key
		and b.Imlan_jechl_lan = e.Impum_lan
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND left(a.impo_upja_sangho,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%')</if>
        <if test='impumGukyk != null and impumGukyk != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_gukyk1+Impum_gukyk2+Impum_gukyk3 LIKE '%' + #{impumGukyk} + '%')</if>
        <if test='impumSungbun != null and impumSungbun != ""'>AND Impo_key in (select Impum_key FROM ncustoms_yj.[kcba].[Impo3] where Impum_sungbun1+Impum_sungbun2+Impum_sungbun3 LIKE '%' + #{impumSungbun} + '%')</if>
        ) c left outer join [soo].[dbo].[CPS_StartInfo] d
        on c.Impo_bl_no = d.startNum
        AND c.Impo_napse_saup = d.startTaxpayerNum
        )datas
        where 1=1
        <if test='Imlan_gije != null and Imlan_gije != ""'>and datas.Imlan_gije != '' AND datas.Imlan_gije LIKE '%' + #{Imlan_gije} + '%' /* InvNO PONO */</if>
        order by datas.Impo_singo_date desc
    </select>

    <select id="selectImportAllStatusList" resultType="map">
        /* 전체수입통관현황 (Import Status) */
        select * from
		(
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_ay.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ay.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_ay.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_bs.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_bs.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_bs.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_ca.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ca.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_ca.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_cj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_cj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_cj.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_cw.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_cw.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_cw.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_dj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_dj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_dj.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_gm.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_gm.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_gm.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_ic.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ic.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_ic.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_jj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_jj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_jj.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_pj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_pj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_pj.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_pt.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_pt.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_pt.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_sel4.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_sel4.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_sel4.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_sn.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_sn.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_sn.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_us.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_us.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_us.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_yj.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_yj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_yj.[kcba].[Impo1] WITH (NOLOCK)
		union all
		SELECT
		Impo_key, Impo_receive_result, Impo_cs, Impo_napse_sangho, Impo_bl_no, Impo_mbl_no, Impo_singo_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_file_no1, Impo_gonggub_sangho, Impo_jukchl_name, Impo_hanggu_name, Impo_jangch_name,
		Impo_pojang_su, Impo_total_jung, Impo_Forwarder_sangho, impo_singo_gubun,
		Impo_Gyelje_Input, Impo_total_tax, Impo_fre_won, Impo_cif_total_won, Impo_cif_total_usd, Impo_gwan_tax, Impo_vat_tax,
		(Impo_total_tax-(Impo_gwan_tax+Impo_vat_tax)) AS 'Impo_etc_tax', impo_segwan,
		ISNULL((SELECT segwan_name FROM ncustoms_ys.[kcba].Bsegwan WITH (NOLOCK) WHERE Segwan_code = impo_segwan), '') AS 'segwanName',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ys.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_ys.[kcba].[Impo1] WITH (NOLOCK)
		) a
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
    </select>

    <select id="selectImportStatusFtpList" resultType="map">
        /* 수입통관현황 (Import Status)+FTP현황 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.Impo_key DESC) AS 'rownum',
        a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_singo_no,
        a.Impo_iphang_date, a.Impo_singo_date, a.Impo_Ok_date, a.Impo_banip_date,
        a.Impo_file_no1, a.Impo_file_no2, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
        a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho,
        a.Impo_Gyelje_Input, a.Impo_total_tax,
        a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_cif_total_usd, a.Impo_gwan_tax, a.Impo_vat_tax, a.Impo_mbl_no,
        a.Impo_indo_jogun, a.Impo_gyelje_money, Impo_gyelje,
        (a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax',
        a.impo_jingsu_type, a.impo_segwan, a.impo_gwa,
        ISNULL((SELECT Imlan_gurae_pum FROM ${_defaultDB}.[kcba].[Impo2] WITH (NOLOCK) WHERE a.Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum',
        ISNULL((SELECT count(count) FROM soo.dbo.TBR_Ftp_Send_Log WITH (NOLOCK) WHERE a.Impo_singo_no = singoNum), 0) AS 'ftpCount'
        FROM ${_defaultDB}.[kcba].[Impo1] a WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != ''
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <when test='taxNum == "7158400024"'>AND a.Impo_napse_saup in ('7158400024','1028141887')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%' /* BL번호 */</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%' /* 신고번호 */</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%' /* Ref_no1(Entity) */</if>
        <if test='impoFileNo2 != null and impoFileNo2 != ""'>AND a.Impo_file_no2 LIKE '%' + #{impoFileNo2} + '%' /* Ref_no2(Vendor) */</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate} /* 입항일 */</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate} /* 통관신고일 */</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate} /* 통관수리일 */</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate} /* 반입일 */</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = '' /* 미결 */</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112)) /* 금일자료 */</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%' /* 서류제출(B인거) */</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoReceiveResult != null and impoReceiveResult != "" and impoReceiveResult != "ALL"'>AND a.Impo_receive_result LIKE '%' + #{impoReceiveResult} + '%' /* status */</if>
        <if test='impoJingsuType != null and impoJingsuType != ""'>AND a.impo_jingsu_type LIKE '%' + #{impoJingsuType} + '%'</if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountCostCustomsList" resultType="map">
        /* 수출입 Account(sein) 데이터 조회 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.FR_KEY) AS 'rownum',
        a.FR_KEY, a.SINGO_DT, a.SURI_DT, a.HAWB, a.AREA_NM,
        a.SUPLY_NM, a.DEAL_PUM_NM, a.SINGO_EK, a.GAMGA_EK, a.TOT_QT, a.QT_UNIT, a.TOT_WT, a.JINGSU_TP,
        a.INDO_JOGUN, a.PAY_METHOD, a.MONEY_EK, a.MONEY_CD, a.EXCH_RATE, a.JAEWON_CD, a.SEGWAN, a.GWA,
        a.FILE_NO1, a.FILE_NO2, a.INVOICE_NO, a.OWNER_COM_NM, a.CUS_BUHO, a.WORK_NM, a.SINGO_NO, a.IMPO_EXPO_KEY,
        a.CUS_BUHO + '' + SUBSTRING(a.SINGO_YEAR,3,2) + '' + a.SINGO_NO AS 'FULLSINGONO',
        a.CUS_BUHO + '-' + SUBSTRING(a.SINGO_YEAR,3,2) + '-' + a.SINGO_NO AS 'FULLSINGONOBAR',a.PORT_NM
        FROM ${_defaultDB}.[dbo].[FR_MAIN] AS a WITH (NOLOCK)
        WHERE a.WORK_NM LIKE #{workNm} + '%'
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND (a.OWNER_BIZ_NO IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y') or a.TRADE_BIZ_NO IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y') or a.ADJ_BIZ_NO IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y') or a.DTI_BIZ_NO IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y') or a.AGENT_BIZ_NO IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y') or a.PROXY_BIZ_NO IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y'))</when>
                <when test='taxNum != "all"'>AND (a.OWNER_BIZ_NO = #{taxNum} or a.TRADE_BIZ_NO = #{taxNum} or a.ADJ_BIZ_NO = #{taxNum} or a.DTI_BIZ_NO = #{taxNum} or a.AGENT_BIZ_NO = #{taxNum} or a.PROXY_BIZ_NO = #{taxNum})</when>
            </choose>
        </if>
        <if test='singoNo != null and singoNo != ""'>AND a.SINGO_NO LIKE '%' + #{singoNo} + '%' /* 수입신고번호 */</if>
        <if test='blNo != null and blNo != ""'>AND a.HAWB LIKE '%' + #{blNo} + '%' /* BL번호 */</if>
        <if test='invoiceNo != null and invoiceNo != ""'>AND a.INVOICE_NO LIKE '%' + #{invoiceNo} + '%' /* 인보이스번호 */</if>
        <if test='fileNo1 != null and fileNo1 != ""'>AND a.FILE_NO1 LIKE '%' + #{fileNo1} + '%' /* 파일1 */</if>
        <if test='segwan != null and segwan != ""'>AND a.SEGWAN LIKE '%' + #{segwan} + '%' /* 세관부호 */</if>
        <if test='suplyNm != null and suplyNm != ""'>AND a.SUPLY_NM LIKE '%' + #{suplyNm} + '%' /* 해외거래처 */</if>
        <if test='napseSangho != null and napseSangho != ""'>AND a.OWNER_COM_NM LIKE '%' + #{napseSangho} + '%' /* 납세자상호 */</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Singo_date_Day"'>AND a.SINGO_DT BETWEEN #{strFromDate} AND #{strToDate} /* 신고일 */</when>
                <when test='_DateType == "Ok_date_Day"'>AND a.SURI_DT BETWEEN #{strFromDate} AND #{strToDate} /* 수리일 */</when>
            </choose>
        </if>
        <if test='strUnsong != null and strUnsong != ""'>
            <choose>
                <when test='strUnsong == "40"'>AND a.PORT_NM LIKE '%공항'</when>
                <when test='strUnsong == "10"'>AND a.PORT_NM not LIKE '%공항'</when>
            </choose>
        </if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountCostAdjustmentList" resultType="map">
        /* 수출입 공용 회계 정산 데이터 조회(정산완료) */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY MAX(a.SORT_SEQ)) AS 'rownum',
        a.ADJ_CD, a.ADJ_NM,
        SUM(a.SUP_EK * a.INOUT_GB * -1) AS 'SUP_EK',
        SUM(a.TAX_EK * a.INOUT_GB * -1) AS 'TAX_EK',
        SUM(a.SUM_EK * a.INOUT_GB * -1) AS 'SUM_EK',
        MAX(a.ADJ_NOTE) AS 'ADJ_NOTE',
        MAX(a.SORT_SEQ) AS 'SORT_SEQ'
        FROM ${_defaultDB}.[dbo].[ADJ_DOC_DTL] AS a WITH (NOLOCK)
        INNER JOIN ${_defaultDB}.[dbo].[ADJ_DOC] AS b WITH (NOLOCK)
        ON a.FR_KEY = b.FR_KEY
        AND b.DEL_YN = 'N'
        WHERE a.FR_KEY = #{frKey}
        AND a.INOUT_GB = '-1'
        AND a.ADJ_CD != 'C015'
        AND a.ADJ_DOC_NO = '001'
        GROUP BY a.ADJ_CD, a.ADJ_NM
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountBillAdjustmentList" resultType="map">
        /* 수출입 공용 회계 청구 데이터 조회 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY MAX(a.SORT_SEQ)) AS 'rownum',
        a.ADJ_CD, a.ADJ_NM,
        SUM(a.SUP_EK * a.INOUT_GB * -1) AS 'SUP_EK',
        SUM(a.TAX_EK * a.INOUT_GB * -1) AS 'TAX_EK',
        SUM(a.SUM_EK * a.INOUT_GB * -1) AS 'SUM_EK',
        MAX(a.ADJ_NOTE) AS 'ADJ_NOTE',
        MAX(a.SORT_SEQ) AS 'SORT_SEQ'
        FROM ${_defaultDB}.[dbo].[REQ_DOC_DTL] AS a WITH (NOLOCK)
        INNER JOIN ${_defaultDB}.[dbo].[REQ_DOC] AS b WITH (NOLOCK)
        ON a.FR_KEY = b.FR_KEY
        AND a.REQ_DOC_NO = b.REQ_DOC_NO
        AND b.DEL_YN = 'N'
        WHERE a.FR_KEY = #{frKey}
        AND a.INOUT_GB = '-1'
        GROUP BY a.ADJ_CD, a.ADJ_NM
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountCostStatementOfAccountsList" resultType="map">
        /* 수출입 공용 회계 자금정산서 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.FR_KEY) AS 'rownum',
        a.FR_KEY, a.AREA_NM, a.WORK_NM, a.AREA_CD, a.WORK_CD,
        a.SINGO_YEAR, a.SUBMIT_NO, a.USER_DG, a.SINGO_NO, a.IMPO_EXPO_KEY,
        a.SINGO_DT, a.SURI_DT, a.SURI_DT2, a.ENTRY_DT, a.JUBSU_DTTM,
        a.SEND_RESULT, a.RECV_RESULT, a.ADJ_COM_CNT, a.REQ_DOC_CNT, a.ADJ_DOC_CNT,
        a.OWNER_AREA_CD, a.OWNER_DEAL_CD, a.OWNER_COM_CD, a.OWNER_COM_NM, a.OWNER_BIZ_NO,
        a.TRADE_AREA_CD, a.TRADE_DEAL_CD, a.TRADE_COM_CD, a.TRADE_COM_NM, a.TRADE_BIZ_NO,
        a.DTI_AREA_CD, a.DTI_DEAL_CD, a.DTI_COM_CD, a.DTI_COM_NM, a.DTI_BIZ_NO,
        a.AGENT_AREA_CD, a.AGENT_DEAL_CD, a.AGENT_COM_CD, a.AGENT_COM_NM, a.AGENT_BIZ_NO,
        a.FEE_COM_CD, a.CARGO_COM_CD, a.RECV_COM_TP, a.PROXY_DEAL_CD, a.PROXY_COM_NM,
        a.PROXY_BIZ_NO, a.CUS_BUHO, a.DEAL_PUM_NM, a.JAEWON_CD, a.EXCH_RATE,
        a.SINGO_EK, a.GAMGA_EK, a.TOT_QT, a.QT_UNIT, a.TOT_WT,
        a.WT_UNIT, a.MRN_NO, a.MAWB, a.HAWB, a.PORT_CD,
        a.PORT_NM, a.SHIP_AIR_NM, a.ARRIVE_DT, a.SEGWAN, a.GWA,
        a.WH_CD, a.WH_NM, a.WH_LOC, a.MOKJUK_CD, a.MOKJUK_NM,
        a.SUNGI_CD, a.SUNGI_NM, a.JUKCHL_CD, a.JUKCHL_NM, a.SUPLY_NM,
        a.SUPLY_BUHO, a.GWANSE_EK, a.SPECIAL_EK, a.TRAFFIC_EK, a.ALCOHOL_EK,
        a.EDU_EK, a.FARM_EK, a.VAT_EK, a.ADD_EK, a.MISINGO_ADD_EK,
        a.TOT_TAX_EK, a.NAPBU_DATE, a.LC_NO, a.INVOICE_NO, a.FILE_NO1,
        a.FILE_NO2, a.INDO_JOGUN, a.PAY_METHOD, a.EXPRESS_BUHO, a.EXPRESS_NM,
        a.MONEY_CD, a.MONEY_EK, a.JINGSU_TP, a.NAPSE_SUB_AREA_NO, a.USER_ID,
        a.USER_NM, a.ADJ_SEND_DT, a.ADJ_SEND_METHOD, a.ADJ_NOTE1, a.ADJ_NOTE2,
        a.ADJ_NOTE3, a.ADJ_NOTE1_POP_YN, a.ADJ_MEM_NO, a.ADJ_MEM_NM, a.FIX_YN,
        a.FEE_ISSUE_YN, a.FEE_RATE, a.JAEWON_TP, a.USER_FEE_RATE, a.USER_JAEWON_TP,
        a.MAGAM_PROC_CD, a.ADJ_PROC_CD, a.ADJ_METHOD, a.ADJ_GROUP_NO, a.ADJ_NO,
        a.TAKE_EK, a.PRE_JAN_EK, a.IN_EK, a.COST_EK, a.EXCEPT_EK,
        a.SALE_SUP_EK, a.SALE_TAX_EK, a.SALE_SUM_EK,
        a.ADJ_PAY_PROC_CD, a.GWANSE_ST, a.CC_MATH_YN, a.CL_MATH_YN,
        a.CS_GB, a.FR_GB, a.LOGIS_SUP_EK, a.LOGIS_TAX_EK, a.LOGIS_SUM_EK,
        a.SINGO_GB, a.TG_PLAN, a.UNSONG_TYPE, a.COM_MEM_NM, a.FEE_WRITE_DT, a.FEE_IN_DT,
        a.LOGIS_BUY_SUP_EK, a.LOGIS_BUY_TAX_EK, a.LOGIS_BUY_SUM_EK, a.TRANS_REQ_DT, a.TRANS_ST_CD,
        a.ADJ_NOTE1_POP_YN_REQ, a.ADJ_NOTE1_POP_YN_ADJ, a.ADJ_NOTE1_POP_YN_TAX, a.ADJ_NOTE1_POP_YN_OUT_EK, a.ADJ_DT,
        a.UNSONG_BOX, a.DEAL_CD_DRAWBACK, a.IN_EK_PROC_CD, a.DITC_DRAWBACK, a.STD_PUM_NM,
        a.HS_CD, a.OUT_DT, a.ADJ_IN_EK, a.OUT_TIME, a.CBM,
        a.CON_SU, a.CHK_FEE_EK_YN, a.MAKER_DEAL_CD, a.MAKER_COM_NM, a.BFLOADCHK,
        a.REQ_MEM_NM, a.RECV_MEM_NM, a.TRANS_REQ_TIME, a.WH_OUT_KEY, a.FWD_CD,
        a.FWD_NM, a.MEMO_CNT, a.USER_NOTE1, a.USER_NOTE2, a.USD_RATE, a.SINGOJA_GIJE,
        b.ADJ_DOC_NO, b.WRITE_DT, b.ACC_CID, b.BANK_CD, b.BANK_NM, b.ACC_NO,
        b.CMS_NO, b.ACC_OWNER, b.TAKE_EK AS 'ADJ_DOC_TAKE_EK', b.TAKE_EK_NOTE, b.SUM_EK, b.SUM_EK_NOTE,
        b.PRE_JAN_EK AS 'ADJ_DOC_PRE_JAN_EK', b.PRE_JAN_EK_NOTE, b.IN_EK AS 'ADJ_DOC_IN_EK', b.IN_EK_NOTE, b.JAN_EK, b.JAN_EK_NOTE,
        b.ADJ_COM_CD, b.ADJ_COM_NM, b.RECV_COM_CD, b.RECV_COM_NM, b.RECV_COM_OWNER, b.RECV_COM_TEL_NO,
        b.RECV_COM_FAX_NO, b.RECV_COM_ADDR, b.RECV_COM_MEM_NM, b.RECV_MEM_EMAIL, b.RECV_MEM_HP_NO, b.SUP_CID,
        b.SUP_COM_NM, b.SUP_COM_OWNER, b.SUP_COM_BIZ_NO, b.SUP_JIRO_ADDR, b.TG_MEM_NM, b.TG_TEL_NO, b.TG_FAX_NO,
        b.ADJ_MEM_NM AS 'ADJ_DOC_ADJ_MEM_NM', b.ADJ_TEL_NO, b.ADJ_FAX_NO, b.NOTE, b.DEL_YN, b.MOD_MEM_NM, b.MOD_DT, b.MOD_TIME,
        b.SUP_EK, b.TAX_EK, b.SEND_JAN_EK, b.SEND_JAN_EK_NOTE, b.ADJ_GROUP_NO AS 'ADJ_DOC_ADJ_GROUP_NO', b.ADJ_NO AS 'ADJ_DOC_ADJ_NO', b.TITLE_NM, b.REF_COM_NM,
        b.REF_COM_OWNER, b.REF_COM_TEL_NO, b.REF_COM_FAX_NO, b.REF_COM_ADDR, b.SUP_AREA_CD, b.ADJ_MEM_NO AS 'ADJ_DOC_ADJ_MEM_NO', b.RECV_COM_BIZ_NO
        FROM ${_defaultDB}.[dbo].[FR_MAIN] a WITH (NOLOCK)
        INNER JOIN ${_defaultDB}.[dbo].[ADJ_DOC] b WITH (NOLOCK)
        ON a.FR_KEY = b.FR_KEY
        AND b.DEL_YN = 'N'
        AND a.WORK_NM = #{workNm}
        WHERE a.FR_KEY = #{frKey}
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountCostStatementOfAccountsDetailList" resultType="map">
        /* 수출입 공용 회계 자금정산서 상세(데모/정산완료) */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY MAX(a.SORT_SEQ)) AS 'rownum',
        a.ADJ_CD, a.ADJ_NM,
        SUM(a.SUP_EK * a.INOUT_GB * -1) AS 'SUP_EK',
        SUM(a.TAX_EK * a.INOUT_GB * -1) AS 'TAX_EK',
        SUM(a.SUM_EK * a.INOUT_GB * -1) AS 'SUM_EK',
        MAX(a.ADJ_NOTE) AS 'ADJ_NOTE',
        MAX(a.SORT_SEQ) AS 'SORT_SEQ'
        FROM ${_defaultDB}.[dbo].[ADJ_DOC_DTL] AS a WITH (NOLOCK)
        INNER JOIN ${_defaultDB}.[dbo].[ADJ_DOC] AS b WITH (NOLOCK)
        ON a.FR_KEY = b.FR_KEY
        AND b.DEL_YN = 'N'
        WHERE a.FR_KEY = #{frKey}
        AND a.INOUT_GB = '-1'
        AND a.SUM_EK != 0
        AND a.ADJ_CD != 'C015'
        AND a.ADJ_DOC_NO = '001'
        GROUP BY a.ADJ_CD, a.ADJ_NM
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountCostStatementOfAccountsList1" resultType="map">
        /* 수출입 공용 회계 자금정산서 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.FR_KEY) AS 'rownum',
        a.FR_KEY, a.AREA_NM, a.WORK_NM, a.AREA_CD, a.WORK_CD,
        a.SINGO_YEAR, a.SUBMIT_NO, a.USER_DG, a.SINGO_NO, a.IMPO_EXPO_KEY,
        a.SINGO_DT, a.SURI_DT, a.SURI_DT2, a.ENTRY_DT, a.JUBSU_DTTM,
        a.SEND_RESULT, a.RECV_RESULT, a.ADJ_COM_CNT, a.REQ_DOC_CNT, a.ADJ_DOC_CNT,
        a.OWNER_AREA_CD, a.OWNER_DEAL_CD, a.OWNER_COM_CD, a.OWNER_COM_NM, a.OWNER_BIZ_NO,
        a.TRADE_AREA_CD, a.TRADE_DEAL_CD, a.TRADE_COM_CD, a.TRADE_COM_NM, a.TRADE_BIZ_NO,
        a.DTI_AREA_CD, a.DTI_DEAL_CD, a.DTI_COM_CD, a.DTI_COM_NM, a.DTI_BIZ_NO,
        a.AGENT_AREA_CD, a.AGENT_DEAL_CD, a.AGENT_COM_CD, a.AGENT_COM_NM, a.AGENT_BIZ_NO,
        a.FEE_COM_CD, a.CARGO_COM_CD, a.RECV_COM_TP, a.PROXY_DEAL_CD, a.PROXY_COM_NM,
        a.PROXY_BIZ_NO, a.CUS_BUHO, a.DEAL_PUM_NM, a.JAEWON_CD, a.EXCH_RATE,
        a.SINGO_EK, a.GAMGA_EK, a.TOT_QT, a.QT_UNIT, a.TOT_WT,
        a.WT_UNIT, a.MRN_NO, a.MAWB, a.HAWB, a.PORT_CD,
        a.PORT_NM, a.SHIP_AIR_NM, a.ARRIVE_DT, a.SEGWAN, a.GWA,
        a.WH_CD, a.WH_NM, a.WH_LOC, a.MOKJUK_CD, a.MOKJUK_NM,
        a.SUNGI_CD, a.SUNGI_NM, a.JUKCHL_CD, a.JUKCHL_NM, a.SUPLY_NM,
        a.SUPLY_BUHO, a.GWANSE_EK, a.SPECIAL_EK, a.TRAFFIC_EK, a.ALCOHOL_EK,
        a.EDU_EK, a.FARM_EK, a.VAT_EK, a.ADD_EK, a.MISINGO_ADD_EK,
        a.TOT_TAX_EK, a.NAPBU_DATE, a.LC_NO, a.INVOICE_NO, a.FILE_NO1,
        a.FILE_NO2, a.INDO_JOGUN, a.PAY_METHOD, a.EXPRESS_BUHO, a.EXPRESS_NM,
        a.MONEY_CD, a.MONEY_EK, a.JINGSU_TP, a.NAPSE_SUB_AREA_NO, a.USER_ID,
        a.USER_NM, a.ADJ_SEND_DT, a.ADJ_SEND_METHOD, a.ADJ_NOTE1, a.ADJ_NOTE2,
        a.ADJ_NOTE3, a.ADJ_NOTE1_POP_YN, a.ADJ_MEM_NO, a.ADJ_MEM_NM, a.FIX_YN,
        a.FEE_ISSUE_YN, a.FEE_RATE, a.JAEWON_TP, a.USER_FEE_RATE, a.USER_JAEWON_TP,
        a.MAGAM_PROC_CD, a.ADJ_PROC_CD, a.ADJ_METHOD, a.ADJ_GROUP_NO, a.ADJ_NO,
        a.TAKE_EK, a.PRE_JAN_EK, a.IN_EK, a.COST_EK, a.EXCEPT_EK,
        a.SALE_SUP_EK, a.SALE_TAX_EK, a.SALE_SUM_EK,
        a.ADJ_PAY_PROC_CD, a.GWANSE_ST, a.CC_MATH_YN, a.CL_MATH_YN,
        a.CS_GB, a.FR_GB, a.LOGIS_SUP_EK, a.LOGIS_TAX_EK, a.LOGIS_SUM_EK,
        a.SINGO_GB, a.TG_PLAN, a.UNSONG_TYPE, a.COM_MEM_NM, a.FEE_WRITE_DT, a.FEE_IN_DT,
        a.LOGIS_BUY_SUP_EK, a.LOGIS_BUY_TAX_EK, a.LOGIS_BUY_SUM_EK, a.TRANS_REQ_DT, a.TRANS_ST_CD,
        a.ADJ_NOTE1_POP_YN_REQ, a.ADJ_NOTE1_POP_YN_ADJ, a.ADJ_NOTE1_POP_YN_TAX, a.ADJ_NOTE1_POP_YN_OUT_EK, a.ADJ_DT,
        a.UNSONG_BOX, a.DEAL_CD_DRAWBACK, a.IN_EK_PROC_CD, a.DITC_DRAWBACK, a.STD_PUM_NM,
        a.HS_CD, a.OUT_DT, a.ADJ_IN_EK, a.OUT_TIME, a.CBM,
        a.CON_SU, a.CHK_FEE_EK_YN, a.MAKER_DEAL_CD, a.MAKER_COM_NM, a.BFLOADCHK,
        a.REQ_MEM_NM, a.RECV_MEM_NM, a.TRANS_REQ_TIME, a.WH_OUT_KEY, a.FWD_CD,
        a.FWD_NM, a.MEMO_CNT, a.USER_NOTE1, a.USER_NOTE2, a.USD_RATE, a.SINGOJA_GIJE,
        b.ADJ_DOC_NO, b.WRITE_DT, b.ACC_CID, b.BANK_CD, b.BANK_NM, b.ACC_NO,
        b.CMS_NO, b.ACC_OWNER, b.TAKE_EK AS 'ADJ_DOC_TAKE_EK', b.TAKE_EK_NOTE, b.SUM_EK, b.SUM_EK_NOTE,
        b.PRE_JAN_EK AS 'ADJ_DOC_PRE_JAN_EK', b.PRE_JAN_EK_NOTE, b.IN_EK AS 'ADJ_DOC_IN_EK', b.IN_EK_NOTE, b.JAN_EK, b.JAN_EK_NOTE,
        b.ADJ_COM_CD, b.ADJ_COM_NM, b.RECV_COM_CD, b.RECV_COM_NM, b.RECV_COM_OWNER, b.RECV_COM_TEL_NO,
        b.RECV_COM_FAX_NO, b.RECV_COM_ADDR, b.RECV_COM_MEM_NM, b.RECV_MEM_EMAIL, b.RECV_MEM_HP_NO, b.SUP_CID,
        b.SUP_COM_NM, b.SUP_COM_OWNER, b.SUP_COM_BIZ_NO, b.SUP_JIRO_ADDR, b.TG_MEM_NM, b.TG_TEL_NO, b.TG_FAX_NO,
        b.ADJ_MEM_NM AS 'ADJ_DOC_ADJ_MEM_NM', b.ADJ_TEL_NO, b.ADJ_FAX_NO, b.NOTE, b.DEL_YN, b.MOD_MEM_NM, b.MOD_DT, b.MOD_TIME,
        b.SUP_EK, b.TAX_EK, b.SEND_JAN_EK, b.SEND_JAN_EK_NOTE, b.ADJ_GROUP_NO AS 'ADJ_DOC_ADJ_GROUP_NO', b.ADJ_NO AS 'ADJ_DOC_ADJ_NO', b.TITLE_NM, b.REF_COM_NM,
        b.REF_COM_OWNER, b.REF_COM_TEL_NO, b.REF_COM_FAX_NO, b.REF_COM_ADDR, b.SUP_AREA_CD, b.ADJ_MEM_NO AS 'ADJ_DOC_ADJ_MEM_NO', b.RECV_COM_BIZ_NO
        FROM ${_defaultDB}.[dbo].[FR_MAIN] a WITH (NOLOCK)
        INNER JOIN ${_defaultDB}.[dbo].[ADJ_DOC] b WITH (NOLOCK)
        ON a.FR_KEY = b.FR_KEY
        AND b.DEL_YN = 'N'
        AND a.WORK_NM = #{workNm}
        WHERE a.SINGO_NO = #{singoNo}
        and a.SINGO_DT = #{singoDt}
        <if test='AREA_NM != null and AREA_NM != ""'>AND a.AREA_NM = #{AREA_NM}</if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountCostStatementOfAccountsDetailList1" resultType="map">
        /* 수출입 공용 회계 자금정산서 상세(데모/정산완료) */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY MAX(a.SORT_SEQ)) AS 'rownum',
        a.ADJ_CD, a.ADJ_NM,
        SUM(a.SUP_EK * a.INOUT_GB * -1) AS 'SUP_EK',
        SUM(a.TAX_EK * a.INOUT_GB * -1) AS 'TAX_EK',
        SUM(a.SUM_EK * a.INOUT_GB * -1) AS 'SUM_EK',
        MAX(a.ADJ_NOTE) AS 'ADJ_NOTE',
        MAX(a.SORT_SEQ) AS 'SORT_SEQ'
        FROM ${_defaultDB}.[dbo].[ADJ_DOC_DTL] AS a WITH (NOLOCK)
        , ${_defaultDB}.[dbo].[ADJ_DOC] AS b WITH (NOLOCK)
        , ${_defaultDB}.[dbo].[FR_MAIN] AS c WITH (NOLOCK)
        WHERE a.FR_KEY = b.FR_KEY
        AND a.FR_KEY = c.FR_KEY
        AND b.DEL_YN = 'N'
        AND c.SINGO_NO = #{singoNo}
        AND c.IMPO_EXPO_KEY = #{ieKey}
        AND a.INOUT_GB = '-1'
        AND a.SUM_EK != 0
        AND a.ADJ_CD != 'C015'
        AND a.ADJ_DOC_NO = '001'
        GROUP BY a.ADJ_CD, a.ADJ_NM
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountBillStatementOfAccountsList" resultType="map">
        /* 수출입 공용 회계 자금청구서 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.FR_KEY) AS 'rownum',
        a.FR_KEY, a.AREA_NM, a.WORK_NM, a.AREA_CD, a.WORK_CD,
        a.SINGO_YEAR, a.SUBMIT_NO, a.USER_DG, a.SINGO_NO, a.IMPO_EXPO_KEY,
        a.SINGO_DT, a.SURI_DT, a.SURI_DT2, a.ENTRY_DT, a.JUBSU_DTTM,
        a.SEND_RESULT, a.RECV_RESULT, a.ADJ_COM_CNT, a.REQ_DOC_CNT, a.ADJ_DOC_CNT,
        a.OWNER_AREA_CD, a.OWNER_DEAL_CD, a.OWNER_COM_CD, a.OWNER_COM_NM, a.OWNER_BIZ_NO,
        a.TRADE_AREA_CD, a.TRADE_DEAL_CD, a.TRADE_COM_CD, a.TRADE_COM_NM, a.TRADE_BIZ_NO,
        a.DTI_AREA_CD, a.DTI_DEAL_CD, a.DTI_COM_CD, a.DTI_COM_NM, a.DTI_BIZ_NO,
        a.AGENT_AREA_CD, a.AGENT_DEAL_CD, a.AGENT_COM_CD, a.AGENT_COM_NM, a.AGENT_BIZ_NO,
        a.FEE_COM_CD, a.CARGO_COM_CD, a.RECV_COM_TP, a.PROXY_DEAL_CD, a.PROXY_COM_NM,
        a.PROXY_BIZ_NO, a.CUS_BUHO, a.DEAL_PUM_NM, a.JAEWON_CD, a.EXCH_RATE,
        a.SINGO_EK, a.GAMGA_EK, a.TOT_QT, a.QT_UNIT, a.TOT_WT,
        a.WT_UNIT, a.MRN_NO, a.MAWB, a.HAWB, a.PORT_CD,
        a.PORT_NM, a.SHIP_AIR_NM, a.ARRIVE_DT, a.SEGWAN, a.GWA,
        a.WH_CD, a.WH_NM, a.WH_LOC, a.MOKJUK_CD, a.MOKJUK_NM,
        a.SUNGI_CD, a.SUNGI_NM, a.JUKCHL_CD, a.JUKCHL_NM, a.SUPLY_NM,
        a.SUPLY_BUHO, a.GWANSE_EK, a.SPECIAL_EK, a.TRAFFIC_EK, a.ALCOHOL_EK,
        a.EDU_EK, a.FARM_EK, a.VAT_EK, a.ADD_EK, a.MISINGO_ADD_EK,
        a.TOT_TAX_EK, a.NAPBU_DATE, a.LC_NO, a.INVOICE_NO, a.FILE_NO1,
        a.FILE_NO2, a.INDO_JOGUN, a.PAY_METHOD, a.EXPRESS_BUHO, a.EXPRESS_NM,
        a.MONEY_CD, a.MONEY_EK, a.JINGSU_TP, a.NAPSE_SUB_AREA_NO, a.USER_ID,
        a.USER_NM, a.ADJ_SEND_DT, a.ADJ_SEND_METHOD, a.ADJ_NOTE1, a.ADJ_NOTE2,
        a.ADJ_NOTE3, a.ADJ_NOTE1_POP_YN, a.ADJ_MEM_NO, a.ADJ_MEM_NM, a.FIX_YN,
        a.FEE_ISSUE_YN, a.FEE_RATE, a.JAEWON_TP, a.USER_FEE_RATE, a.USER_JAEWON_TP,
        a.MAGAM_PROC_CD, a.ADJ_PROC_CD, a.ADJ_METHOD, a.ADJ_GROUP_NO, a.ADJ_NO,
        a.TAKE_EK, a.PRE_JAN_EK, a.IN_EK, a.COST_EK, a.EXCEPT_EK,
        a.SALE_SUP_EK, a.SALE_TAX_EK, a.SALE_SUM_EK,
        a.ADJ_PAY_PROC_CD, a.GWANSE_ST, a.CC_MATH_YN, a.CL_MATH_YN,
        a.CS_GB, a.FR_GB, a.LOGIS_SUP_EK, a.LOGIS_TAX_EK, a.LOGIS_SUM_EK,
        a.SINGO_GB, a.TG_PLAN, a.UNSONG_TYPE, a.COM_MEM_NM, a.FEE_WRITE_DT, a.FEE_IN_DT,
        a.LOGIS_BUY_SUP_EK, a.LOGIS_BUY_TAX_EK, a.LOGIS_BUY_SUM_EK, a.TRANS_REQ_DT, a.TRANS_ST_CD,
        a.ADJ_NOTE1_POP_YN_REQ, a.ADJ_NOTE1_POP_YN_ADJ, a.ADJ_NOTE1_POP_YN_TAX, a.ADJ_NOTE1_POP_YN_OUT_EK, a.ADJ_DT,
        a.UNSONG_BOX, a.DEAL_CD_DRAWBACK, a.IN_EK_PROC_CD, a.DITC_DRAWBACK, a.STD_PUM_NM,
        a.HS_CD, a.OUT_DT, a.ADJ_IN_EK, a.OUT_TIME, a.CBM,
        a.CON_SU, a.CHK_FEE_EK_YN, a.MAKER_DEAL_CD, a.MAKER_COM_NM, a.BFLOADCHK,
        a.REQ_MEM_NM, a.RECV_MEM_NM, a.TRANS_REQ_TIME, a.WH_OUT_KEY, a.FWD_CD,
        a.FWD_NM, a.MEMO_CNT, a.USER_NOTE1, a.USER_NOTE2, a.USD_RATE, a.SINGOJA_GIJE,
        b.REQ_DOC_NO, b.WRITE_DT, b.ACC_CID, b.BANK_CD, b.BANK_NM, b.ACC_NO,
        b.CMS_NO, b.ACC_OWNER, b.MISU_EK AS 'REQ_DOC_MISU_EK', b.MISU_EK_NOTE, b.SUM_EK, b.SUM_EK_NOTE,
        b.PRE_JAN_EK AS 'REQ_DOC_PRE_JAN_EK', b.PRE_JAN_EK_NOTE, b.REQ_EK AS 'REQ_DOC_REQ_EK', b.REQ_EK_NOTE,
        b.ADJ_COM_CD, b.ADJ_COM_NM, b.RECV_COM_CD, b.RECV_COM_NM, b.RECV_COM_OWNER, b.RECV_COM_TEL_NO,
        b.RECV_COM_FAX_NO, b.RECV_COM_ADDR, b.RECV_COM_MEM_NM, b.RECV_MEM_EMAIL, b.RECV_MEM_HP_NO, b.SUP_CID,
        b.SUP_COM_NM, b.SUP_COM_OWNER, b.SUP_COM_BIZ_NO, b.SUP_JIRO_ADDR, b.TG_MEM_NM, b.TG_TEL_NO, b.TG_FAX_NO,
        b.ADJ_MEM_NM AS 'REQ_DOC_ADJ_MEM_NM', b.ADJ_TEL_NO, b.ADJ_FAX_NO, b.NOTE, b.DEL_YN, b.MOD_MEM_NM, b.MOD_DT, b.MOD_TIME,
        b.SUP_EK, b.TAX_EK, b.TITLE_NM, b.REF_COM_NM,
        b.REF_COM_OWNER, b.REF_COM_TEL_NO, b.REF_COM_FAX_NO, b.REF_COM_ADDR, b.SUP_AREA_CD, b.ADJ_MEM_NO AS 'REQ_DOC_ADJ_MEM_NO', b.RECV_COM_BIZ_NO
        FROM ${_defaultDB}.[dbo].[FR_MAIN] a WITH (NOLOCK)
        INNER JOIN ${_defaultDB}.[dbo].[REQ_DOC] b WITH (NOLOCK)
        ON a.FR_KEY = b.FR_KEY
        AND b.DEL_YN = 'N'
        AND a.WORK_NM = #{workNm}
        WHERE a.FR_KEY = #{frKey}
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountBillStatementOfAccountsDetailList" resultType="map">
        /* 수출입 공용 회계 자금청구서 상세(데모/정산완료) */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY MAX(a.SORT_SEQ)) AS 'rownum',
        a.ADJ_CD, a.ADJ_NM,
        SUM(a.SUP_EK * a.INOUT_GB * -1) AS 'SUP_EK',
        SUM(a.TAX_EK * a.INOUT_GB * -1) AS 'TAX_EK',
        SUM(a.SUM_EK * a.INOUT_GB * -1) AS 'SUM_EK',
        MAX(a.ADJ_NOTE) AS 'ADJ_NOTE',
        MAX(a.SORT_SEQ) AS 'SORT_SEQ'
        FROM ${_defaultDB}.[dbo].[REQ_DOC_DTL] AS a WITH (NOLOCK)
        INNER JOIN ${_defaultDB}.[dbo].[REQ_DOC] AS b WITH (NOLOCK)
        ON a.FR_KEY = b.FR_KEY
        AND a.REQ_DOC_NO = b.REQ_DOC_NO
        AND b.DEL_YN = 'N'
        WHERE a.FR_KEY = #{frKey}
        AND a.INOUT_GB = '-1'
        AND a.SUM_EK != 0
        GROUP BY a.ADJ_CD, a.ADJ_NM
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountBillStatementOfAccountsList1" resultType="map">
        /* 수출입 공용 회계 자금청구서 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.FR_KEY) AS 'rownum',
        a.FR_KEY, a.AREA_NM, a.WORK_NM, a.AREA_CD, a.WORK_CD,
        a.SINGO_YEAR, a.SUBMIT_NO, a.USER_DG, a.SINGO_NO, a.IMPO_EXPO_KEY,
        a.SINGO_DT, a.SURI_DT, a.SURI_DT2, a.ENTRY_DT, a.JUBSU_DTTM,
        a.SEND_RESULT, a.RECV_RESULT, a.ADJ_COM_CNT, a.REQ_DOC_CNT, a.ADJ_DOC_CNT,
        a.OWNER_AREA_CD, a.OWNER_DEAL_CD, a.OWNER_COM_CD, a.OWNER_COM_NM, a.OWNER_BIZ_NO,
        a.TRADE_AREA_CD, a.TRADE_DEAL_CD, a.TRADE_COM_CD, a.TRADE_COM_NM, a.TRADE_BIZ_NO,
        a.DTI_AREA_CD, a.DTI_DEAL_CD, a.DTI_COM_CD, a.DTI_COM_NM, a.DTI_BIZ_NO,
        a.AGENT_AREA_CD, a.AGENT_DEAL_CD, a.AGENT_COM_CD, a.AGENT_COM_NM, a.AGENT_BIZ_NO,
        a.FEE_COM_CD, a.CARGO_COM_CD, a.RECV_COM_TP, a.PROXY_DEAL_CD, a.PROXY_COM_NM,
        a.PROXY_BIZ_NO, a.CUS_BUHO, a.DEAL_PUM_NM, a.JAEWON_CD, a.EXCH_RATE,
        a.SINGO_EK, a.GAMGA_EK, a.TOT_QT, a.QT_UNIT, a.TOT_WT,
        a.WT_UNIT, a.MRN_NO, a.MAWB, a.HAWB, a.PORT_CD,
        a.PORT_NM, a.SHIP_AIR_NM, a.ARRIVE_DT, a.SEGWAN, a.GWA,
        a.WH_CD, a.WH_NM, a.WH_LOC, a.MOKJUK_CD, a.MOKJUK_NM,
        a.SUNGI_CD, a.SUNGI_NM, a.JUKCHL_CD, a.JUKCHL_NM, a.SUPLY_NM,
        a.SUPLY_BUHO, a.GWANSE_EK, a.SPECIAL_EK, a.TRAFFIC_EK, a.ALCOHOL_EK,
        a.EDU_EK, a.FARM_EK, a.VAT_EK, a.ADD_EK, a.MISINGO_ADD_EK,
        a.TOT_TAX_EK, a.NAPBU_DATE, a.LC_NO, a.INVOICE_NO, a.FILE_NO1,
        a.FILE_NO2, a.INDO_JOGUN, a.PAY_METHOD, a.EXPRESS_BUHO, a.EXPRESS_NM,
        a.MONEY_CD, a.MONEY_EK, a.JINGSU_TP, a.NAPSE_SUB_AREA_NO, a.USER_ID,
        a.USER_NM, a.ADJ_SEND_DT, a.ADJ_SEND_METHOD, a.ADJ_NOTE1, a.ADJ_NOTE2,
        a.ADJ_NOTE3, a.ADJ_NOTE1_POP_YN, a.ADJ_MEM_NO, a.ADJ_MEM_NM, a.FIX_YN,
        a.FEE_ISSUE_YN, a.FEE_RATE, a.JAEWON_TP, a.USER_FEE_RATE, a.USER_JAEWON_TP,
        a.MAGAM_PROC_CD, a.ADJ_PROC_CD, a.ADJ_METHOD, a.ADJ_GROUP_NO, a.ADJ_NO,
        a.TAKE_EK, a.PRE_JAN_EK, a.IN_EK, a.COST_EK, a.EXCEPT_EK,
        a.SALE_SUP_EK, a.SALE_TAX_EK, a.SALE_SUM_EK,
        a.ADJ_PAY_PROC_CD, a.GWANSE_ST, a.CC_MATH_YN, a.CL_MATH_YN,
        a.CS_GB, a.FR_GB, a.LOGIS_SUP_EK, a.LOGIS_TAX_EK, a.LOGIS_SUM_EK,
        a.SINGO_GB, a.TG_PLAN, a.UNSONG_TYPE, a.COM_MEM_NM, a.FEE_WRITE_DT, a.FEE_IN_DT,
        a.LOGIS_BUY_SUP_EK, a.LOGIS_BUY_TAX_EK, a.LOGIS_BUY_SUM_EK, a.TRANS_REQ_DT, a.TRANS_ST_CD,
        a.ADJ_NOTE1_POP_YN_REQ, a.ADJ_NOTE1_POP_YN_ADJ, a.ADJ_NOTE1_POP_YN_TAX, a.ADJ_NOTE1_POP_YN_OUT_EK, a.ADJ_DT,
        a.UNSONG_BOX, a.DEAL_CD_DRAWBACK, a.IN_EK_PROC_CD, a.DITC_DRAWBACK, a.STD_PUM_NM,
        a.HS_CD, a.OUT_DT, a.ADJ_IN_EK, a.OUT_TIME, a.CBM,
        a.CON_SU, a.CHK_FEE_EK_YN, a.MAKER_DEAL_CD, a.MAKER_COM_NM, a.BFLOADCHK,
        a.REQ_MEM_NM, a.RECV_MEM_NM, a.TRANS_REQ_TIME, a.WH_OUT_KEY, a.FWD_CD,
        a.FWD_NM, a.MEMO_CNT, a.USER_NOTE1, a.USER_NOTE2, a.USD_RATE, a.SINGOJA_GIJE,
        b.REQ_DOC_NO, b.WRITE_DT, b.ACC_CID, b.BANK_CD, b.BANK_NM, b.ACC_NO,
        b.CMS_NO, b.ACC_OWNER, b.MISU_EK AS 'REQ_DOC_MISU_EK', b.MISU_EK_NOTE, b.SUM_EK, b.SUM_EK_NOTE,
        b.PRE_JAN_EK AS 'REQ_DOC_PRE_JAN_EK', b.PRE_JAN_EK_NOTE, b.REQ_EK AS 'REQ_DOC_REQ_EK', b.REQ_EK_NOTE,
        b.ADJ_COM_CD, b.ADJ_COM_NM, b.RECV_COM_CD, b.RECV_COM_NM, b.RECV_COM_OWNER, b.RECV_COM_TEL_NO,
        b.RECV_COM_FAX_NO, b.RECV_COM_ADDR, b.RECV_COM_MEM_NM, b.RECV_MEM_EMAIL, b.RECV_MEM_HP_NO, b.SUP_CID,
        b.SUP_COM_NM, b.SUP_COM_OWNER, b.SUP_COM_BIZ_NO, b.SUP_JIRO_ADDR, b.TG_MEM_NM, b.TG_TEL_NO, b.TG_FAX_NO,
        b.ADJ_MEM_NM AS 'REQ_DOC_ADJ_MEM_NM', b.ADJ_TEL_NO, b.ADJ_FAX_NO, b.NOTE, b.DEL_YN, b.MOD_MEM_NM, b.MOD_DT, b.MOD_TIME,
        b.SUP_EK, b.TAX_EK, b.TITLE_NM, b.REF_COM_NM,
        b.REF_COM_OWNER, b.REF_COM_TEL_NO, b.REF_COM_FAX_NO, b.REF_COM_ADDR, b.SUP_AREA_CD, b.ADJ_MEM_NO AS 'REQ_DOC_ADJ_MEM_NO', b.RECV_COM_BIZ_NO
        FROM ${_defaultDB}.[dbo].[FR_MAIN] a WITH (NOLOCK)
        INNER JOIN ${_defaultDB}.[dbo].[REQ_DOC] b WITH (NOLOCK)
        ON a.FR_KEY = b.FR_KEY
        AND b.DEL_YN = 'N'
        AND a.WORK_NM = #{workNm}
        WHERE a.SINGO_NO = #{singoNo}
        and a.SINGO_DT = #{singoDt}
        <if test='AREA_NM != null and AREA_NM != ""'>AND a.AREA_NM = #{AREA_NM}</if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectAccountBillStatementOfAccountsDetailList1" resultType="map">
        /* 수출입 공용 회계 자금청구서 상세(데모/정산완료) */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY MAX(a.SORT_SEQ)) AS 'rownum',
        a.ADJ_CD, a.ADJ_NM,
        SUM(a.SUP_EK * a.INOUT_GB * -1) AS 'SUP_EK',
        SUM(a.TAX_EK * a.INOUT_GB * -1) AS 'TAX_EK',
        SUM(a.SUM_EK * a.INOUT_GB * -1) AS 'SUM_EK',
        MAX(a.ADJ_NOTE) AS 'ADJ_NOTE',
        MAX(a.SORT_SEQ) AS 'SORT_SEQ'
        FROM ${_defaultDB}.[dbo].[REQ_DOC_DTL] AS a WITH (NOLOCK)
        , ${_defaultDB}.[dbo].[REQ_DOC] AS b WITH (NOLOCK)
        , ${_defaultDB}.[dbo].[FR_MAIN] AS c WITH (NOLOCK)
        WHERE a.FR_KEY = b.FR_KEY
        AND a.FR_KEY = c.FR_KEY
        AND a.REQ_DOC_NO = b.REQ_DOC_NO
        AND b.DEL_YN = 'N'
        AND c.SINGO_NO = #{singoNo}
        AND c.IMPO_EXPO_KEY = #{ieKey}
        AND a.INOUT_GB = '-1'
        AND a.SUM_EK != 0
        GROUP BY a.ADJ_CD, a.ADJ_NM
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectImportRequestList" resultType="map">
        /* 수입 Request 조회 */
        SELECT
        a.startKey, a.startJisaCode, a.startTaxpayerTradeName, a.startTaxpayerNum,
        a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo, a.startNote,
        a.startCompensationYn, a.startLocation, a.addDtm as 'addDay',
        impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_bl_no, impo.Impo_mbl_no, impo.Impo_mrn_no,
        impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
        ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
        FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
        LEFT OUTER JOIN ${_defaultDB}.[kcba].[Impo1] impo WITH (NOLOCK)
        ON impo.Impo_bl_no = a.startNum
        AND impo.Impo_napse_saup = a.startTaxpayerNum
        where a.useYn = 'Y'
        and a.startGubun = #{startGubun}
        and a.startJisaCode = #{_defaultDB}
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "add_Day"'>AND SUBSTRING(a.addDtm,0,9) BETWEEN #{strFromDate} AND #{strToDate} /* 등록일 */</when>
            </choose>
        </if>
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.startTaxpayerNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <when test='taxNum != "all"'>AND a.startTaxpayerNum = #{taxNum}</when>
            </choose>
        </if>
        <if test='tradeName != null and tradeName != ""'>AND a.startTaxpayerTradeName like '%' + #{tradeName} + '%'</if>
        <if test='startNum != null and startNum != ""'>AND a.startNum like '%' + #{startNum} + '%'</if>
        <if test='referenceNo1 != null and referenceNo1 != ""'>AND (a.startReferenceNo1 LIKE '%' + #{referenceNo1} + '%' or a.startReferenceNo2 LIKE '%' + #{referenceNo1} + '%')</if>
        <if test='USERGRADEB != null and USERGRADEB == "D"'>AND a.addUserId = #{ID}</if>
        order by startKey desc
    </select>

    <select id="selectImportAllRequestList" resultType="map">
        /* 수입 Request 전체조회 */
        select * from
		(
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_ay.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_ay'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_bs.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_bs'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_ca.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_ca'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_cj.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_cj'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_cw.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_cw'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_dj.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_dj'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_gm.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_gm'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_ic.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_ic'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_jj.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_jj'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_pj.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_pj'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_pt.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_pt'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_sel4.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_sel4'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_sn.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_sn'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_us.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_us'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_yj.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_yj'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ncustoms_ys.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'ncustoms_ys'
		union all
		SELECT
		a.startKey, a.startTaxpayerTradeName, a.startTaxpayerNum,
		a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo,SUBSTRING(a.addDtm,0,9) as 'addDay', a.addDtm, a.addUserId,
		impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_mbl_no,
		impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
		ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN demoNcustomsPt.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND impo.Impo_napse_saup = a.startTaxpayerNum
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = 'demoNcustomsPt'
		) c
		where 1=1
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "add_Day"'>AND SUBSTRING(c.addDtm,0,9) BETWEEN #{strFromDate} AND #{strToDate} /* 등록일 */</when>
            </choose>
        </if>
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND c.startTaxpayerNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <when test='taxNum != "all"'>AND c.startTaxpayerNum = #{taxNum}</when>
            </choose>
        </if>
        <if test='tradeName != null and tradeName != ""'>AND c.startTaxpayerTradeName like '%' + #{tradeName} + '%'</if>
        <if test='startNum != null and startNum != ""'>AND c.startNum like '%' + #{startNum} + '%'</if>
        <if test='referenceNo1 != null and referenceNo1 != ""'>AND (c.startReferenceNo1 LIKE '%' + #{referenceNo1} + '%' or c.startReferenceNo2 LIKE '%' + #{referenceNo1} + '%')</if>
        <if test='USERGRADEB != null and USERGRADEB == "D"'>AND c.addUserId = #{ID}</if>
        order by c.startKey desc
    </select>

    <select id="selectImportResultTotal" resultType="map">
        /* 수입실적 건수 조회(전체_신고검사구분제외) */
        SELECT a.yyyy, a.mm, SUM(a.PLcnt) AS 'PLcnt', SUM(a.JechulCnt) AS 'JechulCnt'
        FROM (
        SELECT a.yyyy, a.mm, a.impo_key, COUNT(*) AS 'PLcnt', 0 AS 'JechulCnt'
        FROM (
        SELECT a.yyyy, a.mm, a.impo_key
        FROM [soo].[dbo].[TBR_RESULT_ETL_Import] a WITH (NOLOCK)
        WHERE a.yyyy = #{yyyy}
        AND a.impo_singo_gubun IN ('A','C','E','F')
        AND a.db = 'ncustoms'
        AND a.Impo_napse_saup = '2208109507'
        GROUP BY a.yyyy, a.mm, a.impo_key
        ) a
        GROUP BY a.yyyy, a.mm, a.impo_key

        UNION ALL

        SELECT a.yyyy, a.mm, a.impo_key, 0 AS 'PLcnt', COUNT(*) AS 'JechulCnt'
        FROM (
        SELECT a.yyyy, a.mm, a.impo_key
        FROM [soo].[dbo].[TBR_RESULT_ETL_Import] a WITH (NOLOCK)
        WHERE a.yyyy = #{yyyy}
        AND a.impo_singo_gubun IN ('B','D')
        AND a.db = 'ncustoms'
        AND a.Impo_napse_saup = '2208109507'
        GROUP BY a.yyyy, a.mm, a.impo_key
        ) a
        GROUP BY a.yyyy, a.mm, a.impo_key
        ) a
        GROUP BY a.yyyy, a.mm
        ORDER BY a.yyyy, a.mm
    </select>

    <select id="selectImportResultImport" resultType="map">
        /* 수입실적 수입실적 조회(전체) */
        SELECT a.yyyy, a.mm, SUM(a.impo_cif_total_usd) AS 'impo_cif_total_usd', SUM(a.impo_cif_total_won) AS 'impo_cif_total_won'
        FROM (
        SELECT yyyy, mm, impo_key, impo_cif_total_usd, impo_cif_total_won
        FROM [soo].[dbo].[TBR_RESULT_ETL_Import] WITH (NOLOCK)
        WHERE yyyy = #{yyyy}
        AND db = 'ncustoms'
        AND Impo_napse_saup = '2208109507'
        GROUP BY yyyy, mm, impo_key, impo_cif_total_usd, impo_cif_total_won
        ) a
        GROUP BY a.yyyy, a.mm
        ORDER BY a.yyyy, a.mm
    </select>

    <select id="selectImportResultNapse" resultType="map">
        /* 수입실적 납세실적 조회(전체) */
        SELECT a.yyyy, a.mm,
        SUM(a.impo_gwan_tax) AS 'impo_gwan_tax', SUM(a.impo_teuk_tax) AS 'impo_teuk_tax',
        SUM(a.impo_oil_tax) AS 'impo_oil_tax', SUM(a.impo_ju_tax) AS 'impo_ju_tax',
        SUM(a.impo_edu_tax) AS 'impo_edu_tax', SUM(a.impo_nong_tax) AS 'impo_nong_tax',
        SUM(a.impo_vat_tax) AS 'impo_vat_tax', SUM(a.impo_total_tax) AS 'impo_total_tax'
        FROM (
        SELECT yyyy, mm, impo_key,
        impo_gwan_tax, impo_teuk_tax,
        impo_oil_tax, impo_ju_tax,
        impo_edu_tax, impo_nong_tax,
        impo_vat_tax, impo_total_tax
        FROM [soo].[dbo].[TBR_RESULT_ETL_Import] WITH (NOLOCK)
        WHERE yyyy = #{yyyy}
        AND db = 'ncustoms'
        AND Impo_napse_saup = '2208109507'
        GROUP BY yyyy, mm, impo_key,
        impo_gwan_tax, impo_teuk_tax,
        impo_oil_tax, impo_ju_tax,
        impo_edu_tax, impo_nong_tax,
        impo_vat_tax, impo_total_tax
        ) a
        GROUP BY a.yyyy, a.mm
        ORDER BY a.yyyy, a.mm
    </select>

    <select id="selectImportResultGam" resultType="map">
        /* 수입실적 감면 조회(전체) */
        SELECT a.yyyy, a.mm,
        SUM(a.Imlan_san_gwan) AS 'Imlan_san_gwan', SUM(a.Imlan_myun_gwan) AS 'Imlan_myun_gwan',
        SUM(a.Imlan_gyeng_gwan) AS 'Imlan_gyeng_gwan'
        FROM (
        SELECT yyyy, mm, impo_key,
        SUM(Imlan_san_gwan) AS 'Imlan_san_gwan', SUM(Imlan_myun_gwan) AS 'Imlan_myun_gwan',
        SUM(Imlan_gyeng_gwan) AS 'Imlan_gyeng_gwan'
        FROM [soo].[dbo].[TBR_RESULT_ETL_Import] WITH (NOLOCK)
        WHERE yyyy = #{yyyy}
        AND db = 'ncustoms'
        AND Impo_napse_saup = '2208109507'
        GROUP BY yyyy, mm, impo_key
        ) a
        GROUP BY a.yyyy, a.mm
        ORDER BY a.yyyy, a.mm
    </select>

    <select id="selectImportDeliveryRequest" statementType="CALLABLE" resultType="map">
        {call [soo].[dbo].[USP_수입_배송관리_통관데이터_조회](
        @blNum=#{blNum},
        @singoNum=#{singoNum}
        )}
    </select>

    <select id="selectImportDeliveryCompleteCostList" resultType="map">
        /* Delivery 배송완료 비용정산 리스트 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY deliveryRequestKey DESC) AS 'rownum',
        a.deliveryRequestKey,
        a.customerKey, a.customerDB, a.customerCode, a.customerName, a.customerTaxNum,
        a.hblNo, a.singoNo, a.singoDate, a.suirDate,
        a.pojangSu, a.pojangDanwi, a.deliveryPojangSu, a.deliveryPojangDanwi, a.deliveryJung,
        LEFT(a.deliveryEndDate, 8) AS 'deliveryEndDate',
        a.damage, a.damageDetail,
        a.impoJangchName
        FROM [soo].[dbo].[TBR_Delivery_Request] a WITH (NOLOCK)
        <where>
            AND NOT EXISTS (
            SELECT *
            FROM [soo].[dbo].[TBR_Delivery_Cost] b WITH (NOLOCK)
            WHERE b.deliveryCostCl = 'IMPORT'
            AND b.useYn = 'Y'
            AND b.deliveryCostSingoNum = a.singoNo )
            AND a.useYn = 'Y'
            <if test='deliveryCoName != null and deliveryCoName != ""'>AND a.deliveryCoName = #{deliveryCoName}</if>
            <if test='deliveryStatus != null and deliveryStatus != ""'>AND a.deliveryStatus LIKE '%' + #{deliveryStatus} + '%'</if>
            <if test='customerName != null and customerName != ""'>AND a.customerName LIKE '%' + #{customerName} + '%'</if>
            <if test='hblNo != null and hblNo != ""'>AND a.hblNo LIKE '%' + #{hblNo} + '%'</if>
            <if test='singoNo != null and singoNo != ""'>AND a.singoNo LIKE '%' + #{singoNo} + '%'</if>
            <if test='impoJangchName != null and impoJangchName != ""'>AND a.impoJangchName LIKE '%' + #{singoNo} + '%'</if>
            <if test='(strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>AND LEFT(a.deliveryEndDate, 8) BETWEEN #{strFromDate} AND #{strToDate}</if>
        </where>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectImportDeliveryCostList" resultType="map">
        /* Delivery Cost list */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY allData.deliveryCostKey DESC) AS 'rownum',
        allData.*
        FROM (
        SELECT a.deliveryCostKey, a.deliveryCostCl,
        a.deliveryCostCustomerKey, a.deliveryCostCustomerDb, a.deliveryCostCustomerCode, a.deliveryCostCustomerName, a.deliveryCostCustomerTaxNum,
        a.deliveryCostWriteUserKey, a.deliveryCostWriteUserId, a.deliveryCostWriteUserName, a.deliveryCostWriteUserTradeName, a.deliveryCostWriteUserTaxNum,
        a.deliveryCostBlNum, a.deliveryCostSingoNum, a.deliveryCostCompleteDay,
        a.deliveryCostWarehouse, a.deliveryCostCtQty, a.deliveryCostCtUnit, a.deliveryCostWeight, a.deliveryCostTonnage, a.deliveryCostCargoType, a.deliveryCostStartName, a.deliveryCostEndName,
        a.deliveryCostDamageYn, a.deliveryCostDamageNote, a.deliveryCostSpecificNote,
        a.deliveryCostShippingType, a.deliveryCostShippingCharge, a.deliveryCostWarehouseType, a.deliveryCostWarehouseChange,
        a.deliveryCostInsuranceCharge, a.deliveryCostPayforCharge, a.deliveryCostPayforName,
        a.deliveryCostConfirmCharge, a.deliveryCostConfirmUserKey, a.deliveryCostConfirmUserId, a.deliveryCostConfirmUserName, a.deliveryCostConfirmDtm,
        a.deliveryCostStatus, a.deliveryCostNote,
        a.useYn, a.addUserKey, a.addUserId, a.addUserNm, a.addDtm, a.editUserKey, a.editUserId, a.editUserNm, a.editDtm,
        b.deliveryCostGroupKey, b.deliveryCostGroupMainKey, b.deliveryCostGroupSubKey, b.deliveryCostGroupNote, (SELECT aa.deliveryCostBlNum FROM [soo].[dbo].[TBR_Delivery_Cost] aa WHERE b.deliveryCostGroupMainKey = aa.deliveryCostKey) AS 'deliveryCostMainBlNum',
        (SELECT MAX(requestDate) FROM [soo].[dbo].[TBR_Delivery_Request] WHERE hblNo = a.deliveryCostBlNum AND useYn = 'Y') AS 'deliveryRequestRequestDate'
        FROM [soo].[dbo].[TBR_Delivery_Cost] a WITH (NOLOCK)
        INNER JOIN [soo].[dbo].[TBR_Delivery_CostGroup] b WITH (NOLOCK)
        ON a.deliveryCostKey = b.deliveryCostGroupSubKey
        AND a.useYn = 'Y'
        AND b.useYn = 'Y'
        <where>
            <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
                <choose>
                    <when test='_DateType == "addDtm"'>AND LEFT(a.addDtm, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                    <when test='_DateType == "editDtm"'>AND LEFT(a.editDtm, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                    <when test='_DateType == "deliveryCostCompleteDay"'>AND LEFT(a.deliveryCostCompleteDay, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                    <when test='_DateType == "deliveryCostConfirmDtm"'>AND LEFT(a.deliveryCostConfirmDtm, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                </choose>
            </if>
            <if test='deliveryCostKey != null and deliveryCostKey != ""'>AND a.deliveryCostKey = #{deliveryCostKey}</if>
            <if test='deliveryCostCl != null and deliveryCostCl != ""'>AND a.deliveryCostCl LIKE '%' + #{deliveryCostCl} + '%'</if>
            <if test='deliveryCostCustomerName != null and deliveryCostCustomerName != ""'>AND a.deliveryCostCustomerName LIKE '%' + #{deliveryCostCustomerName} + '%'</if>
            <if test='deliveryCostWriteUserTradeName != null and deliveryCostWriteUserTradeName != ""'>AND a.deliveryCostWriteUserTradeName LIKE '%' + #{deliveryCostWriteUserTradeName} + '%'</if>
            <if test='likeDeliveryCostWriteUserName != null and likeDeliveryCostWriteUserName != ""'>AND a.deliveryCostWriteUserName LIKE '%' + #{likeDeliveryCostWriteUserName} + '%'</if>
            <if test='deliveryCostBlNum != null and deliveryCostBlNum != ""'>AND a.deliveryCostBlNum LIKE '%' + #{deliveryCostBlNum} + '%'</if>
            <if test='deliveryCostSingoNum != null and deliveryCostSingoNum != ""'>AND a.deliveryCostSingoNum LIKE '%' + #{deliveryCostSingoNum} + '%'</if>
            <if test='deliveryCostStartName != null and deliveryCostStartName != ""'>AND a.deliveryCostStartName LIKE '%' + #{deliveryCostStartName} + '%'</if>
            <if test='deliveryCostEndName != null and deliveryCostEndName != ""'>AND a.deliveryCostEndName LIKE '%' + #{deliveryCostEndName} + '%'</if>
            <if test='deliveryCostCargoType != null and deliveryCostCargoType != ""'>AND a.deliveryCostCargoType LIKE '%' + #{deliveryCostCargoType} + '%'</if>
            <if test='deliveryCostStatus != null and deliveryCostStatus != ""'>AND a.deliveryCostStatus = #{deliveryCostStatus}</if>
            <if test='useYn != null and useYn != ""'>AND a.useYn LIKE '%' + #{useYn} + '%'</if>
            <if test='deliveryAssignMan != null and deliveryAssignMan != ""'>
                AND a.deliveryCostBlNum IN (
                SELECT c.hblNo
                FROM [soo].[dbo].[TBR_Delivery_Request] c WITH (NOLOCK)
                WHERE c.useYn = 'Y'
                AND c.assignMan LIKE '%' + #{deliveryAssignMan} + '%' )
            </if>
            <if test='deliveryCostWriteUserKey != null and deliveryCostWriteUserKey != ""'>AND a.deliveryCostWriteUserKey = #{deliveryCostWriteUserKey}</if>
        </where>
        UNION ALL

        SELECT a.deliveryCostKey, a.deliveryCostCl,
        a.deliveryCostCustomerKey, a.deliveryCostCustomerDb, a.deliveryCostCustomerCode, a.deliveryCostCustomerName, a.deliveryCostCustomerTaxNum,
        a.deliveryCostWriteUserKey, a.deliveryCostWriteUserId, a.deliveryCostWriteUserName, a.deliveryCostWriteUserTradeName, a.deliveryCostWriteUserTaxNum,
        a.deliveryCostBlNum, a.deliveryCostSingoNum, a.deliveryCostCompleteDay,
        a.deliveryCostWarehouse, a.deliveryCostCtQty, a.deliveryCostCtUnit, a.deliveryCostWeight, a.deliveryCostTonnage, a.deliveryCostCargoType, a.deliveryCostStartName, a.deliveryCostEndName,
        a.deliveryCostDamageYn, a.deliveryCostDamageNote, a.deliveryCostSpecificNote,
        a.deliveryCostShippingType, a.deliveryCostShippingCharge, a.deliveryCostWarehouseType, a.deliveryCostWarehouseChange,
        a.deliveryCostInsuranceCharge, a.deliveryCostPayforCharge, a.deliveryCostPayforName,
        a.deliveryCostConfirmCharge, a.deliveryCostConfirmUserKey, a.deliveryCostConfirmUserId, a.deliveryCostConfirmUserName, a.deliveryCostConfirmDtm,
        a.deliveryCostStatus, a.deliveryCostNote,
        a.useYn, a.addUserKey, a.addUserId, a.addUserNm, a.addDtm, a.editUserKey, a.editUserId, a.editUserNm, a.editDtm,
        -1 AS 'deliveryCostGroupKey', -1 AS 'deliveryCostGroupMainKey', -1 AS 'deliveryCostGroupSubKey', '' AS 'deliveryCostGroupNote', '' AS 'deliveryCostMainBlNum',
        (SELECT MAX(requestDate) FROM [soo].[dbo].[TBR_Delivery_Request] WHERE hblNo = a.deliveryCostBlNum AND useYn = 'Y') AS 'deliveryRequestRequestDate'
        FROM [soo].[dbo].[TBR_Delivery_Cost] a WITH (NOLOCK)
        <where>
            AND a.useYn = 'Y'
            AND NOT EXISTS (
            SELECT *
            FROM [soo].[dbo].[TBR_Delivery_CostGroup] b WITH (NOLOCK)
            WHERE a.deliveryCostKey = b.deliveryCostGroupSubKey
            AND b.useYn = 'Y' )
            <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
                <choose>
                    <when test='_DateType == "addDtm"'>AND LEFT(a.addDtm, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                    <when test='_DateType == "editDtm"'>AND LEFT(a.editDtm, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                    <when test='_DateType == "deliveryCostCompleteDay"'>AND LEFT(a.deliveryCostCompleteDay, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                    <when test='_DateType == "deliveryCostConfirmDtm"'>AND LEFT(a.deliveryCostConfirmDtm, 8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                </choose>
            </if>
            <if test='deliveryCostKey != null and deliveryCostKey != ""'>AND a.deliveryCostKey = #{deliveryCostKey}</if>
            <if test='deliveryCostCl != null and deliveryCostCl != ""'>AND a.deliveryCostCl LIKE '%' + #{deliveryCostCl} + '%'</if>
            <if test='deliveryCostCustomerName != null and deliveryCostCustomerName != ""'>AND a.deliveryCostCustomerName LIKE '%' + #{deliveryCostCustomerName} + '%'</if>
            <if test='deliveryCostWriteUserTradeName != null and deliveryCostWriteUserTradeName != ""'>AND a.deliveryCostWriteUserTradeName LIKE '%' + #{deliveryCostWriteUserTradeName} + '%'</if>
            <if test='likeDeliveryCostWriteUserName != null and likeDeliveryCostWriteUserName != ""'>AND a.deliveryCostWriteUserName LIKE '%' + #{likeDeliveryCostWriteUserName} + '%'</if>
            <if test='deliveryCostBlNum != null and deliveryCostBlNum != ""'>AND a.deliveryCostBlNum LIKE '%' + #{deliveryCostBlNum} + '%'</if>
            <if test='deliveryCostSingoNum != null and deliveryCostSingoNum != ""'>AND a.deliveryCostSingoNum LIKE '%' + #{deliveryCostSingoNum} + '%'</if>
            <if test='deliveryCostStartName != null and deliveryCostStartName != ""'>AND a.deliveryCostStartName LIKE '%' + #{deliveryCostStartName} + '%'</if>
            <if test='deliveryCostEndName != null and deliveryCostEndName != ""'>AND a.deliveryCostEndName LIKE '%' + #{deliveryCostEndName} + '%'</if>
            <if test='deliveryCostCargoType != null and deliveryCostCargoType != ""'>AND a.deliveryCostCargoType LIKE '%' + #{deliveryCostCargoType} + '%'</if>
            <if test='deliveryCostStatus != null and deliveryCostStatus != ""'>AND a.deliveryCostStatus = #{deliveryCostStatus}</if>
            <if test='useYn != null and useYn != ""'>AND a.useYn LIKE '%' + #{useYn} + '%'</if>
            <if test='deliveryAssignMan != null and deliveryAssignMan != ""'>
                AND a.deliveryCostBlNum IN (
                SELECT c.hblNo
                FROM [soo].[dbo].[TBR_Delivery_Request] c WITH (NOLOCK)
                WHERE c.useYn = 'Y'
                AND c.assignMan LIKE '%' + #{deliveryAssignMan} + '%' )
            </if>
            <if test='deliveryCostWriteUserKey != null and deliveryCostWriteUserKey != ""'>AND a.deliveryCostWriteUserKey = #{deliveryCostWriteUserKey}</if>
        </where>
        ) allData
        <where>
            <if test='_isGrouping != null and _isGrouping != ""'>
                <choose>
                    <when test='_isGrouping == "Y"'>AND allData.deliveryCostGroupKey != -1 /* 그룹핑 데이터 구분(Y) */</when>
                    <otherwise>AND allData.deliveryCostGroupKey = -1 /* 그룹핑 데이터 구분(N) */</otherwise>
                </choose>
            </if>
        </where>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <update id="updateImportDeliveryCostGroupList">
		/* Delivery 그룹핑 해제 */
		UPDATE	soo.dbo.TBR_Delivery_CostGroup
		set useYn='N'
		WHERE deliveryCostGroupMainKey = #{deliveryCostGroupMainKey}
	</update>

    <select id="selectImportDeliveryRequestGroupListByDeliveryCoKey" resultType="map">
        /* Import Delivery Request By deliveryCoKey */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY MAX(a.deliveryRequestKey) DESC) AS 'rownum',
        a.customerKey, a.customerDB, a.customerCode, a.customerName, a.customerTaxNum
        FROM [soo].[dbo].[TBR_Delivery_Request] a WITH (NOLOCK)
        <where>
            AND a.useYn = 'Y'
            <if test='deliveryCoKey != null and deliveryCoKey != ""'>AND a.deliveryCoKey = #{deliveryCoKey}</if>
            <if test='deliveryCoName != null and deliveryCoName != ""'>AND a.deliveryCoName = #{deliveryCoName}</if>
            <if test='deliveryStatus != null and deliveryStatus != ""'>AND a.deliveryStatus LIKE '%' + #{deliveryStatus} + '%'</if>
        </where>
        GROUP BY a.customerKey, a.customerDB, a.customerCode, a.customerName, a.customerTaxNum
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectImportDeliveryRequestGroupList" resultType="map">
        /* Import Delivery Cost 그룹핑 리스트 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.deliveryCostKey ASC) AS 'rownum',
        a.deliveryCostKey, a.deliveryCostCl,
        a.deliveryCostCustomerKey, a.deliveryCostCustomerDb, a.deliveryCostCustomerCode, a.deliveryCostCustomerName, a.deliveryCostCustomerTaxNum,
        a.deliveryCostWriteUserKey, a.deliveryCostWriteUserId, a.deliveryCostWriteUserName, a.deliveryCostWriteUserTradeName, a.deliveryCostWriteUserTaxNum,
        a.deliveryCostBlNum, a.deliveryCostSingoNum, a.deliveryCostCompleteDay,
        a.deliveryCostWarehouse, a.deliveryCostCtQty, a.deliveryCostCtUnit, a.deliveryCostWeight, a.deliveryCostTonnage, a.deliveryCostCargoType, a.deliveryCostStartName, a.deliveryCostEndName,
        a.deliveryCostDamageYn, a.deliveryCostDamageNote, a.deliveryCostSpecificNote,
        a.deliveryCostShippingType, a.deliveryCostShippingCharge, a.deliveryCostWarehouseType, a.deliveryCostWarehouseChange,
        a.deliveryCostInsuranceCharge, a.deliveryCostPayforCharge, a.deliveryCostPayforName,
        a.deliveryCostConfirmCharge, a.deliveryCostConfirmUserKey, a.deliveryCostConfirmUserId, a.deliveryCostConfirmUserName, a.deliveryCostConfirmDtm,
        a.deliveryCostStatus, a.deliveryCostNote,
        a.useYn, a.addUserKey, a.addUserId, a.addUserNm, a.addDtm, a.editUserKey, a.editUserId, a.editUserNm, a.editDtm,
        b.deliveryCostGroupKey, b.deliveryCostGroupMainKey, b.deliveryCostGroupSubKey, b.deliveryCostGroupNote
        FROM [soo].[dbo].[TBR_Delivery_Cost] a WITH (NOLOCK)
        LEFT OUTER JOIN [soo].[dbo].[TBR_Delivery_CostGroup] b WITH (NOLOCK)
        ON a.deliveryCostKey = b.deliveryCostGroupSubKey
        AND a.useYn = 'Y'
        AND b.useYn = 'Y'
        <where>
            AND deliveryCostGroupMainKey IN (
            SELECT deliveryCostGroupMainKey
            FROM [soo].[dbo].[TBR_Delivery_CostGroup]
            WHERE useYn = 'Y'
            AND deliveryCostGroupSubKey = #{deliveryCostKey} )
        </where>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectCustomsCostAllExcelExportList" resultType="map">
        /* 수출입 공통 통관 비용 정산완료 엑셀 데이터 조회 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.costMstKey, b.costDtlKey) AS 'rownum',
        a.costMstKey, a.costMstCl, a.costCustomerKey, a.costCustomerDb, a.costCustomerCode, a.costCustomerName, a.costCustomerTaxNum,
        a.accountMonth, a.accountDay,
        a.costShipperKey, a.costShipperUserId, a.costShipperUserNm, a.costShipperTaxNum,
        a.blNum, a.singoNum, a.referenceNum1, a.referenceNum2, a.totalSupplyAmt, a.totalVat, a.totalSumAmt, a.costMstStatus,
        b.costDtlKey, b.costCode, b.costName, b.supplyAmt, b.vat, b.totalAmt
        FROM [soo].[dbo].[TBR_Customs_CostMaster] AS a WITH (NOLOCK)
        INNER JOIN [soo].[dbo].[TBR_Customs_CostDetail] AS b WITH (NOLOCK)
        ON a.costMstKey = b.costMstKey
        AND a.useYn = 'Y'
        AND b.useYn = 'Y'
        <where>
            <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
                <choose>
                    <when test='_DateType == "accountDay"'>AND a.accountDay BETWEEN #{strFromDate} AND #{strToDate}</when>
                    <when test='_DateType == "addDtm"'>AND a.addDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959'</when>
                    <when test='_DateType == "editDtm"'>AND a.editDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959'</when>
                </choose>
            </if>
            <if test='costMstKey != null and costMstKey != ""'>AND a.costMstKey = #{costMstKey}</if>
            <if test='costMstCl != null and costMstCl != ""'>AND a.costMstCl LIKE '%' + #{costMstCl} + '%'</if>
            <if test='costCustomerName != null and costCustomerName != ""'>AND a.costCustomerName LIKE '%' + #{costCustomerName} + '%'</if>
            <if test='accountMonth != null and accountMonth != ""'>AND a.accountMonth LIKE '%' + #{accountMonth} + '%'</if>
            <if test='costShipperUserNm != null and costShipperUserNm != ""'>AND a.costShipperUserNm LIKE '%' + #{costShipperUserNm} + '%'</if>
            <if test='blNum != null and blNum != ""'>AND a.blNum LIKE '%' + #{blNum} + '%'</if>
            <if test='singoNum != null and singoNum != ""'>AND a.singoNum LIKE '%' + #{singoNum} + '%'</if>
            <if test='referenceNum1 != null and referenceNum1 != ""'>AND a.referenceNum1 LIKE '%' + #{referenceNum1} + '%'</if>
            <if test='referenceNum2 != null and referenceNum2 != ""'>AND a.referenceNum2 LIKE '%' + #{referenceNum2} + '%'</if>
            <if test='costMstStatus != null and costMstStatus != ""'>AND a.costMstStatus LIKE '%' + #{costMstStatus} + '%'</if>
        </where>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectGeodisImportDeclarationMasterList" resultType="map">
        /* 수입화물통관 Declaration 마스터 조회(geodis) */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.Impo_key DESC) AS 'rownum',
        a.Impo_key, a.impo_bl_no, a.Impo_bl_gubun, SUBSTRING(a.impo_singo_no, 1,5) + '-' + SUBSTRING(a.impo_singo_no, 6,2) + '-' + SUBSTRING(a.impo_singo_no, 8,7) AS
        'impo_singo_no', a.Impo_file_no1, a.Impo_file_no2,
        ltrim(rtrim(replace(b.Imlan_gije3, 'INV NO.', ''))) AS 'Imlan_gije3', a.Impo_gonggub_sangho, a.Impo_receive_result, a.Impo_Forwarder_sangho, a.Impo_hanggu_name,
        CASE WHEN ISNULL(a.Impo_iphang_date,'')='' THEN '' ELSE SUBSTRING(a.Impo_iphang_date, 1,4)+'-'+SUBSTRING(a.Impo_iphang_date, 5,2)+'-'+SUBSTRING(a.Impo_iphang_date, 7,2) END
        AS 'Impo_iphang_date',
        CASE WHEN ISNULL(a.Impo_banip_date,'')='' THEN '' ELSE SUBSTRING(a.Impo_banip_date, 1,4)+'-'+SUBSTRING(a.Impo_banip_date, 5,2)+'-'+SUBSTRING(a.Impo_banip_date, 7,2) END AS
        'Impo_banip_date',
        CASE WHEN ISNULL(a.impo_singo_date,'')='' THEN '' ELSE SUBSTRING(a.impo_singo_date, 1,4)+'-'+SUBSTRING(a.impo_singo_date, 5,2)+'-'+SUBSTRING(a.impo_singo_date, 7,2) END AS
        'impo_singo_date',
        CASE WHEN ISNULL(a.impo_Ok_date,'')='' THEN '' ELSE SUBSTRING(a.impo_Ok_date, 1,4) + '-' + SUBSTRING(a.impo_Ok_date, 5,2) + '-' + SUBSTRING(a.impo_Ok_date, 7,2) END AS
        'impo_Ok_date',
        d.destination, CASE WHEN ISNULL(d.destination_Date,'')='' THEN '' ELSE SUBSTRING(d.destination_Date, 1,4) + '-' + SUBSTRING(d.destination_Date, 5,2) + '-' +
        SUBSTRING(d.destination_Date, 7,2) END AS 'destination_Date',
        a.Impo_pojang_su, a.Impo_total_jung, a.Impo_indo_jogun, a.Impo_gyelje_money, a.Impo_gyelje,
        a.impo_mbl_no, a.impo_bl_no AS 'hdn_Impo_Bl_No', a.Impo_gyelje_input AS 'hidden_Impo_gyelje_input', a.Impo_pojang_danwi, a.Impo_gyelje_input, a.Impo_send_result,
        a.Impo_total_tax, d.iG_Freight, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_gwan_tax, a.Impo_vat_tax, (a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS
        'Impo_etc_tax',
        CASE WHEN a.Impo_unsong_type='10' THEN 'Ocean' ELSE 'Air' END AS 'Impo_unsong_type'
        FROM ${_defaultDB}.[kcba].[Impo1] a WITH (NOLOCK)
        INNER JOIN (SELECT Imlan_key, MIN(Imlan_gije3) Imlan_gije3
        FROM ${_defaultDB}.[kcba].[Impo2] WITH (NOLOCK)
        GROUP BY Imlan_key) b
        ON a.Impo_key=b.Imlan_key
        LEFT OUTER JOIN ${_defaultDB}.[kcba].[Impo1_M] d WITH (NOLOCK)
        ON a.Impo_key = d.Impo_key

        WHERE a.Impo_DaeSaupNo = #{taxNum}
        AND ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준) */
        <if test='strEntity != null and strEntity != ""'>AND a.impo_file_no1 LIKE '%' + #{strEntity} + '%' /* Entity */</if>
        <if test='strVendor != null and strVendor != ""'>AND a.impo_file_no2 LIKE '%' + #{strVendor} + '%' /* Vendor */</if>
        <if test='strForwarder != null and strForwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{strForwarder} + '%' /* Forwarder */</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate} /* 입항일 */</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate} /* 반입일 */</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate} /* 통관신고일 */</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate} /* 통관수리일 */</when>
            </choose>
        </if>
        <if test='strSingoDelay != null and strSingoDelay != "ALL"'>
            <choose>
                <when test='strSingoDelay == "SINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') != ''</when>
                <when test='strSingoDelay == "MISINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') = ''</when>
            </choose>
        </if>
        <if test='strSegwanDelay != null and strSegwanDelay != "ALL"'>
            <choose>
                <when test='strSegwanDelay == "SIMSA"'>AND (ISNULL(a.Impo_Jubsu_Date,'') != '' AND ISNULL(a.Impo_ok_date,'') != '')</when>
                <when test='strSegwanDelay == "MISIMSA"'>AND (ISNULL(a.Impo_Jubsu_Date,'') != '' AND ISNULL(a.Impo_ok_date,'') = '')</when>
            </choose>
        </if>
        <if test='strSingoNo != null and strSingoNo != ""'>AND a.impo_singo_no LIKE '%' + #{strSingoNo} + '%' /* 수입신고번호 */</if>
        <if test='strBlNo != null and strBlNo != ""'>AND a.impo_bl_no LIKE '%' + #{strBlNo} + '%' /* BL번호 */</if>
        <if test='strInvoiceNo != null and strInvoiceNo != ""'>
            AND EXISTS ( SELECT * FROM ${_defaultDB}.[kcba].[Impo2] b WITH (NOLOCK) WHERE a.impo_key=b.imlan_key AND b.Imlan_gije3 = 'INV NO.' + #{strInvoiceNo} ) /* 인보이스 */
        </if>
        <if test='strOrderNo != null and strOrderNo != ""'>
            AND EXISTS ( SELECT * FROM ${_defaultDB}.[kcba].[Impo3] c WITH (NOLOCK) WHERE a.impo_key=c.Impum_key AND c.Impum_sungbun3 = #{strOrderNo} ) /* OrderNo */
        </if>
        <if test='impoReceiveResult != null and impoReceiveResult != "" and impoReceiveResult != "ALL"'>
            AND a.Impo_receive_result LIKE '%' + #{impoReceiveResult} + '%' /* status */
        </if>
        <if test='strUnsong != null and strUnsong != ""'>AND a.Impo_unsong_type = #{strUnsong}</if>
        ) datas
		<if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
			WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
		</if>
    </select>

    <select id="selectGeodisImportDeclarationDetailList" resultType="map">
        /* 수입화물통관 Declaration 디테일 조회(geodis) */
		SELECT datas.*
		FROM (
		SELECT ROW_NUMBER() OVER (ORDER BY a.Imlan_key, a.Imlan_jechl_lan) AS 'rownum',
        a.Imlan_key, a.Imlan_seyul_gubun, a.Imlan_jechl_lan, a.Imlan_hs hdnImlanHs,
        SUBSTRING(a.Imlan_hs,1, 4) + '.' + SUBSTRING(a.Imlan_hs,5,2) + '-' + SUBSTRING(a.Imlan_hs,7,4) AS 'Imlan_hs', a.Imlan_gurae_pum, a.Imlan_model,
        a.Imlan_gije3,
        a.Imlan_cost, a.Imlan_mulryang, a.Imlan_mulryang_danwi, a.Imlan_jung, a.Imlan_cif_won,
        a.Imlan_cif_usd, a.Imlan_gwan_tax, a.Imlan_vat_tax, a.Imlan_cs_gumsa1, a.imlan_fta_obj,
        a.Imlan_popum, /* 표준품명 */
        a.Imlan_su, a.Imlan_su_danwi, /* 수량 */
        a.Imlan_gwan_gyeng_yul, a.Imlan_gwan_seyula, /* 관세감면 */
        a.Imlan_neguk_gubun, a.Imlan_neguk_code, a.Imlan_neguk_myun, /* 내국세 */
        a.Imlan_edu_yn, a.Imlan_edu_seyul, a.Imlan_edu_tax, /* 교육세 */
        a.Imlan_plus, /* 가산금 */
        a.Imlan_wonsanji_code, a.Imlan_wonsanji_name, a.Imlan_wonsanji_mark, a.Imlan_wonsanji_bang, a.Imlan_wonsanji_type, /* 원산지 */
        a.Imlan_minus, /* 공제금 */
        a.Imlan_wonsanji_no, /* 원산지증명서 */
        a.Imlan_vat_gubun, a.Imlan_vat_gam_buho, a.Imlan_vat_gyeng_yul, /* 란부가세 */
        d.Imlan_gije
        FROM ${_defaultDB}.[kcba].[Impo2] a WITH (NOLOCK)
        LEFT OUTER JOIN ${_defaultDB}.[kcba].[Impo4] b WITH (NOLOCK)
        ON a.Imlan_key=b.Suipyogun_key
        AND a.Imlan_jechl_lan=b.Suipyogun_lan
        LEFT OUTER JOIN ${_defaultDB}.[kcba].[ImNotYog] c WITH (NOLOCK)
        ON a.Imlan_key=c.Impo_key
        AND a.Imlan_jechl_lan=c.Lan
        INNER JOIN
        (SELECT MIN(a.Imlan_key) AS 'Imlan_key', MIN(a.Imlan_jechl_lan) AS 'Imlan_jechl_lan', a.Imlan_gije1 + CHAR(10) + a.Imlan_gije2 + CHAR(10) + a.Imlan_gije3 + CHAR(10) +
        a.Imlan_gije4 + CHAR(10) + a.Imlan_gije5
        + CHAR(10) + a.Imlan_gije6 + CHAR(10) + a.Imlan_gije7 + CHAR(10) + a.Imlan_gije8 + CHAR(10) + a.Imlan_gije9 + CHAR(10) + a.Imlan_gije10 AS 'Imlan_gije'
        FROM ${_defaultDB}.[kcba].[Impo2] a WITH (NOLOCK)
        WHERE a.Imlan_key= #{strImlanKey}
        /* and a.Imlan_gije1!= '' */
        GROUP BY a.Imlan_gije1 + CHAR(10) + a.Imlan_gije2 + CHAR(10) + a.Imlan_gije3 + CHAR(10) + a.Imlan_gije4 + CHAR(10) + a.Imlan_gije5
        + CHAR(10) + a.Imlan_gije6 + CHAR(10) + a.Imlan_gije7 + CHAR(10) + a.Imlan_gije8 + CHAR(10) + a.Imlan_gije9 + CHAR(10) + a.Imlan_gije10) d
        ON a.Imlan_key=d.Imlan_key
        WHERE a.Imlan_key = #{strImlanKey}
        <if test='strOrderNo != null and strOrderNo != ""'>
            AND EXISTS ( SELECT * FROM ${_defaultDB}.[kcba].[Impo3] a1 WITH (NOLOCK) WHERE a.Imlan_key=a1.Impum_key AND a.Imlan_jechl_lan=a1.Impum_lan AND a1.Impum_sungbun3 = #{strOrderNo} )
        </if>
		) datas
		<if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
			WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
		</if>
    </select>

    <select id="selectGeodisImportDeclarationSubDetailList" resultType="map">
		/* 수입화물통관 Declaration 서브디테일 조회(geodis) */
		SELECT datas.*
		FROM (
		SELECT ROW_NUMBER() OVER (ORDER BY a.Impum_key, a.Impum_lan, a.Impum_heang) AS 'rownum',
		a.Impum_key, a.Impum_lan, a.Impum_heang, a.Impum_jajae_code,
		a.Impum_gukyk1, a.Impum_gukyk2, a.Impum_gukyk3, a.Impum_su, a.Impum_su_danwi,
		a.Impum_danga, a.Impum_Amt, a.Impum_sungbun1, a.Impum_sungbun2,
		a.Impum_sungbun3,
		ISNULL(c.acc_C018_amt,0) AS 'acc_C018_amt', ISNULL(c.acc_C026_tot,0) AS 'acc_C026_tot', ISNULL(c.acc_C018_vat,0) AS 'acc_C018_vat', ISNULL(c.acc_C005_amt,0) AS 'acc_C005_amt', ISNULL(c.acc_C005_vat,0) AS 'acc_C005_vat',
		ISNULL(c.acc_C086_tot,0) AS 'acc_C086_tot', ISNULL(c.acc_C054_tot,0) AS 'acc_C054_tot', ISNULL(c.acc_C095_tot,0) AS 'acc_C095_tot',
		ISNULL(c.acc_C080_tot,0) AS 'acc_C080_tot', ISNULL(c.acc_C013_tot,0) AS 'acc_C013_tot',
		ISNULL(c.acc_C014_tot,0) AS 'acc_C014_tot', ISNULL(c.acc_C111_tot,0) AS 'acc_C111_tot',
		ISNULL(b.cifwon,0) AS 'cifwon', ISNULL(b.fre,0) AS 'fre', ISNULL(b.ins,0) AS 'ins', ISNULL(b.plus,0) AS 'plus', ISNULL(b.duty,0) AS 'duty',
		ISNULL(b.tk,0) AS 'tk', ISNULL(b.kt,0) AS 'kt', ISNULL(b.ju,0) AS 'ju', ISNULL(b.edu,0) AS 'edu', ISNULL(b.nong,0) AS 'nong',
		ISNULL(b.vat,0) AS 'vat', ISNULL(b.tax,0) AS 'tax', ISNULL(b.vat_g,0) AS 'vat_g', ISNULL(b.gasan,0) AS 'gasan',
		ISNULL(b.misingo,0) AS 'misingo'
		FROM ${_defaultDB}.[kcba].[Impo3] a WITH (NOLOCK)
		LEFT OUTER JOIN ${_defaultDB}.[kcba].[Impo3_M] b WITH (NOLOCK)
		ON a.Impum_key=b.Impum_key
		AND a.Impum_lan=b.Impum_lan
		AND a.Impum_heang=b.Impum_heang
		LEFT OUTER JOIN 	(
		SELECT aa.Impum_key, aa.Impum_lan, aa.Impum_heang,
		SUM(aa.acc_C005_amt) AS 'acc_C005_amt', SUM(aa.acc_C005_vat) AS 'acc_C005_vat', SUM(aa.acc_C005_tot) AS 'acc_C005_tot',
		SUM(aa.acc_C013_amt) AS 'acc_C013_amt', SUM(aa.acc_C013_vat) AS 'acc_C013_vat', SUM(aa.acc_C013_tot) AS 'acc_C013_tot',
		SUM(aa.acc_C014_amt) AS 'acc_C014_amt', SUM(aa.acc_C014_vat) AS 'acc_C014_vat', SUM(aa.acc_C014_tot) AS 'acc_C014_tot',
		SUM(aa.acc_C018_amt) AS 'acc_C018_amt', SUM(aa.acc_C018_vat) AS 'acc_C018_vat', SUM(aa.acc_C018_tot) AS 'acc_C018_tot',
		SUM(aa.acc_C026_amt) AS 'acc_C026_amt', SUM(aa.acc_C026_vat) AS 'acc_C026_vat', SUM(aa.acc_C026_tot) AS 'acc_C026_tot',
		SUM(aa.acc_C043_amt) AS 'acc_C043_amt', SUM(aa.acc_C043_vat) AS 'acc_C043_vat', SUM(aa.acc_C043_tot) AS 'acc_C043_tot',
		SUM(aa.acc_C054_amt) AS 'acc_C054_amt', SUM(aa.acc_C054_vat) AS 'acc_C054_vat', SUM(aa.acc_C054_tot) AS 'acc_C054_tot',
		SUM(aa.acc_C055_amt) AS 'acc_C055_amt', SUM(aa.acc_C055_vat) AS 'acc_C055_vat', SUM(aa.acc_C055_tot) AS 'acc_C055_tot',
		SUM(aa.acc_C056_amt) AS 'acc_C056_amt', SUM(aa.acc_C056_vat) AS 'acc_C056_vat', SUM(aa.acc_C056_tot) AS 'acc_C056_tot',
		SUM(aa.acc_C057_amt) AS 'acc_C057_amt', SUM(aa.acc_C057_vat) AS 'acc_C057_vat', SUM(aa.acc_C057_tot) AS 'acc_C057_tot',
		SUM(aa.acc_C058_amt) AS 'acc_C058_amt', SUM(aa.acc_C058_vat) AS 'acc_C058_vat', SUM(aa.acc_C058_tot) AS 'acc_C058_tot',
		SUM(aa.acc_C060_amt) AS 'acc_C060_amt', SUM(aa.acc_C060_vat) AS 'acc_C060_vat', SUM(aa.acc_C060_tot) AS 'acc_C060_tot',
		SUM(aa.acc_C062_amt) AS 'acc_C062_amt', SUM(aa.acc_C062_vat) AS 'acc_C062_vat', SUM(aa.acc_C062_tot) AS 'acc_C062_tot',
		SUM(aa.acc_C080_amt) AS 'acc_C080_amt', SUM(aa.acc_C080_vat) AS 'acc_C080_vat', SUM(aa.acc_C080_tot) AS 'acc_C080_tot',
		SUM(aa.acc_C086_amt) AS 'acc_C086_amt', SUM(aa.acc_C086_vat) AS 'acc_C086_vat', SUM(aa.acc_C086_tot) AS 'acc_C086_tot',
		SUM(aa.acc_C090_amt) AS 'acc_C090_amt', SUM(aa.acc_C090_vat) AS 'acc_C090_vat', SUM(aa.acc_C090_tot) AS 'acc_C090_tot',
		SUM(aa.acc_C091_amt) AS 'acc_C091_amt', SUM(aa.acc_C091_vat) AS 'acc_C091_vat', SUM(aa.acc_C091_tot) AS 'acc_C091_tot',
		SUM(aa.acc_C095_amt) AS 'acc_C095_amt', SUM(aa.acc_C095_vat) AS 'acc_C095_vat', SUM(aa.acc_C095_tot) AS 'acc_C095_tot',
		SUM(aa.acc_C097_amt) AS 'acc_C097_amt', SUM(aa.acc_C097_vat) AS 'acc_C097_vat', SUM(aa.acc_C097_tot) AS 'acc_C097_tot',
		SUM(aa.acc_C107_amt) AS 'acc_C107_amt', SUM(aa.acc_C107_vat) AS 'acc_C107_vat', SUM(aa.acc_C107_tot) AS 'acc_C107_tot',
		SUM(aa.acc_C108_amt) AS 'acc_C108_amt', SUM(aa.acc_C108_vat) AS 'acc_C108_vat', SUM(aa.acc_C108_tot) AS 'acc_C108_tot',
		SUM(aa.acc_C109_amt) AS 'acc_C109_amt', SUM(aa.acc_C109_vat) AS 'acc_C109_vat', SUM(aa.acc_C109_tot) AS 'acc_C109_tot',
		SUM(aa.acc_C111_amt) AS 'acc_C111_amt', SUM(aa.acc_C111_vat) AS 'acc_C111_vat', SUM(aa.acc_C111_tot) AS 'acc_C111_tot',
		SUM(aa.acc_C113_amt) AS 'acc_C113_amt', SUM(aa.acc_C113_vat) AS 'acc_C113_vat', SUM(aa.acc_C113_tot) AS 'acc_C113_tot',
		SUM(aa.acc_C116_amt) AS 'acc_C116_amt', SUM(aa.acc_C116_vat) AS 'acc_C116_vat', SUM(aa.acc_C116_tot) AS 'acc_C116_tot',
		SUM(aa.acc_C117_amt) AS 'acc_C117_amt', SUM(aa.acc_C117_vat) AS 'acc_C117_vat', SUM(aa.acc_C117_tot) AS 'acc_C117_tot',
		SUM(aa.acc_C118_amt) AS 'acc_C118_amt', SUM(aa.acc_C118_vat) AS 'acc_C118_vat', SUM(aa.acc_C118_tot) AS 'acc_C118_tot',
		SUM(aa.acc_C119_amt) AS 'acc_C119_amt', SUM(aa.acc_C119_vat) AS 'acc_C119_vat', SUM(aa.acc_C119_tot) AS 'acc_C119_tot',
		SUM(aa.acc_C120_amt) AS 'acc_C120_amt', SUM(aa.acc_C120_vat) AS 'acc_C120_vat', SUM(aa.acc_C120_tot) AS 'acc_C120_tot',
		SUM(aa.acc_C121_amt) AS 'acc_C121_amt', SUM(aa.acc_C121_vat) AS 'acc_C121_vat', SUM(aa.acc_C121_tot) AS 'acc_C121_tot',
		SUM(aa.acc_C122_amt) AS 'acc_C122_amt', SUM(aa.acc_C122_vat) AS 'acc_C122_vat', SUM(aa.acc_C122_tot) AS 'acc_C122_tot',
		SUM(aa.acc_C123_amt) AS 'acc_C123_amt', SUM(aa.acc_C123_vat) AS 'acc_C123_vat', SUM(aa.acc_C123_tot) AS 'acc_C123_tot',
		SUM(aa.acc_C124_amt) AS 'acc_C124_amt', SUM(aa.acc_C124_vat) AS 'acc_C124_vat', SUM(aa.acc_C124_tot) AS 'acc_C124_tot',
		SUM(aa.acc_C125_amt) AS 'acc_C125_amt', SUM(aa.acc_C125_vat) AS 'acc_C125_vat', SUM(aa.acc_C125_tot) AS 'acc_C125_tot',
		SUM(aa.acc_C126_amt) AS 'acc_C126_amt', SUM(aa.acc_C126_vat) AS 'acc_C126_vat', SUM(aa.acc_C126_tot) AS 'acc_C126_tot',
		SUM(aa.acc_tot_sum_amt) AS 'acc_tot_sum_amt', SUM(aa.acc_tot_sum_vat) AS 'acc_tot_sum_vat', SUM(aa.acc_tot_sum_tot) AS 'acc_tot_sum_tot'
		FROM  (
		SELECT a.Impum_key, a.Impum_lan, a.Impum_heang,
		/* C005 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C005' THEN a.sup_ek ELSE 0 END AS 'acc_C005_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C005' THEN a.tax_ek ELSE 0 END AS 'acc_C005_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C005' THEN a.sum_ek ELSE 0 END AS 'acc_C005_tot',
		/* C013 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C013' then a.sup_ek ELSE 0 END AS 'acc_C013_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C013' then a.tax_ek ELSE 0 END AS 'acc_C013_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C013' then a.sum_ek ELSE 0 END AS 'acc_C013_tot',
		/* C014 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C014' then a.sup_ek ELSE 0 END AS 'acc_C014_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C014' then a.tax_ek ELSE 0 END AS 'acc_C014_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C014' then a.sum_ek ELSE 0 END AS 'acc_C014_tot',
		/* C018 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C018' then a.sup_ek ELSE 0 END AS 'acc_C018_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C018' then a.tax_ek ELSE 0 END AS 'acc_C018_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C018' then a.sum_ek ELSE 0 END AS 'acc_C018_tot',
		/* C026 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C026' then a.sup_ek ELSE 0 END AS 'acc_C026_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C026' then a.tax_ek ELSE 0 END AS 'acc_C026_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C026' then a.sum_ek ELSE 0 END AS 'acc_C026_tot',
		/* C043 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C043' then a.sup_ek ELSE 0 END AS 'acc_C043_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C043' then a.tax_ek ELSE 0 END AS 'acc_C043_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C043' then a.sum_ek ELSE 0 END AS 'acc_C043_tot',
		/* C054 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C054' then a.sup_ek ELSE 0 END AS 'acc_C054_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C054' then a.tax_ek ELSE 0 END AS 'acc_C054_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C054' then a.sum_ek ELSE 0 END AS 'acc_C054_tot',
		/* C055 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C055' then a.sup_ek ELSE 0 END AS 'acc_C055_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C055' then a.tax_ek ELSE 0 END AS 'acc_C055_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C055' then a.sum_ek ELSE 0 END AS 'acc_C055_tot',
		/* C056 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C056' then a.sup_ek ELSE 0 END AS 'acc_C056_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C056' then a.tax_ek ELSE 0 END AS 'acc_C056_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C056' then a.sum_ek ELSE 0 END AS 'acc_C056_tot',
		/* C057 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C057' then a.sup_ek ELSE 0 END AS 'acc_C057_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C057' then a.tax_ek ELSE 0 END AS 'acc_C057_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C057' then a.sum_ek ELSE 0 END AS 'acc_C057_tot',
		/* C058 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C058' then a.sup_ek ELSE 0 END AS 'acc_C058_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C058' then a.tax_ek ELSE 0 END AS 'acc_C058_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C058' then a.sum_ek ELSE 0 END AS 'acc_C058_tot',
		/* C060 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C060' then a.sup_ek ELSE 0 END AS 'acc_C060_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C060' then a.tax_ek ELSE 0 END AS 'acc_C060_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C060' then a.sum_ek ELSE 0 END AS 'acc_C060_tot',
		/* C062 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C062' then a.sup_ek ELSE 0 END AS 'acc_C062_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C062' then a.tax_ek ELSE 0 END AS 'acc_C062_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C062' then a.sum_ek ELSE 0 END AS 'acc_C062_tot',
		/* C080 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C080' then a.sup_ek ELSE 0 END AS 'acc_C080_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C080' then a.tax_ek ELSE 0 END AS 'acc_C080_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C080' then a.sum_ek ELSE 0 END AS 'acc_C080_tot',
		/* C086 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C086' then a.sup_ek ELSE 0 END AS 'acc_C086_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C086' then a.tax_ek ELSE 0 END AS 'acc_C086_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C086' then a.sum_ek ELSE 0 END AS 'acc_C086_tot',
		/* C090 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C090' then a.sup_ek ELSE 0 END AS 'acc_C090_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C090' then a.tax_ek ELSE 0 END AS 'acc_C090_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C090' then a.sum_ek ELSE 0 END AS 'acc_C090_tot',
		/* C091 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C091' then a.sup_ek ELSE 0 END AS 'acc_C091_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C091' then a.tax_ek ELSE 0 END AS 'acc_C091_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C091' then a.sum_ek ELSE 0 END AS 'acc_C091_tot',
		/* C095 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C095' then a.sup_ek ELSE 0 END AS 'acc_C095_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C095' then a.tax_ek ELSE 0 END AS 'acc_C095_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C095' then a.sum_ek ELSE 0 END AS 'acc_C095_tot',
		/* C097 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C097' then a.sup_ek ELSE 0 END AS 'acc_C097_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C097' then a.tax_ek ELSE 0 END AS 'acc_C097_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C097' then a.sum_ek ELSE 0 END AS 'acc_C097_tot',
		/* C107 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C107' then a.sup_ek ELSE 0 END AS 'acc_C107_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C107' then a.tax_ek ELSE 0 END AS 'acc_C107_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C107' then a.sum_ek ELSE 0 END AS 'acc_C107_tot',
		/* C108 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C108' then a.sup_ek ELSE 0 END AS 'acc_C108_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C108' then a.tax_ek ELSE 0 END AS 'acc_C108_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C108' then a.sum_ek ELSE 0 END AS 'acc_C108_tot',
		/* C109 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C109' then a.sup_ek ELSE 0 END AS 'acc_C109_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C109' then a.tax_ek ELSE 0 END AS 'acc_C109_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C109' then a.sum_ek ELSE 0 END AS 'acc_C109_tot',
		/* C111 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C111' then a.sup_ek ELSE 0 END AS 'acc_C111_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C111' then a.tax_ek ELSE 0 END AS 'acc_C111_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C111' then a.sum_ek ELSE 0 END AS 'acc_C111_tot',
		/* C113 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C113' then a.sup_ek ELSE 0 END AS 'acc_C113_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C113' then a.tax_ek ELSE 0 END AS 'acc_C113_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C113' then a.sum_ek ELSE 0 END AS 'acc_C113_tot',
		/* C116 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C116' then a.sup_ek ELSE 0 END AS 'acc_C116_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C116' then a.tax_ek ELSE 0 END AS 'acc_C116_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C116' then a.sum_ek ELSE 0 END AS 'acc_C116_tot',
		/* C117 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C117' then a.sup_ek ELSE 0 END AS 'acc_C117_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C117' then a.tax_ek ELSE 0 END AS 'acc_C117_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C117' then a.sum_ek ELSE 0 END AS 'acc_C117_tot',
		/* C118 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C118' then a.sup_ek ELSE 0 END AS 'acc_C118_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C118' then a.tax_ek ELSE 0 END AS 'acc_C118_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C118' then a.sum_ek ELSE 0 END AS 'acc_C118_tot',
		/* C119 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C119' then a.sup_ek ELSE 0 END AS 'acc_C119_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C119' then a.tax_ek ELSE 0 END AS 'acc_C119_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C119' then a.sum_ek ELSE 0 END AS 'acc_C119_tot',
		/* C120 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C120' then a.sup_ek ELSE 0 END AS 'acc_C120_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C120' then a.tax_ek ELSE 0 END AS 'acc_C120_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C120' then a.sum_ek ELSE 0 END AS 'acc_C120_tot',
		/* C121 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C121' then a.sup_ek ELSE 0 END AS 'acc_C121_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C121' then a.tax_ek ELSE 0 END AS 'acc_C121_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C121' then a.sum_ek ELSE 0 END AS 'acc_C121_tot',
		/* C122 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C122' then a.sup_ek ELSE 0 END AS 'acc_C122_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C122' then a.tax_ek ELSE 0 END AS 'acc_C122_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C122' then a.sum_ek ELSE 0 END AS 'acc_C122_tot',
		/* C123 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C123' then a.sup_ek ELSE 0 END AS 'acc_C123_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C123' then a.tax_ek ELSE 0 END AS 'acc_C123_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C123' then a.sum_ek ELSE 0 END AS 'acc_C123_tot',
		/* C124 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C124' then a.sup_ek ELSE 0 END AS 'acc_C124_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C124' then a.tax_ek ELSE 0 END AS 'acc_C124_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C124' then a.sum_ek ELSE 0 END AS 'acc_C124_tot',
		/* C125 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C125' then a.sup_ek ELSE 0 END AS 'acc_C125_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C125' then a.tax_ek ELSE 0 END AS 'acc_C125_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C125' then a.sum_ek ELSE 0 END AS 'acc_C125_tot',
		/* C126 */
		CASE WHEN ISNULL(a.ADJ_CD,'')='C126' then a.sup_ek ELSE 0 END AS 'acc_C126_amt',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C126' then a.tax_ek ELSE 0 END AS 'acc_C126_vat',
		CASE WHEN ISNULL(a.ADJ_CD,'')='C126' then a.sum_ek ELSE 0 END AS 'acc_C126_tot',
		/* total_sum */
		SUM(ISNULL(a.sup_ek,0)) AS 'acc_tot_sum_amt',
		SUM(ISNULL(a.tax_ek,0)) AS 'acc_tot_sum_vat',
		SUM(ISNULL(a.sum_ek,0)) AS 'acc_tot_sum_tot'
		FROM 	${_defaultDB}.[kcba].[impo3_mDtl] a WITH (NOLOCK)
		GROUP BY a.Impum_key, a.Impum_lan, a.Impum_heang, ISNULL(a.ADJ_CD,''), a.sup_ek, a.tax_ek, a.sum_ek
		) aa
		GROUP BY aa.Impum_key, aa.Impum_lan, aa.Impum_heang
		) c
		ON a.Impum_key=c.Impum_key
		AND a.Impum_lan=c.Impum_lan
		AND a.Impum_heang=c.Impum_heang
		WHERE a.Impum_key = #{strImpumKey}
		AND a.Impum_lan = #{strImpumLan}
		) datas
		<if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
			WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
		</if>
	</select>

    <select id="selectMainGraphList" resultType="map">
        /* 메인 그래프 */
        SELECT a.Impo_year, a.mm, floor(SUM(a.import)) AS 'import', floor(SUM(a.export)) AS 'export'
		FROM (
			select
			SUBSTRING(yyyymm,0,5) as 'Impo_year', SUBSTRING(yyyymm,5,2) as 'mm', SUM(amtWon) as 'import', 0 as 'export'
			from soo.dbo.TBR_Statistics_SumData
			where yyyymm like #{yymmdd} + '%'
			and statisticsType = 'IMPORT'
			<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND customerTaxNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND customerTaxNum = #{taxNum}</otherwise>
            </choose>
            </if>
			<if test='ncustomsDb != "all"'>AND ncustomsDb = #{_defaultDB}</if>
			group by yyyymm
			union all
			select
			SUBSTRING(yyyymm,0,5) as 'Impo_year', SUBSTRING(yyyymm,5,2) as 'mm', 0 as 'import', SUM(amtWon) as 'export'
			from soo.dbo.TBR_Statistics_SumData
			where yyyymm like #{yymmdd} + '%'
			and statisticsType = 'EXPORT'
			<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND customerTaxNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND customerTaxNum = #{taxNum}</otherwise>
            </choose>
            </if>
			<if test='ncustomsDb != "all"'>AND ncustomsDb = #{_defaultDB1}</if>
			group by yyyymm
		) a
		group by a.Impo_year, a.mm
    </select>

    <select id="selectMainGraphImportList" resultType="map">
        /* 메인 그래프 */
        SELECT a.mm, floor(SUM(a.nowimport)/100000000) AS 'import', floor(SUM(a.previmport)/100000000) AS 'previmport'
		FROM (
			select
			SUBSTRING(yyyymm,5,2) as 'mm', SUM(amtWon) as 'nowimport', 0 as 'previmport'
			from soo.dbo.TBR_Statistics_SumData
			where yyyymm like #{nowYear} + '%'
			and statisticsType = 'IMPORT'
			<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND customerTaxNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND customerTaxNum = #{taxNum}</otherwise>
            </choose>
            </if>
			<if test='ncustomsDb != "all"'>AND ncustomsDb = #{_defaultDB}</if>
			group by yyyymm
			union all
			select
			SUBSTRING(yyyymm,5,2) as 'mm', 0 as 'nowimport', SUM(amtWon) as 'previmport'
			from soo.dbo.TBR_Statistics_SumData
			where yyyymm like #{prevYear} + '%'
			and statisticsType = 'IMPORT'
			<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND customerTaxNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND customerTaxNum = #{taxNum}</otherwise>
            </choose>
            </if>
			<if test='ncustomsDb != "all"'>AND ncustomsDb = #{_defaultDB}</if>
			group by yyyymm
		) a
		group by a.mm
    </select>

    <select id="selectMainGraphExportList" resultType="map">
        /* 메인 그래프 */
        SELECT a.mm, floor(SUM(a.nowexport)/1000000) AS 'export', floor(SUM(a.prevexport)/1000000) AS 'prevexport'
		FROM (
			select
			SUBSTRING(yyyymm,5,2) as 'mm', SUM(amtWon) as 'nowexport', 0 as 'prevexport'
			from soo.dbo.TBR_Statistics_SumData
			where yyyymm like #{nowYear} + '%'
			and statisticsType = 'EXPORT'
			<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND customerTaxNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND customerTaxNum = #{taxNum}</otherwise>
            </choose>
            </if>
			<if test='ncustomsDb != "all"'>AND ncustomsDb = #{_defaultDB1}</if>
			group by yyyymm
			union all
			select
			SUBSTRING(yyyymm,5,2) as 'mm', 0 as 'nowexport', SUM(amtWon) as 'prevexport'
			from soo.dbo.TBR_Statistics_SumData
			where yyyymm like #{prevYear} + '%'
			and statisticsType = 'EXPORT'
			<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND customerTaxNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND customerTaxNum = #{taxNum}</otherwise>
            </choose>
            </if>
			<if test='ncustomsDb != "all"'>AND ncustomsDb = #{_defaultDB}</if>
			group by yyyymm
		) a
		group by a.mm
    </select>

    <select id="selectMainGraphTotalList" resultType="map">
        /* 메인 그래프 년 총액 */
        SELECT a.Impo_year, SUM(a.impo_cif_total_won) AS 'import', SUM(a.Expo_total_won) AS 'export'
		FROM (
		select
		Impo_year, impo_cif_total_won ,'' as 'Expo_total_won'
		from ${_defaultDB}.[kcba].[Impo1]
		where Impo_napse_saup = #{taxNum}
		and Impo_year = #{yymmdd}
		and Impo_ok_date != ''
		union all
		select
		Expo_year, '' as 'impo_cif_total_won', Expo_total_won
		from ${_defaultDB1}.[kcba].[Expo1]
		where Expo_SuchulSaupNo = #{taxNum}
		and Expo_year = #{yymmdd}
		and Expo_ok_date != ''
		) a
		GROUP BY a.Impo_year
    </select>

    <select id="selectImportStatisticsList" resultType="map">
        /* 메인 수입통계 */
        SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'본사수입1' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'본사수입2' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_sel4.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'안양지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ay.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'부산지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_bs.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'천안지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ca.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'청주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_cj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'창원지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_cw.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'대전지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_dj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'구미지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_gm.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'인천해상' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ic.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'진주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_jj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'파주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_pj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'평택지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_pt.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'경기지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_sn.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'울산지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_us.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'인천공항' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_yj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'여수지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ys.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
    </select>

    <select id="selectImportStatisticsYearList" resultType="map">
        /* 메인 수입년간통계 */
        select * from soo.dbo.CPS_YearStatistics
		where gubun='Import'
		and year = #{yyyy}
	</select>

    <!-- select id="selectImportStatisticsYearList" resultType="map">
        /* 메인 수입년간통계 */
        SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'본사수입1' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'본사수입2' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_sel4.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'안양지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ay.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'부산지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_bs.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'천안지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ca.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'청주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_cj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'창원지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_cw.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'대전지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_dj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'구미지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_gm.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'인천해상' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ic.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'진주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_jj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'파주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_pj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'평택지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_pt.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'경기지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_sn.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'울산지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_us.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'인천공항' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_yj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'여수지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ys.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
    </select-->

    <select id="selectImpoExpoStatisticsList" resultType="map">
        /* 메인 수출입통계 */
        SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'본사1' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'본사1' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_sel_040.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'본사2' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_sel4.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'본사2' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_sel4.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'안양지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_ay.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'안양지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_ay.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'부산지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_bs.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'부산지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_bs.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'천안지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_ca.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'천안지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_ca.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'청주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_cj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'청주지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_cj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'창원지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_cw.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'창원지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_cw.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'대전지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_dj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'대전지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_dj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'구미지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_gm.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'구미지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_gm.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'인천해상' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_ic.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'인천해상' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_ic.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'진주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_jj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'진주지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_jj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'파주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_pj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'파주지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_pj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'평택지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_pt.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'평택지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_pt.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'경기지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_sn.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'경기지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_sn.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'울산지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_us.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'울산지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_us.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'인천공항' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_yj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'인천공항' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_yj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
		union all
		SELECT
		a.jisa, a.year, a.mm, count(*) as 'suri', SUM(a.totalWon) as 'totalWon', SUM(a.totalUsd) as 'totalUsd',
		SUM(a.gwan) as 'gwan', SUM(a.vat) AS 'vat', SUM(a.totalTax) as 'totalTax'
		FROM (
		select
		'여수지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year', substring(Impo_ok_date,5,2) as 'mm',
		impo_cif_total_won as 'totalWon', Impo_cif_total_usd as 'totalUsd',Impo_gwan_tax as 'gwan',Impo_vat_tax AS 'vat',Impo_total_tax as 'totalTax'
		from ncustoms_ys.[kcba].[Impo1]
		where substring(Impo_ok_date,0,7)=#{yyyymm}
		union all
		select
		'여수지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year', substring(Expo_ok_date,5,2) as 'mm',
		Expo_total_won as 'totalWon', Expo_total_usd as 'totalUsd',0 as 'gwan',0 as 'vat',0 as 'totalTax'
		from ncustoms_ys.[kcba].[Expo1]
		where substring(Expo_ok_date,0,7)=#{yyyymm}
		) a
		GROUP BY a.jisa, a.year, a.mm
    </select>

    <select id="selectImpoExpoStatisticsYearList" resultType="map">
        /* 메인 년간 수출입통계 */
        select * from soo.dbo.CPS_YearStatistics
		where gubun='Total'
		and year=#{yyyy}
    </select>

    <!-- select id="selectImpoExpoStatisticsYearList" resultType="map">
        /* 메인 년간 수출입통계 */
        SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'본사1' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'본사1' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_sel_040.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'본사2' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_sel4.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'본사2' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_sel4.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'안양지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ay.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'안양지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_ay.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'부산지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_bs.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'부산지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_bs.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'천안지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ca.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'천안지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_ca.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'청주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_cj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'청주지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_cj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'창원지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_cw.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'창원지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_cw.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'대전지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_dj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'대전지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_dj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'구미지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_gm.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'구미지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_gm.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'인천해상' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ic.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'인천해상' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_ic.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'진주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_jj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'진주지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_jj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'파주지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_pj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'파주지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_pj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'평택지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_pt.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'평택지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_pt.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'경기지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_sn.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'경기지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_sn.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'울산지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_us.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'울산지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_us.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'인천공항' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_yj.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'인천공항' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_yj.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
		union all
		SELECT
		a.jisa, a.year, count(*) as 'suri', SUM(a.impo_cif_total_won) AS 'totalWon', SUM(a.Impo_cif_total_usd) AS 'totalUsd',
		SUM(a.Impo_gwan_tax) AS 'gwan', SUM(a.Impo_vat_tax) AS 'vat', SUM(a.Impo_total_tax) AS 'totalTax'
		FROM (
		select
		'여수지사' as 'jisa', substring(Impo_ok_date,0,5) as 'year',
		impo_cif_total_won, Impo_cif_total_usd,Impo_gwan_tax,Impo_vat_tax,Impo_total_tax
		from ncustoms_ys.[kcba].[Impo1]
		where substring(Impo_ok_date,0,5)=#{yyyy}
		union all
		select
		'여수지사' as 'jisa', substring(Expo_ok_date,0,5) as 'year',
		Expo_total_won, Expo_total_usd, 0 as Impo_gwan_tax, 0 as Impo_vat_tax, 0 as Impo_total_tax
		from ncustoms_ys.[kcba].[Expo1]
		where substring(Expo_ok_date,0,5)=#{yyyy}
		) a
		GROUP BY a.jisa, a.year
    </select-->

    <select id="selectSeinYearGraphList" resultType="map">
        /* 메인 관리자 그래프 */
        select a.year, SUM(a.suri) as suri, SUM(a.totalWon) as totalWon from (
			select
			year, suri , totalWon
			from soo.dbo.CPS_YearStatistics
			where gubun=#{gubun}
			<if test='jisa != "Total" and jisa != ""'>AND jisa = #{jisa}</if>
		) a
		group by a.year
	</select>

    <select id="selectMailingList" resultType="map">
        /* 팀별 메일링 리스트 */
        select b.teamMail AS 'teamMail'
		from soo.dbo.CPS_SaveTeam a, soo.dbo.CPS_Team b
		where a.teamCode = b.teamCode
		and a.userId=#{userId}
    </select>

    <select id="selectGucciList" resultType="map">
        /* 구찌 BL-Invoice현황 리스트 */
        select (CASE WHEN len(tgm.ok_dt) > 7 THEN '정산'
	     WHEN len(imp.impo_banchul_date) > 7 THEN '반출'
	 			WHEN len(imp.impo_ok_date) > 7 THEN '수리'
	 			WHEN len(imp.impo_jubsu_date) > 7 THEN '접수'
	 			WHEN len(imp.impo_banip_date) > 7 THEN '반입'
	 			WHEN len(imp.impo_unsong_date) > 7 THEN '운송'
	 			WHEN len(imp.impo_iphang_date) > 7 THEN '입항'
	 			WHEN len(imp.Impo_mf_date) > 7 THEN '적하'
	 			WHEN len(imp.impo_ip_sc_date) > 7 THEN '입예'
	 			WHEN len(imp.move_dt) > 7 THEN '전환'
	      ELSE '작성' END) as statusp,
       imp.brand_nm as brand_nm,
       imp.Impo_forwarder_sangho as Impo_forwarder_sangho,
       imp.Impo_bl_no as Impo_bl_no,
       imp.Impo_gonggub_sangho as Impo_gonggub_sangho,
       imp.Impo_iphang_date as Impo_iphang_date,
       imp.Impo_banip_date as Impo_banip_date,
       imp.Impo_ok_date as Impo_ok_date,
       imp.gu_dam_dept,
       imp.gu_bu_cd as gu_bu_cd,
       imp.gu_object_cd as gu_object_cd,
       imp.gu_account_name as gu_account_name,
       imp.Impum_ivno as Impum_ivno,
       imp.impum_contactno as impum_contactno,
       imp.Impo_pojang_su as Impo_pojang_su,
       imp.Impo_total_jung as Impo_total_jung,
       imp.Impo_gyelje_input as Impo_gyelje_input,
       impum_amt,
       impum_su,
       imp.impo_ins_last,
       imp.Impo_gwan_tax as Impo_gwan_tax,
       tgm.vat1 as vat1,
       tgm.vat2 as vat2,
       tgm.vat3 as vat3,
       tgm.vat4 as vat4,
       tgm.vat5 as vat5,
       tgm.vat6 as vat6,
       tgm.vat7 as vat7,
       tgm.vat8 as vat8,
       tgm.vat9 as vat9,
       imp.Impo_mf_date as Impo_mf_date,
       imp.Impo_singo_date as Impo_singo_date,
       imp.Impo_singo_no as Impo_singo_no,
       imp.Impo_jukchl_code,
       imp.Impo_banchul_date as Impo_banchul_date,
       tgm.ok_dt as ok_dt,
       tgm.payment_flag as payment_flag,
       imp.Impo_gyelje_money as Impo_gyelje_money,
       imp.Impo_exch_yul as Impo_exch_yul,
       imp.Impo_segwan as Impo_segwan,
       imp.Impo_indo_jogun as Impo_indo_jogun,
       imp.Impo_cif_total_usd as Impo_cif_total_usd,
       imp.Impo_cif_total_won as Impo_cif_total_won,
       imp.Impo_teuk_tax as Impo_teuk_tax,
       imp.Impo_edu_tax as Impo_edu_tax,
       imp.Impo_nong_tax as Impo_nong_tax,
       imp.Impo_vat_tax as Impo_vat_tax,
       tgm.vat10 as vat10,
       tgm.vat11 as vat11,
       imp.issue_txt as issue_txt,
       imp.gu_dam_nm as gu_dam_nm,
       imp.usernm as user_nm,
       imp.Impo_ip_sc_date as Impo_ip_sc_date,
       imp.Impo_key
		from
		  (select  im1.Impo_key, Impo_gonggub_sangho, Impo_bl_no, Impo_singo_no, Impo_ok_date, Impo_pojang_su, Impo_gyelje_input,
				   Impo_gwan_tax, Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_gyelje_money,
				   Impo_exch_yul, Impo_segwan, Impo_indo_jogun, Impo_cif_total_usd, Impo_cif_total_won, Impo_teuk_tax, Impo_edu_tax, Impo_nong_tax,
				   Impo_vat_tax, Impo_forwarder_sangho, Impo_total_jung,
				   Impum_key,  Impum_ivno, impum_contactno ,brand_nm,im2.gu_dam_nm,im2.issue_txt,im2.Impo_mf_date,im2.Impo_ip_sc_date, im2.move_dt,
				   im2.Impo_jubsu_date,im2.Impo_unsong_date,im2.Impo_banchul_date, im1.impum_su, im1.impum_amt,
				   im2.gu_bu_cd, im2.gu_account_name, im2.gu_object_cd, im2.gu_dam_dept, im1.usernm, im1.Impo_jukchl_code, im1.impo_ins_last
				   from
				  (
					select Impo_key, Impo_gonggub_sangho, Impo_bl_no, Impo_singo_no, Impo_ok_date, Impo_pojang_su, Impo_gyelje_input,
						   Impo_gwan_tax, Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_gyelje_money,
						   Impo_exch_yul, Impo_segwan, Impo_indo_jogun, Impo_cif_total_usd, Impo_cif_total_won, Impo_teuk_tax, Impo_edu_tax, Impo_nong_tax,
						   Impo_vat_tax, Impo_forwarder_sangho, Impo_total_jung,
						   Impum_key,  Impum_ivno, impum_contactno, impum_su, impum_amt, usernm, Impo_jukchl_code, impo_ins_last
							from
							(
							select Impo_key, Impo_gonggub_sangho, Impo_bl_no, Impo_singo_no, Impo_ok_date, Impo_pojang_su, Impo_gyelje_input,
								   Impo_gwan_tax, Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_gyelje_money,
								   Impo_exch_yul, Impo_segwan, Impo_indo_jogun, Impo_cif_total_usd, Impo_cif_total_won, Impo_teuk_tax, Impo_edu_tax, Impo_nong_tax,
								   Impo_vat_tax, Impo_forwarder_sangho, Impo_total_jung, usernm, Impo_jukchl_code, Impo_fre_won as impo_ins_last
									from ncustoms.kcba.impo1
									where 1=1
									<if test='taxNum != null and taxNum != ""'>
							            <choose>
							                <when test='taxNum == "all"'>AND Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
							                <when test='taxNum != "all"'>AND Impo_napse_saup = #{taxNum}</when>
							            </choose>
							        </if>
									<if test='sangho != null and sangho != ""'>
								          AND UPPER(Impo_forwarder_sangho) LIKE '%' + UPPER(#{sangho}) + '%'
								    </if>
								    <if test='singoNo != null and singoNo != ""'>
							              AND UPPER(Impo_singo_no) LIKE '%' + UPPER(#{singoNo}) + '%'
							        </if>
							) imp1,
							(
							select Impum_key, Impum_ivno, max(impum_contactno) as impum_contactno, sum(impum_su) as impum_su, sum(impum_amt) as impum_amt
									from ncustoms.kcba.impo3
									group by Impum_key, Impum_ivno
							) imp2
							where imp1.Impo_key = imp2.Impum_key
					)im1
					right outer join
					(select issue_txt
					  , Impo_mf_date
					  , Impo_ip_sc_date
					  , move_dt
					  , Impo_jubsu_date
					  , Impo_unsong_date
					  , Impo_banchul_date
					  , impo_key, brand_nm, gu_dam_nm,  gu_bu_cd, gu_account_name, gu_object_cd,gu_dam_dept
					 from rms.dbo.recv_impo1
					 where gu_brand_flag in ('2','3','4')
					 <if test='ID != null and ID != ""'>
		              <choose>
		                <when test='ID == "267"'>
		                    AND UPPER(brand_nm) in (select UPPER(b_gucci_nm)
		                                              from ncustoms.kcba.Tb_gucci_brand
		                                            WHERE b_gucci_cd in ('86','31','65','35') )
		                </when>
		              </choose>
		             </if>
					<if test='brandNm != null and brandNm != ""'>
			          AND UPPER(brand_nm) LIKE '%' + UPPER(#{brandNm})+ '%'
			        </if>
					<if test='damNm != null and damNm != ""'>
			          AND UPPER(gu_dam_nm) LIKE '%' + UPPER(#{damNm})+ '%'
			        </if>
		            <if test='buCd != null and buCd != ""'>
			           AND UPPER(gu_bu_cd) LIKE '%' + UPPER(#{buCd}) + '%'
			        </if>
		            <if test='objectCd != null and objectCd != ""'>
			           AND UPPER(gu_object_cd) LIKE '%' + UPPER(#{objectCd}) + '%'
			        </if>
					)im2
					on im1.impo_key = im2.impo_key
			)imp
			left outer join
			(
			select Impo_key, brand_nm, tax_07+tax_07_vat as vat1,
			       tax_08+tax_08_vat as vat2, tax_01+tax_01_vat as vat3, tax_02+tax_02_vat as vat4, tax_03+tax_03_vat as vat5, tax_06+tax_06_vat as vat6,
			       tax_09+tax_09_vat as vat7, tax_05+tax_05_vat as vat8, tax_04+ tax_04_vat as vat9, remark_1+remark_2 as vat10,
			       gu_remark_1+gu_remark_2 as vat11,
                   (CASE WHEN payment_flag ='1' THEN 'PAYMENT' ELSE 'F.O.C' END) AS payment_flag,
                   ok_dt,
                   recv_remark
			from ncustoms.kcba.tb_gucci_mst
			where 1=1
			and gu_brand_flag in ('2','3','4')
			) tgm
			on tgm.Impo_key = imp.Impo_key
	        WHERE 1=1
	        <if test='blno != null and blno != ""'>
	          	  AND UPPER(imp.Impo_bl_no) LIKE '%' + UPPER(#{blno}) + '%'
		    </if>
			<if test='shipper != null and shipper != ""'>
		          AND UPPER(imp.Impo_gonggub_sangho) LIKE '%' + UPPER(#{shipper}) + '%'
		    </if>
	        <if test='invoiceno != null and invoiceno != ""'>
		          AND UPPER(imp.Impum_ivno) LIKE '%' + UPPER(#{invoiceno}) + '%'
		    </if>
	        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "impo_ok_date"'>AND imp.impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "impo_singo_date"'>AND imp.impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "impo_iphang_date"'>AND imp.impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "impo_banip_date"'>AND imp.impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "impum_contactno"'>AND imp.impum_contactno BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        order by imp.Impo_singo_date, imp.Impo_singo_no
    </select>

    <select id="selectGucciDetailList" resultType="map">
        /* 구찌 BL-Invoice현황 Detail 리스트 */
        select
			 tgm.brand_nm as brand_nm,
			 imp.impo_segwan as impo_segwan,
             imp.impo_bl_no as impo_bl_no,
             imp.segwan_name as segwan_name,
             imp.impo_singo_date as  impo_singo_date,
             imp.impo_ok_date as  impo_ok_date,
             imp.impo_jingsu_type as impo_jingsu_type,
             imp.jingsu_content as jingsu_content,
             imp.impo_iphang_date  as impo_iphang_date,
             imp.impo_banip_date  as impo_banip_date,
             imp.impo_pojang_su as impo_pojang_su,
             imp.impo_total_jung as impo_total_jung,
             imp.impo_singo_no as impo_singo_no,
             imp.impo_gonggub_sangho as impo_gonggub_sangho,
             imp.impo_indo_jogun as impo_indo_jogun,
             imp.impo_jung_chasu as impo_jung_chasu,
             imp.impo_gyelje_input as impo_gyelje_input,
             imp.impo_cif_total_won as impo_cif_total_won,
             imp.impo_cif_total_usd as impo_cif_total_usd,
             imp.impo_fre_won as impo_fre_won,
             imp.impo_ins_input as impo_ins_input,
             imp.impo_plus as impo_plus,
             imp.impo_minus as impo_minus,
             imp.impo_gyelje_money as impo_gyelje_money,
             imp.impo_exch_yul as impo_exch_yul,
             imp.impo_forwarder_sangho as impo_forwarder_sangho,
             imp.impo_gwan_tax as impo_gwan_tax,
             imp.impo_teuk_tax as impo_teuk_tax,
             imp.impo_oil_tax as impo_oil_tax,
             imp.impo_ju_tax as impo_ju_tax,
             imp.impo_edu_tax as impo_edu_tax,
             imp.impo_nong_tax as impo_nong_tax,
             imp.impo_vat_tax as impo_vat_tax,
             imp.impo_gasan_tax as impo_gasan_tax,
             imp.impo_misingo_tax as impo_misingo_tax,
             imp.impo_total_tax as impo_total_tax,
             tgm.brand_nm as brand_nm,
             tgm.payment_flag as payment_flag,
			 tgm.air_cd as air_cd,
			 tgm.air_nm as air_nm,
			 tgm.tax_07 as tax_07,
			 tgm.tax_07_vat as tax_07_vat,
			 tgm.air_dt   as air_dt,
			 tgm.tax_08 as tax_08,
			 tgm.tax_08_vat as tax_08_vat,
			 tgm.tax_08_dt  as  tax_08_dt,
			 tgm.bose_cd as bose_cd,
			 tgm.bose_nm as bose_nm,
			 tgm.tax_01 as tax_01,
			 tgm.tax_01_vat as tax_01_vat,
			 tgm.bose_dt   as bose_dt,
			 tgm.tax_02 as tax_02,
			 tgm.tax_02_vat as tax_02_vat,
			 tgm.tax_02_dt   as tax_02_dt,
			 tgm.tax_03 as tax_03,
			 tgm.tax_03_vat as tax_03_vat,
			 tgm.tax_04 as tax_04,
			 tgm.road_cd as road_cd,
			 tgm.road_nm as road_nm,
			 tgm.tax_06 as tax_06,
			 tgm.tax_06_vat as tax_06_vat,
			 tgm.road_dt  as road_dt,
			 tgm.kcba_cd as kcba_cd,
			 tgm.kcba_nm as kcba_nm,
			 tgm.tax_09 as tax_09,
			 tgm.tax_09_vat as tax_09_vat,
			 tgm.kcba_dt  as kcba_dt,
			 tgm.tax_05 as tax_05,
			 tgm.payment_flag_v as payment_flag_v
      from
      (
      select impo_key ,Impo_segwan, Impo_bl_no,
             (select segwan_name from ncustoms.kcba.bsegwan where segwan_code = a.Impo_segwan) segwan_name,
             impo_singo_date,impo_ok_date,Impo_jingsu_type,
             (select CD_DESC from soo_MST.dbo.TBR_SYS_CODE where MCD = 'COLT_FORM_CD' and CD = a.Impo_jingsu_type) Jingsu_content,
             Impo_iphang_date,Impo_banip_date,Impo_pojang_su,Impo_total_jung,Impo_singo_no,Impo_gonggub_sangho,
             Impo_indo_jogun,
             (CASE WHEN Impo_jung_chasu ='0' THEN '정상신고'
                   WHEN Impo_jung_chasu ='1' THEN '1차수정신고'
                   WHEN Impo_jung_chasu ='2' THEN '2차수정신고'
                   ELSE '' END) AS Impo_jung_chasu,
             Impo_gyelje_input,Impo_cif_total_won,Impo_cif_total_usd,
             Impo_fre_won,Impo_ins_input,Impo_plus,Impo_minus,Impo_gyelje_money,Impo_exch_yul,Impo_forwarder_sangho,Impo_gwan_tax,
             Impo_teuk_tax,Impo_oil_tax,Impo_ju_tax,Impo_edu_tax,Impo_nong_tax,Impo_vat_tax,Impo_gasan_tax,Impo_misingo_tax,Impo_total_tax
			from ncustoms.kcba.impo1 a
			where Impo_napse_saup in ('1208179834','2118887468','2118711506','2118883220','2118887473')
			  and  Impo_singo_no = #{singoNo}
	   ) imp   left outer join
       (
			select impo_key, brand_nm, (CASE WHEN payment_flag ='1' THEN 'PAYMENT' ELSE 'F.O.C' END) AS payment_flag_v, payment_flag,
			       air_cd, air_nm, tax_07, tax_07_vat, air_dt,
			       tax_08,	tax_08_vat,	tax_08_dt,	bose_cd,	bose_nm,	tax_01,	tax_01_vat,	bose_dt,
			       tax_02,	tax_02_vat,	tax_02_dt,	tax_03,	tax_03_vat, tax_04,	road_cd,	road_nm,	tax_06,	tax_06_vat,
			       road_dt,	kcba_cd,	kcba_nm,	tax_09,	tax_09_vat,	kcba_dt,	tax_05
			from ncustoms.kcba.tb_gucci_mst
			where 1=1
			and gu_brand_flag in ('2','3','4')
			and impo_key in(select impo_key
                        from ncustoms.kcba.impo1
                       where Impo_singo_no = #{singoNo})
			) tgm
			on tgm.Impo_key = imp.Impo_key
    </select>

    <update id="updateImportDeliveryCostList">
		/* Delivery Cost 수정 */
		UPDATE	soo.dbo.TBR_Delivery_Cost
		set deliveryCostCustomerKey = #{deliveryCostCustomerKey},
			deliveryCostCustomerDb = #{deliveryCostCustomerDb},
			deliveryCostCustomerCode = #{deliveryCostCustomerCode},
			deliveryCostCustomerName = #{deliveryCostCustomerName},
			deliveryCostCustomerTaxNum = #{deliveryCostCustomerTaxNum},
			deliveryCostBlNum = #{deliveryCostBlNum},
			deliveryCostSingoNum = #{deliveryCostSingoNum},
			deliveryCostCompleteDay = #{deliveryCostCompleteDay},
			deliveryCostWarehouse = #{deliveryCostWarehouse},
			deliveryCostCtQty = #{deliveryCostCtQty1},
			deliveryCostCtUnit = #{deliveryCostCtUnit},
			deliveryCostWeight = #{deliveryCostWeight1},
			deliveryCostTonnage = #{deliveryCostTonnage},
			deliveryCostCargoType = #{deliveryCostCargoType},
			deliveryCostStartName = #{deliveryCostStartName},
			deliveryCostEndName = #{deliveryCostEndName},
			deliveryCostDamageYn = #{deliveryCostDamageYn},
			deliveryCostDamageNote = #{deliveryCostDamageNote},
			deliveryCostSpecificNote = #{deliveryCostSpecificNote},
			deliveryCostShippingType = #{deliveryCostShippingType},
			deliveryCostShippingCharge = #{deliveryCostShippingCharge1},
			deliveryCostWarehouseType = #{deliveryCostWarehouseType},
			deliveryCostWarehouseChange = #{deliveryCostWarehouseChange1},
			deliveryCostInsuranceCharge = #{deliveryCostInsuranceCharge1},
			deliveryCostPayforCharge = #{deliveryCostPayforCharge1},
			deliveryCostPayforName = #{deliveryCostPayforName},
			deliveryCostConfirmCharge = #{deliveryCostConfirmCharge1},
			deliveryCostConfirmUserKey = #{deliveryCostConfirmUserKey1},
			deliveryCostConfirmUserId = #{deliveryCostConfirmUserId},
			deliveryCostConfirmUserName = #{deliveryCostConfirmUserName},
			deliveryCostConfirmDtm = #{deliveryCostConfirmDtm},
			deliveryCostStatus = #{deliveryCostStatus},
			deliveryCostNote = #{deliveryCostNote},
			useYn = #{useYn},
			addUserKey = #{addUserKey},
			addUserId = #{addUserId},
			addUserNm = #{addUserNm},
			addDtm = #{addDtm},
			editUserKey = #{editUserKey},
			editUserId = #{editUserId},
			editUserNm = #{editUserNm},
			editDtm = #{editDtm}
		WHERE deliveryCostKey = #{deliveryCostKey}
	</update>

    <select id="selectDelayCheckList" resultType="map">
        /* Risk관리 - 신고지연 */
        select
			a.ImNapSangho as 'Impo_napse_sangho',
			a.ImBlNo as 'Impo_bl_no',
			a.ImBlGbn as 'Impo_bl_gubun',
			a.ImMrnNo as 'Impo_mrn_no',
			a.ImSingoNo as 'Impo_singo_no',
			a.ImIphangDt as 'Impo_iphang_date',
			a.ImBanipDtm as 'Impo_banip_date',
			a.AddDtm as 'AddDtTime',
			Convert(Char(10), dateadd(Day,b.AbAddDay,LEFT(a.ImIphangDt,8)),120) as singoLastDay,
			CASE WHEN Left(a.ImBanchulDtm,8) = '' THEN cps.dbo.fn_LAST_DAY(CONVERT(char(10),(CONVERT(smalldatetime,left(a.ImBanipDtm,8))+b.AbAddDay),112),'')
			ELSE cps.dbo.fn_LAST_DAY(CONVERT(char(10),(CONVERT(smalldatetime,LEFT(a.ImJubsuDtm,8))+b.AbAddDay),112),'') END as dayCheck,
			a.AddUserNm as 'UserNm',
			a.ImSegwan as 'Impo_segwan',
			a.ImJangchiNm as 'Impo_jangch_name',
			b.AbAddDay as 'WHDECLADAY',
			a.ImMblNo as 'Impo_mbl_no'
		from CPS.[dbo].[IMAC100] a, CPS.[dbo].[BSAB100] b
		where a.ImJangchiCode = b.AbCd
		and b.AbAddDay <![CDATA[ > ]]> 0
		and b.AbAddGbn = 'Y'
		and a.UseYn='Y'
		and b.UseYn='Y'
		and a.ImSuipCode != ''
		and a.ImMrnNo != ''
		and a.ImRecvResult != '수리'
		and (a.ImJubsuDtm is null or a.ImJubsuDtm = '')
		and (a.ImOkDtm is null  or a.ImOkDtm = '')
		and (a.ImSendResult != '완료' AND a.ImSendResult != '준비')
		and Len(a.ImIphangDt) <![CDATA[ > ]]> 7
		AND (CASE WHEN Left(a.ImBanchulDtm,8) != '' THEN cps.dbo.fn_LAST_DAY(CONVERT(char(10),(CONVERT(smalldatetime,left(a.ImBanipDtm,8))+b.AbAddDay),112),'')
             ELSE cps.dbo.fn_LAST_DAY(CONVERT(char(10),(CONVERT(smalldatetime,LEFT(a.ImJubsuDtm,8))+b.AbAddDay),112),'') END) <![CDATA[ < ]]> 8
		and a.ImJubsuDtm = ''
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.ImNapSaup IN (select Saup from CPS_WEB.[dbo].[ENWM120] where BSAAUMngNo = #{USERMNG} and UseYn = 'Y' and Gbn = 'Saup')</when>
                <otherwise>AND a.ImNapSaup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='IMCODE != null and IMCODE != ""'>AND a.ImNapCode in ( ${IMCODE} ) </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.ImNapSangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='_DateType != null and _DateType != "" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "ALL"'>AND a.AddDtm BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "AddDt"'>AND a.AddDtm BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_day"'>AND a.ImBanipDtm BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        group by a.ImNapSangho,
			a.ImBlNo,
			a.ImBlGbn,
			a.ImMrnNo,
			a.ImSingoNo,
			a.ImIphangDt,
			a.ImBanipDtm,
			a.AddDtm,
			a.AddUserNm,
			a.ImSegwan,
			a.ImJangchiNm,
			b.AbAddDay,
			a.ImMblNo,
			a.ImBanchulDtm,
			left(a.ImJubsuDtm,8)
        order by dayCheck
    </select>
    
    <select id="selectDelayCheckList_back" resultType="map">
        /* Risk관리 - 신고지연 엔컴*/
        select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no
		from ${_defaultDB}.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		where a.Impo_jangch_buho = b.whcode
		and b.WHDECLADAY > 0
		and b.WHDECLADAYYN = 'Y'
		and a.Impo_receive_result != '수리'
		and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
		and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
		and (a.Impo_send_result != '완료' AND a.Impo_send_result != '준비')
		and Len(a.Impo_banip_date) > 7
		and DATEDIFF(dd,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
		and a.Impo_jubsu_date = ''
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='_DateType != null and _DateType != "" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "ALL"'>AND a.AddDtTime BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "AddDt"'>AND a.AddDtTime BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        order by dayCheck
    </select>

    <select id="selectDelayCheckAllList" resultType="map">
        /* Risk관리 - 신고지연 전지사 */
        select * from (
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_bs.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_ca.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_cj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_cw.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_dj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_gm.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_ic.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_jj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_pj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_pt.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_sel4.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_sn.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_us.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_yj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
			union all
			select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_iphang_date,
			a.Impo_banip_date,
			a.AddDtTime,
			Convert(Char(10), dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8)),120) as singoLastDay,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) as dayCheck,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHDECLADAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
			from ncustoms_ys.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
			where a.Impo_jangch_buho = b.whcode
			and b.WHDECLADAY > 0
			and b.WHDECLADAYYN = 'Y'
			and (a.Impo_send_result != '완료' and a.Impo_send_result != '준비')
			and a.Impo_receive_result != '수리'
			and (a.Impo_jubsu_date is null or a.Impo_jubsu_date = '')
			and (a.Impo_ok_date is null  or a.Impo_ok_date = '')
			and Len(a.Impo_banip_date) > 7
			and DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHDECLADAY,LEFT(a.Impo_banip_date,8))) <![CDATA[ < ]]> 8
			and a.Impo_jubsu_date = ''
		) c
		where 1 = 1
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND c.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND c.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND c.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='_DateType != null and _DateType != "" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "ALL"'>AND c.AddDtTime BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "AddDt"'>AND c.AddDtTime BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_day"'>AND c.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        order by c.dayCheck
    </select>

    <select id="selectBanchulCheckList" resultType="map">
        /* Risk관리 - 반출불이행 */
        select
			a.ImNapSangho as 'Impo_napse_sangho',
			a.ImBlNo as 'Impo_bl_no',
			a.ImBlGbn as 'Impo_bl_gubun',
			a.ImMrnNo as 'Impo_mrn_no',
			a.ImSingoNo as 'Impo_singo_no',
			a.ImIphangDt as 'Impo_banip_date',
			left(a.ImJubsuDtm,8) as 'Impo_singo_date',
			a.ImJubsuDtm as 'Impo_jubsu_date',
			a.ImOkDtm as 'Impo_ok_date',
			Convert(Char(10), dateadd(Day,b.AbOutDay,LEFT(a.ImOkDtm,8)),120) as singoLastDay,
			a.ImBanchulDlDtm as 'Impo_upja_code',
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.AbOutDay,LEFT(a.ImOkDtm,8))) as dayCheck,
			a.AddDtm as 'AddDtTime',
			a.AddUserNm as 'UserNm',
			a.ImSegwan as 'Impo_segwan',
			a.ImJangchiNm as 'Impo_jangch_name',
			b.AbOutDay as 'WHOutDAY',
			a.ImMblNo as 'Impo_mbl_no'
		from CPS.[dbo].[IMAC100] a, CPS.[dbo].[BSAB100] b
		WHERE left(a.ImJubsuDtm,8) <![CDATA[ > ]]> '20170101'
		and a.ImJangchiCode = b.AbCd
		and a.UseYn='Y'
		and b.UseYn='Y'
		and Len(a.ImMrnNo) <![CDATA[ > ]]> 11
		and (left(a.ImOkDtm,8) !='99999999' and a.ImOkDtm != '')
		and b.AbOutDay <![CDATA[ > ]]> 0
		and b.AbPenaltyGbn = 'Y'
		AND a.ImRecvResult != '취하'
        AND a.ImSendResult != '완료'
		AND a.ImSuipCode != ''
		and (a.ImBanculYn != 'Y' or a.ImBanculYn is null)
		AND (CASE WHEN Left(a.ImBanchulDtm,8) != '' THEN cps.dbo.fn_LAST_DAY(CONVERT(char(10),(CONVERT(smalldatetime,left(a.ImBanchulDtm,8))),112),'')
            ELSE cps.dbo.fn_LAST_DAY(CONVERT(char(10),(CONVERT(smalldatetime,LEFT(a.ImOkDtm,8))+b.AbOutDay),112),'') END) <![CDATA[ <= ]]> 15
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.ImNapSaup IN (select Saup from CPS_WEB.[dbo].[ENWM120] where BSAAUMngNo = #{USERMNG} and UseYn = 'Y' and Gbn = 'Saup')</when>
                <otherwise>AND a.ImNapSaup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='IMCODE != null and IMCODE != ""'>AND a.ImNapCode in ( ${IMCODE} ) </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.ImNapSangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='_DateType != null and _DateType != "" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "ALL"'>AND left(a.ImJubsuDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_day"'>AND left(a.ImJubsuDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_jubsu_day"'>AND left(a.ImJubsuDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_day"'>AND left(a.ImOkDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        GROUP BY
	       a.ImNapSangho
	     , a.ImBlNo
	     , a.ImBlGbn
		 , a.ImMrnNo
	     , a.ImSingoNo
		 , a.ImIphangDt
		 , a.ImJubsuDtm
		 , a.ImOkDtm
	     , a.ImBanchulDlDtm
		 , b.AbOutDay
	     , a.ImSegwan
	     , a.ImJangchiNm
		 , a.AddDtm
		 , a.AddUserNm
		 , a.ImMblNo
        order by dayCheck
    </select>
    
    <select id="selectBanchulCheckList_back" resultType="map">
        /* Risk관리 - 반출불이행  엔컴*/
        select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no
		from ${_defaultDB}.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
     		ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='_DateType != null and _DateType != "" and (strFromDate1 != null and strFromDate1 != "") and (strToDate1 != null and strToDate1 != "")'>
            <choose>
                <when test='_DateType == "ALL"'>AND a.Impo_singo_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
                <when test='_DateType == "Impo_singo_day"'>AND a.Impo_singo_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
                <when test='_DateType == "Impo_jubsu_day"'>AND a.Impo_jubsu_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
                <when test='_DateType == "Impo_ok_day"'>AND a.Impo_ok_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
            </choose>
        </if>
        order by dayCheck
    </select>

    <select id="selectBanchulCheckAllList" resultType="map">
        /* Risk관리 - 반출불이행 전지사 */
        select * from (
        select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_bs.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_ca.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_cj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_cw.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_dj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_gm.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_ic.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_jj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_pj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_pt.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_sel4.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_sn.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_us.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_yj.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		union all
		select
			a.Impo_napse_sangho,
			a.Impo_bl_no,
			a.Impo_bl_gubun,
			a.Impo_mrn_no,
			a.Impo_singo_no,
			a.Impo_banip_date,
			a.Impo_singo_date,
			a.Impo_jubsu_date,
			a.Impo_ok_date,
			Convert(Char(10), dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8)),120) as singoLastDay,
			a.Impo_upja_code,
			DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) as dayCheck,
			a.AddDtTime,
			a.UserNm,
			a.Impo_segwan,
			a.Impo_jangch_name,
			b.WHOutDAY,
			a.Impo_mbl_no,
			a.Impo_napse_saup
		from ncustoms_ys.kcba.impo1 a, soo_mst.dbo.TBR_CD_BAS_WH b
		WHERE a.Impo_singo_date > '20170101'
		and a.Impo_jangch_buho = b.whcode
		and Len(a.Impo_mrn_no) > 11
		and (a.Impo_ok_date !='99999999' and a.Impo_ok_date != '')
		and b.WHOUTDAY > 0
		and b.WHOUTDAYYN = 'Y'
		and a.Impo_receive_result != '취하'
		and (a.Impo_banchul != 'Y' or a.Impo_banchul is null)
		and (CASE WHEN Len(a.Impo_upja_code) = 8 THEN DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_upja_code,8)))
			ELSE DATEDIFF(DD,GETDATE()-1,dateadd(Day,b.WHOutDAY,LEFT(a.Impo_ok_date,8))) END) <![CDATA[ < ]]> 11
		) c
		where 1 = 1
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND c.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND c.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND c.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='_DateType != null and _DateType != "" and (strFromDate1 != null and strFromDate1 != "") and (strToDate1 != null and strToDate1 != "")'>
            <choose>
                <when test='_DateType == "ALL"'>AND c.Impo_singo_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
                <when test='_DateType == "Impo_singo_day"'>AND c.Impo_singo_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
                <when test='_DateType == "Impo_jubsu_day"'>AND c.Impo_jubsu_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
                <when test='_DateType == "Impo_ok_day"'>AND c.Impo_ok_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
            </choose>
        </if>
        order by dayCheck
    </select>

    <select id="selectReExpoCheckList" resultType="map">
        /* Risk관리 - 재수출기한 */
        select
			Impo_napse_sangho,
			Impo_singo_no,
			Imlan_jechl_lan,
			Impo_ok_date,
			CASE WHEN Len(Gamln_Expo_YJ_Date_last) = 8 THEN DATEDIFF(DD,GETDATE(),Gamln_Expo_YJ_Date_last)
			ELSE DATEDIFF(DD,GETDATE()-1,Gamln_Expo_YJ_Date) END as dayCheck,
			Gamln_Expo_YJ_Date,
			impo_yj_Date,
			Gamln_Expo_YJ_Date_last,
			yj_chsu,
			Imlan_su_first,
			Imlan_su_jan,
			Impo_bl_no,
			Impo_bl_gubun,
			yj_damdang_nm,
			Impo_segwan,
			Impo_gwa,
			Imlan_hs,
			Imlan_gurae_pum,
			Imlan_gukyk_cnt
		from rms.dbo.re_impo1
		where step_flag = ''
		and (CASE WHEN Len(Gamln_Expo_YJ_Date_last) = 8 THEN DATEDIFF(DD,GETDATE()-1,Gamln_Expo_YJ_Date_last)
		     ELSE DATEDIFF(DD,GETDATE()-1,Gamln_Expo_YJ_Date) END) <![CDATA[ < ]]> 730
		<if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='_DateType != null and _DateType != "" and (strFromDate3 != null and strFromDate3 != "") and (strToDate3 != null and strToDate3 != "")'>
            <choose>
                <when test='_DateType == "ALL"'>AND Impo_ok_date BETWEEN #{strFromDate3} AND #{strToDate3}</when>
                <when test='_DateType == "Impo_ok_day"'>AND Impo_ok_date BETWEEN #{strFromDate3} AND #{strToDate3}</when>
                <when test='_DateType == "Gamln_Expo_YJ_Date"'>AND Gamln_Expo_YJ_Date BETWEEN #{strFromDate3} AND #{strToDate3}</when>
            </choose>
        </if>
        order by dayCheck
    </select>

    <select id="selectImportKpiList" resultType="map">
        /* 수입KPI현황 */
        SELECT
		b.ImKey as 'Impo_key', b.ImNapSangho as 'Impo_napse_sangho', b.ImBlNo as 'Impo_bl_no', b.ImSingoNo as 'Impo_singo_no',
		b.ImMblNo as 'Impo_mbl_no', b.ImIphangDt as 'Impo_iphang_date', b.ImBanipDtm as 'Impo_banip_date', left(b.ImJubsuDtm,8) as 'Impo_singo_date',
		b.ImOkDtm as 'Impo_Ok_date', b.ImJubsuDtm as 'Impo_jubsu_date',	b.ImGongSangho as 'Impo_gonggub_sangho',
		b.ImJangchiNm as 'Impo_jangch_name', b.ImForwarderSangho as 'Impo_Forwarder_sangho',
		CASE WHEN ISNULL(b.ImMrnNo,'')='' or ISNULL(b.ImMrnNo,'')='NO'  THEN b.ImOkDtm ELSE b.ImBanchulDtm END AS 'Impo_upja_sangho1',
        CASE WHEN ISNULL(b.ImOkDtm,'')='' then 'StandBy'
             WHEN DATEDIFF(DD,CONVERT(DATE,LEFT(b.ImOkDtm,8),120),CONVERT(DATE,left(b.ImJubsuDtm,8),120)) <![CDATA[ < ]]> 3 then 'Success'
             ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT a.ImLanGuraeNm FROM CPS.[dbo].[IMAC120] a WITH (NOLOCK) WHERE a.ImKey = b.ImKey AND a.ImLan = '001' and a.UseYn='Y'), '') AS 'imlanGuraePum'
		FROM CPS.[dbo].[IMAC100] b WITH (NOLOCK)
        WHERE ISNULL(b.ImJubsuDtm, '') != ''
        and left(b.ImOkDtm,8) != '99999999'
        and b.UseYn = 'Y'
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND b.ImNapSaup IN (select Saup from CPS_WEB.[dbo].[ENWM120] where BSAAUMngNo = #{USERMNG} and UseYn = 'Y' and Gbn = 'Saup')</when>
                <otherwise>AND b.ImNapSaup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='IMCODE != null and IMCODE != ""'>AND b.ImNapCode in ( ${IMCODE} ) </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND b.ImNapSangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND b.ImBlNo LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND b.ImSingoNo LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_jubsu_date_Day"'>AND left(b.ImJubsuDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND left(b.ImJubsuDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND left(b.ImOkDtm,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND b.ImBanchulDtm BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959'</when>
            </choose>
        </if>
        <if test='impoJukchlName != null and impoJukchlName != ""'>AND b.ImJukchulNm LIKE '%' + #{impoJukchlName} + '%'</if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND b.ImGongSangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='impoForwarder != null and impoForwarder != ""'>AND b.ImForwarderSangho LIKE '%' + #{impoForwarder} + '%'</if>
    </select>
    
    <select id="selectImportKpiList_back" resultType="map">
        /* 수입KPI현황  엔컴*/
        SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
        CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
             WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
             ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ${_defaultDB}.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ${_defaultDB}.[kcba].[Impo1] WITH (NOLOCK)
        WHERE ISNULL(Impo_jubsu_date, '') != ''
        and Impo_Ok_date != '99999999'
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_jubsu_date_Day"'>AND Impo_jubsu_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND Impo_upja_sangho BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959'</when>
            </choose>
        </if>
        <if test='impoJukchlName != null and impoJukchlName != ""'>AND Impo_jangch_name LIKE '%' + #{impoJukchlName} + '%'</if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='impoForwarder != null and impoForwarder != ""'>AND Impo_Forwarder_sangho LIKE '%' + #{impoForwarder} + '%'</if>
    </select>

    <select id="selectImportKpiAllList" resultType="map">
        /* 수입KPI 전지사현황 */
        SELECT * from
        (SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ay.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_ay.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_bs.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_bs.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ca.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_ca.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_cj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_cj.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_cw.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_cw.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_dj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_dj.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_gm.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_gm.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ic.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_ic.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_jj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_jj.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_pj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_pj.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_pt.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_pt.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_sel4.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_sel4.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_sn.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_sn.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_us.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_us.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_yj.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_yj.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
		union all
		SELECT
		Impo_key, Impo_napse_sangho, Impo_bl_no, Impo_singo_no, Impo_mbl_no, Impo_napse_saup, Impo_upja_sangho,
		Impo_iphang_date, Impo_banip_date, Impo_singo_date, Impo_Ok_date, Impo_jubsu_date,
		Impo_gonggub_sangho, Impo_jangch_name, Impo_Forwarder_sangho,
		CASE WHEN ISNULL(Impo_mrn_no,'')='' or ISNULL(Impo_mrn_no,'')='NO'  THEN Impo_Ok_date ELSE Impo_upja_sangho END AS 'Impo_upja_sangho1',
		CASE WHEN ISNULL(Impo_Ok_date,'')='' then 'StandBy'
		     WHEN DATEDIFF(DD,CONVERT(DATE,Impo_Ok_date,120),CONVERT(DATE,Impo_singo_date,120)) <![CDATA[ < ]]> 3 then 'Success'
		     ELSE 'StandBy' END AS 'KPI',
		ISNULL((SELECT Imlan_gurae_pum FROM ncustoms_ys.[kcba].[Impo2] WITH (NOLOCK) WHERE Impo_key = Imlan_key AND Imlan_jechl_lan = '001'), '') AS 'imlanGuraePum'
		FROM ncustoms_ys.[kcba].[Impo1] WITH (NOLOCK)
		WHERE ISNULL(Impo_jubsu_date, '') != ''
		and Impo_Ok_date != '99999999'
        ) a
        where 1=1
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_jubsu_date_Day"'>AND a.Impo_jubsu_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banchul_date_Day"'>AND a.Impo_upja_sangho BETWEEN #{strFromDate} + '000000' AND #{strToDate} + '235959'</when>
            </choose>
        </if>
        <if test='impoJukchlName != null and impoJukchlName != ""'>AND a.Impo_jangch_name LIKE '%' + #{impoJukchlName} + '%'</if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='impoForwarder != null and impoForwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{impoForwarder} + '%'</if>
    </select>

    <select id="selectImportSummary" resultType="map">
        /* Summary */
        select
		SUBSTRING(yyyymm,5,2) as 'mm', SUM(singoCnt) as 'singoCnt',
		SUM(amtWon) as 'amtWon', SUM(amtUsd) as 'amtUsd',
		SUM(gwanTax) as 'gwanTax', SUM(vatTax) as 'vatTax', SUM(totalTax) as 'totalTax', SUM(etcTax) as 'etcTax',
		nation, company
		from soo.dbo.TBR_Statistics_SumData
		where yyyymm like #{yyyy} + '%'
		and statisticsType = #{statisticsType}
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND customerTaxNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND customerTaxNum = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='ncustomsDb != "all"'>AND ncustomsDb = #{ncustomsDb}</if>
        group by yyyymm, nation, company
		order by yyyymm
    </select>

    <select id="selectFieldList" resultType="map">
        /* 수입통관현황 (현장직원) */
        SELECT
		defaultDB, imexKey, singoNo
		FROM soo.dbo.CPS_Field_Master WITH (NOLOCK)
        WHERE useYn = 'Y'
        AND status in ('의뢰','접수')
        <if test='gubun != null and gubun != ""'>AND gubun = #{gubun}</if>
    </select>

    <select id="selectImportFieldAllStatusList" resultType="map">
        /* 전체수입통관현황 (현장직원) */
        select * from
		(
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '본사' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '부산' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_bs.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '천안' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_ca.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '청주' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_cj.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '창원' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_cw.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '대전' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_dj.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '구미' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_gm.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '인천해상' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_ic.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '진주' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_jj.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '파주' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_pj.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '평택' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_pt.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '본사' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_sel4.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '경기' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_sn.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '울산' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_us.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '인천공항' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_yj.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		union all
		SELECT
		a.Impo_key, a.Impo_receive_result, a.Impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_ok_date,
		a.Impo_singo_date, a.Impo_jubsu_date, a.impo_damdang_no, a.impo_damdang_name, a.impo_segwan, '여수' as 'jisa', a.Impo_send_result,
		CASE WHEN a.impo_segwan != '' and a.impo_gwa !='' then a.impo_segwan + '-' +a.impo_gwa
		     ELSE a.impo_segwan end AS 'segwan',
		a.Impo_file_no1, a.Impo_file_no2, a.Impo_jangch_name, a.impo_jangch_jangso, a.impo_jangch_buho, a.UserNM, a.impo_singo_gubun, b.userDepart
		FROM ncustoms_ys.[kcba].[Impo1] a , soo.dbo.CPS_UserInfo b
		where a.UserID = b.userId
		) c
        WHERE 1 = 1
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND c.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND c.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND c.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND c.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND (c.Impo_receive_result = '제출' or c.impo_cs = 'Y')</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_singo_date_Day"'>AND c.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND c.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "인천공항"'>AND c.impo_segwan in (040,240)</when>
                <when test='impoGroupSegwan == "공항우편세관"'>AND c.impo_segwan in (013)</when>
                <when test='impoGroupSegwan == "인천항"'>AND c.impo_segwan in (020)</when>
                <when test='impoGroupSegwan == "부산항"'>AND c.impo_segwan in (030,033,037,039)</when>
                <when test='impoGroupSegwan == "김해공항"'>AND c.impo_segwan in (140)</when>
                <when test='impoGroupSegwan == "김포"'>AND c.impo_segwan in (041)</when>
                <when test='impoGroupSegwan == "평택"'>AND c.impo_segwan in (016)</when>
                <when test='impoGroupSegwan == "경기"'>AND c.impo_segwan in (012,014,131)</when>
            </choose>
        </if>
    </select>

    <select id="selectImportJungFieldAllStatusList" resultType="map">
        /* 전체수입통관정정현황 (현장직원) */
        select * from
		(
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '본사' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms.kcba.Imjung1 a WITH (NOLOCK), ncustoms.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '부산' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_bs.kcba.Imjung1 a WITH (NOLOCK), ncustoms_bs.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '천안' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_ca.kcba.Imjung1 a WITH (NOLOCK), ncustoms_ca.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '청주' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_cj.kcba.Imjung1 a WITH (NOLOCK), ncustoms_cj.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '창원' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_cw.kcba.Imjung1 a WITH (NOLOCK), ncustoms_cw.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '대전' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_dj.kcba.Imjung1 a WITH (NOLOCK), ncustoms_dj.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '구미' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_gm.kcba.Imjung1 a WITH (NOLOCK), ncustoms_gm.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '인천해상' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_ic.kcba.Imjung1 a WITH (NOLOCK), ncustoms_ic.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '진주' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_jj.kcba.Imjung1 a WITH (NOLOCK), ncustoms_jj.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '파주' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_pj.kcba.Imjung1 a WITH (NOLOCK), ncustoms_pj.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '평택' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_pt.kcba.Imjung1 a WITH (NOLOCK), ncustoms_pt.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '본사' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_sel4.kcba.Imjung1 a WITH (NOLOCK), ncustoms_sel4.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '경기' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_sn.kcba.Imjung1 a WITH (NOLOCK), ncustoms_sn.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '울산' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_us.kcba.Imjung1 a WITH (NOLOCK), ncustoms_us.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '인천공항' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_yj.kcba.Imjung1 a WITH (NOLOCK), ncustoms_yj.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		union all
		select
		a.Imjung_recv_result, a.Imjung_sinchung_gubun, a.Imjung_napse_sangho, a.Imjung_singo_no, a.Imjung_seqno, a.Imjung_singo_date,
		a.Imjung_sinchung_date, a.Imjung_segwan, a.Imjung_damdang_name, a.Imjung_damdang_code, a.UserNM, a.Imjung_sayu_code, a.Imjung_sayu1, a.Imjung_gwichek_sayu_cd,
		b.Impo_file_no1, b.Impo_file_no2, b.Impo_bl_no, b.Impo_mbl_no, '여수' as 'jisa', c.userDepart,
		CASE WHEN a.Imjung_segwan != '' and a.Imjung_gwa !='' then a.Imjung_segwan + '-' +a.Imjung_gwa
		     ELSE a.Imjung_segwan end AS 'segwan'
		from ncustoms_ys.kcba.Imjung1 a WITH (NOLOCK), ncustoms_ys.kcba.Impo1 b WITH (NOLOCK), soo.dbo.CPS_UserInfo c
		where a.Imjung_singo_no = b.Impo_singo_no
		and b.Impo_singo_no != ''
		and (a.Imjung_sinchung_gubun like 'C%' or a.Imjung_sinchung_gubun like 'O%' or a.Imjung_sinchung_gubun like 'X%')
		and a.Imjung_seungin_date is null
		and a.Imjung_recv_result='접수'
		and a.Imjung_send_result='완료'
		and a.Imjung_sayu_code !='27'
		and a.UserID = c.userId
		) k
        where 1 = 1
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND k.Imjung_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND k.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND k.Imjung_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND k.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate1 != null and strFromDate1 != "") and (strToDate1 != null and strToDate1 != "")'>
            <choose>
                <when test='_DateType == "singo_date"'>AND k.Imjung_singo_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
                <when test='_DateType == "sinchung_date"'>AND k.Imjung_sinchung_date BETWEEN #{strFromDate1} AND #{strToDate1}</when>
            </choose>
        </if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "인천공항"'>AND k.Imjung_segwan in (040,240)</when>
                <when test='impoGroupSegwan == "공항우편세관"'>AND k.Imjung_segwan in (013)</when>
                <when test='impoGroupSegwan == "인천항"'>AND k.Imjung_segwan in (020)</when>
                <when test='impoGroupSegwan == "부산항"'>AND k.Imjung_segwan in (030,033,037,039)</when>
                <when test='impoGroupSegwan == "김해공항"'>AND k.Imjung_segwan in (140)</when>
                <when test='impoGroupSegwan == "김포"'>AND k.Imjung_segwan in (041)</when>
                <when test='impoGroupSegwan == "평택"'>AND k.Imjung_segwan in (016)</when>
                <when test='impoGroupSegwan == "경기"'>AND k.Imjung_segwan in (012,014,131)</when>
            </choose>
        </if>
    </select>

    <select id="selectJangchList" resultType="map">
        /* 반입장치장 주소 */
        SELECT
		Jangchi_juso
		from ncustoms.kcba.DJANGCHI WITH (NOLOCK)
        WHERE Jangchi_code = #{Jangchi_code}
    </select>

    <select id="selectMkImportDeclarationMasterList" resultType="map">
		/* 마이클코어스 수입화물통관 마스터 조회 */
		SELECT	a.Impo_key, a.impo_bl_no, a.Impo_bl_gubun, a.impo_singo_no, a.Impo_file_no2, a.Impo_Gonggub_Sangho, a.Impo_receive_result,
		        a.Impo_Forwarder_sangho, a.Impo_Hanggu_Name, a.Impo_iphang_date, a.Impo_banip_date, a.impo_singo_date, a.impo_Ok_date,
		        a.Impo_pojang_su, a.Impo_total_jung, a.Impo_indo_jogun, a.Impo_gyelje_money, a.Impo_gyelje, a.impo_segwan, a.Impo_unsong_box,
		        a.Impo_gyelje_input, a.Impo_total_tax, a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_gwan_tax, a.Impo_vat_tax,
		        (a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax',
		        c.Imlan_wonsanji_code
		FROM [ncustoms].[kcba].[impo1] a WITH (NOLOCK)
				INNER JOIN (SELECT ba.Impum_key, MIN(ba.Impum_sungbun3) AS 'Impum_sungbun3'
							FROM [ncustoms].[kcba].[impo3] ba WITH (NOLOCK)
								INNER JOIN (SELECT ba1.Impum_key, ba1.Impum_lan, MIN(ba1.Impum_heang) AS 'Impum_heang'
											FROM [ncustoms].[kcba].[impo3] ba1 WITH (NOLOCK)
												INNER JOIN (SELECT baa.Impum_key, MIN(baa.Impum_lan) AS 'Impum_lan'
															FROM [ncustoms].[kcba].[impo3] baa WITH (NOLOCK)
															<where>
  																<if test='strPoNo != "" and strPoNo != null'>AND baa.Impum_sungbun3 LIKE '%' + #{strPoNo} + '%' /* PO번호(Impum_sungbun3) */</if>
  															</where>
															GROUP BY baa.Impum_key) ba2
  												ON ba1.Impum_key = ba2.Impum_key
  												AND ba1.Impum_lan = ba2.Impum_lan
												GROUP BY ba1.Impum_key, ba1.Impum_lan) bb
  								ON ba.Impum_key = bb.Impum_key
  								AND ba.Impum_lan = bb.Impum_lan
  								AND ba.Impum_heang = bb.Impum_heang
  							GROUP BY ba.Impum_key) b
				ON a.Impo_key=b.Impum_key
				INNER JOIN (SELECT Imlan_key, MIN(Imlan_wonsanji_code) AS 'Imlan_wonsanji_code', SUM(Imlan_su) AS 'Imlan_su'
							FROM [ncustoms].[kcba].[impo2] WITH (NOLOCK)
							GROUP BY Imlan_key) c
				ON a.Impo_key=c.Imlan_key
		WHERE a.Impo_napse_saup = '1208818888'
		  and ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
		<if test='strEntity != "" and strEntity != null'>
			AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] dd WITH (NOLOCK) WHERE a.Impo_key = dd.Impum_Key AND dd.Impum_jajae_code LIKE '%' + #{strEntity} + '%' )
		</if>
		<if test='strEntityList != "" and strEntityList != null'>
			AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] ddd WITH (NOLOCK) WHERE a.Impo_key = ddd.Impum_Key AND ddd.Impum_jajae_code IN ${strEntityList} )
		</if>
		<if test='strVendor != "" and strVendor != null'>AND a.Impo_Gonggub_Sangho LIKE '%' + #{strVendor} + '%'</if>
		<if test='_DateType != "ALL" and _DateType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
             <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
              </choose>
        </if>
		<if test='strSingoNo != "" and strSingoNo != null'>AND a.impo_singo_no LIKE '%' + #{strSingoNo} + '%'</if>
		<if test='strBlNo != "" and strBlNo != null'>AND a.impo_bl_no LIKE '%' + #{strBlNo} + '%'</if>
		<if test='strInvNo != "" and strInvNo != null'>AND a.Impo_file_no2 LIKE '%' + #{strInvNo} + '%'</if>
		<if test='strSegwan != "" and strSegwan != null'>AND a.impo_segwan = #{strSegwan}</if>
		<if test='strForwarder != "" and strForwarder != null'>AND a.Impo_Forwarder_sangho LIKE '%' + #{strForwarder} + '%'</if>
		order by a.Impo_singo_date desc
	</select>

    <select id="selectMkImportDeclarationDetailList" resultType="map">
		/* 마이클코어스 수입화물통관 디테일 조회 */
		SELECT a.Imlan_key, a.Imlan_jechl_lan, a.Imlan_hs, a.Imlan_seyul_gubun, a.Imlan_gwan_seyula, a.Imlan_wonsanji_code,
			   a.Imlan_gurae_pum, a.Imlan_model, a.Imlan_cost, a.Imlan_mulryang, a.Imlan_mulryang_danwi, a.Imlan_jung,
			   a.Imlan_cif_won, a.Imlan_cif_usd, a.Imlan_gwan_tax, a.Imlan_vat_tax, a.Imlan_cs_gumsa1
		FROM [ncustoms].[kcba].[Impo2] a WITH (NOLOCK)
		WHERE a.Imlan_key = #{strImlanKey}
	</select>

	<select id="selectMkImportDeclarationSubDetailList" resultType="map">
		/* 마이클코어스 수입화물통관 서브디테일 조회 */
		SELECT a.Impum_key, a.Impum_lan, a.Impum_heang, a.Impum_jajae_code,
				a.Impum_gukyk1, a.Impum_gukyk2, a.Impum_gukyk3,	a.Impum_su, a.Impum_su_danwi,
				a.Impum_danga, a.Impum_Amt, a.Impum_sungbun1, a.Impum_sungbun2, a.Impum_sungbun3,
				ISNULL(b.cifwon,0) AS 'cifwon', ISNULL(b.fre,0) AS 'fre', ISNULL(b.ins,0) AS 'ins', ISNULL(b.plus,0) AS 'plus', ISNULL(b.duty,0) AS 'duty',
				ISNULL(b.tk,0) AS 'tk', ISNULL(b.kt,0) AS 'kt', ISNULL(b.ju,0) AS 'ju', ISNULL(b.edu,0) AS 'edu', ISNULL(b.nong,0) AS 'nong',
				ISNULL(b.vat,0) AS 'vat', ISNULL(b.tax,0) AS 'tax', ISNULL(b.vat_g,0) AS 'vat_g', ISNULL(b.gasan,0) AS 'gasan', ISNULL(b.misingo,0) AS 'misingo'
		FROM [ncustoms].[kcba].[Impo3] a WITH (NOLOCK)
				LEFT OUTER JOIN [ncustoms].[kcba].[Impo3_M] b WITH (NOLOCK)
				ON a.Impum_key=b.Impum_key
				AND a.Impum_lan=b.Impum_lan
				AND a.Impum_heang=b.Impum_heang
		WHERE a.Impum_key = #{strImpumKey}
		AND a.Impum_lan = #{strImpumLan}
	</select>

	<select id="selectMkImpoDetailListByImpoKeyList" resultType="map">
		/* 마이클코어스 수입화물통관 디테일 조회(전체다운엑셀) */
		SELECT a.Imlan_key, a.Imlan_jechl_lan, a.Imlan_hs, a.Imlan_seyul_gubun, a.Imlan_gwan_seyula, a.Imlan_wonsanji_code,
			   a.Imlan_gurae_pum, a.Imlan_model, a.Imlan_cost, a.Imlan_mulryang, a.Imlan_mulryang_danwi, a.Imlan_jung,
			   a.Imlan_cif_won, a.Imlan_cif_usd, a.Imlan_gwan_tax, a.Imlan_vat_tax, a.Imlan_cs_gumsa1
		FROM [ncustoms].[kcba].[Impo2] a WITH (NOLOCK)
		WHERE a.Imlan_key IN ${impoKeyList}
		ORDER BY a.Imlan_key, a.Imlan_jechl_lan
	</select>

	<select id="selectMkImpoSubDetailListByImpoKeyList" resultType="map">
		/* 마이클코어스 수입화물통관 서브디테일 조회(전체다운엑셀) */
		SELECT a.Impum_key, a.Impum_lan, a.Impum_heang, a.Impum_jajae_code,
				a.Impum_gukyk1, a.Impum_gukyk2, a.Impum_gukyk3,	a.Impum_su, a.Impum_su_danwi,
				a.Impum_danga, a.Impum_Amt, a.Impum_sungbun1, a.Impum_sungbun2, a.Impum_sungbun3,
				ISNULL(b.cifwon,0) AS 'cifwon', ISNULL(b.fre,0) AS 'fre', ISNULL(b.ins,0) AS 'ins', ISNULL(b.plus,0) AS 'plus', ISNULL(b.duty,0) AS 'duty',
				ISNULL(b.tk,0) AS 'tk', ISNULL(b.kt,0) AS 'kt', ISNULL(b.ju,0) AS 'ju', ISNULL(b.edu,0) AS 'edu', ISNULL(b.nong,0) AS 'nong',
				ISNULL(b.vat,0) AS 'vat', ISNULL(b.tax,0) AS 'tax', ISNULL(b.vat_g,0) AS 'vat_g', ISNULL(b.gasan,0) AS 'gasan', ISNULL(b.misingo,0) AS 'misingo'
		FROM [ncustoms].[kcba].[Impo3] a WITH (NOLOCK)
				LEFT OUTER JOIN [ncustoms].[kcba].[Impo3_M] b WITH (NOLOCK)
				ON a.Impum_key=b.Impum_key
				AND a.Impum_lan=b.Impum_lan
				AND a.Impum_heang=b.Impum_heang
		WHERE a.Impum_key IN ${impoKeyList}
		ORDER BY a.Impum_key, a.Impum_lan, a.Impum_heang
	</select>

	<select id="selectFtaList" resultType="map">
        /* FTA 리스트 */
        select
			y.*
		from (
			select
				left(a.ImOkDtm,8) as 'Impo_ok_date',	
				a.ImSuipSangho as 'Impo_suipja_sangho', 
				a.AddUserNm as 'UserNM',	
				a.ImRecvResult as 'Impo_receive_result', 
				a.ImBlNo as 'Impo_bl_no', 
				a.ImBlGbn as 'Impo_bl_gubun', 
				a.ImSegwan as 'Impo_segwan', 
				a.ImSingoNo as 'Impo_singo_no', 
				a.ImJukchulCode as 'Impo_jukchl_code', 
				a.ImGongIso as 'Impo_gonggub_buho',
				a.ImBlNation,
				a.ImTax as 'Impo_gwan_tax',
				a.ImGongSangho as 'Impo_gonggub_sangho',
				- datediff(day, DATEADD(YEAR, 1, left(a.ImOkDtm,8)), GETDATE() ) as 'Dealy_day',
				(select e.CdPrtNm from CPS.dbo.CDAF100D e where e.UseYn='Y' and e.Mcd='SAS_FTAYN' and e.Cd=c.ImLanHsNationGbn) as 'FTA',
				CONVERT(CHAR(8), DATEADD(YEAR, 1, left(a.ImOkDtm,8)),112) as 'im_end_dt',
				a.ImSingoDt
			from CPS.dbo.IMAC100 a, CPS.[dbo].[IMAC120]  c
			where a.ImKey = c.ImKey
			and a.UseYn='Y'
			and c.UseYn='Y'
			and a.ImOkDtm !=''
			and a.ImOkDtm !='99999999'
			and left(a.ImOkDtm,8) <![CDATA[ >= ]]> CONVERT(CHAR(8),DATEADD(YEAR, -2, GETDATE()),112)
			and a.ImJungChasu <![CDATA[ < ]]> 1
			and c.ImLanHsGbn not like 'F%'
			and len(c.ImLanHsGbn) <![CDATA[ < ]]> 3
			and c.ImLanHsNationGbn like 'F%'
			and len(c.ImLanHsNationGbn) <![CDATA[ > ]]> 2
			and c.ImLanTaxRate >= c.ImLanHsNationRate
			and (left(c.ImLanHsNationGbn,3) in (select k.AcMcd from CPS.[dbo].[BSAC100D] k where k.UseYn = 'Y' and k.AcDCd = a.ImJukchulCode) or left(c.ImLanHsNationGbn,5) in (select k.AcMcd from CPS.[dbo].[BSAC100D] k where k.UseYn = 'Y' and k.AcDCd = a.ImJukchulCode))		
	        <if test='taxNum != null and taxNum != ""'>
	            <choose>
	                <when test='taxNum == "all"'>AND a.ImNapSaup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
	                <otherwise>AND a.ImNapSaup = #{taxNum}</otherwise>
	            </choose>
	        </if>
	        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.ImSuipSangho LIKE '%' + #{impoNapseSangho} + '%'</if>
	        <if test='impoBlNo != null and impoBlNo != ""'>AND a.ImBlNo LIKE '%' + #{impoBlNo} + '%'</if>
	        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.ImSingoNo LIKE '%' + #{impoSingoNo} + '%'</if>
	        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.ImGongSangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
	        <if test='impoJukchlCode != null and impoJukchlCode != ""'>AND a.ImJukchulCode LIKE '%' + #{impoJukchlCode} + '%'</if>
	    ) y
		where 1 = 1
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "fta_Day"'>AND y.im_end_dt BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND left(y.ImSingoDt,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
	            <when test='_DateType == "Impo_ok_date_Day"'>AND left(y.Impo_ok_date,8) BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
		group by y.Impo_ok_date,
			y.Impo_suipja_sangho,
			y.UserNM,
			y.Impo_receive_result,
			y.Impo_bl_no,
			y.Impo_bl_gubun,
			y.Impo_segwan,
			y.Impo_singo_no,
			y.Impo_jukchl_code,
			y.Impo_gonggub_buho,
			y.ImBlNation,
			y.Impo_gwan_tax,
			y.Impo_gonggub_sangho,
			y.Dealy_day,
			y.FTA,
			y.im_end_dt,
			y.ImSingoDt
		order by y.im_end_dt
    </select>
    
    <select id="selectFtaList_back" resultType="map">
        /* FTA 리스트 엔컴 */
        select
		a.Impo_ok_date,	a.Impo_suipja_sangho, a.UserNM,	a.Impo_send_result,	a.Impo_receive_result, a.Impo_singo_date,
		a.Impo_bl_no, a.Impo_bl_gubun, a.Impo_segwan, a.Impo_singo_no, b.FTA_BL_Cntr, a.Impo_jukchl_code, a.Impo_gonggub_buho,
		b.BL_Cntr, b.DrawFtaFlagNmB, b.DrawFtaFlagNm, b.InformDt1, b.CoRecvDt, b.JungReqDt, b.JungOkDt,	b.DrwReqDt,	b.DrwOkDt,
		a.Impo_gwan_tax, b.RecvRemark, b.DrwTaxBf, b.DrwTax, a.Impo_file_no1, a.Impo_gonggub_sangho, a.impo_fta_obj,
		(case when b.DrawEndYN = 'A' then ''
		      when b.DrawEndYN = 'N' then ''
		      when a.impo_ok_date = '' then ncustoms.dbo.fn_New_DATE_VIEW('D1',CONVERT(varchar(20),(CONVERT(smalldatetime,a.Impo_singo_date)+364),112))
		 else ncustoms.dbo.fn_New_DATE_VIEW('D1',CONVERT(varchar(20),(CONVERT(smalldatetime,a.Impo_ok_date)+364),112)) end) as 'im_end_dt',
		(case when b.DrawEndYN = 'A' then 0
			  when b.DrawEndYN = 'N' then 0
			  when b.DrawFtaFlagB = 'A' then 0
			  when b.DrawFtaFlagB = 'D' then 0
			  when b.DrawFtaFlagB = 'E' then 0
			  when a.impo_ok_date = '' then rms.kcba.fn_RE_EXPO_DAY(convert(char(10),(convert(smalldatetime,a.impo_singo_date)+364),112),'')
		 else rms.kcba.fn_RE_EXPO_DAY(convert(char(10),(convert(smalldatetime,a.impo_ok_date)+364),112),'') end) as 'Dealy_day'
		FROM ${_defaultDB}.[kcba].[Impo1] a,
		${_defaultDB}.kcba.impo1_FTA b
        WHERE a.Impo_key = b.fta_Impo_key
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.Impo_napse_saup IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <otherwise>AND a.Impo_napse_saup = #{taxNum}</otherwise>
            </choose>
        </if>
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "fta_Day"'>AND a.Impo_ok_date BETWEEN CONVERT(varchar(10),(CONVERT(smalldatetime,#{strFromDate})-364),112) AND CONVERT(varchar(10),(CONVERT(smalldatetime,#{strToDate})-364),112)</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='impoJukchlCode != null and impoJukchlCode != ""'>AND a.Impo_jukchl_code LIKE '%' + #{impoJukchlCode} + '%'</if>
        <if test='impoFtaObj != null and impoFtaObj != ""'>
            <choose>
                <when test='impoFtaObj == "공백"'>AND b.DrawFtaFlagNm = '' AND a.impo_fta_obj = '확인'</when>
                <otherwise>AND a.impo_fta_obj = #{impoFtaObj}</otherwise>
            </choose>
        </if>
    </select>

	<insert id="saveImpo1mdtl">
		/* 토즈 포워더 비용입력 */
		INSERT INTO [ncustoms].[kcba].[impo1_mDtl]
		       ([Impo_key]
		       ,[ADJ_CD]
		       ,[ADJ_NM]
		       ,[ADJ_GR_CD]
		       ,[SUP_EK]
		       ,[TAX_EK]
		       ,[SUM_EK]
		       ,[impo_singo_no]
		       ,[acc_nm]
		       ,[acc_dt]
		       ,[confYn])
		VALUES
		       (#{Impo_key}
		       ,#{ADJ_CD}
		       ,#{ADJ_NM}
		       ,#{ADJ_GR_CD}
		       ,REPLACE(#{SUP_EK}, ',', '')
		       ,REPLACE(#{TAX_EK}, ',', '')
		       ,REPLACE(#{SUM_EK}, ',', '')
		       ,#{impo_singo_no}
		       ,#{acc_nm}
		       ,#{acc_dt}
		       ,#{confYn})
	</insert>

	<select id="selectTodsCount" resultType="map">
		/* 토즈 비용 등록 확인 카운트 */
		SELECT count(Impo_key) as 'count'
		from [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK)
		WHERE Impo_key = #{Impo_key}
	</select>

	<delete id="updateImpo1Mdtl">
	    /* 토즈 포워더 비용수정 */
	    update [ncustoms].[kcba].[impo1_mDtl]
	    set SUP_EK = #{supEk},
	    TAX_EK = #{taxEk},
	    SUM_EK = #{sumEk}
		WHERE KEY_impo1_mDtl = #{mDtlKey}
	</delete>

	<insert id="insertImpo1MdtlDelLog">
		/* 비용관리 impo1Mdtl 삭제로그 입력 */
		INSERT INTO [ncustoms].[kcba].[impo1_mDtl_Log]
		       ([KEY_impo1_mDtl]
		       ,[Impo_key]
		       ,[ADJ_CD]
		       ,[ADJ_NM]
		       ,[ADJ_GR_CD]
		       ,[SUP_EK]
		       ,[TAX_EK]
		       ,[SUM_EK]
		       ,[impo_singo_no]
		       ,[acc_nm]
		       ,[acc_dt]
		       ,[acc_Note]
		       ,[confYn]
		       ,[confUserId]
		       ,[confUserName]
		       ,[confDate]
		       ,[confDesc]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm] )
		select KEY_impo1_mDtl,
			Impo_key,
			ADJ_CD,
			ADJ_NM,
			ADJ_GR_CD,
			SUP_EK,
			TAX_EK,
			SUM_EK,
			impo_singo_no,
			acc_nm,
			acc_dt,
			acc_Note,
			confYn,
			confUserId,
			confUserName,
			confDate,
			#{confDesc},
			#{addUserId},
			#{addUserNm},
			#{addDtm}
		from [ncustoms].[kcba].[impo1_mDtl]
		where KEY_impo1_mDtl = #{mDtlKey}
	</insert>


	<select id="selectImportZeissRequestList" resultType="map">
        /* 칼자이스 수입 Request 조회 */
        SELECT
        a.startKey, a.startJisaCode, a.startTaxpayerTradeName, a.startTaxpayerNum,
        a.startNum, a.startReferenceNo1, a.startReferenceNo2, a.startIssueContent, a.startPoNo, a.startNote,
        a.startCompensationYn, a.startLocation, a.addDtm as 'addDay', a.addUserNm,
        impo.Impo_Key, impo.Impo_receive_result, impo.Impo_singo_no, impo.Impo_bl_no, impo.Impo_mbl_no, impo.Impo_mrn_no,
        impo.Impo_iphang_date, impo.Impo_banip_date, impo.Impo_singo_date, impo.Impo_ok_date,
        ISNULL((SELECT count(EdmsNo) FROM CPS.[dbo].[SDAA100] WITH (NOLOCK) WHERE a.startNum = EdmsNo and ISNULL(impo.Impo_singo_no,'')=EdmsSingoNo and UseYn='Y'), 0) AS 'fileCnt',
        ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms.[kcba].[Impo2]
			where impo.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms.[kcba].[Impo2]
			where impo.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO'
        FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
        LEFT OUTER JOIN ${_defaultDB}.[kcba].[Impo1] impo WITH (NOLOCK)
        ON impo.Impo_bl_no = a.startNum
        AND impo.Impo_napse_saup = a.startTaxpayerNum
        where a.useYn = 'Y'
        and a.startGubun = #{startGubun}
        and a.startJisaCode = #{_defaultDB}
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "add_Day"'>AND SUBSTRING(a.addDtm,0,9) BETWEEN #{strFromDate} AND #{strToDate} /* 등록일 */</when>
            </choose>
        </if>
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.startTaxpayerNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <when test='taxNum != "all"'>AND a.startTaxpayerNum = #{taxNum}</when>
            </choose>
        </if>
        <if test='tradeName != null and tradeName != ""'>AND a.startTaxpayerTradeName like '%' + #{tradeName} + '%'</if>
        <if test='startNum != null and startNum != ""'>AND a.startNum like '%' + #{startNum} + '%'</if>
        <if test='referenceNo1 != null and referenceNo1 != ""'>AND (a.startReferenceNo1 LIKE '%' + #{referenceNo1} + '%' or a.startReferenceNo2 LIKE '%' + #{referenceNo1} + '%')</if>
        <if test='USERGRADEB != null and USERGRADEB == "D"'>AND a.addUserId = #{ID}</if>
        order by startKey desc
    </select>

	<select id="selectImportZeissDecide" resultType="map">
	    SELECT
	    a.startKey,
	    impo.Impo_key,
		impo.Impo_receive_result,
		impo.Impo_cs,
		a.startNum,
		a.addDtm,
		impo.Impo_iphang_date,
		impo.Impo_banip_date,
		impo.Impo_jubsu_date,
		impo.Impo_ok_date,
		impo.Impo_singo_no,
		impo.Impo_mbl_no,
		impo.Impo_gonggub_sangho,
		impo.IMPO_OK_DTTM,
		rms.dbo.fn_NEW_DATE_VIEW('D1',impo.Impo_iphang_date) as 'Impo_iphang_date1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',impo.Impo_jubsu_date) as 'Impo_jubsu_date1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',impo.Impo_ok_date) as 'Impo_ok_date1',
		left(impo.Impo_upja_sangho,8) as 'Impo_upja_sangho',
		impo.Impo_jangch_name,
		a.startNote,
		a.startPoNo,
		a.startReferenceNo1,
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.startReferenceNo1) as 'startReferenceNo3',
		case when impo.Impo_iphang_date != '' then rms.dbo.fn_NEW_DATE_VIEW('D1',impo.Impo_iphang_date)
		else '미입항' end as 'Impo_iphang',
		a.startLocation,
		a.startIssueContent,
		a.startJisaCode,
		case when impo.Impo_singo_date != ''
		then
		(select
		case when(
		charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
		and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
		and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
		)
		then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
		when(
		charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
		and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
		and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
		)
		then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
		when(
		charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
		and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
		)
		then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
		charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
		else ''
		end as 'IVNO'
		from ${_defaultDB}.[kcba].[Impo2]
		where impo.Impo_key = Imlan_key
		and Imlan_jechl_lan = '001')
		else a.startReferenceNo2
		end as 'startReferenceNo2',
		case when ISNULL(impo.Impo_Key, '') = '' then a.startPoNo
		else
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else a.startPoNo
			end as 'PONO'
			from ${_defaultDB}.[kcba].[Impo2]
			where impo.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '')
		end AS 'startPoNo1',
		case when ISNULL(impo.Impo_jubsu_date,0) = '0'
		then 1
		else ISNULL((SELECT count(Impo_key) FROM ${_defaultDB}.[kcba].[Impo1] WITH (NOLOCK) WHERE impo.Impo_Key = Impo_Key AND (ISNULL(impo.Impo_ok_date, '') = '' and ISNULL(impo.Impo_jubsu_date, '') = '')), 0)
		end as 'decideCnt',
		ISNULL(rvimpo.Impo_banip_date + REPLICATE('0',14-LEN(rvimpo.Impo_banip_date)), '00000000000000') as 'banip_date',
		ISNULL(rvimpo.Impo_jubsu_date + REPLICATE('0',14-LEN(rvimpo.Impo_jubsu_date)), '00000000000000') as 'jubsu_date',
		replace(replace(replace(CONVERT(CHAR(19), GETDATE(), 120),'-',''),':',''),' ','') as 'now_date',
		case when ISNULL(rvimpo.Impo_banip_date + REPLICATE('0',14-LEN(rvimpo.Impo_banip_date)), '00000000000000') = '00000000000000' then ''
			when ISNULL(rvimpo.Impo_banip_date + REPLICATE('0',14-LEN(rvimpo.Impo_banip_date)), '00000000000000') != '00000000000000'
			and ISNULL(impo.Impo_jubsu_date + REPLICATE('0',14-LEN(impo.Impo_jubsu_date)), '00000000000000') = '00000000000000' then
			ISNULL(DATEDIFF(DD,left(ISNULL(rvimpo.Impo_banip_date + REPLICATE('0',14-LEN(rvimpo.Impo_banip_date)), '00000000000000'),8),left(replace(replace(replace(CONVERT(CHAR(19), GETDATE(), 120),'-',''),':',''),' ',''),8)),'')
			else ''
			end as 'aa',
		case when ISNULL(rvimpo.Impo_banip_date + REPLICATE('0',14-LEN(rvimpo.Impo_banip_date)), '00000000000000') = '00000000000000' then ''
		     when ISNULL(impo.Impo_jubsu_date + REPLICATE('0',14-LEN(impo.Impo_jubsu_date)), '00000000000000') = '00000000000000' then ''
			 else ISNULL(DATEDIFF(DD,left(rvimpo.Impo_banip_date,8),left(impo.Impo_jubsu_date,8)),'')
			end as 'bb'
		FROM [soo].[dbo].[CPS_StartInfo] a WITH (NOLOCK)
		LEFT OUTER JOIN ${_defaultDB}.[kcba].[Impo1] impo WITH (NOLOCK)
		ON impo.Impo_bl_no = a.startNum
		AND (impo.Impo_napse_saup = a.startTaxpayerNum or impo.Impo_SuipSaupNo = a.startTaxpayerNum)
		LEFT OUTER JOIN [rms].[dbo].[recv_impo1] rvimpo WITH (NOLOCK)
		ON impo.Impo_bl_no = rvimpo.Impo_bl_no
		AND (impo.Impo_napse_saup = rvimpo.Impo_napse_saup or impo.Impo_SuipSaupNo = rvimpo.Impo_SuipSaupNo)
		where a.useYn = 'Y'
		and a.startGubun = 'IMPORT'
		and a.startJisaCode = #{_defaultDB}
	    <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "add_Day"'>AND a.startReferenceNo1 BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "iphang_Day"'>AND impo.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "banip_Day"'>AND impo.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "singo_Day"'>AND impo.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "ok_Day"'>AND impo.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='taxNum != null and taxNum != ""'>
            <choose>
                <when test='taxNum == "all"'>AND a.startTaxpayerNum IN (select userSaup from soo.dbo.CPS_SaveCustomer where userKey = #{ID} and useYn='Y')</when>
                <when test='taxNum != "all"'>AND a.startTaxpayerNum = #{taxNum}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND (ISNULL(impo.Impo_ok_date, '') = '' and ISNULL(impo.Impo_jubsu_date, '') = '')</if>
        <if test='_Unbanchul != null and _Unbanchul != ""'>AND ISNULL(impo.Impo_upja_sangho, '') = ''</if>
        <if test='startNum != null and startNum != ""'>AND a.startNum LIKE '%' + #{startNum} + '%'</if>
        <if test='singoNum != null and singoNum != ""'>AND impo.Impo_singo_no LIKE '%' + #{singoNum} + '%'</if>
        <if test='Impo_gonggub_sangho != null and Impo_gonggub_sangho != ""'>AND impo.Impo_gonggub_sangho LIKE '%' + #{Impo_gonggub_sangho} + '%'</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (impo.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR impo.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='location != null and location != ""'>AND a.startLocation = #{location}</if>
        <if test='hour != null and hour != ""'>AND a.addDtm between #{hour1} and #{hour}</if>
        order by a.startKey desc
	</select>

	<select id="selectZeissFileDownList" resultType="map">
        /* 칼자이스 수입통관현황  (파일 다운) */
        SELECT datas.*
        FROM (
        SELECT
		a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_gonggub_sangho,
		a.Impo_iphang_date, a.Impo_singo_date, a.Impo_Ok_date,
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO'
		FROM ncustoms.[kcba].[Impo1] a WITH (NOLOCK), ncustoms.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND a.Impo_napse_saup = '2038151510'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        union all
        SELECT
		a.Impo_bl_no, a.Impo_mbl_no, a.Impo_singo_no, a.Impo_gonggub_sangho,
		a.Impo_iphang_date, a.Impo_singo_date, a.Impo_Ok_date,
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO'
		FROM ncustoms_yj.[kcba].[Impo1] a WITH (NOLOCK), ncustoms_yj.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND a.Impo_napse_saup = '1058677021'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
        )datas
        where 1=1
        <if test='Imlan_gije != null and Imlan_gije != ""'>AND Imlan_gije LIKE '%' + #{Imlan_gije} + '%' /* InvNO PONO */</if>
    </select>

	<delete id="selectZeissFileDel">
	    /* 칼자이스 파일 삭제 */
	    delete FROM [soo].[dbo].[CPS_ZeissFileDown]
		WHERE addUserId = #{ID}
	</delete>

	<delete id="selectZeissFileTempDel">
	    /* 칼자이스 Temp파일 삭제 */
	    delete FROM [soo].[dbo].[CPS_ZeissFileDown_Temp]
		WHERE addUserId = #{ID}
	</delete>

	<delete id="selectZeissFileTemp1Del">
	    /* 칼자이스 Temp1파일 삭제 */
	    delete FROM [soo].[dbo].[CPS_ZeissFileDown_Temp1]
		WHERE addUserId = #{ID}
	</delete>

	<select id="selectZeissFileDown" resultType="map">
        /* 칼자이스 수입통관현황  (파일 다운) */
        SELECT datas.*
        FROM (
        SELECT *
		FROM [soo].[dbo].[CPS_ZeissFileDown] WITH (NOLOCK)
        WHERE 1 = 1
        <if test='ID != null and ID != ""'>AND addUserId = #{ID}</if>
        )datas
        order by datas.edmsInvNo
    </select>

	<insert id="selectZeissTempInsert">
		/* 칼자이스 Temp DB입력 */
		INSERT INTO [soo].[dbo].[CPS_ZeissFileDown_Temp]
		SELECT
		a.Impo_bl_no, a.Impo_singo_no, a.Impo_gonggub_sangho,
		ISNULL((select
			case when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ < ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			and charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 0
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),10)
			when(
			charindex('IVNO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) = 1
			and LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ','')) <![CDATA[ > ]]> 40
			)
			then LEFT(replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''),
			charindex('PONO.',replace(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),'IVNO.',''))-1)
			else ''
			end as 'IVNO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'IVNO',
		ISNULL((select
			case when(
			charindex('PONO',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0) <![CDATA[ > ]]> 0
			)
			then left(right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4),
			charindex('달러환율',right(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),LEN(replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''))-charindex('PONO.',replace(replace(Imlan_gije1+ '' +Imlan_gije2+ '' +Imlan_gije3+ '' +Imlan_gije4+ '' +Imlan_gije5+ '' +Imlan_gije6+ '' +Imlan_gije7+ '' +Imlan_gije8+ '' +Imlan_gije9+ '' +Imlan_gije10,'*',''),' ',''),0)-4))-1)
			else ''
			end as 'PONO'
			from ncustoms.[kcba].[Impo2]
			where a.Impo_key = Imlan_key
			and Imlan_jechl_lan = '001'), '') AS 'PONO',
			a.Impo_mbl_no, a.Impo_iphang_date, a.Impo_singo_date, a.Impo_Ok_date, ${ID}
		FROM ncustoms.[kcba].[Impo1] a WITH (NOLOCK), ncustoms.[kcba].[Impo2] b WITH (NOLOCK)
        WHERE ISNULL(a.Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        AND a.Impo_napse_saup = '2038151510'
        and a.Impo_key = b.imlan_key
        and b.Imlan_jechl_lan = '001'
        <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%'</if>
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
        <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='_Undecided != null and _Undecided != ""'>AND ISNULL(a.Impo_ok_date, '') = ''</if>
        <if test='_TodayData != null and _TodayData != ""'>AND (a.Impo_singo_date = CONVERT(VARCHAR, GETDATE(), 112) OR a.Impo_ok_date = CONVERT(VARCHAR, GETDATE(), 112))</if>
        <if test='_Document != null and _Document != ""'>AND a.impo_singo_gubun LIKE #{_Document} + '%'</if>
        <if test='_Test != null and _Test != ""'>AND a.impo_cs in ('O','R','T','W','Y')</if>
        <if test='impoSegwan != null and impoSegwan != ""'>AND a.impo_segwan = #{impoSegwan}</if>
        <if test='impoGroupSegwan != null and impoGroupSegwan != ""'>
            <choose>
                <when test='impoGroupSegwan == "경기"'>AND a.impo_segwan in (012,014,021,131)</when>
                <when test='impoGroupSegwan == "구미"'>AND a.impo_segwan in (120,121)</when>
                <when test='impoGroupSegwan == "대전"'>AND a.impo_segwan in (080,081,082,150)</when>
                <when test='impoGroupSegwan == "부산"'>AND a.impo_segwan in (030,033,037,039,051,054,140)</when>
                <when test='impoGroupSegwan == "서울"'>AND a.impo_segwan in (010,011,090,100,101,102,103,130)</when>
                <when test='impoGroupSegwan == "여수"'>AND a.impo_segwan in (060,062,070,071)</when>
                <when test='impoGroupSegwan == "울산"'>AND a.impo_segwan in (110,122)</when>
                <when test='impoGroupSegwan == "인천"'>AND a.impo_segwan in (013,020,023,040,041)</when>
                <when test='impoGroupSegwan == "창원"'>AND a.impo_segwan in (050,052,053,056)</when>
                <when test='impoGroupSegwan == "천안"'>AND a.impo_segwan in (152)</when>
                <when test='impoGroupSegwan == "청주"'>AND a.impo_segwan in (151,153)</when>
                <when test='impoGroupSegwan == "파주"'>AND a.impo_segwan in (017)</when>
                <when test='impoGroupSegwan == "평택"'>AND a.impo_segwan in (016,154)</when>
            </choose>
        </if>
        <if test='impoGonggubSangho != null and impoGonggubSangho != ""'>AND a.impo_gonggub_sangho LIKE '%' + #{impoGonggubSangho} + '%'</if>
        <if test='forwarder != null and forwarder != ""'>AND a.Impo_Forwarder_sangho LIKE '%' + #{forwarder} + '%'</if>
        <if test='ImpoGonggubSangho != null and ImpoGonggubSangho != ""'>AND a.Impo_gonggub_sangho LIKE '%' + #{ImpoGonggubSangho} + '%'</if>
        <if test='invNo != null and invNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{invNo} + '%'</if>
        <if test='poNo != null and poNo != ""'>AND b.Imlan_gije1+b.Imlan_gije2+b.Imlan_gije3+b.Imlan_gije4+b.Imlan_gije5+b.Imlan_gije6+b.Imlan_gije7+b.Imlan_gije8+b.Imlan_gije9+b.Imlan_gije10 LIKE '%' + #{poNo} + '%'</if>
	</insert>

	<insert id="selectZeissTemp1Insert">
		/* 칼자이스 Temp1 DB입력 */
		INSERT INTO [soo].[dbo].[CPS_ZeissFileDown_Temp1]
		(edmsFileKey,
		edmsSingoNum,
		edmsFileCategory,
		edmsFilePath,
		edmsSaveFileName,
		edmsOrgFileName,
		edmsFileSize,
		edmsFileExt,
		addUserId)
		select
		SDAAKey,
		EdmsSingoNo,
		EdmsFileCategory,
		EdmsFilePath,
		EdmsSaveFileNm,
		EdmsOrgFileNm,
		EdmsFileSize,
		EdmsFileExt,
		#{addUserId}
		from CPS.[dbo].[SDAA100]
		where UseYn = 'Y'
		and EdmsParentGbn = 'IMPORT'
		and EdmsJisaCode = 'ncustoms'
		<if test='singo != null and singo != ""'>AND EdmsSingoNo in ${singo}</if>
		<if test='category != null and category != ""'>AND EdmsFileCategory in ${category}</if>
	</insert>

	<insert id="selectZeissFileInsert">
		/* 칼자이스 파일 다운로드 DB입력 */
		INSERT INTO [soo].[dbo].[CPS_ZeissFileDown]
		select
		b.edmsFileKey,
		a.edmsNum,
		a.edmsSingoNum,
		a.edmsGongGub,
		a.edmsInvNo,
		a.edmsPoNo,
		a.edmsMbl,
		a.edmsIphangDate,
		a.edmsSingoDate,
		a.edmsOkDate,
		b.edmsFileCategory,
		b.edmsFilePath,
		b.edmsSaveFileName,
		b.edmsOrgFileName,
		b.edmsFileSize,
		b.edmsFileExt,
		'Y',
		b.addUserId
		from soo.dbo.CPS_ZeissFileDown_Temp a, soo.dbo.CPS_ZeissFileDown_Temp1 b
		where a.edmsSingoNum = b.edmsSingoNum
		<if test='ID != null and ID != ""'>AND b.addUserId = #{ID}</if>
	</insert>

	<select id="selectFileCount" resultType="map">
        /* 선적서류 유무 */
        SELECT count(EdmsNo) as 'count'
        FROM CPS.[dbo].[SDAA100] WITH (NOLOCK)
        WHERE EdmsNo = #{blNo}
        and UseYn='Y'
    </select>

	<insert id="saveFieldManage">
		/* 현장 관리실적 입력 */
		INSERT INTO soo.dbo.CPS_Field_Management
		       (regDate,
		        segwan,
				jisa,
				team,
				userNm,
				gubun,
				singoCode,
				singoNum,
				company,
				gumYn,
				jangchi,
				gwanUser,
				jubsu,
				approve,
				issue,
				remark,
				price,
				useYn,
				addUserId,
				addDtm)
		VALUES
		       (#{regDate}
		       ,#{segwan}
		       ,#{jisa}
		       ,#{team}
		       ,#{userNm}
		       ,#{gubun}
		       ,#{singoCode}
		       ,#{singoNum}
		       ,#{company}
		       ,#{gumYn}
		       ,#{jangchi}
		       ,#{gwanUser}
		       ,#{jubsu}
			   ,#{approve}
			   ,#{issue}
			   ,#{remark}
		       ,#{price}
		       ,#{useYn}
		       ,#{addUserId}
		       ,#{addDtm})
	</insert>

	<select id="selectFieldManage" resultType="map">
        /* 현장관리 조회 */
        SELECT *
        FROM soo.dbo.CPS_Field_Management WITH (NOLOCK)
        WHERE useYn='Y'
        <if test='fieldMngKey != null and fieldMngKey != ""'>AND fieldMngKey = #{fieldMngKey}</if>
        <if test='singoNum != null and singoNum != ""'>AND singoNum LIKE '%' + #{singoNum} + '%'</if>
        <if test='gubun != null and gubun != ""'>AND gubun = #{gubun}</if>
        <if test='company != null and company != ""'>AND company LIKE '%' + #{company} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate4 != null and strFromDate4 != "") and (strToDate4 != null and strToDate4 != "")'>
            <choose>
                <when test='_DateType == "regDate"'>AND regDate BETWEEN #{strFromDate4} AND #{strToDate4}</when>
            </choose>
        </if>
        <if test='segwan != null and segwan != ""'>
            <choose>
                <when test='segwan == "인천공항"'>AND segwan in (040,240)</when>
                <when test='segwan == "공항우편세관"'>AND segwan in (013)</when>
                <when test='segwan == "인천항"'>AND segwan in (020)</when>
                <when test='segwan == "부산항"'>AND segwan in (030,033,037,039)</when>
                <when test='segwan == "김해공항"'>AND segwan in (140)</when>
                <when test='segwan == "김포"'>AND segwan in (041)</when>
                <when test='segwan == "평택"'>AND segwan in (016)</when>
                <when test='segwan == "경기"'>AND segwan in (012,014,131)</when>
                <when test='segwan == "인천김포"'>AND segwan in (020,041)</when>
            </choose>
        </if>
        order by fieldMngKey desc
    </select>

	<update id="updateFieldManage">
		/* 현장관리 수정*/
		UPDATE	soo.dbo.CPS_Field_Management
		<trim prefix="SET" suffixOverrides=",">
			<if test='regDate != null'>regDate = #{regDate} ,</if>
			<if test='segwan != null'>segwan = #{segwan} ,</if>
			<if test='jisa != null'>jisa = #{jisa} ,</if>
			<if test='team != null'>team = #{team} ,</if>
			<if test='userNm != null'>userNm = #{userNm} ,</if>
			<if test='gubun != null'>gubun = #{gubun} ,</if>
			<if test='singoCode != null'>singoCode = #{singoCode} ,</if>
			<if test='singoNum != null'>singoNum = #{singoNum} ,</if>
			<if test='company != null'>company = #{company} ,</if>
			<if test='gumYn != null'>gumYn = #{gumYn} ,</if>
			<if test='jangchi != null'>jangchi = #{jangchi} ,</if>
			<if test='gwanUser != null'>gwanUser = #{gwanUser} ,</if>
			<if test='jubsu != null'>jubsu = #{jubsu} ,</if>
			<if test='approve != null'>approve = #{approve} ,</if>
			<if test='issue != null'>issue = #{issue} ,</if>
			<if test='remark != null'>remark = #{remark} ,</if>
			<if test='price != null'>price = #{price} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE fieldMngKey = #{fieldMngKey}
	</update>

	<update id="deleteFieldManage">
		/* 현장관리 삭제*/
		UPDATE	soo.dbo.CPS_Field_Management
		<trim prefix="SET" suffixOverrides=",">
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE fieldMngKey = #{fieldMngKey}
	</update>

	<select id="selectCostcoAccountList" resultType="map">
        /* 코스트코 정산관리 조회 */
        select
			a1.*,
			case when a1.se = '0' then ''
			else cast(a1.se as varchar(11))
			end as 'sein',
			case when a1.se1 = '0' then ''
			else cast(a1.se1 as varchar(11))
			end as 'sein1',
			case when a1.se2 = '0' then ''
			else cast(a1.se2 as varchar(11))
			end as 'sein2',
			case when Impum_lan = '001' and Impum_heang = '01' then
			  case when cast(cast(isNull((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y'),0) as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(isNull((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y'),0) as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as 'price',
			case when Impum_lan = '001' and Impum_heang = '01' then
			  case when cast(cast(isNull(Round((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y') / 10,0),0) as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(isNull(Round((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y') / 10,0),0) as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as 'price1',
			case when Impum_lan = '001' and Impum_heang = '01' then
			  case when cast(cast(isNull(isNull((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y'),0) + Round((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y') / 10,0),0) as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(isNull(isNull((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y'),0) + Round((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y') / 10,0),0) as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as 'price2',
			case when Impum_lan = '001' and Impum_heang = '01' then cast(a1.se + isNull((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y'),0)  as varchar(11))
			else ''
			end as 'total',
			case when Impum_lan = '001' and Impum_heang = '01' then cast(a1.se1 + isNull(Round((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y') / 10,0),0) as varchar(11))
			else ''
			end as 'total1',
			case when Impum_lan = '001' and Impum_heang = '01' then cast(a1.se2 + isNull(isNull((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y'),0) + Round((select sum(price) from soo.dbo.CPS_CostcoYog where blNo=e.blNo and useYn='Y') / 10,0),0) as varchar(11))
			else ''
			end as 'total2'
			from
			(select
			a.Impo_key,
			case when a.Impo_jangch_buho='01606042' then '천일'
			when a.Impo_jangch_buho='01610103' then '천일'
			when a.Impo_jangch_buho='01606030' then '천일'
			when a.Impo_jangch_buho='01606037' then '세방'
			else 'CY'
			end as 'jangch',
			'세인' as 'com',
			a.Impo_bl_no,
			c.Impum_jajae_code,
			a.Impo_singo_date,
			substring(a.Impo_singo_date,0,5)+'.'+substring(a.Impo_singo_date,5,2)+'.'+substring(a.Impo_singo_date,7,2) as 'Impo_singo_date1',
			a.Impo_ok_date,
			substring(a.Impo_ok_date,0,5)+'.'+substring(a.Impo_ok_date,5,2)+'.'+substring(a.Impo_ok_date,7,2) as 'Impo_ok_date1',
			a.Impo_singo_no,
			substring(a.Impo_singo_no,0,6)+'-'+substring(a.Impo_singo_no,6,2)+'-'+substring(a.Impo_singo_no,8,7) as 'Impo_singo_no1',
			b.Imlan_gwan_seyulc,
			b.Imlan_seyul_gubun,
			d.Mhs_code,
			substring(d.Mhs_code,0,5)+'.'+substring(d.Mhs_code,5,2)+'-'+substring(d.Mhs_code,7,4) as 'Mhs_code1',
			c.Impum_su,
			a.Impo_gyelje_money,
			c.Impum_danga,
			c.Impum_amt,
			c.Impum_lan,
			c.Impum_heang,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_cif_total_won as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_cif_total_won as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_cif_total_won,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_gwan_tax as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_gwan_tax as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_gwan_tax,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_teuk_tax as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_teuk_tax as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_teuk_tax,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_oil_tax as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_oil_tax as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_oil_tax,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_ju_tax as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_ju_tax as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_ju_tax,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_edu_tax as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_edu_tax as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_edu_tax,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_nong_tax as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_nong_tax as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_nong_tax,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then b.Imlan_vat_gubun
			else ''
			end as Imlan_vat_gubun,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_vat_tax as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_vat_tax as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_vat_tax,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			  case when cast(cast(a.Impo_total_tax as numeric(11,0)) as varchar(11)) = '0' then ''
			      else cast(cast(a.Impo_total_tax as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as Impo_total_tax,
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			 case when FLOOR(a.Impo_cif_total_won * 2 /1000) <![CDATA[ < ]]> 30000 then 30000
			      when FLOOR(a.Impo_cif_total_won * 2 /1000) <![CDATA[ > ]]> 300000 then 300000
			      else cast(cast(FLOOR(a.Impo_cif_total_won * 2 /1000) as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as 'se',
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			 case when FLOOR(a.Impo_cif_total_won * 2 /1000) <![CDATA[ < ]]> 30000 then 3000
			      when FLOOR(a.Impo_cif_total_won * 2 /1000) <![CDATA[ > ]]> 300000 then 30000
			      else cast(cast(Round(FLOOR(a.Impo_cif_total_won * 2 /1000)* 0.1,0) as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as 'se1',
			case when c.Impum_lan = '001' and c.Impum_heang = '01' then
			 case when FLOOR(a.Impo_cif_total_won * 2 /1000) <![CDATA[ < ]]> 30000 then 33000
			      when FLOOR(a.Impo_cif_total_won * 2 /1000) <![CDATA[ > ]]> 300000 then 330000
			      else cast(cast(FLOOR(a.Impo_cif_total_won * 2 /1000)+Round(FLOOR(a.Impo_cif_total_won * 2 /1000)* 0.1,0) as numeric(11,0)) as varchar(11))
			      end
			else ''
			end as 'se2'
		from ncustoms.kcba.Impo1 a, ncustoms.kcba.Impo2 b, ncustoms.kcba.Impo3 c, CPS.[dbo].[MAAA100] d
		where a.Impo_key = b.imlan_key
		and a.Impo_key = c.Impum_key
		and b.Imlan_jechl_lan = c.Impum_lan
		and c.Impum_jajae_code = d.Mmodel_code
		and c.Impum_jajae_code != ''
        <if test='taxNum != null and taxNum != ""'>AND d.Mco_com = #{taxNum}</if>
        <if test='taxNum != null and taxNum != ""'>AND a.Impo_napse_saup = #{taxNum}</if>
        <if test='Impum_jajae_code != null and Impum_jajae_code != ""'>AND c.Impum_jajae_code like '%' + #{Impum_jajae_code} + '%'</if>
        <if test='Impo_bl_no != null and Impo_bl_no != ""'>AND a.Impo_bl_no like '%' + #{Impo_bl_no} + '%'</if>
        <if test='Impo_singo_no != null and Impo_singo_no != ""'>AND a.Impo_singo_no like '%' + #{Impo_singo_no} + '%'</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        ) a1
		left outer join soo.dbo.CPS_CostcoYog e
		on a1.Impo_bl_no = e.blNo
		and e.useYn = 'Y'
		group by a1.Impo_key, a1.jangch, a1.com, a1.Impo_bl_no, a1.Impum_jajae_code, a1.Impo_singo_date, a1.Impo_singo_date1, a1.Impo_ok_date, a1.Impo_ok_date1, a1.Impo_singo_no,
		a1.Impo_singo_no1, a1.Imlan_gwan_seyulc, a1.Imlan_seyul_gubun, a1.Mhs_code, a1.Mhs_code1, a1.Impum_su, a1.Impo_gyelje_money, a1.Impum_danga, a1.Impum_amt,
		a1.Impum_lan, a1.Impum_heang, a1.Impo_cif_total_won, a1.Impo_gwan_tax, a1.Impo_teuk_tax, a1.Impo_oil_tax, a1.Impo_ju_tax, a1.Impo_edu_tax, a1.Impo_nong_tax,
		a1.Imlan_vat_gubun, a1.Impo_vat_tax, a1.Impo_total_tax, a1.se, a1.se1, a1.se2, e.blNo
		order by a1.Impo_singo_date, a1.Impo_singo_no, a1.Impum_lan, a1.Impum_heang
    </select>

	<select id="selectCostcoFeesList" resultType="map">
        /* 코스트코 요건수수료 조회 */
        select
			*
		from soo.dbo.CPS_CostcoYog
		where useYn in ('X','Y')
        <if test='Impum_jajae_code != null and Impum_jajae_code != ""'>AND mmodelCode like '%' + #{Impum_jajae_code} + '%'</if>
        <if test='Impo_bl_no != null and Impo_bl_no != ""'>AND blNo like '%' + #{Impo_bl_no} + '%'</if>
		order by yogKey desc
    </select>

	<select id="selectCostcoImportStatusList" resultType="map">
        /* 코스트코 수입통관현황 */
        SELECT
		Impo_key
		FROM ncustoms.[kcba].[Impo1] WITH (NOLOCK)
        WHERE ISNULL(Impo_jubsu_date, '') != '' /* 접수일이 있는 것(실데이터 판단 기준)  */
        <if test='taxNum != null and taxNum != ""'>AND Impo_napse_saup = #{taxNum}</if>
        <if test='blNo != null and blNo != ""'>AND Impo_bl_no LIKE '%' + #{blNo} + '%'</if>
    </select>

	<insert id="saveCostcoFees">
		/* 코스트코 요건수수료 입력 */
		INSERT INTO soo.dbo.CPS_CostcoYog
		       (blNo,
		        mmodelCode,
				price,
				useYn,
				addUserId,
				addUserNm,
				addDtm)
		VALUES
		       (#{blNo}
		       ,#{mmodelCode}
		       ,#{price}
		       ,#{useYn}
		       ,#{addUserId}
		       ,#{addUserNm}
		       ,#{addDtm})
	</insert>

	<update id="deleteCostcoFees">
		/* 코스트코 요건수수료 삭제 및 수수료 반영*/
		UPDATE	soo.dbo.CPS_CostcoYog
		<trim prefix="SET" suffixOverrides=",">
		    <if test='impoKey != null'>impoKey = #{impoKey} ,</if>
		    <if test='useYn != null'>useYn = #{useYn} ,</if>
			<if test='editUserId != null'>editUserId = #{editUserId} ,</if>
			<if test='editUserNm != null'>editUserNm = #{editUserNm} ,</if>
			<if test='editDtm != null'>editDtm = #{editDtm} ,</if>
		</trim>
		WHERE yogKey = #{yogKey}
	</update>
































    <select id="findImportDetailStatusList" resultType="map">
        /* 수입화물통관 디테일 조회 */
		SELECT a.Imlan_key, a.Imlan_seyul_gubun, a.Imlan_jechl_lan, a.Imlan_hs AS 'hdnImlanHs',
			SUBSTRING(a.Imlan_hs,1, 4) + '.' + SUBSTRING(a.Imlan_hs,5,2) + '-' + SUBSTRING(a.Imlan_hs,7,4) AS 'Imlan_hs', a.Imlan_gwan_seyula, a.Imlan_gurae_pum, a.Imlan_model,
			a.Imlan_gije1+a.Imlan_gije2+a.Imlan_gije3+a.Imlan_gije4+a.Imlan_gije5+a.Imlan_gije6+a.Imlan_gije7+a.Imlan_gije8+a.Imlan_gije9+a.Imlan_gije10 AS 'Imlan_gije3',
			a.Imlan_cost, a.Imlan_mulryang, a.Imlan_mulryang_danwi, a.Imlan_jung, a.Imlan_jung_danwi, a.Imlan_cif_won,
			a.Imlan_cif_usd, a.Imlan_gwan_tax, a.Imlan_vat_tax, a.Imlan_cs_gumsa1, a.imlan_fta_obj,
			a.Imlan_popum,  /* 표준품명 */
			a.Imlan_su, a.Imlan_su_danwi,  /* 수량 */
			a.Imlan_gwan_gyeng_yul, a.Imlan_gwan_seyula,  /* 관세감면 */
			a.Imlan_neguk_gubun, a.Imlan_neguk_code, a.Imlan_neguk_myun,  /* 내국세 */
			a.Imlan_edu_yn, a.Imlan_edu_seyul, a.Imlan_edu_tax, /* 교육세 */
			a.Imlan_plus,  /* 가산금 */
			a.Imlan_wonsanji_code, a.Imlan_wonsanji_name, a.Imlan_wonsanji_mark, a.Imlan_wonsanji_bang, a.Imlan_wonsanji_type,  /* 원산지 */
			a.Imlan_minus,  /* 공제금 */
			a.Imlan_wonsanji_no,  /* 원산지증명서 */
			a.Imlan_vat_gubun, a.Imlan_vat_gam_buho, a.Imlan_vat_gyeng_yul,  /* 란부가세 */
			b.Suipyogun_no
		FROM [ncustoms].[kcba].[Impo2] a WITH (NOLOCK)
			LEFT OUTER JOIN (
				SELECT a1.Suipyogun_key, a1.Suipyogun_lan,
					  SUBSTRING((SELECT ', ' + a2.SUIPYOGUN_NO
					  			FROM [ncustoms].[kcba].[Impo4] a2 WITH (NOLOCK)
					  			WHERE a2.Suipyogun_key = a1.Suipyogun_key
					  			AND a2.Suipyogun_lan = a1.Suipyogun_lan
					  			FOR XML PATH ('')), 3, 4000) AS 'SUIPYOGUN_NO'
				FROM [ncustoms].[kcba].[Impo4] a1 WITH (NOLOCK)
				WHERE a1.Suipyogun_key = #{strImlanKey}
				GROUP BY a1.Suipyogun_key, a1.Suipyogun_lan
			) b
			ON a.Imlan_key = b.Suipyogun_key
			AND a.Imlan_jechl_lan = b.Suipyogun_lan
		WHERE a.Imlan_key = #{strImlanKey}
		<if test='strInvoiceNo != "" and strInvoiceNo != null'>
			AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[impo3] a1 WITH (NOLOCK) WHERE a.Imlan_key=a1.Impum_key AND a.Imlan_jechl_lan=a1.Impum_lan AND a1.Impum_sungbun3 = #{strInvoiceNo})
		</if>
    </select>

    <select id="findImportSubDetailStatusList" resultType="map">
        /* 수입화물통관 서브디테일 조회 */
		SELECT a.Impum_key, a.Impum_lan, a.Impum_heang, a.Impum_jajae_code,
				a.Impum_gukyk1, a.Impum_gukyk2, a.Impum_gukyk3,	a.Impum_su, a.Impum_su_danwi,
				a.Impum_danga, a.Impum_Amt, a.Impum_sungbun1, a.Impum_sungbun2,
				a.Impum_sungbun3,
				a.Impum_ivno, a.impum_contactno,
				SUBSTRING(a.impum_chamjo_no, 0, CHARINDEX('-', a.impum_chamjo_no)) AS 'impum_Dept',
				SUBSTRING(a.impum_chamjo_no, CHARINDEX('-', a.impum_chamjo_no)+1, LEN(a.impum_chamjo_no)) AS 'impum_GoodsYn',
				ISNULL(b.cifwon,0) AS 'cifwon', ISNULL(b.fre,0) AS 'fre', ISNULL(b.ins,0) AS 'ins', ISNULL(b.plus,0) AS 'plus', ISNULL(b.duty,0) AS 'duty',
				ISNULL(b.tk,0) AS 'tk', ISNULL(b.kt,0) AS 'kt', ISNULL(b.ju,0) AS 'ju', ISNULL(b.edu,0) AS 'edu', ISNULL(b.nong,0) AS 'nong',
				ISNULL(b.vat,0) AS 'vat', ISNULL(b.tax,0) AS 'tax', ISNULL(b.vat_g,0) AS 'vat_g', ISNULL(b.gasan,0) AS 'gasan', ISNULL(b.misingo,0) AS 'misingo',
				c.Suipyogun_no
		FROM [ncustoms].[kcba].[Impo3] a WITH (NOLOCK)
				LEFT OUTER JOIN [ncustoms].[kcba].[Impo3_M] b WITH (NOLOCK)
				ON a.Impum_key=b.Impum_key
				AND a.Impum_lan=b.Impum_lan
				AND a.Impum_heang=b.Impum_heang
				LEFT OUTER JOIN (
					SELECT a1.SUIPYOGUN_KEY, a1.SUIPYOGUN_LAN, a1.SUIPYOGUN_HEANG,
						  SUBSTRING((SELECT ', ' + a2.SUIPYOGUN_NO
						  			FROM [ncustoms].[kcba].[Impo41] a2 WITH (NOLOCK)
						  			WHERE a2.SUIPYOGUN_KEY = a1.SUIPYOGUN_KEY
						  			AND a2.SUIPYOGUN_LAN = a1.SUIPYOGUN_LAN
						  			AND a2.SUIPYOGUN_HEANG = a1.SUIPYOGUN_HEANG
						  			FOR XML PATH ('')), 3, 4000) AS 'SUIPYOGUN_NO'
					FROM [ncustoms].[kcba].[Impo41] a1 WITH (NOLOCK)
					WHERE a1.SUIPYOGUN_KEY = #{strImpumKey}
					AND a1.SUIPYOGUN_LAN = #{strImpumLan}
					GROUP BY a1.SUIPYOGUN_KEY, a1.SUIPYOGUN_LAN, a1.SUIPYOGUN_HEANG
				) c
				ON a.Impum_key = c.SUIPYOGUN_KEY
				AND a.Impum_lan = c.SUIPYOGUN_LAN
				AND a.Impum_heang = c.SUIPYOGUN_HEANG
		WHERE a.Impum_key = #{strImpumKey}
		AND a.Impum_lan = #{strImpumLan}
    </select>

    <select id="findImportMasterByNotRegisteredCheckList" resultType="map">
        /* 수입통관(Impo1) 미등록 체크리스트 조회 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.Impo_key DESC) AS 'rownum',
        a.Impo_key, a.Impo_receive_result, a.impo_cs, a.Impo_napse_sangho, a.Impo_bl_no, a.Impo_singo_no,
        a.Impo_iphang_date, a.impo_singo_date, a.impo_Ok_date, a.Impo_banip_date, LEFT(ISNULL(a.Impo_jubsu_date, ''), 8) AS 'Impo_jubsu_date',
        a.Impo_file_no1, a.Impo_gonggub_sangho, a.Impo_jukchl_name, a.Impo_hanggu_name, a.Impo_jangch_name,
        a.Impo_pojang_su, a.Impo_total_jung, a.Impo_Forwarder_sangho,
        a.impo_Gyelje_Input, a.Impo_total_tax,
        a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_gwan_tax, a.Impo_vat_tax, a.Impo_mbl_no,
        a.Impo_indo_jogun, a.Impo_gyelje_money, Impo_gyelje,
        (a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax'
        FROM [ncustoms_pj].[kcba].[Impo1] a WITH (NOLOCK)
        <where>
            AND a.Impo_napse_saup = #{geowsTaxNum}
            AND NOT EXISTS (SELECT *
            FROM [GEOWS].[dbo].[TBR_Inventory_Master] WITH (NOLOCK)
            WHERE imsImDeclarationNo = a.Impo_singo_no
            AND imsInputType = 'Z' )
            AND ISNULL(a.Impo_ok_date, '') != ''
            <if test='_isCustomsStock != null and _isCustomsStock != ""'>AND a.Impo_singo_date <![CDATA[ >= ]]> #{_isCustomsStock} /* 시스템사용시작일 */</if>
            <if test='impoBlNo != null and impoBlNo != ""'>AND a.Impo_bl_no LIKE '%' + #{impoBlNo} + '%' /* BL번호 */</if>
            <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%' /* 신고번호 */</if>
            <if test='impoFileNo1 != null and impoFileNo1 != ""'>AND a.Impo_file_no1 LIKE '%' + #{impoFileNo1} + '%' /* Ref_no1(Entity) */</if>
            <if test='impoFileNo2 != null and impoFileNo2 != ""'>AND a.Impo_file_no2 LIKE '%' + #{impoFileNo2} + '%' /* Ref_no2(Vendor) */</if>
            <if test='impoNapseSangho != null and impoNapseSangho != ""'>AND a.Impo_napse_sangho LIKE '%' + #{impoNapseSangho} + '%' /* 납세자상호 */</if>
            <if test='_dateType != null and _dateType != "ALL" and (startDay != null and startDay != "") and (endDay != null and endDay != "")'>
                <choose>
                    <when test='_dateType == "Impo_iphang_date_Day"'>AND a.Impo_iphang_date BETWEEN #{startDay} AND #{endDay} /* 입항일 */</when>
                    <when test='_dateType == "Impo_singo_date_Day"'>AND a.Impo_singo_date BETWEEN #{startDay} AND #{endDay} /* 통관신고일 */</when>
                    <when test='_dateType == "Impo_ok_date_Day"'>AND a.Impo_ok_date BETWEEN #{startDay} AND #{endDay} /* 통관수리일 */</when>
                    <when test='_dateType == "Impo_banip_date_Day"'>AND a.Impo_banip_date BETWEEN #{startDay} AND #{endDay} /* 반입일 */</when>
                    <when test='_dateType == "Impo_jubsu_date_Day"'>AND LEFT(a.Impo_jubsu_date, 8) BETWEEN #{startDay} AND #{endDay} /* 접수일 */</when>
                </choose>
            </if>
            <if test='impoReceiveResult != null and impoReceiveResult != "" and impoReceiveResult != "ALL"'>AND ISNULL(a.Impo_receive_result, '') LIKE #{impoReceiveResult} + '%' /* status */</if>
            <if test='impumSungbun3 != null and impumSungbun3 != ""'>AND EXISTS ( SELECT *
                FROM [ncustoms_pj].[kcba].[Impo3] d1 WITH (NOLOCK)
                WHERE d1.Impum_key = a.Impo_key
                AND d1.Impum_sungbun3 LIKE '%' + #{impumSungbun3} + '%' ) /* 성분3(워크오더번호) */
            </if>
            <if test='isNotRegisteredItemMaster != null and isNotRegisteredItemMaster != ""'>
                <choose>
                    <when test='isNotRegisteredItemMaster == "Y"'>AND EXISTS ( SELECT *
                        FROM [ncustoms_pj].[kcba].[Impo3] d1 WITH (NOLOCK)
                        WHERE d1.Impum_key = a.Impo_key
                        AND NOT EXISTS ( SELECT *
                        FROM CPS.[dbo].[MAAA100] d2 WITH (NOLOCK)
                        WHERE d2.Mco_com = #{geowsTaxNum}
                        AND d2.Mmodel_code = d1.Impum_jajae_code
                        AND d2.useYn = 'Y' ) ) /* 자재마스터 미등록 */
                    </when>
                </choose>
            </if>
            <if test='isNotRegisteredWorkOrderMaster != null and isNotRegisteredWorkOrderMaster != ""'>
                <choose>
                    <when test='isNotRegisteredWorkOrderMaster == "Y"'>AND EXISTS ( SELECT *
                        FROM [ncustoms_pj].[kcba].[Impo3] e1 WITH (NOLOCK)
                        INNER JOIN [ncustoms_pj].[kcba].[Impo1] e2 WITH (NOLOCK)
                        ON e1.Impum_key = e2.Impo_key
                        AND e2.Impo_napse_saup = #{geowsTaxNum}
                        AND NOT EXISTS ( SELECT *
                        FROM [GEOWS].[dbo].[TBR_Inventory_Master] WITH (NOLOCK)
                        WHERE imsImDeclarationNo = e2.Impo_singo_no
                        AND imsInputType = 'Z')
                        AND ISNULL(e2.Impo_ok_date, '') != ''
                        AND e1.Impum_key = a.Impo_key
                        <if test='_isCustomsStock != null and _isCustomsStock != ""'>AND a.Impo_singo_date <![CDATA[ >= ]]> #{_isCustomsStock} /* 시스템사용시작일 */</if>
                        WHERE NOT EXISTS ( SELECT *
                        FROM [GEOWS].[dbo].[TBR_Order_WorkOrder] e3 WITH (NOLOCK)
                        WHERE e3.workOrderNum = e1.Impum_sungbun3
                        AND e3.useYn = 'Y' ) ) /* 워크오더 미등록 */
                    </when>
                </choose>
            </if>
        </where>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="findImportDetailByNotRegisteredCheckList" resultType="map">
        /* 수입통관(Impo3) 미등록 체크리스트 조회 */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.Impum_key, a.Impum_lan, a.Impum_heang) AS 'rownum',
        a.*
        FROM [ncustoms_pj].[kcba].[Impo3] a WITH (NOLOCK)
        <where>
            AND a.Impum_key = #{impumKey}
            <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND a.Impum_jajae_code = #{impumJajaeCode}</if>
            <if test='isNotRegisteredItemMaster != null and isNotRegisteredItemMaster != ""'>
                <choose>
                    <when test='isNotRegisteredItemMaster == "Y"'>
                        AND NOT EXISTS ( SELECT *
                        FROM CPS.[dbo].[MAAA100] a1 WITH (NOLOCK)
                        WHERE a1.Mco_com = #{geowsTaxNum}
                        AND a1.Mmodel_code = a.Impum_jajae_code
                        AND a1.useYn = 'Y' ) /* 자재마스터 미등록 */
                    </when>
                </choose>
            </if>
            <if test='isNotRegisteredWorkOrderMaster != null and isNotRegisteredWorkOrderMaster != ""'>
                <choose>
                    <when test='isNotRegisteredWorkOrderMaster == "Y"'>
                        AND NOT EXISTS ( SELECT *
                        FROM [GEOWS].[dbo].[TBR_Order_WorkOrder] b1 WITH (NOLOCK)
                        WHERE b1.workOrderNum = a.Impum_sungbun3
                        AND b1.useYn = 'Y' ) /* 워크오더 미등록 */
                    </when>
                </choose>
            </if>
        </where>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <select id="selectImpoCostMasterList" resultType="map">
		/* 비용관리 마스터 조회 */
		SELECT a.Impo_key,
				a.Vendor,
				a.수입신고번호,
				a.BL번호,
				a.MBL번호,
				a.수리일,
				a.입항일,
				a.반입일,
				a.신고일,
				a.[hidden Invoice Amount] AS 'hidden Invoice Amount',
				a.[Invoice Amount] AS 'Invoice Amount',
				a.Impo_gyelje_money,
				a.Impo_exch_yul,
				a.calculateInvoiceAmount,
				a.Impo_Segwan,
				a.과세운임,
				a.과세가격,
				a.관세,
				a.부가세,
				a.기타세,
				a.총세액,
				SUM(a.C090) AS 'C090',
				SUM(a.C108) AS 'C108',
				SUM(a.C117) AS 'C117',
				SUM(a.C125) AS 'C125',
				SUM(a.C086) AS 'C086',
				SUM(a.C107) AS 'C107',
				SUM(a.C097) AS 'C097',
				SUM(a.C018) AS 'C018',
				SUM(a.C026) AS 'C026',
				SUM(a.C043) AS 'C043',
				SUM(a.C014) AS 'C014',
				SUM(a.C084) AS 'C084',
				SUM(a.C124) AS 'C124',
				SUM(a.C094) AS 'C094',
				SUM(a.C079) AS 'C079',
				SUM(a.C110) AS 'C110',
				SUM(a.C060) AS 'C060',
				SUM(a.C013) AS 'C013',
				SUM(a.C080) AS 'C080',
				SUM(a.C019) AS 'C019',
				SUM(a.C023) AS 'C023',
				SUM(a.C005) AS 'C005',
				SUM(a.C120) AS 'C120',
				SUM(a.C006) AS 'C006',
				SUM(a.합계금액) AS '합계금액',
				SUM(a.confCount) AS 'confCount',
				SUM(a.totalImpo1MDtlCount) AS 'totalImpo1MDtlCount',
				CASE WHEN (SUM(a.totalImpo1MDtlCount) > 0 AND SUM(a.totalImpo1MDtlCount) = SUM(a.confCount)) THEN 'Y' ELSE 'N' END '정산확정',
				a.impo_jingsu_type
		FROM	(
					SELECT	a.Impo_key,
							a.Impo_Gonggub_Sangho AS 'Vendor',
							SUBSTRING(a.impo_singo_no, 1,5) + '-' + SUBSTRING(a.impo_singo_no, 6,2) + '-' + SUBSTRING(a.impo_singo_no, 8,7) AS '수입신고번호',
							a.impo_bl_no AS 'BL번호',
							a.impo_mbl_no AS 'MBL번호',
							CASE WHEN ISNULL(a.impo_singo_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.impo_singo_date),120) END AS '수리일',
							CASE WHEN ISNULL(a.Impo_iphang_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.Impo_iphang_date),120) END AS '입항일',
							CASE WHEN ISNULL(a.Impo_banip_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.Impo_banip_date),120) END AS '반입일',
							CASE WHEN ISNULL(a.impo_singo_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.impo_singo_date),120) END  AS '신고일',
							a.Impo_gyelje_input AS 'hidden Invoice Amount',
							a.Impo_gyelje_input AS 'Invoice Amount',
							a.Impo_gyelje_money,
							a.Impo_exch_yul,
							CASE WHEN a.Impo_gyelje_money = 'KRW' THEN a.Impo_gyelje_input ELSE (a.Impo_gyelje_input * a.Impo_exch_yul) END AS 'calculateInvoiceAmount',
							a.Impo_Segwan,
							a.Impo_fre_won AS '과세운임',
							a.Impo_cif_total_won AS '과세가격',
							a.Impo_gwan_tax AS '관세',
							a.Impo_vat_tax AS '부가세',
							(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS '기타세',
							a.Impo_total_tax AS '총세액',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C090' THEN b.sup_ek ELSE 0 END AS 'C090',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C108' THEN b.sup_ek ELSE 0 END AS 'C108',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C117' THEN b.sup_ek ELSE 0 END AS 'C117',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C125' THEN b.sup_ek ELSE 0 END AS 'C125',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C086' THEN b.sup_ek ELSE 0 END AS 'C086',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C107' THEN b.sup_ek ELSE 0 END AS 'C107',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C097' THEN b.sup_ek ELSE 0 END AS 'C097',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C018' THEN b.sup_ek ELSE 0 END AS 'C018',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C026' THEN b.sup_ek ELSE 0 END AS 'C026',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C043' THEN b.sup_ek ELSE 0 END AS 'C043',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C014' THEN b.sup_ek ELSE 0 END AS 'C014',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C084' THEN b.sup_ek ELSE 0 END AS 'C084',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C124' THEN b.sup_ek ELSE 0 END AS 'C124',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C094' THEN b.sup_ek ELSE 0 END AS 'C094',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C079' THEN b.sup_ek ELSE 0 END AS 'C079',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C110' THEN b.sup_ek ELSE 0 END AS 'C110',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C060' THEN b.sup_ek ELSE 0 END AS 'C060',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C013' THEN b.sup_ek ELSE 0 END AS 'C013',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C080' THEN b.sup_ek ELSE 0 END AS 'C080',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C019' THEN b.sup_ek ELSE 0 END AS 'C019',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C023' THEN b.sup_ek ELSE 0 END AS 'C023',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C005' THEN b.sup_ek ELSE 0 END AS 'C005',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C120' THEN b.sup_ek ELSE 0 END AS 'C120',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C006' THEN b.sup_ek ELSE 0 END AS 'C006',
							SUM(ISNULL(b.sup_ek,0)) AS '합계금액',
							SUM(CASE WHEN b.confYn = 'Y' THEN 1 ELSE 0 END) AS 'confCount',
							COUNT(b.KEY_impo1_mDtl) AS 'totalImpo1MDtlCount',
							a.impo_jingsu_type
					FROM [ncustoms].[kcba].[impo1] a WITH (NOLOCK)
						LEFT OUTER JOIN [ncustoms].[kcba].[impo1_mDtl] b WITH (NOLOCK)
						ON a.Impo_key=b.Impo_key
						<if test='strAccDt != "" and strAccDt != null'>AND b.acc_dt = #{strAccDt}</if>
					WHERE a.Impo_napse_saup = #{saup}
					<if test='strEntity != "" and strEntity != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] dd WITH (NOLOCK) WHERE a.Impo_key = dd.Impum_Key AND dd.Impum_jajae_code LIKE #{strEntity} + '%' )
					</if>
					<if test='strEntityList != "" and strEntityList != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] ddd WITH (NOLOCK) WHERE a.Impo_key = ddd.Impum_Key AND ddd.Impum_jajae_code IN ${strEntityList} )
					</if>
					<if test='strVendor != "" and strVendor != null'>AND a.Impo_Gonggub_Sangho LIKE '%' + #{strVendor} + '%'</if>
					<if test='sType != "ALL" and sType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
			             <choose>
			                <when test='sType == "Impo_iphang_date"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='sType == "Impo_banip_date"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='sType == "Impo_singo_date"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='sType == "Impo_ok_date"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			              </choose>
			        </if>
			        <if test='strSingoDelay != "ALL" and strSingoDelay != null'>
			             <choose>
			                <when test='strSingoDelay == "SINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') != ''</when>
			                <when test='strSingoDelay == "MISINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') = ''</when>
			              </choose>
			        </if>
			        <if test='strSegwanDelay != "ALL" and strSegwanDelay != null'>
			             <choose>
			                <when test='strSegwanDelay == "SIMSA"'>
			                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
			                    AND ISNULL(a.Impo_ok_date,'') != ''
			                </when>
			                <when test='strSegwanDelay == "MISIMSA"'>
			                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
			                    AND ISNULL(a.Impo_ok_date,'') = ''
			                </when>
			              </choose>
			        </if>
					<if test='strSingoNo != "" and strSingoNo != null'>AND a.impo_singo_no LIKE '%' + #{strSingoNo} + '%'</if>
					<if test='strBlNo != "" and strBlNo != null'>AND a.impo_bl_no LIKE '%' + #{strBlNo} + '%'</if>
					<if test='strInvoiceNo != "" and strInvoiceNo != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[impo3] a1 WITH (NOLOCK) WHERE a.Impo_key=a1.Impum_key AND a1.Impum_ivno = #{strInvoiceNo})
					</if>
					<if test='strAccNm != "" and strAccNm != null'>AND b.acc_Nm LIKE '%' + #{strAccNm} + '%'</if>
					<if test='strAccDt != "" and strAccDt != null'>
						AND a.Impo_key IN (SELECT Impo_key FROM [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK) WHERE acc_dt = #{strAccDt})
					</if>
					<if test='sType != "ALL" and sType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
						<choose>
							<when test='sType == "Impum_Invoice_date"'>
								AND a.Impo_key IN (SELECT Impo_key
													FROM [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK)
													WHERE impum_contactno BETWEEN #{strFromDate} AND #{strToDate}
													)
							</when>
						</choose>
					</if>
					<if test='strYogunNum != "" and strYogunNum != null'>
						AND EXISTS ( SELECT *
									FROM [ncustoms].[kcba].[impo41] h WITH (NOLOCK)
			     					WHERE h.SUIPYOGUN_KEY = a.Impo_key
			     					AND h.SUIPYOGUN_NO = #{strYogunNum} )
			        </if>
					GROUP BY a.Impo_key,
							a.Impo_Gonggub_Sangho,
							SUBSTRING(a.impo_singo_no, 1,5) + '-' + SUBSTRING(a.impo_singo_no, 6,2) + '-' + SUBSTRING(a.impo_singo_no, 8,7),
							a.impo_bl_no,
							a.impo_mbl_no,
							CASE WHEN ISNULL(a.impo_singo_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.impo_singo_date),120) END,
							CASE WHEN ISNULL(a.Impo_iphang_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.Impo_iphang_date),120) END,
							CASE WHEN ISNULL(a.Impo_banip_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.Impo_banip_date),120) END,
							a.Impo_gyelje_input,
							a.Impo_gyelje_money,
							a.Impo_exch_yul,
							a.Impo_Segwan,
							a.Impo_fre_won,
							a.Impo_cif_total_won,
							a.Impo_gwan_tax,
							a.Impo_vat_tax,
							(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)),
							a.Impo_total_tax,
							ISNULL(b.ADJ_CD,''),
							b.sup_ek,
							a.impo_jingsu_type
				) a

		GROUP BY a.Impo_key,
				a.Vendor,
				a.수입신고번호,
				a.BL번호,
				a.MBL번호,
				a.수리일,
				a.입항일,
				a.반입일,
				a.신고일,
				a.[hidden Invoice Amount],
				a.[Invoice Amount],
				a.Impo_gyelje_money,
				a.Impo_exch_yul,
				a.calculateInvoiceAmount,
				a.Impo_Segwan,
				a.과세운임,
				a.과세가격,
				a.관세,
				a.부가세,
				a.기타세,
				a.총세액,
				a.impo_jingsu_type
		ORDER BY a.Impo_key
	</select>

    <select id="selectImpoCostMasterForExcelList" resultType="map">
		/* 비용관리 마스터 조회(엑셀) */
		SELECT
				a.Impo_key,
				a.impo_singo_no, a.impo_Indo_Jogun, a.Impo_bl_no,
				a.Impum_ivno, a.impum_contactno,
				a.impo_Gyelje_Money, a.Impum_amt, a.Impo_unsong_type, a.calculateInvoiceAmount,
				a.impo_ok_date, a.impo_jingsu_type, a.impo_Forwarder_sangho, a.Impo_Gonggub,
				a.invoiceAmt,
				a.duty, a.otherTax,
				a.vat, a.tax,
				a.Impum_su, a.Impo_Segwan,
				a.impum_Dept, a.impum_GoodsYn,

				SUM(a.C005) AS 'C005',
				SUM(a.C120) AS 'C120',
				SUM(a.C086) AS 'C086',
				SUM(a.C006) AS 'C006',
				SUM(a.C090) AS 'C090',
				SUM(a.C014) AS 'C014',
				SUM(a.C018) AS 'C018',
				SUM(a.C097) AS 'C097',
				SUM(a.C080) AS 'C080',
				SUM(a.C026) AS 'C026',

				SUM(a.합계금액) AS '합계금액'
		FROM	(
					SELECT  a.Impo_key,
							a.impo_singo_no, a.impo_Indo_Jogun, a.Impo_bl_no,
							c.Impum_ivno, c.impum_contactno,
							a.impo_Gyelje_Money, c.Impum_amt, a.Impo_unsong_type,
							CASE WHEN a.Impo_gyelje_money = 'KRW' THEN a.Impo_gyelje_input ELSE (a.Impo_gyelje_input * a.Impo_exch_yul) END AS 'calculateInvoiceAmount',
							a.impo_ok_date, a.impo_jingsu_type, a.impo_Forwarder_sangho, a.Impo_Gonggub,
							(ISNULL(c.Impum_amt,0) * ISNULL(a.Impo_exch_yul,0)) AS 'invoiceAmt',
							ISNULL(d.duty, 0) AS 'duty', ISNULL(d.TK,0)+ISNULL(d.kt,0)+ISNULL(d.ju,0)+ISNULL(d.edu,0)+ISNULL(d.nong,0) AS 'otherTax',
							ISNULL(d.vat,0) AS 'vat', ISNULL(d.tax, 0) AS 'tax',
							c.Impum_su, a.Impo_Segwan,
							SUBSTRING(c.impum_chamjo_no, 0, CHARINDEX('-', c.impum_chamjo_no)) AS 'impum_Dept',
							SUBSTRING(c.impum_chamjo_no, CHARINDEX('-', c.impum_chamjo_no)+1, LEN(c.impum_chamjo_no)) AS 'impum_GoodsYn',

							CASE WHEN ISNULL(b.ADJ_CD,'')='C005' THEN b.sup_ek ELSE 0 END AS 'C005',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C120' THEN b.sup_ek ELSE 0 END AS 'C120',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C086' THEN b.sup_ek ELSE 0 END AS 'C086',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C006' THEN b.sup_ek ELSE 0 END AS 'C006',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C090' THEN b.sup_ek ELSE 0 END AS 'C090',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C014' THEN b.sup_ek ELSE 0 END AS 'C014',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C018' THEN b.sup_ek ELSE 0 END AS 'C018',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C097' THEN b.sup_ek ELSE 0 END AS 'C097',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C080' THEN b.sup_ek ELSE 0 END AS 'C080',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C026' THEN b.sup_ek ELSE 0 END AS 'C026',

							SUM(ISNULL(b.sup_ek,0)) AS '합계금액'

					FROM [ncustoms].[kcba].[impo1] a WITH (NOLOCK)
						LEFT OUTER JOIN [ncustoms].[kcba].[impo1_mDtl] b WITH (NOLOCK)
						ON a.Impo_key=b.Impo_key
						<if test='strAccDt != "" and strAccDt != null'>AND b.acc_dt = #{strAccDt}</if>

						INNER JOIN [ncustoms].[kcba].[impo3] c WITH (NOLOCK)
						ON a.impo_key = c.impum_key
							LEFT OUTER JOIN [ncustoms].[kcba].[impo3_m] d WITH (NOLOCK)
							ON c.Impum_key=d.Impum_key
							AND c.Impum_lan=d.Impum_lan
							AND c.Impum_heang=d.Impum_heang

					WHERE a.Impo_napse_saup = #{saup}
					<if test='strEntity != "" and strEntity != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] dd WITH (NOLOCK) WHERE a.Impo_key = dd.Impum_Key AND dd.Impum_jajae_code LIKE #{strEntity} + '%' )
					</if>
					<if test='strEntityList != "" and strEntityList != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] ddd WITH (NOLOCK) WHERE a.Impo_key = ddd.Impum_Key AND ddd.Impum_jajae_code IN ${strEntityList} )
					</if>
					<if test='strVendor != "" and strVendor != null'>AND a.Impo_Gonggub_Sangho LIKE '%' + #{strVendor} + '%'</if>
					<if test='sType != "ALL" and sType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
			             <choose>
			                <when test='sType == "Impo_iphang_date"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='sType == "Impo_banip_date"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='sType == "Impo_singo_date"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='sType == "Impo_ok_date"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			              </choose>
			        </if>
			        <if test='strSingoDelay != "ALL" and strSingoDelay != null'>
			             <choose>
			                <when test='strSingoDelay == "SINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') != ''</when>
			                <when test='strSingoDelay == "MISINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') = ''</when>
			              </choose>
			        </if>
			        <if test='strSegwanDelay != "ALL" and strSegwanDelay != null'>
			             <choose>
			                <when test='strSegwanDelay == "SIMSA"'>
			                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
			                    AND ISNULL(a.Impo_ok_date,'') != ''
			                </when>
			                <when test='strSegwanDelay == "MISIMSA"'>
			                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
			                    AND ISNULL(a.Impo_ok_date,'') = ''
			                </when>
			              </choose>
			        </if>
					<if test='strSingoNo != "" and strSingoNo != null'>AND a.impo_singo_no LIKE '%' + #{strSingoNo} + '%'</if>
					<if test='strBlNo != "" and strBlNo != null'>AND a.impo_bl_no LIKE '%' + #{strBlNo} + '%'</if>
					<if test='strInvoiceNo != "" and strInvoiceNo != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[impo3] a1 WITH (NOLOCK) WHERE a.Impo_key=a1.Impum_key AND a1.Impum_ivno = #{strInvoiceNo})
					</if>
					<if test='strAccNm != "" and strAccNm != null'>AND b.acc_Nm LIKE '%' + #{strAccNm} + '%'</if>
					<if test='strAccDt != "" and strAccDt != null'>
						AND a.Impo_key IN (SELECT Impo_key FROM [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK) WHERE acc_dt = #{strAccDt})
					</if>
					<if test='sType != "ALL" and sType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
						<choose>
							<when test='sType == "Impum_Invoice_date"'>
								AND a.Impo_key IN (SELECT Impo_key
													FROM [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK)
													WHERE impum_contactno BETWEEN #{strFromDate} AND #{strToDate}
													)
							</when>
						</choose>
					</if>
					<if test='strYogunNum != "" and strYogunNum != null'>
						AND EXISTS ( SELECT *
									FROM [ncustoms].[kcba].[impo41] h WITH (NOLOCK)
			     					WHERE h.SUIPYOGUN_KEY = a.Impo_key
			     					AND h.SUIPYOGUN_NO = #{strYogunNum} )
			        </if>
					GROUP BY a.Impo_key, a.impo_singo_no, a.impo_Indo_Jogun, a.Impo_bl_no,
							c.Impum_ivno, c.impum_contactno,
							a.impo_Gyelje_Money, c.Impum_amt, a.Impo_unsong_type,
							CASE WHEN a.Impo_gyelje_money = 'KRW' THEN a.Impo_gyelje_input ELSE (a.Impo_gyelje_input * a.Impo_exch_yul) END,
							a.impo_ok_date, a.impo_jingsu_type, a.impo_Forwarder_sangho, a.Impo_Gonggub,
							(ISNULL(c.Impum_amt,0) * ISNULL(a.Impo_exch_yul,0)),
							ISNULL(d.duty, 0), ISNULL(d.TK,0)+ISNULL(d.kt,0)+ISNULL(d.ju,0)+ISNULL(d.edu,0)+ISNULL(d.nong,0),
							ISNULL(d.vat,0), ISNULL(d.tax, 0),
							c.Impum_su, a.Impo_Segwan, c.impum_chamjo_no,
							ISNULL(b.ADJ_CD,''), b.sup_ek
				) a

		GROUP BY a.Impo_key,
				a.impo_singo_no, a.impo_Indo_Jogun, a.Impo_bl_no,
				a.Impum_ivno, a.impum_contactno,
				a.impo_Gyelje_Money, a.Impum_amt, a.Impo_unsong_type, a.calculateInvoiceAmount,
				a.impo_ok_date, a.impo_jingsu_type, a.impo_Forwarder_sangho, a.Impo_Gonggub,
				a.invoiceAmt,
				a.duty, a.otherTax,
				a.vat, a.tax,
				a.Impum_su, a.Impo_Segwan,
				a.impum_Dept, a.impum_GoodsYn
		ORDER BY a.Impo_key
	</select>

    <select id="selectImpoCostMasterImpoBlNoList" resultType="map">
		/* 비용관리 마스터 BL별 조회 */
		SELECT	a.impo_bl_no,
				SUM(a.Impo_gyelje_input) AS 'Impo_gyelje_input',
				CASE WHEN a.Impo_gyelje_money = 'KRW' THEN SUM(a.Impo_gyelje_input) ELSE SUM(a.Impo_gyelje_input * a.Impo_exch_yul) END AS 'calculateInvoiceAmount',
				SUM(a.Impo_fre_won) AS 'Impo_fre_won',
				SUM(a.Impo_cif_total_won) AS 'Impo_cif_total_won',
				SUM(a.Impo_gwan_tax) AS 'Impo_gwan_tax',
				SUM(a.Impo_vat_tax) AS 'Impo_vat_tax',
				SUM(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS '기타세',
				SUM(a.Impo_total_tax) AS 'Impo_total_tax',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C090' THEN SUM(b.sup_ek) ELSE 0 END AS 'C090',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C108' THEN SUM(b.sup_ek) ELSE 0 END AS 'C108',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C117' THEN SUM(b.sup_ek) ELSE 0 END AS 'C117',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C125' THEN SUM(b.sup_ek) ELSE 0 END AS 'C125',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C086' THEN SUM(b.sup_ek) ELSE 0 END AS 'C086',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C107' THEN SUM(b.sup_ek) ELSE 0 END AS 'C107',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C097' THEN SUM(b.sup_ek) ELSE 0 END AS 'C097',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C018' THEN SUM(b.sup_ek) ELSE 0 END AS 'C018',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C026' THEN SUM(b.sup_ek) ELSE 0 END AS 'C026',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C043' THEN SUM(b.sup_ek) ELSE 0 END AS 'C043',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C014' THEN SUM(b.sup_ek) ELSE 0 END AS 'C014',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C084' THEN SUM(b.sup_ek) ELSE 0 END AS 'C084',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C124' THEN SUM(b.sup_ek) ELSE 0 END AS 'C124',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C094' THEN SUM(b.sup_ek) ELSE 0 END AS 'C094',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C079' THEN SUM(b.sup_ek) ELSE 0 END AS 'C079',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C110' THEN SUM(b.sup_ek) ELSE 0 END AS 'C110',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C060' THEN SUM(b.sup_ek) ELSE 0 END AS 'C060',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C013' THEN SUM(b.sup_ek) ELSE 0 END AS 'C013',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C080' THEN SUM(b.sup_ek) ELSE 0 END AS 'C080',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C019' THEN SUM(b.sup_ek) ELSE 0 END AS 'C019',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C023' THEN SUM(b.sup_ek) ELSE 0 END AS 'C023',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C005' THEN SUM(b.sup_ek) ELSE 0 END AS 'C005',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C120' THEN SUM(b.sup_ek) ELSE 0 END AS 'C120',
				CASE WHEN ISNULL(b.ADJ_CD,'')='C006' THEN SUM(b.sup_ek) ELSE 0 END AS 'C006',
				SUM(ISNULL(b.sup_ek,0)) AS '합계금액'
		FROM [ncustoms].[kcba].[impo1] a WITH (NOLOCK)
			LEFT OUTER JOIN [ncustoms].[kcba].[impo1_mDtl] b WITH (NOLOCK)
			ON a.Impo_key=b.Impo_key
			<if test='strAccDt != "" and strAccDt != null'>AND b.acc_dt = #{strAccDt}</if>
		WHERE a.Impo_napse_saup = #{saup}
		<if test='strEntity != "" and strEntity != null'>
			AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] dd WITH (NOLOCK) WHERE a.Impo_key = dd.Impum_Key AND dd.Impum_jajae_code LIKE '%' + #{strEntity} + '%' )
		</if>
		<if test='strEntityList != "" and strEntityList != null'>
			AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] ddd WITH (NOLOCK) WHERE a.Impo_key = ddd.Impum_Key AND ddd.Impum_jajae_code IN ${strEntityList} )
		</if>
		<if test='strVendor != "" and strVendor != null'>AND a.Impo_Gonggub_Sangho LIKE '%' + #{strVendor} + '%'</if>
		<if test='sType != "ALL" and sType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
             <choose>
                <when test='sType == "Impo_iphang_date"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='sType == "Impo_banip_date"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='sType == "Impo_singo_date"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='sType == "Impo_ok_date"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
              </choose>
        </if>
        <if test='strSingoDelay != "ALL" and strSingoDelay != null'>
             <choose>
                <when test='strSingoDelay == "SINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') != ''</when>
                <when test='strSingoDelay == "MISINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') = ''</when>
              </choose>
        </if>
        <if test='strSegwanDelay != "ALL" and strSegwanDelay != null'>
             <choose>
                <when test='strSegwanDelay == "SIMSA"'>
                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
                    AND ISNULL(a.Impo_ok_date,'') != ''
                </when>
                <when test='strSegwanDelay == "MISIMSA"'>
                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
                    AND ISNULL(a.Impo_ok_date,'') = ''
                </when>
              </choose>
        </if>
		<if test='strSingoNo != "" and strSingoNo != null'>AND a.impo_singo_no LIKE '%' + #{strSingoNo} + '%'</if>
		<if test='strBlNo != "" and strBlNo != null'>AND a.impo_bl_no LIKE '%' + #{strBlNo} + '%'</if>
		<if test='strInvoiceNo != "" and strInvoiceNo != null'>
			AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[impo3] a1 WITH (NOLOCK) WHERE a.Impo_key=a1.Impum_key AND a1.Impum_ivno = #{strInvoiceNo})
		</if>
		<if test='strAccNm != "" and strAccNm != null'>AND b.acc_Nm LIKE '%' + #{strAccNm} + '%'</if>
		<if test='strAccDt != "" and strAccDt != null'>
			AND a.Impo_key IN (SELECT Impo_key FROM [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK) WHERE acc_dt = #{strAccDt})
		</if>
		<if test='sType != "ALL" and sType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
			<choose>
				<when test='sType == "Impum_Invoice_date"'>
					AND a.Impo_key IN (SELECT Impo_key
										FROM [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK)
										WHERE impum_contactno BETWEEN #{strFromDate} AND #{strToDate}
										)
				</when>
			</choose>
		</if>
		<if test='strYogunNum != "" and strYogunNum != null'>
			AND EXISTS ( SELECT *
						FROM [ncustoms].[kcba].[impo41] h WITH (NOLOCK)
     					WHERE h.SUIPYOGUN_KEY = a.Impo_key
     					AND h.SUIPYOGUN_NO = #{strYogunNum} )
        </if>
		GROUP BY a.impo_bl_no, a.Impo_gyelje_money, ISNULL(b.ADJ_CD,'')
		ORDER BY a.impo_bl_no
	</select>

    <select id="selectImpoCompanySumData" resultType="map">
	    /* 회사별 월 청구비용합계 */
	    SELECT LTRIM(RTRIM(b.회사)) AS '회사', b.청구처구분 AS '청구처구분', SUM(b.회사별합계) AS '회사별월청구비용합계'
	    FROM [ncustoms].[kcba].[impo1] a WITH (NOLOCK)
	   			INNER JOIN (
								SELECT Impo_key, acc_nm AS '회사', ADJ_GR_CD AS '청구처구분', SUM(sup_ek) AS '회사별합계'
								FROM [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK)
								WHERE acc_dt = #{strAccDt}
								GROUP BY Impo_key, acc_nm, ADJ_GR_CD
							) b
							ON a.Impo_key = b.Impo_key
		WHERE a.Impo_napse_saup = #{saup}
		GROUP BY LTRIM(RTRIM(b.회사)), b.청구처구분
	</select>

    <select id="selectImpoCostByImpumIvnoList" resultType="map">
		/* 비용관리 impo3 인보이스 번호별 세목별 비용 조회 */
		SELECT a.Impum_ivno,
				SUM(ISNULL(b.cifwon,0)) AS 'cifwon', SUM(ISNULL(b.fre,0)) AS 'fre', SUM(ISNULL(b.ins,0)) AS 'ins',
				SUM(ISNULL(b.plus,0)) AS 'plus', SUM(ISNULL(b.duty,0)) AS 'duty', SUM(ISNULL(b.tk,0)) AS 'tk',
				SUM(ISNULL(b.kt,0)) AS 'kt', SUM(ISNULL(b.vat,0)) AS 'vat', SUM(ISNULL(b.tax,0)) AS 'tax',
				SUM(ISNULL(b.vat_g,0)) AS 'vat_g', SUM(ISNULL(b.gasan,0)) AS 'gasan', SUM(ISNULL(b.misingo,0)) AS 'misingo',
				SUM(a.Impum_su) AS 'Impum_su', SUM(a.Impum_danga) AS 'Impum_danga', SUM(a.Impum_amt) AS 'Impum_amt'
		FROM [ncustoms].[kcba].[Impo3] a WITH (NOLOCK)
			LEFT OUTER JOIN [ncustoms].[kcba].[Impo3_M] b WITH (NOLOCK)
						ON a.Impum_key=b.Impum_key
						AND a.Impum_lan=b.Impum_lan
						AND a.Impum_heang=b.Impum_heang
		WHERE a.Impum_key = #{impumKey}
		GROUP BY a.Impum_ivno
	</select>

    <select id="selectImpoCostByImpumIvnoDescList" resultType="map">
		/* 비용관리 impo3 인보이스 번호별 세목별 비용 상세 조회 */
		SELECT a.Impum_key, a.Impum_lan, a.Impum_heang, a.Impum_ivno, a.Impum_jajae_code,
				ISNULL(b.cifwon,0) AS 'cifwon', ISNULL(b.fre,0) AS 'fre', ISNULL(b.ins,0) AS 'ins',
				ISNULL(b.plus,0) AS 'plus', ISNULL(b.duty,0) AS 'duty', ISNULL(b.tk,0) AS 'tk',
				ISNULL(b.kt,0) AS 'kt', ISNULL(b.vat,0) AS 'vat', ISNULL(b.tax,0) AS 'tax',
				ISNULL(b.vat_g,0) AS 'vat_g', ISNULL(b.gasan,0) AS 'gasan', ISNULL(b.misingo,0) AS 'misingo',
				a.Impum_su, a.Impum_danga, a.Impum_amt,
				c.Mdivision_code
		FROM [ncustoms].[kcba].[Impo3] a WITH (NOLOCK)
		LEFT OUTER JOIN [ncustoms].[kcba].[Impo3_M] b WITH (NOLOCK)
		ON a.Impum_key=b.Impum_key
		AND a.Impum_lan=b.Impum_lan
		AND a.Impum_heang=b.Impum_heang
		LEFT OUTER JOIN CPS.[dbo].[MAAA100] c WITH (NOLOCK)
		ON a.Impum_jajae_code=c.Mmodel_code
		WHERE a.Impum_key = #{impumKey}
		AND a.Impum_ivno = #{impumIvno}
	</select>

    <select id="selectImpoCostSubMasterList" resultType="map">
		/* 비용관리 마스터안분 조회(계정별) */
		SELECT	a.ADJ_CD AS '계정코드',
				a.ADJ_NM AS '계정명',
				a.sum_ek AS '합계금액',
				a.Acc_NM AS '청구처',
				SUBSTRING(a.Acc_DT, 1,4) + '-' + SUBSTRING(a.Acc_DT, 5,2) AS '청구월',
				a.SUP_EK AS '공급가',
				a.TAX_EK AS '부가세',
				a.KEY_impo1_mDtl,
				a.Impo_key,
				a.ADJ_GR_CD,
				a.impo_singo_no,
				a.acc_dt,
				a.acc_Note,
				a.confYn,
				a.confUserId,
				a.confUserName,
				a.confDate
		FROM [ncustoms].[kcba].[impo1_mDtl] a WITH (NOLOCK)
		WHERE a.Impo_key= #{strImpoKey}
		ORDER BY a.ADJ_CD
	</select>

    <select id="selectImpoCostSubMasterDetailList" resultType="map">
		/* 비용관리 impo3_mDtl 조회 */
		SELECT	a.ADJ_NM AS '계정명',
				a.SUP_EK AS '공급가',
				a.TAX_EK AS '부가세',
				a.sum_ek AS '합계금액'
		FROM [ncustoms].[kcba].[impo3_mDtl] a WITH (NOLOCK)
		WHERE a.Impum_key= #{Impum_key}
		 and a.Impum_lan= #{Impum_lan}
		 and a.Impum_heang= #{Impum_heang}
	</select>

    <select id="selectImpoCostSubMasterByCustomsList" resultType="map">
		/* 비용관리 마스터안분 조회(청구처별) */
		SELECT	a.Acc_NM AS '청구처',
				SUM(a.sum_ek) AS '합계금액',
				SUBSTRING(a.Acc_DT, 1,4) + '-' + SUBSTRING(a.Acc_DT, 5,2) AS '청구월',
				SUM(a.SUP_EK) AS '공급가',
				SUM(a.TAX_EK) AS '부가세'
		FROM [ncustoms].[kcba].[impo1_mDtl] a WITH (NOLOCK)
		WHERE a.Impo_key= #{strImpoKey}
		GROUP BY a.Acc_NM, a.Acc_DT
		ORDER BY a.Acc_NM
	</select>

    <select id="selectImpo1MdtlLogList" resultType="map">
		/* 비용관리 impo1Mdtl 로그 조회 */
		SELECT *
		FROM [ncustoms].[kcba].[impo1_mDtl_Log] a WITH (NOLOCK)
		<where>
			<if test='impo1MdtlLogKey != "" and impo1MdtlLogKey != null'>AND a.impo1MdtlLogKey = #{impo1MdtlLogKey}</if>
			<if test='keyImpo1Mdtl != "" and keyImpo1Mdtl != null'>AND a.KEY_impo1_mDtl = #{keyImpo1Mdtl}</if>
			<if test='impoKey != "" and impoKey != null'>AND a.Impo_key = #{impoKey}</if>
			<if test='adjCd != "" and adjCd != null'>AND a.ADJ_CD = #{adjCd}</if>
			<if test='adjNm != "" and adjNm != null'>AND a.ADJ_NM LIKE '%' + #{adjNm} + '%'</if>
			<if test='impoSingoNo != "" and impoSingoNo != null'>AND a.impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
			<if test='accNm != "" and accNm != null'>AND a.acc_nm LIKE '%' + #{accNm} + '%'</if>
			<if test='sType != "ALL" and losType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
	            <choose>
	            	<when test='sType == "accDt"'>AND a.acc_dt BETWEEN #{strFromDate} AND #{strToDate}</when>
	            </choose>
			</if>
			<if test='confYn != "" and confYn != null'>AND a.confYn LIKE '%' + #{confYn} + '%'</if>
			<if test='confDesc != "" and confDesc != null'>AND a.confDesc LIKE '%' + #{confDesc} + '%'</if>
		</where>
		ORDER BY a.impo1MdtlLogKey DESC
	</select>

    <update id="updateImpo1MdtlCalculate">
		/* 비용관리 impo1Mdtl 정산확정 수정 */
		UPDATE	[ncustoms].[kcba].[impo1_mDtl]
		<trim prefix="SET" suffixOverrides=",">
			<if test='supEk != null'>SUP_EK = #{supEk} ,</if>
			<if test='taxEk != null'>TAX_EK = #{taxEk} ,</if>
			<if test='sumEk != null'>SUM_EK = #{sumEk} ,</if>
			<if test='confYn != null'>confYn = #{confYn} ,</if>
			<if test='confYn == "Y" and confUserId != null'>confUserId = #{_userId} ,</if>
			<if test='confYn != "Y"'>confUserId = null ,</if>
			<if test='confYn == "Y" and confUserName != null'>confUserName = #{_userNm} ,</if>
			<if test='confYn != "Y"'>confUserName = null ,</if>
			<if test='confYn == "Y"'>confDate = REPLACE(CONVERT(VARCHAR(8), GETDATE(), 112)+CONVERT(VARCHAR(8), GETDATE(), 114), ':','') ,</if>
			<if test='confYn != "Y"'>confDate = null ,</if>
		</trim>
		WHERE KEY_impo1_mDtl = #{keyImpo1Mdtl}
	</update>

    <insert id="insertImpo1MdtlLog">
		/* 비용관리 impo1Mdtl 로그 입력 */
		INSERT INTO [ncustoms].[kcba].[impo1_mDtl_Log]
		       ([KEY_impo1_mDtl]
		       ,[Impo_key]
		       ,[ADJ_CD]
		       ,[ADJ_NM]
		       ,[ADJ_GR_CD]
		       ,[SUP_EK]
		       ,[TAX_EK]
		       ,[SUM_EK]
		       ,[impo_singo_no]
		       ,[acc_nm]
		       ,[acc_dt]
		       ,[acc_Note]
		       ,[confYn]
		       ,[confUserId]
		       ,[confUserName]
		       ,[confDate]
		       ,[confDesc]
		       ,[addUserId]
		       ,[addUserNm]
		       ,[addDtm] )
		VALUES
		       (#{KEY_impo1_mDtl}
		       ,#{Impo_key}
		       ,#{ADJ_CD}
		       ,#{ADJ_NM}
		       ,#{ADJ_GR_CD}
		       ,REPLACE(#{SUP_EK}, ',', '')
		       ,REPLACE(#{TAX_EK}, ',', '')
		       ,REPLACE(#{SUM_EK}, ',', '')
		       ,#{impo_singo_no}
		       ,#{acc_nm}
		       ,#{acc_dt}
		       ,#{acc_Note}
		       ,#{confYn}
		       ,#{confUserId}
		       ,#{confUserName}
		       ,#{confDate}
		       ,#{confDesc}
		       ,#{_userId}
		       ,#{_userNm}
		       ,REPLACE(CONVERT(VARCHAR(8), GETDATE(), 112)+CONVERT(VARCHAR(8), GETDATE(), 114), ':','') )
		<selectKey keyProperty="rslt" resultType="java.lang.Long" order="AFTER">SELECT IDENT_CURRENT('[ncustoms].[kcba].[impo1_mDtl_Log]')</selectKey>
	</insert>

    <select id="findImportManagementList" resultType="map">
        /* 수입management현황(recv_impo1) */
        SELECT datas.*
        FROM (
        SELECT ROW_NUMBER() OVER (ORDER BY a.key_no DESC) AS 'rownum',
		a.key_no,a.impo_iphang_date,a.gu_object_cd, a.impo_bl_no,a.impo_singo_no, substring(a.impo_ok_date,0,9) as impo_ok_date,
		c.invoice_no,c.invoice_dt,c.Impum_sungbun1,b.Imlan_wonsanji_code,e.Mdivision_code,c.Impum_jajae_code,
		c.Impum_gukyk2+' '+c.Impum_gukyk3 as Impum_gukyk,c.Impum_sungbun2,c.Impum_sungbun3,c.Impum_su,c.Impum_su_danwi,c.Impum_danga,
		c.Impum_amt,c.Munitprice_current,c.Mhs_kind,c.Mhs_rate,c.Mhs_code,e.Myog_flag,e.Myog_ok_no,d.Suipyogun_no,c.Impum_lan,c.Impum_heang,
		c.TransDt, c.TransChsu, c.InDt, c.Remark1, c.TransCom,
		CASE WHEN ISNULL(f.itemSu,'')='' THEN c.Impum_su ELSE (c.Impum_su*f.itemSu) END AS 'qty'
		from rms.dbo.recv_impo1 a WITH (NOLOCK)
		LEFT OUTER JOIN rms.dbo.recv_impo2 b WITH (NOLOCK)
		on a.key_no=b.key_no
		LEFT OUTER JOIN rms.dbo.recv_impo3 c WITH (NOLOCK)
		on a.key_no=c.key_no
		and b.Imlan_jechl_lan=c.impum_lan
		LEFT OUTER JOIN rms.dbo.recv_impo41 d WITH (NOLOCK)
		on c.key_no=d.key_no
		and c.Impum_lan=d.Suipyogun_lan
		and c.Impum_heang=d.Suipyogun_heang
		LEFT OUTER JOIN CPS.[dbo].[MAAA100] e WITH (NOLOCK)
		on c.Impum_jajae_code=e.Mmodel_code
		and e.Mco_com = #{saup}
		LEFT OUTER JOIN rms.dbo.TBR_Alcon_ItemCount f WITH (NOLOCK)
		on c.Impum_jajae_code=f.mmodel_code
        where a.Impo_napse_saup = #{saup}
        <if test='impoBlNo != null and impoBlNo != ""'>AND a.impo_bl_no LIKE '%' + #{impoBlNo} + '%' /* BL번호 */</if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND a.impo_singo_no LIKE '%' + #{impoSingoNo} + '%' /* 신고번호 */</if>
        <if test='impumIvNo != null and impumIvNo != ""'>AND c.invoice_no LIKE '%' + #{impumIvNo} + '%' /* I/V NO */</if>
        <if test='mdivisionCode != null and mdivisionCode != ""'>AND e.Mdivision_code LIKE '%' + #{mdivisionCode} + '%' /* 사업부코드 */</if>
        <if test='impumJajaeCode != null and impumJajaeCode != ""'>AND c.Impum_jajae_code LIKE '%' + #{impumJajaeCode} + '%' /* 자재코드 */</if>
        <if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_singo_date"'>AND a.impo_singo_date BETWEEN #{strFromDate} AND #{strToDate} /* 통관신고일 */</when>
                <when test='_DateType == "Impo_ok_date"'>AND a.impo_ok_date BETWEEN #{strFromDate} AND #{strToDate} /* 통관수리일 */</when>
                <when test='_DateType == "TransDt"'>AND c.TransDt BETWEEN #{strFromDate} AND #{strToDate} /* DKSH 배송일 */</when>
                <when test='_DateType == "InDt"'>AND c.InDt BETWEEN #{strFromDate} AND #{strToDate} /* DKSH 입고일 */</when>
            </choose>
        </if>
        ) datas
        <if test='_pageNumber != null and _pageNumber != "" and _pageRow != null and _pageRow != ""'>
            WHERE datas.rownum BETWEEN (((CONVERT(INTEGER, #{_pageNumber})) * (CONVERT(INTEGER, #{_pageRow}))) +1) AND ((CONVERT(INTEGER, #{_pageNumber}) + 1) * CONVERT(INTEGER, #{_pageRow}))
        </if>
    </select>

    <update id="updateRecvImpo3">
		/* Import Management 수기입력 */
		UPDATE	[rms].[dbo].[recv_Impo3]
		<trim prefix="SET" suffixOverrides=",">
			<if test='TransDt != null'>TransDt = #{TransDt} ,</if>
			<if test='TransChsu != null'>TransChsu = #{TransChsu} ,</if>
			<if test='TransCom != null'>TransCom = #{TransCom} ,</if>
			<if test='InDt != null'>InDt = #{InDt} ,</if>
			<if test='Remark1 != null'>Remark1 = #{Remark1} ,</if>
		</trim>
		WHERE key_no = #{key_no}
		  and Impum_lan = #{Impum_lan}
		  and Impum_heang = #{Impum_heang}
	</update>

	<select id="getMKImpoCostMasterList" resultType="map">
		/* 비용관리 마스터 조회 */
		SELECT a.Impo_key,
				a.Vendor,
				a.수입신고번호,
				a.BL번호,
				a.MBL번호,
				a.수리일,
				a.입항일,
				a.반입일,
				a.신고일,
				a.Impo_file_no1,
				a.Impo_file_no2,
				a.[hidden Invoice Amount] AS 'hidden Invoice Amount',
				a.[Invoice Amount] AS 'Invoice Amount',
				a.Impo_gyelje_money,
				a.Impo_exch_yul,
				a.과세운임,
				a.과세가격,
				a.관세,
				a.부가세,
				a.기타세,
				a.총세액,
				SUM(a.C090) AS 'C090',
				SUM(a.C108) AS 'C108',
				SUM(a.C117) AS 'C117',
				SUM(a.C125) AS 'C125',
				SUM(a.C086) AS 'C086',
				SUM(a.C107) AS 'C107',
				SUM(a.C097) AS 'C097',
				SUM(a.C018) AS 'C018',
				SUM(a.C026) AS 'C026',
				SUM(a.C043) AS 'C043',
				SUM(a.C014) AS 'C014',
				SUM(a.C084) AS 'C084',
				SUM(a.C124) AS 'C124',
				SUM(a.C094) AS 'C094',
				SUM(a.C079) AS 'C079',
				SUM(a.C110) AS 'C110',
				SUM(a.C060) AS 'C060',
				SUM(a.C013) AS 'C013',
				SUM(a.C080) AS 'C080',
				SUM(a.합계금액) AS '합계금액'
		FROM	(
					SELECT	a.Impo_key,
							a.Impo_Gonggub_Sangho AS 'Vendor',
							SUBSTRING(a.impo_singo_no, 1,5) + '-' + SUBSTRING(a.impo_singo_no, 6,2) + '-' + SUBSTRING(a.impo_singo_no, 8,7) AS '수입신고번호',
							a.impo_bl_no AS 'BL번호',
							a.impo_mbl_no AS 'MBL번호',
							CASE WHEN ISNULL(a.impo_singo_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.impo_singo_date),120) END AS '수리일',
							CASE WHEN ISNULL(a.Impo_iphang_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.Impo_iphang_date),120) END AS '입항일',
							CASE WHEN ISNULL(a.Impo_banip_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.Impo_banip_date),120) END AS '반입일',
							CASE WHEN ISNULL(a.impo_singo_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.impo_singo_date),120) END  AS '신고일',
							a.Impo_file_no1,
							a.Impo_file_no2,
							a.Impo_gyelje_input AS 'hidden Invoice Amount',
							a.Impo_gyelje_input AS 'Invoice Amount',
							a.Impo_gyelje_money,
							a.Impo_exch_yul,
							a.Impo_fre_won AS '과세운임',
							a.Impo_cif_total_won AS '과세가격',
							a.Impo_gwan_tax AS '관세',
							a.Impo_vat_tax AS '부가세',
							(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS '기타세',
							a.Impo_total_tax AS '총세액',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C090' THEN b.sup_ek ELSE 0 END AS 'C090',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C108' THEN b.sup_ek ELSE 0 END AS 'C108',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C117' THEN b.sup_ek ELSE 0 END AS 'C117',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C125' THEN b.sup_ek ELSE 0 END AS 'C125',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C086' THEN b.sup_ek ELSE 0 END AS 'C086',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C107' THEN b.sup_ek ELSE 0 END AS 'C107',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C097' THEN b.sup_ek ELSE 0 END AS 'C097',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C018' THEN b.sup_ek ELSE 0 END AS 'C018',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C026' THEN b.sup_ek ELSE 0 END AS 'C026',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C043' THEN b.sup_ek ELSE 0 END AS 'C043',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C014' THEN b.sup_ek ELSE 0 END AS 'C014',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C084' THEN b.sup_ek ELSE 0 END AS 'C084',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C124' THEN b.sup_ek ELSE 0 END AS 'C124',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C094' THEN b.sup_ek ELSE 0 END AS 'C094',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C079' THEN b.sup_ek ELSE 0 END AS 'C079',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C110' THEN b.sup_ek ELSE 0 END AS 'C110',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C060' THEN b.sup_ek ELSE 0 END AS 'C060',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C013' THEN b.sup_ek ELSE 0 END AS 'C013',
							CASE WHEN ISNULL(b.ADJ_CD,'')='C080' THEN b.sup_ek ELSE 0 END AS 'C080',
							SUM(ISNULL(b.sup_ek,0)) AS '합계금액'
					FROM [ncustoms].[kcba].[impo1] a WITH (NOLOCK)
						LEFT OUTER JOIN [ncustoms].[kcba].[impo1_mDtl] b WITH (NOLOCK)
						ON a.Impo_key=b.Impo_key
						<if test='strAccDt != "" and strAccDt != null'>AND b.acc_dt = #{strAccDt}</if>
					WHERE a.Impo_napse_saup = #{saup}
					<if test='strEntity != "" and strEntity != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] d1 WITH (NOLOCK) WHERE a.Impo_key = d1.Impum_Key AND d1.Impum_jajae_code LIKE #{strEntity} + '%' )
					</if>
					<if test='strEntityList != "" and strEntityList != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] d2 WITH (NOLOCK) WHERE a.Impo_key = d2.Impum_Key AND d2.Impum_jajae_code IN ${strEntityList} )
					</if>
					<if test='strPoNo != "" and strPoNo != null'>
						AND EXISTS ( SELECT * FROM [ncustoms].[kcba].[Impo3] d3 WITH (NOLOCK) WHERE a.Impo_key = d3.Impum_Key AND d3.Impum_sungbun3 LIKE #{strPoNo} + '%' )
					</if>
					<if test='strVendor != "" and strVendor != null'>AND a.Impo_Gonggub_Sangho LIKE '%' + #{strVendor} + '%'</if>
					<if test='_DateType != "ALL" and _DateType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
			             <choose>
			                <when test='_DateType == "Impo_iphang_date"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='_DateType == "Impo_banip_date"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='_DateType == "Impo_singo_date"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			                <when test='_DateType == "Impo_ok_date"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
			              </choose>
			        </if>
			        <if test='strSingoDelay != "ALL" and strSingoDelay != null'>
			             <choose>
			                <when test='strSingoDelay == "SINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') != ''</when>
			                <when test='strSingoDelay == "MISINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') = ''</when>
			              </choose>
			        </if>
			        <if test='strSegwanDelay != "ALL" and strSegwanDelay != null'>
			             <choose>
			                <when test='strSegwanDelay == "SIMSA"'>
			                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
			                    AND ISNULL(a.Impo_ok_date,'') != ''
			                </when>
			                <when test='strSegwanDelay == "MISIMSA"'>
			                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
			                    AND ISNULL(a.Impo_ok_date,'') = ''
			                </when>
			              </choose>
			        </if>
					<if test='strSingoNo != "" and strSingoNo != null'>AND a.impo_singo_no LIKE '%' + #{strSingoNo} + '%'</if>
					<if test='strBlNo != "" and strBlNo != null'>AND a.impo_bl_no LIKE '%' + #{strBlNo} + '%'</if>
					<if test='strInvoiceNo != null and strInvoiceNo != ""'>AND a.Impo_file_no2 LIKE '%' + #{strInvoiceNo} + '%'</if>
					<if test='strAccNm != "" and strAccNm != null'>AND b.acc_Nm LIKE '%' + #{strAccNm} + '%'</if>
					<if test='strAccDt != "" and strAccDt != null'>
						AND a.Impo_key IN (SELECT Impo_key FROM [ncustoms].[kcba].[impo1_mDtl] WITH (NOLOCK) WHERE acc_dt = #{strAccDt})
					</if>
					GROUP BY a.Impo_key,
							a.Impo_Gonggub_Sangho,
							SUBSTRING(a.impo_singo_no, 1,5) + '-' + SUBSTRING(a.impo_singo_no, 6,2) + '-' + SUBSTRING(a.impo_singo_no, 8,7),
							a.impo_bl_no,
							a.impo_mbl_no,
							CASE WHEN ISNULL(a.impo_singo_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.impo_singo_date),120) END,
							CASE WHEN ISNULL(a.Impo_iphang_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.Impo_iphang_date),120) END,
							CASE WHEN ISNULL(a.Impo_banip_date,'')='' THEN '' ELSE CONVERT(VARCHAR(10),CONVERT(DATETIME, a.Impo_banip_date),120) END,
							a.Impo_file_no1,
							a.Impo_file_no2,
							a.Impo_gyelje_input,
							a.Impo_gyelje_money,
							a.Impo_exch_yul,
							a.Impo_fre_won,
							a.Impo_cif_total_won,
							a.Impo_gwan_tax,
							a.Impo_vat_tax,
							(a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)),
							a.Impo_total_tax,
							ISNULL(b.ADJ_CD,''),
							b.sup_ek
				) a

		GROUP BY a.Impo_key,
				a.Vendor,
				a.수입신고번호,
				a.BL번호,
				a.MBL번호,
				a.수리일,
				a.입항일,
				a.반입일,
				a.신고일,
				a.Impo_file_no1,
				a.Impo_file_no2,
				a.[hidden Invoice Amount],
				a.[Invoice Amount],
				a.Impo_gyelje_money,
				a.Impo_exch_yul,
				a.과세운임,
				a.과세가격,
				a.관세,
				a.부가세,
				a.기타세,
				a.총세액
		ORDER BY a.Impo_key
	</select>



	<select id="findImportResult소분류" statementType="CALLABLE" resultType="map">
        { call [soo].[dbo].[USP_RESULT_Impo_getImportResult_소분류] (
          @yyyy = #{yyyy}, @mm = #{mm}, @db = #{db}, @taxNum = #{taxNum}, @singoGubun = #{singoGubun}, @csGubun = #{csGubun}, @searchGubun = #{searchGubun}, @searchKeyword = #{searchKeyword}
        ) }
    </select>



	<select id="selectImportSebStatusList" resultType="map">
        /* 그룹세브 수입화물통관 마스터 조회 */
		SELECT	a.Impo_key, a.Impo_send_result, a.Impo_receive_result, a.Impo_bl_gubun,
				SUBSTRING(a.impo_singo_no, 1,5) + '-' + SUBSTRING(a.impo_singo_no, 6,2) + '-' + SUBSTRING(a.impo_singo_no, 8,7) AS 'impo_singo_no', a.impo_bl_no, a.impo_bl_no AS 'hdn_Impo_Bl_No',
				a.Impo_hanggu_name, a.Impo_pojang_su, a.Impo_pojang_danwi, a.Impo_total_jung, a.impo_mbl_no,
				CASE WHEN ISNULL(a.Impo_iphang_date,'')='' THEN '' ELSE SUBSTRING(a.Impo_iphang_date, 1,4)+'-'+SUBSTRING(a.Impo_iphang_date, 5,2)+'-'+SUBSTRING(a.Impo_iphang_date, 7,2) END AS 'Impo_iphang_date',
				CASE WHEN ISNULL(a.Impo_banip_date,'')='' THEN '' ELSE SUBSTRING(a.Impo_banip_date, 1,4)+'-'+SUBSTRING(a.Impo_banip_date, 5,2)+'-'+SUBSTRING(a.Impo_banip_date, 7,2) END AS 'Impo_banip_date',
				CASE WHEN ISNULL(a.impo_singo_date,'')='' THEN '' ELSE SUBSTRING(a.impo_singo_date, 1,4)+'-'+SUBSTRING(a.impo_singo_date, 5,2)+'-'+SUBSTRING(a.impo_singo_date, 7,2) END AS 'Impo_singo_date',
				CASE WHEN ISNULL(a.impo_Ok_date,'')='' THEN '' ELSE SUBSTRING(a.impo_Ok_date, 1,4) + '-' + SUBSTRING(a.impo_Ok_date, 5,2) + '-' + SUBSTRING(a.impo_Ok_date, 7,2) END AS 'impo_Ok_date',
				CASE WHEN ISNULL(a.impo_Ok_date,'')='' THEN '' ELSE SUBSTRING(a.impo_Ok_date, 1,4) + '-' + SUBSTRING(a.impo_Ok_date, 5,2) + '-' + SUBSTRING(a.impo_Ok_date, 7,2) END AS 'impo_Ok_date1',
				a.Impo_indo_jogun, a.Impo_gyelje_money, a.Impo_gyelje, a.Impo_gyelje_input AS 'hidden_Impo_gyelje_input', a.Impo_gyelje_input,
				a.Impo_fre_won, a.Impo_cif_total_won, a.Impo_gwan_tax,
				a.Impo_vat_tax, (a.Impo_total_tax-(a.Impo_gwan_tax+a.Impo_vat_tax)) AS 'Impo_etc_tax', a.Impo_total_tax,
				ISNULL(b.Impum_sungbun3,'') AS 'Impum_sungbun3',
				a.Impo_jung_danwi, a.Impo_cif_total_usd, a.Impo_Segwan, a.Impo_Gwa, a.Impo_Suipja_Code, a.Impo_Suipja_Sangho,
				a.Impo_Napse_Code, a.Impo_Napse_Sangho, a.Impo_Suipja_Tong, a.Impo_Jubsu_Date, a.Impo_Forwarder_Code,
				a.Impo_Damdang_Name, a.Impo_Damdangja, a.Impo_Gonggub_Sangho, a.Impo_Gonggub_Buho,
				a.Impo_Hanggu_Code, a.Impo_Hanggu_Name, a.Impo_Unsong_Type, a.Impo_Ship_Name, a.Impo_Edu_Tax,
				a.Impo_Fre_Money, a.Impo_Fre_Exch, a.Impo_Fre,
				a.Impo_Mrn_No, a.Impo_file_no1, a.Impo_file_no2, a.Impo_plus_yul_gubun, a.Impo_plus_yul,
				a.Impo_plus_money, a.Impo_plus_exch, a.Impo_plus,
				a.Impo_minus_yul_gubun, a.Impo_minus_yul, a.Impo_minus_money, a.Impo_minus_exch, a.Impo_minus,
				a.Impo_gyelje_input, a.Impo_jukchl_code, a.Impo_jukchl_name, a.Impo_ins_input,
				a.Impo_jukchl_code, a.Impo_jukchl_name, c.Imlan_su
		FROM [ncustoms_sn].[kcba].[impo1] a WITH (NOLOCK)
				INNER JOIN (SELECT ba.Impum_key, MIN(ba.Impum_sungbun3) AS 'Impum_sungbun3'
							FROM [ncustoms_sn].[kcba].[impo3] ba WITH (NOLOCK)
								INNER JOIN (SELECT ba1.Impum_key, ba1.Impum_lan, MIN(ba1.Impum_heang) AS 'Impum_heang'
											FROM [ncustoms_sn].[kcba].[impo3] ba1 WITH (NOLOCK)
												INNER JOIN (SELECT baa.Impum_key, MIN(baa.Impum_lan) AS 'Impum_lan'
															FROM [ncustoms_sn].[kcba].[impo3] baa WITH (NOLOCK)
															GROUP BY baa.Impum_key) ba2
  												ON ba1.Impum_key = ba2.Impum_key
  												AND ba1.Impum_lan = ba2.Impum_lan
												GROUP BY ba1.Impum_key, ba1.Impum_lan) bb
  								ON ba.Impum_key = bb.Impum_key
  								AND ba.Impum_lan = bb.Impum_lan
  								AND ba.Impum_heang = bb.Impum_heang
							GROUP BY ba.Impum_key) b
				ON a.Impo_key=b.Impum_key
				INNER JOIN (SELECT Imlan_key, SUM(Imlan_su) AS 'Imlan_su'
							FROM [ncustoms_sn].[kcba].[impo2] WITH (NOLOCK)
							GROUP BY Imlan_key) c
				ON a.Impo_key=c.Imlan_key
		WHERE a.Impo_napse_saup IN ('2208146671')

		<if test='strEntity != "" and strEntity != null'>
			AND EXISTS ( SELECT * FROM [ncustoms_sn].[kcba].[Impo3] dd WITH (NOLOCK) WHERE a.Impo_key = dd.Impum_Key AND dd.Impum_jajae_code LIKE #{strEntity} + '%' )
		</if>
		<if test='strEntityList != "" and strEntityList != null'>
			AND EXISTS ( SELECT * FROM [ncustoms_sn].[kcba].[Impo3] ddd WITH (NOLOCK) WHERE a.Impo_key = ddd.Impum_Key AND ddd.Impum_jajae_code IN ${strEntityList} )
		</if>
		<if test='strVendor != "" and strVendor != null'>AND a.Impo_Gonggub_Sangho LIKE '%' + #{strVendor} + '%'</if>
		<if test='_DateType != "ALL" and _DateType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
             <choose>
                <when test='_DateType == "Impo_iphang_date"'>AND a.Impo_iphang_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_banip_date"'>AND a.Impo_banip_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_singo_date"'>AND a.Impo_singo_date BETWEEN #{strFromDate} AND #{strToDate}</when>
                <when test='_DateType == "Impo_ok_date"'>AND a.Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
              </choose>
        </if>
        <if test='strSingoDelay != "ALL" and strSingoDelay != null'>
             <choose>
                <when test='strSingoDelay == "SINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') != ''</when>
                <when test='strSingoDelay == "MISINGO"'>AND ISNULL(a.Impo_Jubsu_Date,'') = ''</when>
              </choose>
        </if>
        <if test='strSegwanDelay != "ALL" and strSegwanDelay != null'>
             <choose>
                <when test='strSegwanDelay == "SIMSA"'>
                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
                    AND ISNULL(a.Impo_ok_date,'') != ''
                </when>
                <when test='strSegwanDelay == "MISIMSA"'>
                    AND ISNULL(a.Impo_Jubsu_Date,'') != ''
                    AND ISNULL(a.Impo_ok_date,'') = ''
                </when>
              </choose>
        </if>
		<if test='strSingoNo != "" and strSingoNo != null'>AND a.impo_singo_no LIKE '%' + #{strSingoNo} + '%'</if>
		<if test='strBlNo != "" and strBlNo != null'>AND a.impo_bl_no LIKE #{strBlNo} + '%'</if>
		<if test='strInvoiceNo != "" and strInvoiceNo != null'>
			AND EXISTS ( SELECT * FROM [ncustoms_sn].[kcba].[impo3] a1 WITH (NOLOCK) WHERE a.Impo_key=a1.Impum_key AND a1.Impum_sungbun3 = #{strInvoiceNo})
		</if>
    </select>

	<select id="selectImportSebStatusDetail" resultType="map">
		/* 그룹세브 수입화물통관 디테일 조회 */
		SELECT a.Imlan_key, a.Imlan_seyul_gubun, a.Imlan_jechl_lan, a.Imlan_hs AS 'hdnImlanHs',
			SUBSTRING(a.Imlan_hs,1, 4) + '.' + SUBSTRING(a.Imlan_hs,5,2) + '-' + SUBSTRING(a.Imlan_hs,7,4) AS 'Imlan_hs', a.Imlan_gwan_seyula, a.Imlan_gurae_pum, a.Imlan_model,
			a.Imlan_gije1+a.Imlan_gije2+a.Imlan_gije3+a.Imlan_gije4+a.Imlan_gije5+a.Imlan_gije6+a.Imlan_gije7+a.Imlan_gije8+a.Imlan_gije9+a.Imlan_gije10 AS 'Imlan_gije3',
			a.Imlan_cost, a.Imlan_mulryang, a.Imlan_mulryang_danwi, a.Imlan_jung, a.Imlan_jung_danwi, a.Imlan_cif_won,
			a.Imlan_cif_usd, a.Imlan_gwan_tax, a.Imlan_vat_tax, a.Imlan_cs_gumsa1, a.imlan_fta_obj,
			a.Imlan_popum,  /* 표준품명 */
			a.Imlan_su, a.Imlan_su_danwi,  /* 수량 */
			a.Imlan_gwan_gyeng_yul,
			a.Imlan_neguk_gubun, a.Imlan_neguk_code, a.Imlan_neguk_myun,  /* 내국세 */
			a.Imlan_edu_yn, a.Imlan_edu_seyul, a.Imlan_edu_tax, /* 교육세 */
			a.Imlan_plus,  /* 가산금 */
			a.Imlan_wonsanji_code, a.Imlan_wonsanji_name, a.Imlan_wonsanji_mark, a.Imlan_wonsanji_bang, a.Imlan_wonsanji_type,  /* 원산지 */
			a.Imlan_minus,  /* 공제금 */
			a.Imlan_wonsanji_no,  /* 원산지증명서 */
			a.Imlan_vat_gubun, a.Imlan_vat_gam_buho, a.Imlan_vat_gyeng_yul,  /* 란부가세 */
			b.Suipyogun_no
		FROM [ncustoms_sn].[kcba].[Impo2] a WITH (NOLOCK)
			LEFT OUTER JOIN (
				SELECT a1.Suipyogun_key, a1.Suipyogun_lan,
					  SUBSTRING((SELECT ', ' + a2.SUIPYOGUN_NO
					  			FROM [ncustoms_sn].[kcba].[Impo4] a2 WITH (NOLOCK)
					  			WHERE a2.Suipyogun_key = a1.Suipyogun_key
					  			AND a2.Suipyogun_lan = a1.Suipyogun_lan
					  			FOR XML PATH ('')), 3, 4000) AS 'SUIPYOGUN_NO'
				FROM [ncustoms_sn].[kcba].[Impo4] a1 WITH (NOLOCK)
				WHERE a1.Suipyogun_key = #{strImlanKey}
				GROUP BY a1.Suipyogun_key, a1.Suipyogun_lan
			) b
			ON a.Imlan_key = b.Suipyogun_key
			AND a.Imlan_jechl_lan = b.Suipyogun_lan
		WHERE a.Imlan_key = #{strImlanKey}
		<if test='strInvoiceNo != "" and strInvoiceNo != null'>
			AND EXISTS ( SELECT * FROM [ncustoms_sn].[kcba].[impo3] a1 WITH (NOLOCK) WHERE a.Imlan_key=a1.Impum_key AND a.Imlan_jechl_lan=a1.Impum_lan AND a1.Impum_sungbun3 = #{strInvoiceNo})
		</if>
	</select>

	<select id="selectImportSebStatusSubDetail" resultType="map">
		/* 그룹세브 수입화물통관 서브디테일 조회 */
		SELECT a.Impum_key, a.Impum_lan, a.Impum_heang, a.Impum_jajae_code,
				a.Impum_gukyk1, a.Impum_gukyk2, a.Impum_gukyk3,	a.Impum_su, a.Impum_su_danwi,
				a.Impum_danga, a.Impum_Amt, a.Impum_sungbun1, a.Impum_sungbun2,
				a.Impum_sungbun3,
				ISNULL(b.cifwon,0) AS 'cifwon', ISNULL(b.fre,0) AS 'fre', ISNULL(b.ins,0) AS 'ins', ISNULL(b.plus,0) AS 'plus', ISNULL(b.duty,0) AS 'duty',
				ISNULL(b.tk,0) AS 'tk', ISNULL(b.kt,0) AS 'kt', ISNULL(b.ju,0) AS 'ju', ISNULL(b.edu,0) AS 'edu', ISNULL(b.nong,0) AS 'nong',
				ISNULL(b.vat,0) AS 'vat', ISNULL(b.tax,0) AS 'tax', ISNULL(b.vat_g,0) AS 'vat_g', ISNULL(b.gasan,0) AS 'gasan', ISNULL(b.misingo,0) AS 'misingo',
				c.Suipyogun_no
		FROM [ncustoms_sn].[kcba].[Impo3] a WITH (NOLOCK)
				LEFT OUTER JOIN [ncustoms_sn].[kcba].[Impo3_M] b WITH (NOLOCK)
				ON a.Impum_key=b.Impum_key
				AND a.Impum_lan=b.Impum_lan
				AND a.Impum_heang=b.Impum_heang
				LEFT OUTER JOIN (
					SELECT a1.SUIPYOGUN_KEY, a1.SUIPYOGUN_LAN, a1.SUIPYOGUN_HEANG,
						  SUBSTRING((SELECT ', ' + a2.SUIPYOGUN_NO
						  			FROM [ncustoms_sn].[kcba].[Impo41] a2 WITH (NOLOCK)
						  			WHERE a2.SUIPYOGUN_KEY = a1.SUIPYOGUN_KEY
						  			AND a2.SUIPYOGUN_LAN = a1.SUIPYOGUN_LAN
						  			AND a2.SUIPYOGUN_HEANG = a1.SUIPYOGUN_HEANG
						  			FOR XML PATH ('')), 3, 4000) AS 'SUIPYOGUN_NO'
					FROM [ncustoms_sn].[kcba].[Impo41] a1 WITH (NOLOCK)
					WHERE a1.SUIPYOGUN_KEY = #{strImpumKey}
					AND a1.SUIPYOGUN_LAN = #{strImpumLan}
					GROUP BY a1.SUIPYOGUN_KEY, a1.SUIPYOGUN_LAN, a1.SUIPYOGUN_HEANG
				) c
				ON a.Impum_key = c.SUIPYOGUN_KEY
				AND a.Impum_lan = c.SUIPYOGUN_LAN
				AND a.Impum_heang = c.SUIPYOGUN_HEANG
		WHERE a.Impum_key = #{strImpumKey}
		AND a.Impum_lan = #{strImpumLan}
	</select>

	<select id="selectImpoDetailListByImpoKeyList" resultType="map">
		/* 수입화물통관 디테일 조회(전체다운엑셀) */
		SELECT a.Imlan_key, a.Imlan_seyul_gubun, a.Imlan_jechl_lan, a.Imlan_jechl_lan, a.Imlan_jechl_lan, a.Imlan_hs AS 'hdnImlanHs',
			SUBSTRING(a.Imlan_hs,1, 4) + '.' + SUBSTRING(a.Imlan_hs,5,2) + '-' + SUBSTRING(a.Imlan_hs,7,4) AS 'Imlan_hs', a.Imlan_gwan_seyula, a.Imlan_gurae_pum, a.Imlan_model,
			a.Imlan_gije1+a.Imlan_gije2+a.Imlan_gije3+a.Imlan_gije4+a.Imlan_gije5+a.Imlan_gije6+a.Imlan_gije7+a.Imlan_gije8+a.Imlan_gije9+a.Imlan_gije10 AS 'Imlan_gije3',
			a.Imlan_cost, a.Imlan_mulryang, a.Imlan_mulryang_danwi, a.Imlan_jung, a.Imlan_jung_danwi, a.Imlan_cif_won,
			a.Imlan_cif_usd, a.Imlan_gwan_tax, a.Imlan_vat_tax, a.Imlan_cs_gumsa1, a.imlan_fta_obj,
			a.Imlan_popum,  /* 표준품명 */
			a.Imlan_su, a.Imlan_su_danwi,  /* 수량 */
			a.Imlan_gwan_gyeng_yul, a.Imlan_gwan_seyula,  /* 관세감면 */
			a.Imlan_neguk_gubun, a.Imlan_neguk_code, a.Imlan_neguk_myun,  /* 내국세 */
			a.Imlan_edu_yn, a.Imlan_edu_seyul, a.Imlan_edu_tax, /* 교육세 */
			a.Imlan_plus,  /* 가산금 */
			a.Imlan_wonsanji_code, a.Imlan_wonsanji_name, a.Imlan_wonsanji_mark, a.Imlan_wonsanji_bang, a.Imlan_wonsanji_type,  /* 원산지 */
			a.Imlan_minus,  /* 공제금 */
			a.Imlan_wonsanji_no,  /* 원산지증명서 */
			a.Imlan_vat_gubun, a.Imlan_vat_gam_buho, a.Imlan_vat_gyeng_yul,  /* 란부가세 */
			b.Suipyogun_no
		FROM [ncustoms_sn].[kcba].[Impo2] a WITH (NOLOCK)
			LEFT OUTER JOIN (
				SELECT a1.Suipyogun_key, a1.Suipyogun_lan,
					  SUBSTRING((SELECT ', ' + a2.SUIPYOGUN_NO
					  			FROM [ncustoms_sn].[kcba].[Impo4] a2 WITH (NOLOCK)
					  			WHERE a2.Suipyogun_key = a1.Suipyogun_key
					  			AND a2.Suipyogun_lan = a1.Suipyogun_lan
					  			FOR XML PATH ('')), 3, 4000) AS 'SUIPYOGUN_NO'
				FROM [ncustoms_sn].[kcba].[Impo4] a1 WITH (NOLOCK)
				WHERE a1.Suipyogun_key IN ${impoKeyList}
				GROUP BY a1.Suipyogun_key, a1.Suipyogun_lan
			) b
			ON a.Imlan_key = b.Suipyogun_key
			AND a.Imlan_jechl_lan = b.Suipyogun_lan
		<!-- WHERE a.Imlan_key IN <foreach collection="strImlanKey" item="items"  open="(" close=")" separator=",">#{items.value}</foreach> -->
		WHERE a.Imlan_key IN ${impoKeyList}
		<if test='strInvoiceNo != "" and strInvoiceNo != null'>
			AND EXISTS ( SELECT * FROM [ncustoms_sn].[kcba].[impo3] a1 WITH (NOLOCK) WHERE a.Imlan_key=a1.Impum_key AND a.Imlan_jechl_lan=a1.Impum_lan AND a1.Impum_sungbun3 = #{strInvoiceNo})
		</if>
		ORDER BY a.Imlan_key, a.Imlan_jechl_lan
	</select>

	<select id="selectImpoSubDetailListByImpoKeyList" resultType="map">
		/* 수입화물통관 서브디테일 조회(전체다운엑셀) */
		SELECT a.Impum_key, a.Impum_lan, a.Impum_heang, a.Impum_jajae_code,
				a.Impum_gukyk1, a.Impum_gukyk2, a.Impum_gukyk3,	a.Impum_su, a.Impum_su_danwi,
				a.Impum_danga, a.Impum_Amt, a.Impum_sungbun1, a.Impum_sungbun2,
				a.Impum_sungbun3,
				ISNULL(b.cifwon,0) AS 'cifwon', ISNULL(b.fre,0) AS 'fre', ISNULL(b.ins,0) AS 'ins', ISNULL(b.plus,0) AS 'plus', ISNULL(b.duty,0) AS 'duty',
				ISNULL(b.tk,0) AS 'tk', ISNULL(b.kt,0) AS 'kt', ISNULL(b.ju,0) AS 'ju', ISNULL(b.edu,0) AS 'edu', ISNULL(b.nong,0) AS 'nong',
				ISNULL(b.vat,0) AS 'vat', ISNULL(b.tax,0) AS 'tax', ISNULL(b.vat_g,0) AS 'vat_g', ISNULL(b.gasan,0) AS 'gasan', ISNULL(b.misingo,0) AS 'misingo',
				c.Suipyogun_no
		FROM [ncustoms_sn].[kcba].[Impo3] a WITH (NOLOCK)
				LEFT OUTER JOIN [ncustoms_sn].[kcba].[Impo3_M] b WITH (NOLOCK)
				ON a.Impum_key=b.Impum_key
				AND a.Impum_lan=b.Impum_lan
				AND a.Impum_heang=b.Impum_heang

				LEFT OUTER JOIN (
					SELECT a1.SUIPYOGUN_KEY, a1.SUIPYOGUN_LAN, a1.SUIPYOGUN_HEANG,
						  SUBSTRING((SELECT ', ' + a2.SUIPYOGUN_NO
						  			FROM [ncustoms_sn].[kcba].[Impo41] a2 WITH (NOLOCK)
						  			WHERE a2.SUIPYOGUN_KEY = a1.SUIPYOGUN_KEY
						  			AND a2.SUIPYOGUN_LAN = a1.SUIPYOGUN_LAN
						  			AND a2.SUIPYOGUN_HEANG = a1.SUIPYOGUN_HEANG
						  			FOR XML PATH ('')), 3, 4000) AS 'SUIPYOGUN_NO'
					FROM [ncustoms_sn].[kcba].[Impo41] a1 WITH (NOLOCK)
					WHERE a1.SUIPYOGUN_KEY IN ${impoKeyList}
					GROUP BY a1.SUIPYOGUN_KEY, a1.SUIPYOGUN_LAN, a1.SUIPYOGUN_HEANG
				) c
				ON a.Impum_key = c.SUIPYOGUN_KEY
				AND a.Impum_lan = c.SUIPYOGUN_LAN
				AND a.Impum_heang = c.SUIPYOGUN_HEANG

		WHERE a.Impum_key IN ${impoKeyList}
		ORDER BY a.Impum_key, a.Impum_lan, a.Impum_heang
	</select>

	<select id="selectImpoAllListByImpoKeyList" resultType="map">
		/* 수입화물통관 전체 리스트(전체다운엑셀) */
		SELECT
		  a.Impo_key,
		  a.Impo_send_result,
		  a.Impo_receive_result,
		  a.Impo_bl_gubun,
		  SUBSTRING(a.impo_singo_no, 1, 5) + '-' + SUBSTRING(a.impo_singo_no, 6, 2) + '-' + SUBSTRING(a.impo_singo_no, 8, 7) AS 'impo_singo_no',
		  a.impo_bl_no,
		  a.impo_bl_no AS 'hdn_Impo_Bl_No',
		  a.Impo_hanggu_name,
		  a.Impo_pojang_su,
		  a.Impo_pojang_danwi,
		  a.Impo_total_jung,
		  a.impo_mbl_no,
		  CASE
		    WHEN ISNULL(a.Impo_iphang_date, '') = '' THEN ''
		    ELSE SUBSTRING(a.Impo_iphang_date, 1, 4) + '-' + SUBSTRING(a.Impo_iphang_date, 5, 2) + '-' + SUBSTRING(a.Impo_iphang_date, 7, 2)
		  END AS 'Impo_iphang_date',
		  CASE
		    WHEN ISNULL(a.Impo_banip_date, '') = '' THEN ''
		    ELSE SUBSTRING(a.Impo_banip_date, 1, 4) + '-' + SUBSTRING(a.Impo_banip_date, 5, 2) + '-' + SUBSTRING(a.Impo_banip_date, 7, 2)
		  END AS 'Impo_banip_date',
		  CASE
		    WHEN ISNULL(a.impo_singo_date, '') = '' THEN ''
		    ELSE SUBSTRING(a.impo_singo_date, 1, 4) + '-' + SUBSTRING(a.impo_singo_date, 5, 2) + '-' + SUBSTRING(a.impo_singo_date, 7, 2)
		  END AS 'Impo_singo_date',
		  CASE
		    WHEN ISNULL(a.impo_Ok_date, '') = '' THEN ''
		    ELSE SUBSTRING(a.impo_Ok_date, 1, 4) + '-' + SUBSTRING(a.impo_Ok_date, 5, 2) + '-' + SUBSTRING(a.impo_Ok_date, 7, 2)
		  END AS 'impo_Ok_date',
		  CASE
		    WHEN ISNULL(a.impo_Ok_date, '') = '' THEN ''
		    ELSE SUBSTRING(a.impo_Ok_date, 1, 4) + '-' + SUBSTRING(a.impo_Ok_date, 5, 2) + '-' + SUBSTRING(a.impo_Ok_date, 7, 2)
		  END AS 'impo_Ok_date1',
		  a.Impo_indo_jogun,
		  a.Impo_gyelje_money,
		  a.Impo_gyelje,
		  a.Impo_gyelje_input AS 'hidden_Impo_gyelje_input',
		  a.Impo_gyelje_input,
		  a.Impo_fre_won,
		  a.Impo_cif_total_won,
		  a.Impo_gwan_tax,
		  a.Impo_vat_tax,
		  (a.Impo_total_tax - (a.Impo_gwan_tax + a.Impo_vat_tax)) AS 'Impo_etc_tax',
		  a.Impo_total_tax,
		  ISNULL(b.Impum_sungbun3, '') AS 'daepyo_Impum_sungbun3',
		  a.Impo_jung_danwi,
		  a.Impo_cif_total_usd,
		  a.Impo_Segwan,
		  a.Impo_Gwa,
		  a.Impo_Suipja_Code,
		  a.Impo_Suipja_Sangho,
		  a.Impo_Napse_Code,
		  a.Impo_Napse_Sangho,
		  a.Impo_Suipja_Tong,
		  a.Impo_Jubsu_Date,
		  a.Impo_Forwarder_Code,
		  a.Impo_Damdang_Name,
		  a.Impo_Damdangja,
		  a.Impo_Gonggub_Sangho,
		  a.Impo_Gonggub_Buho,
		  a.Impo_Hanggu_Code,
		  a.Impo_Unsong_Type,
		  a.Impo_Ship_Name,
		  a.Impo_Edu_Tax,
		  a.Impo_Fre_Money,
		  a.Impo_Fre_Exch,
		  a.Impo_Fre,
		  a.Impo_Mrn_No,
		  a.Impo_file_no1,
		  a.Impo_file_no2,
		  a.Impo_plus_yul_gubun,
		  a.Impo_plus_yul,
		  a.Impo_plus_money,
		  a.Impo_plus_exch,
		  a.Impo_plus,
		  a.Impo_minus_yul_gubun,
		  a.Impo_minus_yul,
		  a.Impo_minus_money,
		  a.Impo_minus_exch,
		  a.Impo_minus,
		  a.Impo_jukchl_code,
		  a.Impo_jukchl_name,
		  a.Impo_ins_input,
		  c.Imlan_su AS 'total_Imlan_su',

		  /* impo2 */
		  d.Imlan_key,
		  d.Imlan_seyul_gubun,
		  d.Imlan_jechl_lan,
		  d.Imlan_hs AS 'hdnImlanHs',
		  SUBSTRING(d.Imlan_hs, 1, 4) + '.' + SUBSTRING(d.Imlan_hs, 5, 2) + '-' + SUBSTRING(d.Imlan_hs, 7, 4) AS 'Imlan_hs',
		  d.Imlan_gurae_pum,
		  d.Imlan_model,
		  d.Imlan_gije1 + d.Imlan_gije2 + d.Imlan_gije3 + d.Imlan_gije4 + d.Imlan_gije5 + d.Imlan_gije6 + d.Imlan_gije7 + d.Imlan_gije8 + d.Imlan_gije9 + d.Imlan_gije10 AS 'Imlan_gije3',
		  d.Imlan_cost,
		  d.Imlan_mulryang,
		  d.Imlan_mulryang_danwi,
		  d.Imlan_jung,
		  d.Imlan_jung_danwi,
		  d.Imlan_cif_won,
		  d.Imlan_cif_usd,
		  d.Imlan_gwan_tax,
		  d.Imlan_vat_tax,
		  d.Imlan_cs_gumsa1,
		  d.imlan_fta_obj,
		  d.Imlan_popum,  /* 표준품명 */
		  d.Imlan_su,
		  d.Imlan_su_danwi,  /* 수량 */
		  d.Imlan_gwan_gyeng_yul,
		  d.Imlan_gwan_seyula,  /* 관세감면 */
		  d.Imlan_neguk_gubun,
		  d.Imlan_neguk_code,
		  d.Imlan_neguk_myun,  /* 내국세 */
		  d.Imlan_edu_yn,
		  d.Imlan_edu_seyul,
		  d.Imlan_edu_tax, /* 교육세 */
		  d.Imlan_plus,  /* 가산금 */
		  d.Imlan_wonsanji_code,
		  d.Imlan_wonsanji_name,
		  d.Imlan_wonsanji_mark,
		  d.Imlan_wonsanji_bang,
		  d.Imlan_wonsanji_type,  /* 원산지 */
		  d.Imlan_minus,  /* 공제금 */
		  d.Imlan_wonsanji_no,  /* 원산지증명서 */
		  d.Imlan_vat_gubun,
		  d.Imlan_vat_gam_buho,
		  d.Imlan_vat_gyeng_yul,  /* 란부가세 */
		  e.Suipyogun_no AS 'Suipyogun_no_1',

		  /* impo3 */
		  f.Impum_key,
		  f.Impum_lan,
		  f.Impum_heang,
		  f.Impum_jajae_code,
		  f.Impum_gukyk1,
		  f.Impum_gukyk2,
		  f.Impum_gukyk3,
		  f.Impum_su,
		  f.Impum_su_danwi,
		  f.Impum_danga,
		  f.Impum_Amt,
		  f.Impum_sungbun1,
		  f.Impum_sungbun2,
		  f.Impum_sungbun3,
		  ISNULL(g.cifwon, 0) AS 'cifwon',
		  ISNULL(g.fre, 0) AS 'fre',
		  ISNULL(g.ins, 0) AS 'ins',
		  ISNULL(g.plus, 0) AS 'plus',
		  ISNULL(g.duty, 0) AS 'duty',
		  ISNULL(g.tk, 0) AS 'tk',
		  ISNULL(g.kt, 0) AS 'kt',
		  ISNULL(g.ju, 0) AS 'ju',
		  ISNULL(g.edu, 0) AS 'edu',
		  ISNULL(g.nong, 0) AS 'nong',
		  ISNULL(g.vat, 0) AS 'vat',
		  ISNULL(g.tax, 0) AS 'tax',
		  ISNULL(g.vat_g, 0) AS 'vat_g',
		  ISNULL(g.gasan, 0) AS 'gasan',
		  ISNULL(g.misingo, 0) AS 'misingo',
		  h.Suipyogun_no AS 'Suipyogun_no_2'

		FROM [ncustoms_sn].[kcba].[impo1] a WITH (NOLOCK)
		INNER JOIN (SELECT
		  ba.Impum_key,
		  MIN(ba.Impum_sungbun3) AS 'Impum_sungbun3'
		FROM [ncustoms_sn].[kcba].[impo3] ba WITH (NOLOCK)
		INNER JOIN (SELECT
		  ba1.Impum_key,
		  ba1.Impum_lan,
		  MIN(ba1.Impum_heang) AS 'Impum_heang'
		FROM [ncustoms_sn].[kcba].[impo3] ba1 WITH (NOLOCK)
		INNER JOIN (SELECT
		  baa.Impum_key,
		  MIN(baa.Impum_lan) AS 'Impum_lan'
		FROM [ncustoms_sn].[kcba].[impo3] baa WITH (NOLOCK)
		GROUP BY baa.Impum_key) ba2
		  ON ba1.Impum_key = ba2.Impum_key
		  AND ba1.Impum_lan = ba2.Impum_lan
		GROUP BY ba1.Impum_key,
		         ba1.Impum_lan) bb
		  ON ba.Impum_key = bb.Impum_key
		  AND ba.Impum_lan = bb.Impum_lan
		  AND ba.Impum_heang = bb.Impum_heang
		GROUP BY ba.Impum_key) b
		  ON a.Impo_key = b.Impum_key
		INNER JOIN (SELECT
		  Imlan_key,
		  SUM(Imlan_su) AS 'Imlan_su'
		FROM [ncustoms_sn].[kcba].[impo2] WITH (NOLOCK)
		GROUP BY Imlan_key) c
		  ON a.Impo_key = c.Imlan_key
		/* impo2 */
		INNER JOIN [ncustoms_sn].[kcba].[Impo2] d WITH (NOLOCK)
		  ON a.Impo_key = d.Imlan_key
		LEFT OUTER JOIN (SELECT
		  a1.Suipyogun_key,
		  a1.Suipyogun_lan,
		  SUBSTRING((SELECT
		    ', ' + a2.SUIPYOGUN_NO
		  FROM [ncustoms_sn].[kcba].[Impo4] a2 WITH (NOLOCK)
		  WHERE a2.Suipyogun_key = a1.Suipyogun_key
		  AND a2.Suipyogun_lan = a1.Suipyogun_lan
		  FOR xml PATH ('')), 3, 4000) AS 'SUIPYOGUN_NO'
		FROM [ncustoms_sn].[kcba].[Impo4] a1 WITH (NOLOCK)
		WHERE a1.Suipyogun_key IN ${impoKeyList}
		GROUP BY a1.Suipyogun_key,
		         a1.Suipyogun_lan) e
		  ON d.Imlan_key = e.Suipyogun_key
		  AND d.Imlan_jechl_lan = e.Suipyogun_lan
		/* impo3 */
		INNER JOIN [ncustoms_sn].[kcba].[Impo3] f WITH (NOLOCK)
		  ON d.Imlan_key = f.Impum_key
		  AND d.Imlan_jechl_lan = f.Impum_lan
		LEFT OUTER JOIN [ncustoms_sn].[kcba].[Impo3_M] g WITH (NOLOCK)
		  ON f.Impum_key = g.Impum_key
		  AND f.Impum_lan = g.Impum_lan
		  AND f.Impum_heang = g.Impum_heang
		LEFT OUTER JOIN (SELECT
		  a1.SUIPYOGUN_KEY,
		  a1.SUIPYOGUN_LAN,
		  a1.SUIPYOGUN_HEANG,
		  SUBSTRING((SELECT
		    ', ' + a2.SUIPYOGUN_NO
		  FROM [ncustoms_sn].[kcba].[Impo41] a2 WITH (NOLOCK)
		  WHERE a2.SUIPYOGUN_KEY = a1.SUIPYOGUN_KEY
		  AND a2.SUIPYOGUN_LAN = a1.SUIPYOGUN_LAN
		  AND a2.SUIPYOGUN_HEANG = a1.SUIPYOGUN_HEANG
		  FOR xml PATH ('')), 3, 4000) AS 'SUIPYOGUN_NO'
		FROM [ncustoms_sn].[kcba].[Impo41] a1 WITH (NOLOCK)
		WHERE a1.SUIPYOGUN_KEY IN ${impoKeyList}
		GROUP BY a1.SUIPYOGUN_KEY,
		         a1.SUIPYOGUN_LAN,
		         a1.SUIPYOGUN_HEANG) h
		  ON f.Impum_key = h.SUIPYOGUN_KEY
		  AND f.Impum_lan = h.SUIPYOGUN_LAN
		  AND f.Impum_heang = h.SUIPYOGUN_HEANG
		WHERE a.Impo_napse_saup IN ('2208146671')
		AND a.Impo_key IN ${impoKeyList}
	</select>







	<select id="findFtaList" resultType="map">
		/* FTA 자재코드별 리스트 조회 */
		SELECT a.IMPUM_JAJAE_CODE,
				SUM(a.IMPO_PLUS_TOTAL) AS 'IMPO_PLUS_TOTAL', SUM(a.IMPO_FRE_WON) AS 'IMPO_FRE_WON', SUM(a.IMPO_CIF_TOTAL_WON) AS 'IMPO_CIF_TOTAL_WON',
				SUM(a.IMPO_CIF_TOTAL_USD) AS 'IMPO_CIF_TOTAL_USD', SUM(a.IMPO_GWAN_TAX) AS 'IMPO_GWAN_TAX', SUM(a.IMPO_TEUK_TAX) AS 'IMPO_TEUK_TAX',
				SUM(a.IMPO_OIL_TAX) AS 'IMPO_OIL_TAX', SUM(a.IMPO_JU_TAX) AS 'IMPO_JU_TAX', SUM(a.IMPO_NEGUK_TAX) AS 'IMPO_NEGUK_TAX',
				SUM(a.IMPO_EDU_TAX) AS 'IMPO_EDU_TAX', SUM(a.IMPO_VAT_TAX) AS 'IMPO_VAT_TAX', SUM(a.IMPO_GASAN_TAX) AS 'IMPO_GASAN_TAX',
				SUM(a.IMPO_GITA_TAX) AS 'IMPO_GITA_TAX', SUM(a.IMPO_TOTAL_TAX) AS 'IMPO_TOTAL_TAX', SUM(a.IMPO_TOTAL_TAX)-SUM(a.IMPO_VAT_TAX) AS 'IMPO_PAYMENT_TERM',
				SUM(a.PAIDDUTY) AS 'PAIDDUTY', SUM(a.DUTYSAVINGS) AS 'DUTYSAVINGS'
		FROM [rms].[dbo].[FTA_Master] a WITH (NOLOCK)
		<where>
		    <if test='IMPUM_JAJAE_CODE != null and IMPUM_JAJAE_CODE != ""'>AND a.IMPUM_JAJAE_CODE LIKE '%' + #{IMPUM_JAJAE_CODE} + '%'</if>
			<if test='taxNum != null and taxNum != ""'>AND a.impo_napse_saup = #{taxNum}</if>
			<if test='BU != null and BU != ""'>AND a.BU = #{BU}</if>
			<if test='_DateType != "ALL" and _DateType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
	             <choose>
	                <when test='_DateType == "IMPO_OK_DATE"'>AND a.IMPO_OK_DATE BETWEEN #{strFromDate} AND #{strToDate}</when>
	             </choose>
	        </if>
			<if test='FTAAPPLICATION != null and FTAAPPLICATION != ""'>AND a.FTAAPPLICATION LIKE '%' + #{FTAAPPLICATION} + '%'</if>
		</where>
		GROUP BY a.IMPUM_JAJAE_CODE
	</select>

	<select id="findFtaDetailList" resultType="map">
		/* FTA Detail 리스트 조회 */
		SELECT	aa.*
		FROM	(
			SELECT	ROW_NUMBER() OVER (ORDER BY a.IMPO_OK_DATE) AS 'rownum',
					a.*,
					SUBSTRING(a.BU, 0, CHARINDEX('-', a.BU)) AS 'convertBu',
					SUBSTRING(a.BU, CHARINDEX('-', a.BU)+1, LEN(a.BU)) AS 'goodsYn'
			FROM	[rms].[dbo].[FTA_Master] a WITH (NOLOCK)
			<where>
			    <if test='IMPUM_JAJAE_CODE != null and IMPUM_JAJAE_CODE != ""'>AND a.IMPUM_JAJAE_CODE LIKE '%' + #{IMPUM_JAJAE_CODE} + '%'</if>
				<if test='taxNum != null and taxNum != ""'>AND a.impo_napse_saup = #{taxNum}</if>
				<if test='_DateType != "ALL" and _DateType != null and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
		             <choose>
		                <when test='sType == "IMPO_OK_DATE"'>AND a.IMPO_OK_DATE BETWEEN #{strFromDate} AND #{strToDate}</when>
		             </choose>
		        </if>
			</where>
		) aa
	</select>

	<select id="selectImJungList" resultType="map">
		/* 에드워드 수입정정리스트 */
		select * from
		(select
		d.SingoNo as 'Imjung_singo_no',
		rms.dbo.fn_NEW_DATE_VIEW('D1',d.OkDt) as 'Impo_ok_date',
		d.BlNo as 'Impo_bl_no',
		d.JungCd,
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_DCLR_MDFY_RCD' and useYn = 'Y' and Cd = d.JungCd) as 'Imjung_sayu_code',
		rms.dbo.fn_NEW_DATE_VIEW('D1',d.RecvOkDt) as 'Imjung_seungin_date',
		case when d.OkGbn is not null then d.OkGbn else '' end as 'OkGbn',
		d.BfDesc,
		d.AfDesc,
		case when d.ErrScoreLast is not null then d.ErrScoreLast else '0' end as 'ErrScoreLast',
		(select CusHnm from CPS.[dbo].[CDAB100M] where CusCd = d.Segwan) as 'Imjung_segwan',
		d.LanNo,
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_MDFY_ITEM_CD' and useYn = 'Y' and Cd = d.hangmokCode) as 'hangmokCode',
		d.ReasonCd as 'Imjung_gwichek_sayu_cd',
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMPT_RCD' and useYn = 'Y' and Cd = d.ReasonCd) as 'Imjung_gwichek_sayu_desc',
		d.ReasonSayu as 'Imjung_gwichek_sayu',
		d.DamDang as 'Imjung_damdang_name',	
		( select top 1 a.ImGongSangho from CPS.[dbo].[IMAC100] a where a.UseYn='Y' and a.ImSingoNo = d.SingoNo ) as 'ImGongSangho',	
		d.JungSayu as 'Imjung_sayu1',		
		d.hangmokCode as 'Imjung_hangmok_code'
		from CPS_SR.[dbo].[GOVCBR5FR] d
		<where> 
		    and d.imexGbn='IM'
		    <if test='taxNum != null and taxNum != ""'>AND d.DealSaupHead = #{taxNum}</if>
			<if test='impoSingoNo != null and impoSingoNo != ""'>AND d.SingoNo LIKE '%' + #{impoSingoNo} + '%'</if>
			<if test='impoBlNo != null and impoBlNo != ""'>AND d.BlNo LIKE '%' + #{impoBlNo} + '%'</if>
			<if test='_DateType != "ALL" and _DateType != null and (strFromDate5 != null and strFromDate5 != "") and (strToDate5 != null and strToDate5 != "")'>
			  <choose>
				<when test='_DateType == "Imjung_seungin_date"'>AND left(d.SinchungDtm,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
				<when test='_DateType == "Impo_ok_date"'>AND left(d.OkDt,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
			  </choose>
			</if>
		</where>) q
	    where q.OkGbn != ''
		/* 중부 전선옥 과장 요청으로 중복 제거를 제거함 (20240131)
		group by q.Imjung_singo_no, q.Impo_ok_date, q.Impo_bl_no, q.Imjung_sayu1, q.Imjung_seungin_date,
		q.OkGbn, q.BfDesc, q.AfDesc, q.ErrScoreLast, q.Imjung_gwichek_sayu_cd, q.Imjung_segwan, q.LanNo,
		q.hangmokCode, q.Imjung_hangmok_code, q.Imjung_sayu_code, q.Imjung_gwichek_sayu, q.Imjung_damdang_name, q.JungCd
		order by q.Imjung_seungin_date desc, q.Imjung_singo_no, q.LanNo, q.hangmokCode */
	</select>
	
	<select id="selectImJungList_back_back" resultType="map">
		/* 에드워드 수입정정리스트 */
		select * from
		(select
		d.SingoNo as 'Imjung_singo_no',
		rms.dbo.fn_NEW_DATE_VIEW('D1',d.OkDt) as 'Impo_ok_date',
		d.BlNo as 'Impo_bl_no',
		d.JungSayu as 'Imjung_sayu1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',d.RecvOkDt) as 'Imjung_seungin_date',
		case when d.OkGbn is not null then d.OkGbn else '' end as 'OkGbn',
		d.BfDesc,
		d.AfDesc,
		case when d.ErrScoreLast is not null then d.ErrScoreLast else '0' end as 'ErrScoreLast',
		d.ReasonCd as 'Imjung_gwichek_sayu_cd',
		(select CusHnm from CPS.[dbo].[CDAB100M] where CusCd = d.Segwan) as 'Imjung_segwan',
		d.LanNo,
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_MDFY_ITEM_CD' and useYn = 'Y' and Cd = d.hangmokCode) as 'hangmokCode',
		d.hangmokCode as 'Imjung_hangmok_code',
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_DCLR_MDFY_RCD' and useYn = 'Y' and Cd = d.JungCd) as 'Imjung_sayu_code',
		d.ReasonSayu as 'Imjung_gwichek_sayu',
		d.DamDang as 'Imjung_damdang_name',
		d.JungCd
		from CPS_SR.[dbo].[GOVCBR5FR] d
		<where> 
		    and d.DealSaupHead='3128112960'
		    and d.imexGbn='IM'
			<if test='impoSingoNo != null and impoSingoNo != ""'>AND d.SingoNo LIKE '%' + #{impoSingoNo} + '%'</if>
			<if test='impoBlNo != null and impoBlNo != ""'>AND d.BlNo LIKE '%' + #{impoBlNo} + '%'</if>
			<if test='_DateType != "ALL" and _DateType != null and (strFromDate5 != null and strFromDate5 != "") and (strToDate5 != null and strToDate5 != "")'>
			  <choose>
				<when test='_DateType == "Imjung_seungin_date"'>AND left(d.SinchungDtm,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
				<when test='_DateType == "Impo_ok_date"'>AND left(d.OkDt,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
			  </choose>
			</if>
		</where>
		union all
		select
		z.Imjung_singo_no,
		rms.dbo.fn_NEW_DATE_VIEW('D1',z.Impo_ok_date) as 'Impo_ok_date',
		z.Impo_bl_no,
		z.Imjung_sayu1,
		rms.dbo.fn_NEW_DATE_VIEW('D1',z.Imjung_seungin_date) as 'Imjung_seungin_date',
		case when d.OkGbn is not null then d.OkGbn else '' end as 'OkGbn',
		replace(z.Imjung_jung_before,',','') as 'BfDesc',
		replace(z.Imjung_jung_after,',','') as 'AfDesc',
		case when d.ErrScoreLast is not null then d.ErrScoreLast else '0' end as 'ErrScoreLast',
		z.Imjung_gwichek_sayu_cd,
		z.Imjung_segwan,
		z.Imjung_lan as 'LanNo',
		z.Imjung_hangmok_nm as 'hangmokCode',
		z.Imjung_hangmok_code,
		z.Imjung_sayu_code,
		z.Imjung_gwichek_sayu,
		z.Imjung_damdang_name,
		d.JungCd
		from
		(select
		y.Imjung_singo_no,
		y.Impo_ok_date,
		y.Impo_bl_no,
		y.Imjung_sayu1,
		y.Imjung_seungin_date,
		y.Imjung_gwichek_sayu_cd,
		c.AmdBf as 'Imjung_jung_before',
		c.AmdAf as 'Imjung_jung_after',
		c.ImLan as 'Imjung_lan',
		c.HangmokCd as 'Imjung_hangmok_code',
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_MDFY_ITEM_CD' and useYn = 'Y' and Cd = c.HangmokCd) as 'Imjung_hangmok_nm',
		y.Imjung_segwan,
		y.Imjung_sayu_code,
		y.Imjung_gwichek_sayu,
		y.Imjung_damdang_name
		from
		(select
		a.ImALMngNo,
		a.ImYr as 'Imjung_year',
		a.ImJechulNo as 'Imjung_jechl_no',
		a.ImSingoNo as 'Imjung_singo_no',
		b.ImOkDtm as 'Impo_ok_date',
		b.ImBlNo as 'Impo_bl_no',
		a.AmdSayu as 'Imjung_sayu1',
		a.RecvOkDate as 'Imjung_seungin_date',
		a.AmdResonCd as 'Imjung_gwichek_sayu_cd',
		(select CusHnm from CPS.[dbo].[CDAB100M] where CusCd = a.ImSegwan) as 'Imjung_segwan',
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_DCLR_MDFY_RCD' and useYn = 'Y' and Cd = a.AmdSayuCd) as 'Imjung_sayu_code',
		(select CdHtxt from CPS.dbo.CDAA100D where Mcd='IMP_IMPT_RCD' and Cd = a.AmdResonCd) as 'Imjung_gwichek_sayu',
		a.RecvCusNm as 'Imjung_damdang_name'
		from CPS.[dbo].[IMAL100] a, CPS.[dbo].[IMAC100] b
		where a.ImNapSaup='3128112960'
		  and a.ImSingoNo = b.ImSingoNo
		  and a.UseYn = 'Y'
		  and b.UseYn = 'Y') y left outer join CPS.[dbo].[IMAL110] c
		  on y.ImALMngNo = c.ImALMngNo) z left outer Join CPS_SR.[dbo].[GOVCBR5FR] d
		on z.Imjung_singo_no = d.SingoNo
		and z.Imjung_lan = d.LanNo
		and z.Imjung_hangmok_code = d.hangmokCode
		and left(z.Imjung_seungin_date,8) = left(d.SinchungDtm,8)
		<where>
		<if test='impoSingoNo != null and impoSingoNo != ""'>AND z.Imjung_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
		<if test='impoBlNo != null and impoBlNo != ""'>AND z.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
		<if test='_DateType != "ALL" and _DateType != null and (strFromDate5 != null and strFromDate5 != "") and (strToDate5 != null and strToDate5 != "")'>
	      <choose>
	        <when test='_DateType == "Imjung_seungin_date"'>AND left(z.Imjung_seungin_date,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
	        <when test='_DateType == "Impo_ok_date"'>AND left(z.Impo_ok_date,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
	      </choose>
	    </if>
	    </where>) q
	    where q.OkGbn != ''
		group by q.Imjung_singo_no, q.Impo_ok_date, q.Impo_bl_no, q.Imjung_sayu1, q.Imjung_seungin_date,
		q.OkGbn, q.BfDesc, q.AfDesc, q.ErrScoreLast, q.Imjung_gwichek_sayu_cd, q.Imjung_segwan, q.LanNo,
		q.hangmokCode, q.Imjung_hangmok_code, q.Imjung_sayu_code, q.Imjung_gwichek_sayu, q.Imjung_damdang_name, q.JungCd
		order by q.Imjung_seungin_date desc, q.Imjung_singo_no, q.LanNo, q.hangmokCode
	</select>

	<select id="selectImJungList_back" resultType="map">
		/* 에드워드 수입정정리스트 백업 */
		select * from
		(select
		a.Imjung_singo_no,
		rms.dbo.fn_NEW_DATE_VIEW('D1',b.Impo_ok_date) as 'Impo_ok_date',
		b.Impo_bl_no,
		a.Imjung_sayu1,
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.Imjung_seungin_date) as 'Imjung_seungin_date',
		case when d.OkGbn is not null then d.OkGbn else '' end as 'OkGbn',
		d.BfDesc,
		d.AfDesc,
		case when d.ErrScoreLast is not null then d.ErrScoreLast else '0' end as 'ErrScoreLast',
		a.Imjung_gwichek_sayu_cd,
		(select CD_DESC from soo_MST.dbo.TBR_SYS_CODE where MCD='SEGWAN' and CD = a.Imjung_segwan) as 'Imjung_segwan',
		d.LanNo,
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_MDFY_ITEM_CD' and useYn = 'Y' and Cd = d.hangmokCode) as 'hangmokCode',
		d.hangmokCode as 'Imjung_hangmok_code',
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_DCLR_MDFY_RCD' and useYn = 'Y' and Cd = a.Imjung_sayu_code) as 'Imjung_sayu_code',
		(select CD_DESC from soo_MST.dbo.TBR_SYS_CODE where MCD='IMP_IMPT_RCD' and CD = a.Imjung_gwichek_sayu_cd) as 'Imjung_gwichek_sayu',
		a.Imjung_damdang_name
		from ncustoms_ca.kcba.Imjung1 a, ncustoms_ca.kcba.Impo1 b, [122.99.247.5].[seinAnalysis].[dbo].[TBR_GOVCBR5FR] d
		<where>
		    and a.Imjung_napse_sangho='에드워드코리아(주)'
		    and a.Imjung_singo_no = b.Impo_singo_no
		    and a.Imjung_singo_no = d.SingoNo
			and left(a.Imjung_seungin_date,8) = left(d.SinchungDtm,8)
		<if test='impoSingoNo != null and impoSingoNo != ""'>AND a.Imjung_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
		<if test='impoBlNo != null and impoBlNo != ""'>AND b.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
		<if test='_DateType != "ALL" and _DateType != null and (strFromDate5 != null and strFromDate5 != "") and (strToDate5 != null and strToDate5 != "")'>
	      <choose>
	        <when test='_DateType == "Imjung_seungin_date"'>AND left(a.Imjung_seungin_date,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
	        <when test='_DateType == "Impo_ok_date"'>AND left(b.Impo_ok_date,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
	      </choose>
	    </if>
	    </where>
		union all
		select
		b.Impo_singo_no,
		rms.dbo.fn_NEW_DATE_VIEW('D1',b.Impo_ok_date) as 'Impo_ok_date',
		b.Impo_bl_no,
		a.Sinchung_sayu+a.SINCHUNG_SAYU2 as 'Imjung_sayu1',
		rms.dbo.fn_NEW_DATE_VIEW('D1',a.Ok_date) as 'Imjung_seungin_date',
		case when d.OkGbn is not null then d.OkGbn else '' end as 'OkGbn',
		d.BfDesc,
		d.AfDesc,
		case when d.ErrScoreLast is not null then d.ErrScoreLast else '0' end as 'ErrScoreLast',
		'' as Imjung_gwichek_sayu_cd,
		(select CD_DESC from soo_MST.dbo.TBR_SYS_CODE where MCD='SEGWAN' and CD = a.Impo_segwan) as 'Imjung_segwan',
		d.LanNo,
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_MDFY_ITEM_CD' and useYn = 'Y' and Cd = d.hangmokCode) as 'hangmokCode',
		d.hangmokCode as 'Imjung_hangmok_code',
		'' as 'Imjung_sayu_code',
		'' as 'Imjung_gwichek_sayu',
		a.Damdang
		from ncustoms_ca.kcba.imCancel a, ncustoms_ca.kcba.Impo1 b, [122.99.247.5].[seinAnalysis].[dbo].[TBR_GOVCBR5FR] d
		<where>
		    and b.Impo_napse_sangho='에드워드코리아(주)'
		    and a.Impo_year = b.Impo_year
			and a.Impo_jechl_no = b.Impo_jechl_no
		    and b.Impo_singo_no = d.SingoNo
			and left(a.Ok_date,8) = left(d.SinchungDtm,8)
		<if test='impoSingoNo != null and impoSingoNo != ""'>AND b.Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
		<if test='impoBlNo != null and impoBlNo != ""'>AND b.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
		<if test='_DateType != "ALL" and _DateType != null and (strFromDate5 != null and strFromDate5 != "") and (strToDate5 != null and strToDate5 != "")'>
	      <choose>
	        <when test='_DateType == "Imjung_seungin_date"'>AND left(a.Ok_date,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
	        <when test='_DateType == "Impo_ok_date"'>AND left(b.Impo_ok_date,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
	      </choose>
	    </if>
	    </where>
		union all
		select
		z.Imjung_singo_no,
		rms.dbo.fn_NEW_DATE_VIEW('D1',z.Impo_ok_date) as 'Impo_ok_date',
		z.Impo_bl_no,
		z.Imjung_sayu1,
		rms.dbo.fn_NEW_DATE_VIEW('D1',z.Imjung_seungin_date) as 'Imjung_seungin_date',
		case when d.OkGbn is not null then d.OkGbn else '' end as 'OkGbn',
		z.Imjung_jung_before as 'BfDesc',
		z.Imjung_jung_after as 'AfDesc',
		case when d.ErrScoreLast is not null then d.ErrScoreLast else '0' end as 'ErrScoreLast',
		z.Imjung_gwichek_sayu_cd,
		z.Imjung_segwan,
		z.Imjung_lan as 'LanNo',
		z.Imjung_hangmok_nm as 'hangmokCode',
		z.Imjung_hangmok_code,
		z.Imjung_sayu_code,
		z.Imjung_gwichek_sayu,
		z.Imjung_damdang_name
		from
		(select
		y.Imjung_singo_no,
		y.Impo_ok_date,
		y.Impo_bl_no,
		y.Imjung_sayu1,
		y.Imjung_seungin_date,
		y.Imjung_gwichek_sayu_cd,
		c.Imjung_jung_before,
		c.Imjung_jung_after,
		c.Imjung_lan,
		c.Imjung_hangmok_code,
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_MDFY_ITEM_CD' and useYn = 'Y' and Cd = c.Imjung_hangmok_code) as 'Imjung_hangmok_nm',
		y.Imjung_segwan,
		y.Imjung_sayu_code,
		y.Imjung_gwichek_sayu,
		y.Imjung_damdang_name
		from
		(select
		a.Imjung_year,
		a.Imjung_jechl_no,
		a.Imjung_singo_no,
		b.Impo_ok_date,
		b.Impo_bl_no,
		a.Imjung_sayu1,
		a.Imjung_seungin_date,
		a.Imjung_gwichek_sayu_cd,
		(select CD_DESC from soo_MST.dbo.TBR_SYS_CODE where MCD='SEGWAN' and CD = a.Imjung_segwan) as 'Imjung_segwan',
		(select CdPrtNm from CPS.dbo.CDAA100D where Mcd = 'IMP_DCLR_MDFY_RCD' and useYn = 'Y' and Cd = a.Imjung_sayu_code) as 'Imjung_sayu_code',
		(select CD_DESC from soo_MST.dbo.TBR_SYS_CODE where MCD='IMP_IMPT_RCD' and CD = a.Imjung_gwichek_sayu_cd) as 'Imjung_gwichek_sayu',
		a.Imjung_damdang_name
		from ncustoms_ca.kcba.Imjung1 a, ncustoms_ca.kcba.Impo1 b
		where a.Imjung_napse_sangho='에드워드코리아(주)'
		  and a.Imjung_singo_no = b.Impo_singo_no ) y left outer join ncustoms_ca.kcba.imjung2 c
		  on y.Imjung_year = c.Imjung_year
		  and y.Imjung_jechl_no = c.Imjung_jechl_no) z left outer Join [122.99.247.5].[seinAnalysis].[dbo].[TBR_GOVCBR5FR] d
		on z.Imjung_singo_no = d.SingoNo
		and z.Imjung_lan = d.LanNo
		and z.Imjung_hangmok_code = d.hangmokCode
		and left(z.Imjung_seungin_date,8) = left(d.SinchungDtm,8)
		<where>
		<if test='impoSingoNo != null and impoSingoNo != ""'>AND z.Imjung_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
		<if test='impoBlNo != null and impoBlNo != ""'>AND z.Impo_bl_no LIKE '%' + #{impoBlNo} + '%'</if>
		<if test='_DateType != "ALL" and _DateType != null and (strFromDate5 != null and strFromDate5 != "") and (strToDate5 != null and strToDate5 != "")'>
	      <choose>
	        <when test='_DateType == "Imjung_seungin_date"'>AND left(z.Imjung_seungin_date,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
	        <when test='_DateType == "Impo_ok_date"'>AND left(z.Impo_ok_date,8) BETWEEN #{strFromDate5} AND #{strToDate5}</when>
	      </choose>
	    </if>
	    </where>) q
		group by q.Imjung_singo_no, q.Impo_ok_date, q.Impo_bl_no, q.Imjung_sayu1, q.Imjung_seungin_date,
		q.OkGbn, q.BfDesc, q.AfDesc, q.ErrScoreLast, q.Imjung_gwichek_sayu_cd, q.Imjung_segwan, q.LanNo,
		q.hangmokCode, q.Imjung_hangmok_code, q.Imjung_sayu_code, q.Imjung_gwichek_sayu, q.Imjung_damdang_name
		order by q.Imjung_seungin_date desc, q.Imjung_singo_no, q.LanNo, q.hangmokCode
	</select>

	<select id="selectImJungDetailList" resultType="map">
		/* 에드워드 수입정정 상세리스트 */
		select
		b.Imjung_singo_no,
		b.Imjung_lan,
		rms.dbo.fn_NEW_DATE_VIEW('D1',b.Imjung_seungin_date) as 'SinchungDtm',
		case when d.OkGbn is not null then d.OkGbn else '' end as 'OkGbn',
		b.Imjung_hangmok_code,
		b.Imjung_hangmok,
		b.Imjung_jung_before,
		b.Imjung_jung_after,
		case when d.ErrScoreLast is not null then d.ErrScoreLast else '0' end as 'ErrScoreLast',
		b.Imjung_sayu_code,
		(select CD_DESC from soo_MST.dbo.TBR_SYS_CODE where MCD='IMP_IMPT_RCD' and CD = b.Imjung_gwichek_sayu_cd) as 'Imjung_gwichek_sayu',
		b.Imjung_damdang_name
		from
		(select
		a.Imjung_singo_no,
		c.Imjung_lan,
		a.Imjung_seungin_date,
		c.Imjung_hangmok_code,
		c.Imjung_hangmok,
		c.Imjung_jung_before,
		c.Imjung_jung_after,
		a.Imjung_sayu_code,
		a.Imjung_damdang_name,
		a.Imjung_gwichek_sayu_cd
		from ncustoms_ca.kcba.Imjung1 a, ncustoms_ca.kcba.Imjung2 c
		where a.Imjung_napse_sangho='에드워드코리아(주)'
			and a.Imjung_year = c.Imjung_year
			and a.Imjung_jechl_no = c.Imjung_jechl_no ) b left outer Join [122.99.247.5].[seinAnalysis].[dbo].[TBR_GOVCBR5FR] d
		on b.Imjung_singo_no = d.SingoNo
			and b.Imjung_lan = d.LanNo
			and b.Imjung_hangmok_code = d.hangmokCode
			where b.Imjung_singo_no LIKE '%' + #{Imjung_singo_no} + '%'
		order by b.Imjung_lan, b.Imjung_hangmok_code
	</select>

	<select id="selectImpoTaxList" resultType="map">
		/* 포르쉐 세액리스트 */
		SELECT
		  Impo_ship_name as 'Vessel'
		, Impo_singo_no as 'RegistrationNo'
		, Impo_singo_date as 'Declaration'
		, Impo_ok_date as 'DeclarationAcceptance'
		, CASE WHEN impo_jingsu_type = '43' THEN '월별납부'
		        WHEN impo_jingsu_type = '14' THEN '사후납부'
		        WHEN impo_jingsu_type = '13' THEN '사후납부'
		        WHEN impo_jingsu_type = '11' THEN '사전납부'
		   END  as 'PayNoticeNO'
		, CASE WHEN impo_jingsu_type = '43' THEN
		           CASE WHEN (DAY(DATEADD(day, -1,DATEADD(MONTH, 1, DATENAME(YEAR,convert(DATETIME,IMPO_OK_DATE)) + DATENAME(month,convert(datetime,IMPO_OK_DATE))+'01'))) - 14) <![CDATA[ > ]]> DAY(convert(datetime,IMPO_OK_DATE))
			               THEN REPLACE(left(CONVERT(CHAR(19), (select dateadd(month,1,convert(datetime,IMPO_OK_DATE)) - (day(convert(datetime,IMPO_OK_DATE)))),120),10),'-','')
			            WHEN (DAY(DATEADD(day, -1,DATEADD(MONTH, 1, DATENAME(YEAR,convert(DATETIME,IMPO_OK_DATE)) + DATENAME(month,convert(datetime,IMPO_OK_DATE))+'01'))) - 14) <![CDATA[ <= ]]> DAY(convert(datetime,IMPO_OK_DATE))
		    	           THEN REPLACE(left(CONVERT(CHAR(19), (select dateadd(month,2,convert(datetime,IMPO_OK_DATE)) - (day(convert(datetime,IMPO_OK_DATE)))),120),10),'-','')
		           END
		        WHEN impo_jingsu_type = '13' THEN  REPLACE(left(CONVERT(CHAR(19), (select dateadd(month,1,convert(datetime,IMPO_OK_DATE)) + 14),120),10),'-','')
				WHEN impo_jingsu_type = '14' THEN  REPLACE(left(CONVERT(CHAR(19), (select dateadd(month,1,convert(datetime,IMPO_OK_DATE)) + 14),120),10),'-','')
				ELSE impo_ok_date
		   END as 'DueDate'
		, (Select avk_mn From rms.dbo.tb_avk_master Where avk_vin_no = impo_file_no1) as 'MODEL'
		, '공사중' as '제원관리번호'
		, (Select orderNo From rms.dbo.tb_avk_master Where avk_vin_no = impo_file_no1) as 'ODNo'
		, Impo_file_no1 as 'VINNo'
		, (Select avk_my  From rms.dbo.tb_avk_master Where avk_vin_no = impo_file_no1) as 'Modelyear'
		, impo_cif_total_won as 'CustomsValue'
		, impo_gyelje_input as 'InvoicePrice'
		, Impo_fre_won as 'SeaFreight'
		, impo_ins_last as 'Insurance'
		, Impo_plus_total as 'AdditionalCharges'
		, Impo_gwan_tax as 'CustomsDuty'
		, Impo_teuk_tax as 'ICT'
		, Impo_edu_tax as 'EducationTax'
		, Impo_vat_tax as 'VATTax'
		, Impo_total_tax as 'TOTALTax'
		, 10000 as 'Commision'
		, 1000 as 'VAT'
		, 11000 as 'CommisionTotal'
		, CASE WHEN FLOOR(((Impo_cif_total_won + Impo_gwan_tax) * 0.015)) <![CDATA[ > ]]> 1000000
		            THEN 1000000
		       ELSE FLOOR(((Impo_cif_total_won + Impo_gwan_tax) * 0.015)/100) * 100
		  END as 'geso'
		, CASE WHEN FLOOR(((Impo_cif_total_won + Impo_gwan_tax) * 0.015)) <![CDATA[ > ]]> 1000000
		            THEN 300000
		       ELSE FLOOR(((Impo_cif_total_won + Impo_gwan_tax) * 0.015) * 0.3 / 100) * 100
		  END as 'edu'
		, CASE WHEN FLOOR(((Impo_cif_total_won + Impo_gwan_tax) * 0.015)) <![CDATA[ > ]]> 1000000
		            THEN 1400000
		       ELSE FLOOR(((Impo_cif_total_won + Impo_gwan_tax) * 0.015) / 100) * 100
		           + FLOOR(((Impo_cif_total_won + Impo_gwan_tax) * 0.015) * 0.3 / 100) * 100
		  END as 'gamTotal'
		From ncustoms.kcba.impo1 with (NoLock)
		<where>
		 and impo_napse_saup = '1208802732'
		 and impo_suipja_code = 'POSA'
		<if test='_DateType != null and _DateType != "ALL" and (strFromDate != null and strFromDate != "") and (strToDate != null and strToDate != "")'>
            <choose>
                <when test='_DateType == "Impo_ok_date_Day"'>AND Impo_ok_date BETWEEN #{strFromDate} AND #{strToDate}</when>
            </choose>
        </if>
        <if test='impoSingoNo != null and impoSingoNo != ""'>AND Impo_singo_no LIKE '%' + #{impoSingoNo} + '%'</if>
		<if test='impoFileNo1Total != null and impoFileNo1Total != ""'>AND Impo_file_no1 in ${impoFileNo1Total}</if>
		</where>
		order by impo_ok_date, impo_bl_no
	</select>

	<select id="selectSeinTotalList" resultType="map">
        select
        year, sein, tnl, sein+tnl as 'total',
        floor(round(sein/100000000,0)) as 'seinG' , floor(round(tnl/100000000,0)) as 'tnlG' , floor(round((sein+tnl)/100000000,0)) as 'totalG',
        gwan, vat, totalTax, impoTotalWon, expoTotalWon, impoTotalWon+expoTotalWon as 'total1',
        floor(round(impoTotalWon/1000000000000,0)) as 'impoTotalWonG' , floor(round(expoTotalWon/1000000000000,0)) as 'expoTotalWonG',
        floor(round((impoTotalWon+expoTotalWon)/1000000000000,0)) as 'total1G',
        impoSuri, expoSuri, impoSuri+expoSuri as 'total2'
        from CPS_WEB.[dbo].[STAT_SEIN]
        where type='B'
	</select>

	<select id="selectSeinTotalList1" resultType="map">
		select a.month,
		sum(a.ImPreYear) as 'ImPreYear',
		sum(a.ExPreYear) as 'ExPreYear',
		sum(a.TotalPreYear) as 'TotalPreYear',
		sum(a.ImNowYear) as 'ImNowYear',
		sum(a.ExNowYear) as 'ExNowYear',
		sum(a.TotalNowYear) as 'TotalNowYear',
		floor(round(sum(a.ImPreYear)/100000000,0)) as 'ImPreYearG',
		floor(round(sum(a.ExPreYear)/100000000,0)) as 'ExPreYearG',
		floor(round(sum(a.TotalPreYear)/100000000,0)) as 'TotalPreYearG',
		floor(round(sum(a.ImNowYear)/100000000,0)) as 'ImNowYearG',
		floor(round(sum(a.ExNowYear)/100000000,0)) as 'ExNowYearG',
		floor(round(sum(a.TotalNowYear)/100000000,0)) as 'TotalNowYearG',
		sum(a.ImSPreYear) as 'ImSPreYear',
		sum(a.ExSPreYear) as 'ExSPreYear',
		sum(a.TotalSPreYear) as 'TotalSPreYear',
		sum(a.ImSNowYear) as 'ImSNowYear',
		sum(a.ExSNowYear) as 'ExSNowYear',
		sum(a.TotalSNowYear) as 'TotalSNowYear'
		from
		(
		select
		month,
		impoTotalWon as 'ImPreYear',
		expoTotalWon as 'ExPreYear',
		impoTotalWon+expoTotalWon as 'TotalPreYear',
		0 as 'ImNowYear',
		0 as 'ExNowYear',
		0 as 'TotalNowYear',
		impoSuri as 'ImSPreYear',
		expoSuri as 'ExSPreYear',
		impoSuri+expoSuri as 'TotalSPreYear',
		0 as 'ImSNowYear',
		0 as 'ExSNowYear',
		0 as 'TotalSNowYear'
		from CPS_WEB.[dbo].[STAT_SEIN]
		where type='D'
		and year=#{preYear}
		union all
		select
		month,
		0 as 'ImPreYear',
		0 as 'ExPreYear',
		0 as 'TotalPreYear',
		impoTotalWon as 'ImNowYear',
		expoTotalWon as 'ExNowYear',
		impoTotalWon+expoTotalWon as 'TotalNowYear',
		0 as 'ImSPreYear',
		0 as 'ExSPreYear',
		0 as 'TotalSPreYear',
		impoSuri as 'ImSNowYear',
		expoSuri as 'ExSNowYear',
		impoSuri+expoSuri as 'TotalSNowYear'
		from CPS_WEB.[dbo].[STAT_SEIN]
		where type='D'
		and year=#{nowYear} ) a
		group by a.month
		order by a.month
	</select>

	<select id="selectSeinTotalList2" resultType="map">
        select *
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where 1 = 1
		<if test='basic != null and basic != ""'>AND Basic in ${basic}</if>
		<if test='part != null and part != ""'>and PartSort is not null</if>
		<if test='year != null and year != ""'>AND Year = #{year}</if>
		order by GroupSort, partSort
	</select>

	<select id="selectSeinTotalList3" resultType="map">
        select Year, Basic,
		floor(round(sum(Total01)/100000000,0)) as 'Total01',
		floor(round(sum(Total02)/100000000,0)) as 'Total02',
		floor(round(sum(Total03)/100000000,0)) as 'Total03',
		floor(round(sum(Total04)/100000000,0)) as 'Total04',
		floor(round(sum(Total05)/100000000,0)) as 'Total05',
		floor(round(sum(Total06)/100000000,0)) as 'Total06',
		floor(round(sum(Total07)/100000000,0)) as 'Total07',
		floor(round(sum(Total08)/100000000,0)) as 'Total08',
		floor(round(sum(Total09)/100000000,0)) as 'Total09',
		floor(round(sum(Total10)/100000000,0)) as 'Total10',
		floor(round(sum(Total11)/100000000,0)) as 'Total11',
		floor(round(sum(Total12)/100000000,0)) as 'Total12'
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where Basic in ('B')
		and Year=#{nowYear}
		group by Year, Basic
		union all
		select Year, Basic,
		floor(round(sum(Total01)/100000000,0)) as 'Total01',
		floor(round(sum(Total02)/100000000,0)) as 'Total02',
		floor(round(sum(Total03)/100000000,0)) as 'Total03',
		floor(round(sum(Total04)/100000000,0)) as 'Total04',
		floor(round(sum(Total05)/100000000,0)) as 'Total05',
		floor(round(sum(Total06)/100000000,0)) as 'Total06',
		floor(round(sum(Total07)/100000000,0)) as 'Total07',
		floor(round(sum(Total08)/100000000,0)) as 'Total08',
		floor(round(sum(Total09)/100000000,0)) as 'Total09',
		floor(round(sum(Total10)/100000000,0)) as 'Total10',
		floor(round(sum(Total11)/100000000,0)) as 'Total11',
		floor(round(sum(Total12)/100000000,0)) as 'Total12'
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where Basic in ('SS')
		and Year=#{nowYear}
		group by Year, Basic
		union all
		select Year, Basic,
		floor(round(sum(Total01)/100000000,0)) as 'Total01',
		floor(round(sum(Total02)/100000000,0)) as 'Total02',
		floor(round(sum(Total03)/100000000,0)) as 'Total03',
		floor(round(sum(Total04)/100000000,0)) as 'Total04',
		floor(round(sum(Total05)/100000000,0)) as 'Total05',
		floor(round(sum(Total06)/100000000,0)) as 'Total06',
		floor(round(sum(Total07)/100000000,0)) as 'Total07',
		floor(round(sum(Total08)/100000000,0)) as 'Total08',
		floor(round(sum(Total09)/100000000,0)) as 'Total09',
		floor(round(sum(Total10)/100000000,0)) as 'Total10',
		floor(round(sum(Total11)/100000000,0)) as 'Total11',
		floor(round(sum(Total12)/100000000,0)) as 'Total12'
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where Basic in ('SS')
		and Year=#{prevYear}
		group by Year, Basic
		union all
		select Year, Basic,
		floor(round(sum(Total01)/100000000,0)) as 'Total01',
		floor(round(sum(Total02)/100000000,0)) as 'Total02',
		floor(round(sum(Total03)/100000000,0)) as 'Total03',
		floor(round(sum(Total04)/100000000,0)) as 'Total04',
		floor(round(sum(Total05)/100000000,0)) as 'Total05',
		floor(round(sum(Total06)/100000000,0)) as 'Total06',
		floor(round(sum(Total07)/100000000,0)) as 'Total07',
		floor(round(sum(Total08)/100000000,0)) as 'Total08',
		floor(round(sum(Total09)/100000000,0)) as 'Total09',
		floor(round(sum(Total10)/100000000,0)) as 'Total10',
		floor(round(sum(Total11)/100000000,0)) as 'Total11',
		floor(round(sum(Total12)/100000000,0)) as 'Total12'
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where Basic in ('TM')
		and Year=#{prevYear}
		group by Year, Basic
		union all
		select Year, Basic,
		floor(round(sum(Total01)/100000000,0)) as 'Total01',
		floor(round(sum(Total02)/100000000,0)) as 'Total02',
		floor(round(sum(Total03)/100000000,0)) as 'Total03',
		floor(round(sum(Total04)/100000000,0)) as 'Total04',
		floor(round(sum(Total05)/100000000,0)) as 'Total05',
		floor(round(sum(Total06)/100000000,0)) as 'Total06',
		floor(round(sum(Total07)/100000000,0)) as 'Total07',
		floor(round(sum(Total08)/100000000,0)) as 'Total08',
		floor(round(sum(Total09)/100000000,0)) as 'Total09',
		floor(round(sum(Total10)/100000000,0)) as 'Total10',
		floor(round(sum(Total11)/100000000,0)) as 'Total11',
		floor(round(sum(Total12)/100000000,0)) as 'Total12'
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where Basic in ('TM')
		and Year=#{nowYear}
		group by Year, Basic
		union all
		select Year, Basic,
		floor(round(sum(Total01)/100000000,0)) as 'Total01',
		floor(round(sum(Total02)/100000000,0)) as 'Total02',
		floor(round(sum(Total03)/100000000,0)) as 'Total03',
		floor(round(sum(Total04)/100000000,0)) as 'Total04',
		floor(round(sum(Total05)/100000000,0)) as 'Total05',
		floor(round(sum(Total06)/100000000,0)) as 'Total06',
		floor(round(sum(Total07)/100000000,0)) as 'Total07',
		floor(round(sum(Total08)/100000000,0)) as 'Total08',
		floor(round(sum(Total09)/100000000,0)) as 'Total09',
		floor(round(sum(Total10)/100000000,0)) as 'Total10',
		floor(round(sum(Total11)/100000000,0)) as 'Total11',
		floor(round(sum(Total12)/100000000,0)) as 'Total12'
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where Basic in ('TI')
		and Year=#{prevYear}
		group by Year, Basic
		union all
		select Year, Basic,
		floor(round(sum(Total01)/100000000,0)) as 'Total01',
		floor(round(sum(Total02)/100000000,0)) as 'Total02',
		floor(round(sum(Total03)/100000000,0)) as 'Total03',
		floor(round(sum(Total04)/100000000,0)) as 'Total04',
		floor(round(sum(Total05)/100000000,0)) as 'Total05',
		floor(round(sum(Total06)/100000000,0)) as 'Total06',
		floor(round(sum(Total07)/100000000,0)) as 'Total07',
		floor(round(sum(Total08)/100000000,0)) as 'Total08',
		floor(round(sum(Total09)/100000000,0)) as 'Total09',
		floor(round(sum(Total10)/100000000,0)) as 'Total10',
		floor(round(sum(Total11)/100000000,0)) as 'Total11',
		floor(round(sum(Total12)/100000000,0)) as 'Total12'
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where Basic in ('TI')
		and Year=#{nowYear}
		group by Year, Basic
	</select>

	<select id="selectSeinTotalList4" resultType="map">
        select Year, Basic,
		floor(round(sum(Total01)/1000000,0)) as 'Total01',
		floor(round(sum(Total02)/1000000,0)) as 'Total02',
		floor(round(sum(Total03)/1000000,0)) as 'Total03',
		floor(round(sum(Total04)/1000000,0)) as 'Total04',
		floor(round(sum(Total05)/1000000,0)) as 'Total05',
		floor(round(sum(Total06)/1000000,0)) as 'Total06',
		floor(round(sum(Total07)/1000000,0)) as 'Total07',
		floor(round(sum(Total08)/1000000,0)) as 'Total08',
		floor(round(sum(Total09)/1000000,0)) as 'Total09',
		floor(round(sum(Total10)/1000000,0)) as 'Total10',
		floor(round(sum(Total11)/1000000,0)) as 'Total11',
		floor(round(sum(Total12)/1000000,0)) as 'Total12'
		from [122.99.247.4].[Statistic].dbo.STAT_CLFMS
		where Basic in ('SS')
		and Year=#{nowYear}
		<if test='CLFMSKey != null and CLFMSKey != ""'>AND CLFMSKey = #{CLFMSKey}</if>
		group by Year, Basic
	</select>

	<select id="selectSeinTotalList5" resultType="map">
        select
        *
        from CPS_WEB.[dbo].[STAT_SEINPART]
        where year = #{year}
        order by seq
	</select>
</mapper>